2025-10-12 17:15:54,517 | INFO | === Retraining pipeline started ===
2025-10-12 17:15:54,518 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 17:15:55,753 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_40purchase.csv
Tổng số event: 18041
Số user: 2564
Số sản phẩm: 95
Các loại event: {'view': 0.326, 'click': 0.231, 'purchase': 0.163, 'add_to_cart': 0.158, 'reject': 0.065, 'out': 0.057}
      session_id  user_id  product_id            timestamp   event_type
14746   56d97253        2          84  2024-01-17 00:00:00         view
14747   56d97253        2          84  2024-01-17 00:04:00          out
14748   56d97253        2          84  2024-01-17 00:09:00         view
14749   56d97253        2          84  2024-01-17 00:11:00        click
14750   56d97253        2          84  2024-01-17 00:15:00  add_to_cart
14751   56d97253        2          84  2024-01-17 00:17:00     purchase
14752   b9d1fadc        2          84  2024-01-19 00:21:00         view
14753   b9d1fadc        2          84  2024-01-19 00:24:00        click
14754   b9d1fadc        2          84  2024-01-19 00:27:00  add_to_cart
14755   b9d1fadc        2          84  2024-01-19 00:31:00     purchase

2025-10-12 17:15:55,753 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 17:15:56,396 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce/ecommerce.inter (18041 dòng)
   user_id  item_id            timestamp   event_type  label
0        2       84  2024-01-17 00:00:00         view      0
1        2       84  2024-01-17 00:04:00          out      0
2        2       84  2024-01-17 00:09:00         view      0
3        2       84  2024-01-17 00:11:00        click      0
4        2       84  2024-01-17 00:15:00  add_to_cart      0
5        2       84  2024-01-17 00:17:00     purchase      1
6        2       84  2024-01-19 00:21:00         view      0
7        2       84  2024-01-19 00:24:00        click      0
8        2       84  2024-01-19 00:27:00  add_to_cart      0
9        2       84  2024-01-19 00:31:00     purchase      1

2025-10-12 17:15:56,396 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 17:15:56,423 | INFO | /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python: can't open file '/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/train_bert4rec.py': [Errno 2] No such file or directory

2025-10-12 17:15:56,423 | ERROR | Retraining pipeline failed: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 77, in main
    run_step([sys.executable, "train_bert4rec.py"], PROJECT_ROOT / "recommender")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 17:18:56,505 | INFO | === Retraining pipeline started ===
2025-10-12 17:18:56,505 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 17:18:57,212 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_40purchase.csv
Tổng số event: 18124
Số user: 2578
Số sản phẩm: 95
Các loại event: {'view': 0.326, 'click': 0.231, 'purchase': 0.163, 'add_to_cart': 0.158, 'reject': 0.064, 'out': 0.057}
      session_id  user_id  product_id            timestamp   event_type
9513    2b0d724c        1          53  2024-04-21 00:00:00         view
9514    2b0d724c        1          53  2024-04-21 01:51:00          out
9515    2b0d724c        1          53  2024-04-21 02:49:00         view
9516    2b0d724c        1          53  2024-04-21 03:24:00        click
11375   01c6c6e9        2          63  2024-03-01 00:00:00         view
11376   01c6c6e9        2          63  2024-03-01 00:57:00        click
11377   01c6c6e9        2          63  2024-03-01 01:54:00       reject
15981   bb8e9202        2          90  2024-03-29 00:00:00         view
15982   bb8e9202        2          90  2024-03-29 00:19:00        click
15983   bb8e9202        2          90  2024-03-29 00:28:00  add_to_cart

2025-10-12 17:18:57,212 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 17:18:57,575 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce/ecommerce.inter (18124 dòng)
   user_id  item_id            timestamp   event_type  label
0        1       53  2024-04-21 00:00:00         view      0
1        1       53  2024-04-21 01:51:00          out      0
2        1       53  2024-04-21 02:49:00         view      0
3        1       53  2024-04-21 03:24:00        click      0
4        2       63  2024-03-01 00:00:00         view      0
5        2       63  2024-03-01 00:57:00        click      0
6        2       63  2024-03-01 01:54:00       reject      0
7        2       90  2024-03-29 00:00:00         view      0
8        2       90  2024-03-29 00:19:00        click      0
9        2       90  2024-03-29 00:28:00  add_to_cart      0

2025-10-12 17:18:57,575 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 17:18:57,584 | INFO | /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python: can't open file '/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/train_bert4rec.py': [Errno 2] No such file or directory

2025-10-12 17:18:57,584 | ERROR | Retraining pipeline failed: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 77, in main
    run_step([sys.executable, "train_bert4rec.py"], PROJECT_ROOT / "recommender")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 17:19:19,442 | INFO | === Retraining pipeline started ===
2025-10-12 17:19:19,443 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 17:19:20,565 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_40purchase.csv
Tổng số event: 18134
Số user: 2582
Số sản phẩm: 95
Các loại event: {'view': 0.327, 'click': 0.23, 'purchase': 0.162, 'add_to_cart': 0.158, 'reject': 0.064, 'out': 0.059}
     session_id  user_id  product_id            timestamp   event_type
3690   059f71f6        2          20  2024-01-31 00:00:00         view
3691   059f71f6        2          20  2024-01-31 00:51:00        click
172    aebcb07f        2           1  2024-02-15 00:00:00         view
173    aebcb07f        2           1  2024-02-15 01:12:00        click
731    6cf41ff3        2           4  2024-02-26 00:00:00         view
5521   6393d405        2          31  2024-02-26 00:00:00         view
5522   6393d405        2          31  2024-02-26 00:01:00        click
5523   6393d405        2          31  2024-02-26 00:03:00  add_to_cart
5524   6393d405        2          31  2024-02-26 00:06:00     purchase
732    6cf41ff3        2           4  2024-02-26 00:25:00       reject

2025-10-12 17:19:20,565 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 17:19:21,144 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce/ecommerce.inter (18134 dòng)
   user_id  item_id            timestamp   event_type  label
0        2       20  2024-01-31 00:00:00         view      0
1        2       20  2024-01-31 00:51:00        click      0
2        2        1  2024-02-15 00:00:00         view      0
3        2        1  2024-02-15 01:12:00        click      0
4        2        4  2024-02-26 00:00:00         view      0
5        2       31  2024-02-26 00:00:00         view      0
6        2       31  2024-02-26 00:01:00        click      0
7        2       31  2024-02-26 00:03:00  add_to_cart      0
8        2       31  2024-02-26 00:06:00     purchase      1
9        2        4  2024-02-26 00:25:00       reject      0

2025-10-12 17:19:21,144 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 17:19:21,154 | INFO | /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python: can't open file '/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/train_bert4rec.py': [Errno 2] No such file or directory

2025-10-12 17:19:21,154 | ERROR | Retraining pipeline failed: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 77, in main
    run_step([sys.executable, "train_bert4rec.py"], PROJECT_ROOT / "recommender")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 17:34:05,528 | INFO | === Retraining pipeline started ===
2025-10-12 17:34:05,528 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 17:34:06,799 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_40purchase.csv
Tổng số event: 18141
Số user: 2570
Số sản phẩm: 95
Các loại event: {'view': 0.326, 'click': 0.231, 'purchase': 0.162, 'add_to_cart': 0.159, 'reject': 0.065, 'out': 0.059}
      session_id  user_id  product_id            timestamp event_type
18067   99ff1bae        1         100  2024-02-25 00:00:00       view
18068   99ff1bae        1         100  2024-02-25 01:13:00      click
11640   c825b65b        3          64  2024-02-29 00:00:00       view
11641   c825b65b        3          64  2024-02-29 00:41:00      click
11642   c825b65b        3          64  2024-02-29 01:14:00     reject
7610    5120480e        7          40  2024-01-22 00:00:00       view
7611    5120480e        7          40  2024-01-22 00:11:00     reject
14219   8e570ccc        9          79  2024-01-31 00:00:00       view
14220   8e570ccc        9          79  2024-01-31 01:58:00        out
14221   8e570ccc        9          79  2024-01-31 03:41:00       view

2025-10-12 17:34:06,800 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 17:34:07,608 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce/ecommerce.inter (18141 dòng)
   user_id  item_id            timestamp event_type  label
0        1      100  2024-02-25 00:00:00       view      0
1        1      100  2024-02-25 01:13:00      click      0
2        3       64  2024-02-29 00:00:00       view      0
3        3       64  2024-02-29 00:41:00      click      0
4        3       64  2024-02-29 01:14:00     reject      0
5        7       40  2024-01-22 00:00:00       view      0
6        7       40  2024-01-22 00:11:00     reject      0
7        9       79  2024-01-31 00:00:00       view      0
8        9       79  2024-01-31 01:58:00        out      0
9        9       79  2024-01-31 03:41:00       view      0

2025-10-12 17:34:07,609 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 17:34:07,644 | INFO | /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python: can't open file '/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/train_bert4rec.py': [Errno 2] No such file or directory

2025-10-12 17:34:07,644 | ERROR | Retraining pipeline failed: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 77, in main
    run_step([sys.executable, "train_bert4rec.py"], PROJECT_ROOT / "recommender")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 17:45:46,688 | INFO | === Retraining pipeline started ===
2025-10-12 17:45:46,689 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 17:45:47,973 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_40purchase.csv
Tổng số event: 18173
Số user: 2593
Số sản phẩm: 95
Các loại event: {'view': 0.326, 'click': 0.232, 'purchase': 0.163, 'add_to_cart': 0.158, 'reject': 0.063, 'out': 0.058}
      session_id  user_id  product_id            timestamp   event_type
18155   fe237664        1         100  2024-01-21 00:00:00         view
18156   fe237664        1         100  2024-01-21 00:17:00       reject
13007   8cbf14b5        3          71  2024-02-20 00:00:00         view
13008   8cbf14b5        3          71  2024-02-20 00:59:00       reject
8093    c4daea36        3          44  2024-03-23 00:00:00         view
8094    c4daea36        3          44  2024-03-23 00:03:00        click
8095    c4daea36        3          44  2024-03-23 00:04:00  add_to_cart
8096    c4daea36        3          44  2024-03-23 00:06:00     purchase
8097    c4daea36        3          44  2024-03-23 00:11:00     purchase
5730    6803b5d3        4          32  2024-01-09 00:00:00         view

2025-10-12 17:45:47,973 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 17:45:48,677 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce/ecommerce.inter (18173 dòng)
   user_id  item_id            timestamp   event_type  label
0        1      100  2024-01-21 00:00:00         view      0
1        1      100  2024-01-21 00:17:00       reject      0
2        3       71  2024-02-20 00:00:00         view      0
3        3       71  2024-02-20 00:59:00       reject      0
4        3       44  2024-03-23 00:00:00         view      0
5        3       44  2024-03-23 00:03:00        click      0
6        3       44  2024-03-23 00:04:00  add_to_cart      0
7        3       44  2024-03-23 00:06:00     purchase      1
8        3       44  2024-03-23 00:11:00     purchase      1
9        4       32  2024-01-09 00:00:00         view      0

2025-10-12 17:45:48,677 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 17:45:48,697 | INFO | /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python: can't open file '/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/train_bert4rec.py': [Errno 2] No such file or directory

2025-10-12 17:45:48,697 | ERROR | Retraining pipeline failed: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 77, in main
    run_step([sys.executable, "train_bert4rec.py"], PROJECT_ROOT / "recommender")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 18:05:09,593 | INFO | === Retraining pipeline started ===
2025-10-12 18:05:09,595 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 18:05:10,986 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_40purchase.csv
Tổng số event: 18124
Số user: 2549
Số sản phẩm: 95
Các loại event: {'view': 0.326, 'click': 0.231, 'purchase': 0.163, 'add_to_cart': 0.157, 'reject': 0.064, 'out': 0.059}
      session_id  user_id  product_id            timestamp   event_type
13685   aa7b7164        1          76  2024-03-12 00:00:00         view
13686   aa7b7164        1          76  2024-03-12 00:01:00        click
13687   aa7b7164        1          76  2024-03-12 00:02:00  add_to_cart
13688   aa7b7164        1          76  2024-03-12 00:03:00     purchase
859     bd1e983a        2           7  2024-02-22 00:00:00         view
860     bd1e983a        2           7  2024-02-22 00:16:00        click
861     bd1e983a        2           7  2024-02-22 00:43:00  add_to_cart
862     bd1e983a        2           7  2024-02-22 01:13:00     purchase
863     918a8536        2           7  2024-02-26 01:29:00         view
864     918a8536        2           7  2024-02-26 01:35:00        click

2025-10-12 18:05:10,986 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 18:05:11,787 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce/ecommerce.inter (18124 dòng)
   user_id  item_id            timestamp   event_type  label
0        1       76  2024-03-12 00:00:00         view      0
1        1       76  2024-03-12 00:01:00        click      0
2        1       76  2024-03-12 00:02:00  add_to_cart      0
3        1       76  2024-03-12 00:03:00     purchase      1
4        2        7  2024-02-22 00:00:00         view      0
5        2        7  2024-02-22 00:16:00        click      0
6        2        7  2024-02-22 00:43:00  add_to_cart      0
7        2        7  2024-02-22 01:13:00     purchase      1
8        2        7  2024-02-26 01:29:00         view      0
9        2        7  2024-02-26 01:35:00        click      0

2025-10-12 18:05:11,787 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 18:05:11,805 | INFO | /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python: can't open file '/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/train_bert4rec.py': [Errno 2] No such file or directory

2025-10-12 18:05:11,805 | ERROR | Retraining pipeline failed: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 77, in main
    run_step([sys.executable, "train_bert4rec.py"], PROJECT_ROOT / "recommender")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 18:05:24,306 | INFO | === Retraining pipeline started ===
2025-10-12 18:05:24,306 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 18:05:25,060 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_40purchase.csv
Tổng số event: 17989
Số user: 2605
Số sản phẩm: 95
Các loại event: {'view': 0.326, 'click': 0.231, 'purchase': 0.162, 'add_to_cart': 0.159, 'reject': 0.065, 'out': 0.057}
      session_id  user_id  product_id            timestamp   event_type
14276   c563ebaf        1          80  2024-01-11 00:00:00         view
14277   c563ebaf        1          80  2024-01-11 00:14:00        click
14278   c563ebaf        1          80  2024-01-11 00:30:00  add_to_cart
14279   c563ebaf        1          80  2024-01-11 00:50:00       reject
12295   65c8a7fe        1          68  2024-01-30 00:00:00         view
12296   65c8a7fe        1          68  2024-01-30 00:31:00          out
12297   65c8a7fe        1          68  2024-01-30 00:49:00         view
12298   65c8a7fe        1          68  2024-01-30 01:32:00       reject
10994   db3ccba1        1          62  2024-02-01 00:00:00         view
10995   db3ccba1        1          62  2024-02-01 00:03:00        click

2025-10-12 18:05:25,061 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 18:05:25,414 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce/ecommerce.inter (17989 dòng)
   user_id  item_id            timestamp   event_type  label
0        1       80  2024-01-11 00:00:00         view      0
1        1       80  2024-01-11 00:14:00        click      0
2        1       80  2024-01-11 00:30:00  add_to_cart      0
3        1       80  2024-01-11 00:50:00       reject      0
4        1       68  2024-01-30 00:00:00         view      0
5        1       68  2024-01-30 00:31:00          out      0
6        1       68  2024-01-30 00:49:00         view      0
7        1       68  2024-01-30 01:32:00       reject      0
8        1       62  2024-02-01 00:00:00         view      0
9        1       62  2024-02-01 00:03:00        click      0

2025-10-12 18:05:25,415 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 18:05:25,425 | INFO | /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python: can't open file '/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/train_bert4rec.py': [Errno 2] No such file or directory

2025-10-12 18:05:25,426 | ERROR | Retraining pipeline failed: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 77, in main
    run_step([sys.executable, "train_bert4rec.py"], PROJECT_ROOT / "recommender")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 19:39:17,419 | INFO | === Retraining pipeline started ===
2025-10-12 19:39:17,419 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 19:39:18,587 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_40purchase.csv
Tổng số event: 18012
Số user: 2554
Số sản phẩm: 95
Các loại event: {'view': 0.326, 'click': 0.23, 'purchase': 0.163, 'add_to_cart': 0.158, 'reject': 0.064, 'out': 0.058}
     session_id  user_id  product_id            timestamp   event_type
883    a0c0ef2d        1           8  2024-03-23 00:00:00         view
884    a0c0ef2d        1           8  2024-03-23 00:04:00        click
885    a0c0ef2d        1           8  2024-03-23 00:07:00  add_to_cart
886    a0c0ef2d        1           8  2024-03-23 00:12:00     purchase
887    a0c0ef2d        1           8  2024-03-23 00:14:00     purchase
1102   c6926f92        1           8  2024-04-14 00:00:00         view
1103   c6926f92        1           8  2024-04-14 00:29:00       reject
3708   d274f8d7        2          21  2024-04-19 00:00:00         view
3709   d274f8d7        2          21  2024-04-19 00:04:00        click
3710   d274f8d7        2          21  2024-04-19 00:07:00  add_to_cart

2025-10-12 19:39:18,587 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 19:39:19,074 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce/ecommerce.inter (18012 dòng)
   user_id  item_id            timestamp   event_type  label
0        1        8  2024-03-23 00:00:00         view      0
1        1        8  2024-03-23 00:04:00        click      0
2        1        8  2024-03-23 00:07:00  add_to_cart      0
3        1        8  2024-03-23 00:12:00     purchase      1
4        1        8  2024-03-23 00:14:00     purchase      1
5        1        8  2024-04-14 00:00:00         view      0
6        1        8  2024-04-14 00:29:00       reject      0
7        2       21  2024-04-19 00:00:00         view      0
8        2       21  2024-04-19 00:04:00        click      0
9        2       21  2024-04-19 00:07:00  add_to_cart      0

2025-10-12 19:39:19,074 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 19:39:19,083 | INFO | /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python: can't open file '/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/train_bert4rec.py': [Errno 2] No such file or directory

2025-10-12 19:39:19,083 | ERROR | Retraining pipeline failed: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 77, in main
    run_step([sys.executable, "train_bert4rec.py"], PROJECT_ROOT / "recommender")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 19:39:28,921 | INFO | === Retraining pipeline started ===
2025-10-12 19:39:28,921 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 19:39:29,512 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_40purchase.csv
Tổng số event: 18029
Số user: 2555
Số sản phẩm: 95
Các loại event: {'view': 0.325, 'click': 0.231, 'purchase': 0.164, 'add_to_cart': 0.159, 'reject': 0.064, 'out': 0.057}
      session_id  user_id  product_id            timestamp   event_type
11666   76e6a890        1          65  2024-01-02 00:00:00         view
11667   76e6a890        1          65  2024-01-02 00:05:00        click
11668   76e6a890        1          65  2024-01-02 00:06:00  add_to_cart
11669   76e6a890        1          65  2024-01-02 00:08:00     purchase
11670   e6e8ba7f        1          65  2024-01-06 00:13:00         view
11671   e6e8ba7f        1          65  2024-01-06 00:14:00        click
11672   e6e8ba7f        1          65  2024-01-06 00:15:00  add_to_cart
11673   e6e8ba7f        1          65  2024-01-06 00:19:00     purchase
3522    3a70d267        1          20  2024-01-28 00:00:00         view
3523    3a70d267        1          20  2024-01-28 00:01:00        click

2025-10-12 19:39:29,512 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 19:39:29,878 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce/ecommerce.inter (18029 dòng)
   user_id  item_id            timestamp   event_type  label
0        1       65  2024-01-02 00:00:00         view      0
1        1       65  2024-01-02 00:05:00        click      0
2        1       65  2024-01-02 00:06:00  add_to_cart      0
3        1       65  2024-01-02 00:08:00     purchase      1
4        1       65  2024-01-06 00:13:00         view      0
5        1       65  2024-01-06 00:14:00        click      0
6        1       65  2024-01-06 00:15:00  add_to_cart      0
7        1       65  2024-01-06 00:19:00     purchase      1
8        1       20  2024-01-28 00:00:00         view      0
9        1       20  2024-01-28 00:01:00        click      0

2025-10-12 19:39:29,878 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 19:39:29,887 | INFO | /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python: can't open file '/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/train_bert4rec.py': [Errno 2] No such file or directory

2025-10-12 19:39:29,887 | ERROR | Retraining pipeline failed: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 77, in main
    run_step([sys.executable, "train_bert4rec.py"], PROJECT_ROOT / "recommender")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (2): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 19:42:19,473 | INFO | === Retraining pipeline started ===
2025-10-12 19:42:19,473 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 19:42:20,740 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_40purchase.csv
Tổng số event: 17966
Số user: 2565
Số sản phẩm: 95
Các loại event: {'view': 0.329, 'click': 0.229, 'purchase': 0.16, 'add_to_cart': 0.157, 'reject': 0.065, 'out': 0.061}
      session_id  user_id  product_id            timestamp   event_type
7161    1bd9b645        1          39  2024-02-27 00:00:00         view
7162    1bd9b645        1          39  2024-02-27 00:51:00        click
15303   96f086d2        2          88  2024-01-13 00:00:00         view
15304   96f086d2        2          88  2024-01-13 00:23:00        click
15305   96f086d2        2          88  2024-01-13 00:49:00  add_to_cart
15306   96f086d2        2          88  2024-01-13 01:09:00     purchase
15307   5e2ae57a        2          88  2024-01-18 01:22:00         view
15308   5e2ae57a        2          88  2024-01-18 01:50:00        click
15309   5e2ae57a        2          88  2024-01-18 02:02:00  add_to_cart
15310   5e2ae57a        2          88  2024-01-18 02:16:00     purchase

2025-10-12 19:42:20,740 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 19:42:21,273 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce/ecommerce.inter (17966 dòng)
   user_id  item_id            timestamp   event_type  label
0        1       39  2024-02-27 00:00:00         view      0
1        1       39  2024-02-27 00:51:00        click      0
2        2       88  2024-01-13 00:00:00         view      0
3        2       88  2024-01-13 00:23:00        click      0
4        2       88  2024-01-13 00:49:00  add_to_cart      0
5        2       88  2024-01-13 01:09:00     purchase      1
6        2       88  2024-01-18 01:22:00         view      0
7        2       88  2024-01-18 01:50:00        click      0
8        2       88  2024-01-18 02:02:00  add_to_cart      0
9        2       88  2024-01-18 02:16:00     purchase      1

2025-10-12 19:42:21,274 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 19:42:27,648 | INFO | 12 Oct 19:42    INFO  ['train_bert4rec.py']
12 Oct 19:42    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 129, in run_recbole
    dataset = create_dataset(config)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/utils.py", line 72, in create_dataset
    dataset = dataset_class(config)
              ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/sequential_dataset.py", line 36, in __init__
    super().__init__(config)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py", line 108, in __init__
    self._from_scratch()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py", line 118, in _from_scratch
    self._load_data(self.dataset_name, self.dataset_path)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py", line 268, in _load_data
    self._load_inter_feat(token, dataset_path)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py", line 295, in _load_inter_feat
    inter_feat = self._load_feat(inter_feat_path, FeatureSource.INTERACTION)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py", line 462, in _load_feat
    field, ftype = field_type.split(":")
    ^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)

2025-10-12 19:42:27,649 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 77, in main
    run_step([sys.executable, "train_bert4rec.py"], PROJECT_ROOT / "recommender" / "training")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 19:42:32,355 | INFO | === Retraining pipeline started ===
2025-10-12 19:42:32,355 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 19:42:33,052 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_40purchase.csv
Tổng số event: 18031
Số user: 2578
Số sản phẩm: 95
Các loại event: {'view': 0.325, 'click': 0.232, 'purchase': 0.162, 'add_to_cart': 0.16, 'reject': 0.065, 'out': 0.056}
      session_id  user_id  product_id            timestamp   event_type
1582    3a615603        1          10  2024-01-01 00:00:00         view
1583    3a615603        1          10  2024-01-01 00:40:00       reject
12947   d821ef66        2          72  2024-01-12 00:00:00         view
12948   d821ef66        2          72  2024-01-12 00:05:00        click
12949   d821ef66        2          72  2024-01-12 00:10:00  add_to_cart
12950   d821ef66        2          72  2024-01-12 00:15:00     purchase
12951   5a15a57f        2          72  2024-01-16 00:18:00         view
12952   5a15a57f        2          72  2024-01-16 00:23:00        click
12953   5a15a57f        2          72  2024-01-16 00:26:00  add_to_cart
12954   5a15a57f        2          72  2024-01-16 00:28:00     purchase

2025-10-12 19:42:33,052 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 19:42:33,362 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce/ecommerce.inter (18031 dòng)
   user_id  item_id            timestamp   event_type  label
0        1       10  2024-01-01 00:00:00         view      0
1        1       10  2024-01-01 00:40:00       reject      0
2        2       72  2024-01-12 00:00:00         view      0
3        2       72  2024-01-12 00:05:00        click      0
4        2       72  2024-01-12 00:10:00  add_to_cart      0
5        2       72  2024-01-12 00:15:00     purchase      1
6        2       72  2024-01-16 00:18:00         view      0
7        2       72  2024-01-16 00:23:00        click      0
8        2       72  2024-01-16 00:26:00  add_to_cart      0
9        2       72  2024-01-16 00:28:00     purchase      1

2025-10-12 19:42:33,362 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 19:42:36,141 | INFO | 12 Oct 19:42    INFO  ['train_bert4rec.py']
12 Oct 19:42    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 129, in run_recbole
    dataset = create_dataset(config)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/utils.py", line 72, in create_dataset
    dataset = dataset_class(config)
              ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/sequential_dataset.py", line 36, in __init__
    super().__init__(config)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py", line 108, in __init__
    self._from_scratch()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py", line 118, in _from_scratch
    self._load_data(self.dataset_name, self.dataset_path)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py", line 268, in _load_data
    self._load_inter_feat(token, dataset_path)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py", line 295, in _load_inter_feat
    inter_feat = self._load_feat(inter_feat_path, FeatureSource.INTERACTION)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py", line 462, in _load_feat
    field, ftype = field_type.split(":")
    ^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)

2025-10-12 19:42:36,141 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 77, in main
    run_step([sys.executable, "train_bert4rec.py"], PROJECT_ROOT / "recommender" / "training")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 19:48:39,613 | INFO | === Retraining pipeline started ===
2025-10-12 19:48:39,614 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 19:48:40,775 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_40purchase.csv
Tổng số event: 18129
Số user: 2567
Số sản phẩm: 95
Các loại event: {'view': 0.326, 'click': 0.231, 'purchase': 0.162, 'add_to_cart': 0.158, 'reject': 0.064, 'out': 0.058}
      session_id  user_id  product_id            timestamp   event_type
14800   36ba1a77        1          84  2024-03-09 00:00:00         view
14801   36ba1a77        1          84  2024-03-09 00:04:00          out
14802   36ba1a77        1          84  2024-03-09 00:05:00         view
14803   36ba1a77        1          84  2024-03-09 00:07:00        click
14804   36ba1a77        1          84  2024-03-09 00:09:00  add_to_cart
14805   36ba1a77        1          84  2024-03-09 00:10:00     purchase
12509   30e47295        1          70  2024-03-25 00:00:00         view
12510   30e47295        1          70  2024-03-25 00:05:00          out
12511   30e47295        1          70  2024-03-25 00:07:00         view
12512   30e47295        1          70  2024-03-25 00:11:00        click

2025-10-12 19:48:40,775 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 19:48:41,306 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce/ecommerce.inter (18129 dòng)
   user_id  item_id   timestamp  label
0        1       84  1709942400      0
1        1       84  1709942640      0
2        1       84  1709942700      0
3        1       84  1709942820      0
4        1       84  1709942940      0
5        1       84  1709943000      1
6        1       70  1711324800      0
7        1       70  1711325100      0
8        1       70  1711325220      0
9        1       70  1711325460      0

2025-10-12 19:48:41,306 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 19:48:56,224 | INFO | === Retraining pipeline started ===
2025-10-12 19:48:56,224 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 19:48:57,138 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_40purchase.csv
Tổng số event: 18113
Số user: 2565
Số sản phẩm: 95
Các loại event: {'view': 0.327, 'click': 0.23, 'purchase': 0.163, 'add_to_cart': 0.157, 'reject': 0.064, 'out': 0.059}
      session_id  user_id  product_id            timestamp   event_type
13628   0998c223        1          75  2024-03-01 00:00:00         view
13629   0998c223        1          75  2024-03-01 00:31:00        click
4827    908f902f        1          27  2024-03-09 00:00:00         view
4828    908f902f        1          27  2024-03-09 00:36:00       reject
3365    baed996a        1          19  2024-03-26 00:00:00         view
3366    baed996a        1          19  2024-03-26 00:13:00       reject
3128    675fc097        3          19  2024-01-10 00:00:00         view
3129    675fc097        3          19  2024-01-10 00:03:00        click
3130    675fc097        3          19  2024-01-10 00:06:00  add_to_cart
3131    675fc097        3          19  2024-01-10 00:08:00     purchase

2025-10-12 19:48:57,138 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 19:48:57,522 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce/ecommerce.inter (18113 dòng)
   user_id  item_id   timestamp  label
0        1       75  1709251200      0
1        1       75  1709253060      0
2        1       27  1709942400      0
3        1       27  1709944560      0
4        1       19  1711411200      0
5        1       19  1711411980      0
6        3       19  1704844800      0
7        3       19  1704844980      0
8        3       19  1704845160      0
9        3       19  1704845280      1

2025-10-12 19:48:57,523 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 19:51:01,998 | INFO | 12 Oct 19:48    INFO  ['train_bert4rec.py']
12 Oct 19:48    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
12 Oct 19:48    INFO  ecommerce
The number of users: 2568
Average actions of users: 7.062329567588625
The number of items: 96
Average actions of items: 190.83157894736843
The number of inters: 18129
The sparsity of the dataset: 92.64627141744548%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
12 Oct 19:48    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
12 Oct 19:48    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
12 Oct 19:48    INFO  BERT4Rec(
  (item_embedding): Embedding(97, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 113888
12 Oct 19:48    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                           | 0/11 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.02 G/3.68 G]
Train     0:   9%|██▍                        | 1/11 [00:00<00:03,  2.77it/s, GPU RAM: 1.02 G/3.68 G]
Train     0:   9%|██▍                        | 1/11 [00:00<00:03,  2.77it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  18%|████▉                      | 2/11 [00:00<00:02,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  18%|████▉                      | 2/11 [00:00<00:02,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  27%|███████▎                   | 3/11 [00:00<00:01,  5.76it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  27%|███████▎                   | 3/11 [00:00<00:01,  5.76it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  36%|█████████▊                 | 4/11 [00:00<00:01,  6.78it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  36%|█████████▊                 | 4/11 [00:00<00:01,  6.78it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  45%|████████████▎              | 5/11 [00:00<00:00,  7.58it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  45%|████████████▎              | 5/11 [00:00<00:00,  7.58it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.14it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  55%|██████████████▋            | 6/11 [00:01<00:00,  8.14it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  64%|█████████████████▏         | 7/11 [00:01<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  64%|█████████████████▏         | 7/11 [00:01<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.84it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.84it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.05it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.05it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train     0: 100%|██████████████████████████| 11/11 [00:01<00:00,  7.69it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:48    INFO  epoch 0 training [time: 1.43s, train loss: 49.7464]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.32it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.32it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 24.56it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:48    INFO  epoch 0 evaluating [time: 0.14s, valid_score: 0.056000]
12 Oct 19:48    INFO  valid result: 
recall@5 : 0.1008    recall@10 : 0.1589    mrr@5 : 0.0481    mrr@10 : 0.056    ndcg@5 : 0.061    ndcg@10 : 0.0799    hit@5 : 0.1008    hit@10 : 0.1589    precision@5 : 0.0202    precision@10 : 0.0159
12 Oct 19:48    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train     1:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     1:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:   9%|██▍                        | 1/11 [00:00<00:01,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:   9%|██▍                        | 1/11 [00:00<00:01,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  18%|████▉                      | 2/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  18%|████▉                      | 2/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  27%|███████▎                   | 3/11 [00:00<00:00,  9.52it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  27%|███████▎                   | 3/11 [00:00<00:00,  9.52it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  45%|████████████▎              | 5/11 [00:00<00:00,  9.52it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  45%|████████████▎              | 5/11 [00:00<00:00,  9.52it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.45it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.45it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.45it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.45it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.49it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.49it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.49it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.49it/s, GPU RAM: 1.07 G/3.68 G]
Train     1: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:48    INFO  epoch 1 training [time: 1.15s, train loss: 48.9588]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.71it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.65it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:48    INFO  epoch 1 evaluating [time: 0.11s, valid_score: 0.077900]
12 Oct 19:48    INFO  valid result: 
recall@5 : 0.1352    recall@10 : 0.2198    mrr@5 : 0.0671    mrr@10 : 0.0779    ndcg@5 : 0.0839    ndcg@10 : 0.1109    hit@5 : 0.1352    hit@10 : 0.2198    precision@5 : 0.027    precision@10 : 0.022
12 Oct 19:48    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train     2:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     2:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:   9%|██▍                        | 1/11 [00:00<00:01,  9.07it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:   9%|██▍                        | 1/11 [00:00<00:01,  9.07it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  18%|████▉                      | 2/11 [00:00<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  18%|████▉                      | 2/11 [00:00<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  27%|███████▎                   | 3/11 [00:00<00:00,  9.49it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  27%|███████▎                   | 3/11 [00:00<00:00,  9.49it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  45%|████████████▎              | 5/11 [00:00<00:00,  7.26it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  45%|████████████▎              | 5/11 [00:00<00:00,  7.26it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  55%|██████████████▋            | 6/11 [00:00<00:00,  7.90it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  55%|██████████████▋            | 6/11 [00:00<00:00,  7.90it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.35it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.35it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.66it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.66it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.87it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.87it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.99it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.99it/s, GPU RAM: 1.07 G/3.68 G]
Train     2: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.83it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:48    INFO  epoch 2 training [time: 1.25s, train loss: 46.8465]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.91it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.91it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 25.37it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:48    INFO  epoch 2 evaluating [time: 0.13s, valid_score: 0.260200]
12 Oct 19:48    INFO  valid result: 
recall@5 : 0.3871    recall@10 : 0.5711    mrr@5 : 0.2355    mrr@10 : 0.2602    ndcg@5 : 0.273    ndcg@10 : 0.3327    hit@5 : 0.3871    hit@10 : 0.5711    precision@5 : 0.0774    precision@10 : 0.0571
12 Oct 19:48    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train     3:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     3:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:   9%|██▍                        | 1/11 [00:00<00:01,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:   9%|██▍                        | 1/11 [00:00<00:01,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  18%|████▉                      | 2/11 [00:00<00:01,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  18%|████▉                      | 2/11 [00:00<00:01,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  27%|███████▎                   | 3/11 [00:00<00:00,  8.91it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  27%|███████▎                   | 3/11 [00:00<00:00,  8.91it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  45%|████████████▎              | 5/11 [00:00<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  45%|████████████▎              | 5/11 [00:00<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.52it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.52it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.61it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.61it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.66it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.66it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.68it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.68it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.70it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.70it/s, GPU RAM: 1.07 G/3.68 G]
Train     3: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.59it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:48    INFO  epoch 3 training [time: 1.15s, train loss: 42.8452]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 16.90it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 16.90it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 23.78it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:48    INFO  epoch 3 evaluating [time: 0.13s, valid_score: 0.455000]
12 Oct 19:48    INFO  valid result: 
recall@5 : 0.6431    recall@10 : 0.7286    mrr@5 : 0.4431    mrr@10 : 0.455    ndcg@5 : 0.4929    ndcg@10 : 0.5211    hit@5 : 0.6431    hit@10 : 0.7286    precision@5 : 0.1286    precision@10 : 0.0729
12 Oct 19:48    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train     4:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     4:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:   9%|██▍                        | 1/11 [00:00<00:01,  8.93it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:   9%|██▍                        | 1/11 [00:00<00:01,  8.93it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  18%|████▉                      | 2/11 [00:00<00:00,  9.01it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  18%|████▉                      | 2/11 [00:00<00:00,  9.01it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  27%|███████▎                   | 3/11 [00:00<00:00,  8.80it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  27%|███████▎                   | 3/11 [00:00<00:00,  8.80it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  45%|████████████▎              | 5/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  45%|████████████▎              | 5/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.54it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.54it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train     4: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:48    INFO  epoch 4 training [time: 1.17s, train loss: 39.1037]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 16.90it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 16.90it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 23.92it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:48    INFO  epoch 4 evaluating [time: 0.14s, valid_score: 0.542500]
12 Oct 19:48    INFO  valid result: 
recall@5 : 0.6859    recall@10 : 0.7412    mrr@5 : 0.5352    mrr@10 : 0.5425    ndcg@5 : 0.5733    ndcg@10 : 0.5911    hit@5 : 0.6859    hit@10 : 0.7412    precision@5 : 0.1372    precision@10 : 0.0741
12 Oct 19:48    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train     5:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     5:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:   9%|██▍                        | 1/11 [00:00<00:01,  8.57it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:   9%|██▍                        | 1/11 [00:00<00:01,  8.57it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  18%|████▉                      | 2/11 [00:00<00:01,  7.82it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  18%|████▉                      | 2/11 [00:00<00:01,  7.82it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  27%|███████▎                   | 3/11 [00:00<00:00,  8.29it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  27%|███████▎                   | 3/11 [00:00<00:00,  8.29it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.59it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.59it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  45%|████████████▎              | 5/11 [00:00<00:00,  8.81it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  45%|████████████▎              | 5/11 [00:00<00:00,  8.81it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.87it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.87it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.02it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.02it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.12it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  73%|███████████████████▋       | 8/11 [00:01<00:00,  9.12it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.81it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.81it/s, GPU RAM: 1.07 G/3.68 G]
Train     5: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.87it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:48    INFO  epoch 5 training [time: 1.24s, train loss: 35.7476]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.75it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.75it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 25.10it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:48    INFO  epoch 5 evaluating [time: 0.13s, valid_score: 0.607500]
12 Oct 19:48    INFO  valid result: 
recall@5 : 0.711    recall@10 : 0.7691    mrr@5 : 0.5998    mrr@10 : 0.6075    ndcg@5 : 0.6276    ndcg@10 : 0.6463    hit@5 : 0.711    hit@10 : 0.7691    precision@5 : 0.1422    precision@10 : 0.0769
12 Oct 19:48    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train     6:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     6:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:   9%|██▍                        | 1/11 [00:00<00:01,  8.98it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:   9%|██▍                        | 1/11 [00:00<00:01,  8.98it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  18%|████▉                      | 2/11 [00:00<00:01,  6.30it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  18%|████▉                      | 2/11 [00:00<00:01,  6.30it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  27%|███████▎                   | 3/11 [00:00<00:01,  7.42it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  27%|███████▎                   | 3/11 [00:00<00:01,  7.42it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.10it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.10it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  45%|████████████▎              | 5/11 [00:00<00:00,  8.52it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  45%|████████████▎              | 5/11 [00:00<00:00,  8.52it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.66it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.66it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.94it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.94it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.10it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  73%|███████████████████▋       | 8/11 [00:01<00:00,  9.10it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.20it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.20it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train     6: 100%|██████████████████████████| 11/11 [00:01<00:00,  7.75it/s, GPU RAM: 1.07 G/3.68 G]
Train     6: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.25it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:48    INFO  epoch 6 training [time: 1.33s, train loss: 32.5455]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 15.72it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 15.72it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 21.74it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:48    INFO  epoch 6 evaluating [time: 0.15s, valid_score: 0.655200]
12 Oct 19:48    INFO  valid result: 
recall@5 : 0.7407    recall@10 : 0.7974    mrr@5 : 0.6476    mrr@10 : 0.6552    ndcg@5 : 0.6709    ndcg@10 : 0.6893    hit@5 : 0.7407    hit@10 : 0.7974    precision@5 : 0.1481    precision@10 : 0.0797
12 Oct 19:48    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train     7:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     7:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:   9%|██▍                        | 1/11 [00:00<00:01,  8.85it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:   9%|██▍                        | 1/11 [00:00<00:01,  8.85it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  18%|████▉                      | 2/11 [00:00<00:01,  7.95it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  18%|████▉                      | 2/11 [00:00<00:01,  7.95it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  27%|███████▎                   | 3/11 [00:00<00:00,  8.19it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  27%|███████▎                   | 3/11 [00:00<00:00,  8.19it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.59it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.59it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  45%|████████████▎              | 5/11 [00:00<00:00,  8.92it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  45%|████████████▎              | 5/11 [00:00<00:00,  8.92it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.31it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.31it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.43it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.43it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.48it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.48it/s, GPU RAM: 1.07 G/3.68 G]
Train     7: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.23it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 7 training [time: 1.19s, train loss: 29.3859]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 30.51it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 7 evaluating [time: 0.10s, valid_score: 0.708800]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.7807    recall@10 : 0.8192    mrr@5 : 0.7036    mrr@10 : 0.7088    ndcg@5 : 0.723    ndcg@10 : 0.7355    hit@5 : 0.7807    hit@10 : 0.8192    precision@5 : 0.1561    precision@10 : 0.0819
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train     8:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     8:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:   9%|██▍                        | 1/11 [00:00<00:01,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:   9%|██▍                        | 1/11 [00:00<00:01,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  18%|████▉                      | 2/11 [00:00<00:00,  9.54it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  18%|████▉                      | 2/11 [00:00<00:00,  9.54it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  27%|███████▎                   | 3/11 [00:00<00:00,  9.55it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  27%|███████▎                   | 3/11 [00:00<00:00,  9.55it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.50it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.50it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  45%|████████████▎              | 5/11 [00:00<00:00,  8.42it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  45%|████████████▎              | 5/11 [00:00<00:00,  8.42it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.74it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.74it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.02it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.02it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.14it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.14it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.37it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.37it/s, GPU RAM: 1.07 G/3.68 G]
Train     8: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.40it/s, GPU RAM: 1.07 G/3.68 G]
Train     8: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 8 training [time: 1.19s, train loss: 26.6825]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 16.66it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 16.66it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 21.21it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 8 evaluating [time: 0.16s, valid_score: 0.741700]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.7969    recall@10 : 0.8336    mrr@5 : 0.7369    mrr@10 : 0.7417    ndcg@5 : 0.752    ndcg@10 : 0.7638    hit@5 : 0.7969    hit@10 : 0.8336    precision@5 : 0.1594    precision@10 : 0.0834
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train     9:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     9:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:   9%|██▍                        | 1/11 [00:00<00:01,  9.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:   9%|██▍                        | 1/11 [00:00<00:01,  9.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  18%|████▉                      | 2/11 [00:00<00:01,  7.56it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  18%|████▉                      | 2/11 [00:00<00:01,  7.56it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  27%|███████▎                   | 3/11 [00:00<00:01,  7.91it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  27%|███████▎                   | 3/11 [00:00<00:01,  7.91it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.09it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.09it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  45%|████████████▎              | 5/11 [00:00<00:00,  8.36it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  45%|████████████▎              | 5/11 [00:00<00:00,  8.36it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.52it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.52it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.46it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  64%|█████████████████▏         | 7/11 [00:01<00:00,  8.46it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  73%|███████████████████▋       | 8/11 [00:01<00:00,  7.45it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  73%|███████████████████▋       | 8/11 [00:01<00:00,  7.45it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  82%|██████████████████████     | 9/11 [00:01<00:00,  7.77it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  82%|██████████████████████     | 9/11 [00:01<00:00,  7.77it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.23it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.23it/s, GPU RAM: 1.07 G/3.68 G]
Train     9: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.68it/s, GPU RAM: 1.07 G/3.68 G]
Train     9: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.25it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 9 training [time: 1.33s, train loss: 24.4023]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.71it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.71it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 25.21it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 9 evaluating [time: 0.14s, valid_score: 0.762500]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8118    recall@10 : 0.8457    mrr@5 : 0.758    mrr@10 : 0.7625    ndcg@5 : 0.7715    ndcg@10 : 0.7824    hit@5 : 0.8118    hit@10 : 0.8457    precision@5 : 0.1624    precision@10 : 0.0846
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    10:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    10:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:   9%|██▍                        | 1/11 [00:00<00:01,  6.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:   9%|██▍                        | 1/11 [00:00<00:01,  6.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  18%|████▉                      | 2/11 [00:00<00:01,  7.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  18%|████▉                      | 2/11 [00:00<00:01,  7.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  27%|███████▎                   | 3/11 [00:00<00:01,  7.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  27%|███████▎                   | 3/11 [00:00<00:01,  7.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  36%|█████████▊                 | 4/11 [00:00<00:00,  7.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  36%|█████████▊                 | 4/11 [00:00<00:00,  7.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  45%|████████████▎              | 5/11 [00:00<00:01,  4.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  45%|████████████▎              | 5/11 [00:01<00:01,  4.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.87it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.87it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  4.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    10: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    10: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.30it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 10 training [time: 2.08s, train loss: 22.0765]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.85it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.85it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.67it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.67it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.95it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 10 evaluating [time: 0.45s, valid_score: 0.780700]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8281    recall@10 : 0.8592    mrr@5 : 0.7765    mrr@10 : 0.7807    ndcg@5 : 0.7895    ndcg@10 : 0.7995    hit@5 : 0.8281    hit@10 : 0.8592    precision@5 : 0.1656    precision@10 : 0.0859
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    11:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    11:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:   9%|██▍                        | 1/11 [00:00<00:02,  4.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:   9%|██▍                        | 1/11 [00:00<00:02,  4.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  18%|████▉                      | 2/11 [00:00<00:01,  4.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  18%|████▉                      | 2/11 [00:00<00:01,  4.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  27%|███████▎                   | 3/11 [00:00<00:01,  4.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  27%|███████▎                   | 3/11 [00:00<00:01,  4.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  45%|████████████▎              | 5/11 [00:00<00:01,  5.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  45%|████████████▎              | 5/11 [00:01<00:01,  5.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  4.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    11: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    11: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.00it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 11 training [time: 2.20s, train loss: 20.0062]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.68it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.68it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.85it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.85it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  7.14it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 11 evaluating [time: 0.46s, valid_score: 0.803600]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8425    recall@10 : 0.8634    mrr@5 : 0.8008    mrr@10 : 0.8036    ndcg@5 : 0.8113    ndcg@10 : 0.8181    hit@5 : 0.8425    hit@10 : 0.8634    precision@5 : 0.1685    precision@10 : 0.0863
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    12:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    12:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:   9%|██▍                        | 1/11 [00:00<00:02,  3.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:   9%|██▍                        | 1/11 [00:00<00:02,  3.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  18%|████▉                      | 2/11 [00:00<00:02,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  18%|████▉                      | 2/11 [00:00<00:02,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  27%|███████▎                   | 3/11 [00:00<00:01,  4.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  27%|███████▎                   | 3/11 [00:00<00:01,  4.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  45%|████████████▎              | 5/11 [00:00<00:01,  5.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  45%|████████████▎              | 5/11 [00:01<00:01,  5.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.99it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.99it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  64%|█████████████████▏         | 7/11 [00:01<00:00,  6.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  64%|█████████████████▏         | 7/11 [00:01<00:00,  6.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  73%|███████████████████▋       | 8/11 [00:01<00:00,  6.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  73%|███████████████████▋       | 8/11 [00:01<00:00,  6.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  5.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    12: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    12: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.19it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 12 training [time: 2.12s, train loss: 18.0701]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.32it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.32it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.66it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.66it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.42it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 12 evaluating [time: 0.50s, valid_score: 0.823000]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8559    recall@10 : 0.868    mrr@5 : 0.8215    mrr@10 : 0.823    ndcg@5 : 0.8301    ndcg@10 : 0.8339    hit@5 : 0.8559    hit@10 : 0.868    precision@5 : 0.1712    precision@10 : 0.0868
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    13:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    13:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:   9%|██▍                        | 1/11 [00:00<00:02,  4.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:   9%|██▍                        | 1/11 [00:00<00:02,  4.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  18%|████▉                      | 2/11 [00:00<00:01,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  18%|████▉                      | 2/11 [00:00<00:01,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  27%|███████▎                   | 3/11 [00:00<00:01,  4.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  27%|███████▎                   | 3/11 [00:00<00:01,  4.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  45%|████████████▎              | 5/11 [00:01<00:01,  4.67it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  45%|████████████▎              | 5/11 [00:01<00:01,  4.67it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.76it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.76it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  82%|██████████████████████     | 9/11 [00:01<00:00,  6.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  82%|██████████████████████     | 9/11 [00:01<00:00,  6.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  5.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    13: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    13: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.14it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 13 training [time: 2.14s, train loss: 16.4830]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.11it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.11it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.36it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.36it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  7.03it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 13 evaluating [time: 0.44s, valid_score: 0.834800]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8611    recall@10 : 0.8736    mrr@5 : 0.8332    mrr@10 : 0.8348    ndcg@5 : 0.8402    ndcg@10 : 0.8442    hit@5 : 0.8611    hit@10 : 0.8736    precision@5 : 0.1722    precision@10 : 0.0874
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    14:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    14:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:   9%|██▍                        | 1/11 [00:00<00:02,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:   9%|██▍                        | 1/11 [00:00<00:02,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  18%|████▉                      | 2/11 [00:00<00:01,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  18%|████▉                      | 2/11 [00:00<00:01,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  27%|███████▎                   | 3/11 [00:00<00:01,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  27%|███████▎                   | 3/11 [00:00<00:01,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  45%|████████████▎              | 5/11 [00:01<00:01,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  45%|████████████▎              | 5/11 [00:01<00:01,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    14: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    14: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.51it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 14 training [time: 2.44s, train loss: 15.3477]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.74it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.74it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.02it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.02it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.51it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 14 evaluating [time: 0.47s, valid_score: 0.839000]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8638    recall@10 : 0.8773    mrr@5 : 0.8371    mrr@10 : 0.839    ndcg@5 : 0.8439    ndcg@10 : 0.8483    hit@5 : 0.8638    hit@10 : 0.8773    precision@5 : 0.1728    precision@10 : 0.0877
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    15:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    15:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:   9%|██▍                        | 1/11 [00:00<00:02,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:   9%|██▍                        | 1/11 [00:00<00:02,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  18%|████▉                      | 2/11 [00:00<00:02,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  18%|████▉                      | 2/11 [00:00<00:02,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  27%|███████▎                   | 3/11 [00:00<00:01,  4.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  27%|███████▎                   | 3/11 [00:00<00:01,  4.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  45%|████████████▎              | 5/11 [00:01<00:01,  5.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  45%|████████████▎              | 5/11 [00:01<00:01,  5.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  5.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    15: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    15: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.09it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 15 training [time: 2.16s, train loss: 15.2076]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.90it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.90it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.04it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.04it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  7.86it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 15 evaluating [time: 0.40s, valid_score: 0.851300]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8708    recall@10 : 0.8829    mrr@5 : 0.8498    mrr@10 : 0.8513    ndcg@5 : 0.855    ndcg@10 : 0.8588    hit@5 : 0.8708    hit@10 : 0.8829    precision@5 : 0.1742    precision@10 : 0.0883
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    16:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    16:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:   9%|██▍                        | 1/11 [00:00<00:02,  3.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:   9%|██▍                        | 1/11 [00:00<00:02,  3.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  18%|████▉                      | 2/11 [00:00<00:02,  3.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  18%|████▉                      | 2/11 [00:00<00:02,  3.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  27%|███████▎                   | 3/11 [00:00<00:01,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  27%|███████▎                   | 3/11 [00:01<00:01,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  45%|████████████▎              | 5/11 [00:01<00:01,  4.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  45%|████████████▎              | 5/11 [00:01<00:01,  4.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.76it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.76it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.45it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  82%|██████████████████████     | 9/11 [00:02<00:00,  5.45it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    16: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    16: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.96it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 16 training [time: 2.22s, train loss: 14.0708]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.38it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.38it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.57it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.57it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.93it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 16 evaluating [time: 0.44s, valid_score: 0.850300]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8694    recall@10 : 0.8838    mrr@5 : 0.8483    mrr@10 : 0.8503    ndcg@5 : 0.8536    ndcg@10 : 0.8583    hit@5 : 0.8694    hit@10 : 0.8838    precision@5 : 0.1739    precision@10 : 0.0884

Train    17:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    17:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:   9%|██▍                        | 1/11 [00:00<00:02,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:   9%|██▍                        | 1/11 [00:00<00:02,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  18%|████▉                      | 2/11 [00:00<00:01,  5.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  18%|████▉                      | 2/11 [00:00<00:01,  5.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  27%|███████▎                   | 3/11 [00:00<00:01,  4.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  27%|███████▎                   | 3/11 [00:00<00:01,  4.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  45%|████████████▎              | 5/11 [00:01<00:01,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  45%|████████████▎              | 5/11 [00:01<00:01,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  5.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    17: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.12it/s, GPU RAM: 1.07 G/3.68 G]
Train    17: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.09it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 17 training [time: 2.16s, train loss: 13.5478]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.32it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.32it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  3.46it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  3.46it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 17 evaluating [time: 0.66s, valid_score: 0.852500]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8694    recall@10 : 0.8875    mrr@5 : 0.8501    mrr@10 : 0.8525    ndcg@5 : 0.855    ndcg@10 : 0.8609    hit@5 : 0.8694    hit@10 : 0.8875    precision@5 : 0.1739    precision@10 : 0.0888
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    18:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    18:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:   9%|██▍                        | 1/11 [00:00<00:02,  4.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:   9%|██▍                        | 1/11 [00:00<00:02,  4.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  18%|████▉                      | 2/11 [00:00<00:02,  4.45it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  18%|████▉                      | 2/11 [00:00<00:02,  4.45it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  27%|███████▎                   | 3/11 [00:00<00:01,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  27%|███████▎                   | 3/11 [00:00<00:01,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  45%|████████████▎              | 5/11 [00:01<00:01,  5.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  45%|████████████▎              | 5/11 [00:01<00:01,  5.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.94it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.94it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.76it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.76it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    18: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    18: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.81it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 18 training [time: 2.29s, train loss: 12.1666]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.09it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.09it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  3.66it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  3.66it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  4.94it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 18 evaluating [time: 0.63s, valid_score: 0.852900]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.869    recall@10 : 0.8857    mrr@5 : 0.8507    mrr@10 : 0.8529    ndcg@5 : 0.8553    ndcg@10 : 0.8607    hit@5 : 0.869    hit@10 : 0.8857    precision@5 : 0.1738    precision@10 : 0.0886
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    19:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    19:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:   9%|██▍                        | 1/11 [00:00<00:02,  4.99it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:   9%|██▍                        | 1/11 [00:00<00:02,  4.99it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  18%|████▉                      | 2/11 [00:00<00:01,  4.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  18%|████▉                      | 2/11 [00:00<00:01,  4.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  27%|███████▎                   | 3/11 [00:00<00:01,  4.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  27%|███████▎                   | 3/11 [00:00<00:01,  4.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  45%|████████████▎              | 5/11 [00:00<00:01,  5.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  45%|████████████▎              | 5/11 [00:01<00:01,  5.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    19: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    19: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.81it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 19 training [time: 2.29s, train loss: 12.1991]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.62it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.62it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  7.56it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 19 evaluating [time: 0.41s, valid_score: 0.854200]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8731    recall@10 : 0.8875    mrr@5 : 0.8522    mrr@10 : 0.8542    ndcg@5 : 0.8575    ndcg@10 : 0.8622    hit@5 : 0.8731    hit@10 : 0.8875    precision@5 : 0.1746    precision@10 : 0.0888
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    20:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    20:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:   9%|██▍                        | 1/11 [00:00<00:02,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:   9%|██▍                        | 1/11 [00:00<00:02,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  18%|████▉                      | 2/11 [00:00<00:01,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  18%|████▉                      | 2/11 [00:00<00:01,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  27%|███████▎                   | 3/11 [00:00<00:01,  4.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  27%|███████▎                   | 3/11 [00:00<00:01,  4.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  45%|████████████▎              | 5/11 [00:00<00:01,  5.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  45%|████████████▎              | 5/11 [00:01<00:01,  5.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  5.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    20: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    20: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.21it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 20 training [time: 2.11s, train loss: 12.0695]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.53it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.53it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  5.73it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 20 evaluating [time: 0.53s, valid_score: 0.855500]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8736    recall@10 : 0.8857    mrr@5 : 0.8539    mrr@10 : 0.8555    ndcg@5 : 0.8588    ndcg@10 : 0.8628    hit@5 : 0.8736    hit@10 : 0.8857    precision@5 : 0.1747    precision@10 : 0.0886
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    21:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    21:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:   9%|██▍                        | 1/11 [00:00<00:02,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:   9%|██▍                        | 1/11 [00:00<00:02,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  18%|████▉                      | 2/11 [00:00<00:02,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  18%|████▉                      | 2/11 [00:00<00:02,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  27%|███████▎                   | 3/11 [00:00<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  27%|███████▎                   | 3/11 [00:00<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  36%|█████████▊                 | 4/11 [00:01<00:01,  5.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  45%|████████████▎              | 5/11 [00:01<00:01,  5.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  45%|████████████▎              | 5/11 [00:01<00:01,  5.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  64%|█████████████████▏         | 7/11 [00:01<00:00,  6.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  64%|█████████████████▏         | 7/11 [00:01<00:00,  6.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  4.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    21: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    21: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.98it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 21 training [time: 2.21s, train loss: 12.2220]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.37it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.37it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.35it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.35it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.39it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 21 evaluating [time: 0.48s, valid_score: 0.855900]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8727    recall@10 : 0.8875    mrr@5 : 0.8539    mrr@10 : 0.8559    ndcg@5 : 0.8586    ndcg@10 : 0.8634    hit@5 : 0.8727    hit@10 : 0.8875    precision@5 : 0.1745    precision@10 : 0.0888
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    22:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    22:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:   9%|██▍                        | 1/11 [00:00<00:02,  4.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:   9%|██▍                        | 1/11 [00:00<00:02,  4.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  18%|████▉                      | 2/11 [00:00<00:02,  4.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  18%|████▉                      | 2/11 [00:00<00:02,  4.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  27%|███████▎                   | 3/11 [00:00<00:01,  4.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  27%|███████▎                   | 3/11 [00:00<00:01,  4.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  45%|████████████▎              | 5/11 [00:01<00:01,  4.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  45%|████████████▎              | 5/11 [00:01<00:01,  4.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    22: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    22: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.43it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 22 training [time: 2.48s, train loss: 11.3011]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.64it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.64it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.69it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.69it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.08it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 22 evaluating [time: 0.50s, valid_score: 0.855900]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8745    recall@10 : 0.8852    mrr@5 : 0.8545    mrr@10 : 0.8559    ndcg@5 : 0.8596    ndcg@10 : 0.8629    hit@5 : 0.8745    hit@10 : 0.8852    precision@5 : 0.1749    precision@10 : 0.0885
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    23:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    23:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:   9%|██▍                        | 1/11 [00:00<00:02,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:   9%|██▍                        | 1/11 [00:00<00:02,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  18%|████▉                      | 2/11 [00:00<00:02,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  18%|████▉                      | 2/11 [00:00<00:02,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  27%|███████▎                   | 3/11 [00:00<00:01,  5.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  27%|███████▎                   | 3/11 [00:00<00:01,  5.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.52it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.52it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  45%|████████████▎              | 5/11 [00:00<00:01,  5.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  45%|████████████▎              | 5/11 [00:01<00:01,  5.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    23: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    23: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.53it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 23 training [time: 2.43s, train loss: 11.4103]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.61it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.61it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  3.94it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  3.94it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  5.38it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 23 evaluating [time: 0.57s, valid_score: 0.856600]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8741    recall@10 : 0.8857    mrr@5 : 0.8551    mrr@10 : 0.8566    ndcg@5 : 0.8599    ndcg@10 : 0.8636    hit@5 : 0.8741    hit@10 : 0.8857    precision@5 : 0.1748    precision@10 : 0.0886
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    24:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    24:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:   9%|██▍                        | 1/11 [00:00<00:02,  4.67it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:   9%|██▍                        | 1/11 [00:00<00:02,  4.67it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  18%|████▉                      | 2/11 [00:00<00:01,  5.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  18%|████▉                      | 2/11 [00:00<00:01,  5.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  27%|███████▎                   | 3/11 [00:00<00:01,  5.87it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  27%|███████▎                   | 3/11 [00:00<00:01,  5.87it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  36%|█████████▊                 | 4/11 [00:00<00:01,  6.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  36%|█████████▊                 | 4/11 [00:00<00:01,  6.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  45%|████████████▎              | 5/11 [00:00<00:01,  5.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  45%|████████████▎              | 5/11 [00:01<00:01,  5.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    24: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    24: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.22it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 24 training [time: 2.11s, train loss: 11.2403]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.34it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.34it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  3.58it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  3.58it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  4.99it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 24 evaluating [time: 0.61s, valid_score: 0.859100]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.875    recall@10 : 0.8917    mrr@5 : 0.8569    mrr@10 : 0.8591    ndcg@5 : 0.8614    ndcg@10 : 0.8668    hit@5 : 0.875    hit@10 : 0.8917    precision@5 : 0.175    precision@10 : 0.0892
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    25:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    25:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:   9%|██▍                        | 1/11 [00:00<00:02,  4.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:   9%|██▍                        | 1/11 [00:00<00:02,  4.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  18%|████▉                      | 2/11 [00:00<00:01,  4.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  18%|████▉                      | 2/11 [00:00<00:01,  4.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  27%|███████▎                   | 3/11 [00:00<00:01,  4.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  27%|███████▎                   | 3/11 [00:00<00:01,  4.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  36%|█████████▊                 | 4/11 [00:01<00:01,  5.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  45%|████████████▎              | 5/11 [00:01<00:01,  4.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  45%|████████████▎              | 5/11 [00:01<00:01,  4.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    25: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    25: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 25 training [time: 2.46s, train loss: 12.4170]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  2.65it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  2.65it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  3.26it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  3.26it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 25 evaluating [time: 0.66s, valid_score: 0.860100]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8755    recall@10 : 0.8894    mrr@5 : 0.8583    mrr@10 : 0.8601    ndcg@5 : 0.8626    ndcg@10 : 0.8671    hit@5 : 0.8755    hit@10 : 0.8894    precision@5 : 0.1751    precision@10 : 0.0889
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    26:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    26:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:   9%|██▍                        | 1/11 [00:00<00:01,  6.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:   9%|██▍                        | 1/11 [00:00<00:01,  6.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  18%|████▉                      | 2/11 [00:00<00:01,  6.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  18%|████▉                      | 2/11 [00:00<00:01,  6.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  27%|███████▎                   | 3/11 [00:00<00:01,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  27%|███████▎                   | 3/11 [00:00<00:01,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  45%|████████████▎              | 5/11 [00:01<00:01,  3.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  45%|████████████▎              | 5/11 [00:01<00:01,  3.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  64%|█████████████████▏         | 7/11 [00:01<00:01,  3.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  64%|█████████████████▏         | 7/11 [00:01<00:01,  3.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  73%|███████████████████▋       | 8/11 [00:01<00:00,  3.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  73%|███████████████████▋       | 8/11 [00:02<00:00,  3.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.88it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.88it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    26: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    26: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 26 training [time: 2.68s, train loss: 11.3862]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.88it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.88it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.59it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.59it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  8.51it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 26 evaluating [time: 0.37s, valid_score: 0.863400]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8783    recall@10 : 0.8917    mrr@5 : 0.8615    mrr@10 : 0.8634    ndcg@5 : 0.8657    ndcg@10 : 0.8701    hit@5 : 0.8783    hit@10 : 0.8917    precision@5 : 0.1757    precision@10 : 0.0892
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    27:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    27:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:   9%|██▍                        | 1/11 [00:00<00:02,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:   9%|██▍                        | 1/11 [00:00<00:02,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  18%|████▉                      | 2/11 [00:00<00:02,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  18%|████▉                      | 2/11 [00:00<00:02,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  27%|███████▎                   | 3/11 [00:00<00:02,  3.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  27%|███████▎                   | 3/11 [00:00<00:02,  3.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  45%|████████████▎              | 5/11 [00:01<00:01,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  45%|████████████▎              | 5/11 [00:01<00:01,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    27: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.46it/s, GPU RAM: 1.07 G/3.68 G]
Train    27: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 27 training [time: 2.59s, train loss: 10.6209]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  9.45it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  9.45it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 12.59it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 27 evaluating [time: 0.25s, valid_score: 0.860600]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8736    recall@10 : 0.8908    mrr@5 : 0.8584    mrr@10 : 0.8606    ndcg@5 : 0.8622    ndcg@10 : 0.8677    hit@5 : 0.8736    hit@10 : 0.8908    precision@5 : 0.1747    precision@10 : 0.0891

Train    28:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    28:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:   9%|██▍                        | 1/11 [00:00<00:01,  5.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:   9%|██▍                        | 1/11 [00:00<00:01,  5.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  18%|████▉                      | 2/11 [00:00<00:01,  4.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  18%|████▉                      | 2/11 [00:00<00:01,  4.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  27%|███████▎                   | 3/11 [00:00<00:01,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  27%|███████▎                   | 3/11 [00:00<00:01,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  45%|████████████▎              | 5/11 [00:00<00:01,  5.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  45%|████████████▎              | 5/11 [00:01<00:01,  5.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    28: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    28: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.67it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 28 training [time: 2.36s, train loss: 11.5542]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.38it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.38it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.38it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 10.19it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 28 evaluating [time: 0.33s, valid_score: 0.862400]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8745    recall@10 : 0.888    mrr@5 : 0.8606    mrr@10 : 0.8624    ndcg@5 : 0.8641    ndcg@10 : 0.8684    hit@5 : 0.8745    hit@10 : 0.888    precision@5 : 0.1749    precision@10 : 0.0888

Train    29:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    29:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:   9%|██▍                        | 1/11 [00:00<00:01,  6.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:   9%|██▍                        | 1/11 [00:00<00:01,  6.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  18%|████▉                      | 2/11 [00:00<00:01,  6.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  18%|████▉                      | 2/11 [00:00<00:01,  6.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  27%|███████▎                   | 3/11 [00:00<00:01,  4.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  27%|███████▎                   | 3/11 [00:00<00:01,  4.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  45%|████████████▎              | 5/11 [00:01<00:01,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  45%|████████████▎              | 5/11 [00:01<00:01,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    29: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    29: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.27it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 29 training [time: 2.58s, train loss: 10.7464]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.03it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.03it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  8.08it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 29 evaluating [time: 0.38s, valid_score: 0.862800]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8745    recall@10 : 0.8866    mrr@5 : 0.8612    mrr@10 : 0.8628    ndcg@5 : 0.8646    ndcg@10 : 0.8685    hit@5 : 0.8745    hit@10 : 0.8866    precision@5 : 0.1749    precision@10 : 0.0887

Train    30:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    30:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:   9%|██▍                        | 1/11 [00:00<00:01,  5.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:   9%|██▍                        | 1/11 [00:00<00:01,  5.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  18%|████▉                      | 2/11 [00:00<00:02,  3.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  18%|████▉                      | 2/11 [00:00<00:02,  3.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  27%|███████▎                   | 3/11 [00:00<00:01,  4.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  27%|███████▎                   | 3/11 [00:00<00:01,  4.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  45%|████████████▎              | 5/11 [00:01<00:01,  4.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  45%|████████████▎              | 5/11 [00:01<00:01,  4.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    30: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.50it/s, GPU RAM: 1.07 G/3.68 G]
Train    30: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.35it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 30 training [time: 2.53s, train loss: 11.1230]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.53it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.53it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.78it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.78it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  9.37it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 30 evaluating [time: 0.33s, valid_score: 0.860900]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8773    recall@10 : 0.8889    mrr@5 : 0.8594    mrr@10 : 0.8609    ndcg@5 : 0.8639    ndcg@10 : 0.8676    hit@5 : 0.8773    hit@10 : 0.8889    precision@5 : 0.1755    precision@10 : 0.0889

Train    31:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    31:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:   9%|██▍                        | 1/11 [00:00<00:01,  5.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:   9%|██▍                        | 1/11 [00:00<00:01,  5.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  18%|████▉                      | 2/11 [00:00<00:01,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  18%|████▉                      | 2/11 [00:00<00:01,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  27%|███████▎                   | 3/11 [00:00<00:01,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  27%|███████▎                   | 3/11 [00:00<00:01,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  45%|████████████▎              | 5/11 [00:01<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  45%|████████████▎              | 5/11 [00:01<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    31: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    31: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 31 training [time: 2.55s, train loss: 10.5487]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.68it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.68it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.33it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.33it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  8.66it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 31 evaluating [time: 0.35s, valid_score: 0.862900]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8783    recall@10 : 0.8922    mrr@5 : 0.8611    mrr@10 : 0.8629    ndcg@5 : 0.8654    ndcg@10 : 0.8699    hit@5 : 0.8783    hit@10 : 0.8922    precision@5 : 0.1757    precision@10 : 0.0892

Train    32:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    32:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:   9%|██▍                        | 1/11 [00:00<00:01,  6.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:   9%|██▍                        | 1/11 [00:00<00:01,  6.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  18%|████▉                      | 2/11 [00:00<00:01,  4.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  18%|████▉                      | 2/11 [00:00<00:01,  4.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  27%|███████▎                   | 3/11 [00:00<00:01,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  27%|███████▎                   | 3/11 [00:00<00:01,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  45%|████████████▎              | 5/11 [00:01<00:01,  4.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  45%|████████████▎              | 5/11 [00:01<00:01,  4.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    32: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    32: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 32 training [time: 2.45s, train loss: 10.3041]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.09it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.09it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.98it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 32 evaluating [time: 0.45s, valid_score: 0.862700]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8769    recall@10 : 0.8908    mrr@5 : 0.8608    mrr@10 : 0.8627    ndcg@5 : 0.8648    ndcg@10 : 0.8694    hit@5 : 0.8769    hit@10 : 0.8908    precision@5 : 0.1754    precision@10 : 0.0891

Train    33:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    33:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:   9%|██▍                        | 1/11 [00:00<00:02,  4.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:   9%|██▍                        | 1/11 [00:00<00:02,  4.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  18%|████▉                      | 2/11 [00:00<00:01,  4.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  18%|████▉                      | 2/11 [00:00<00:01,  4.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  27%|███████▎                   | 3/11 [00:00<00:01,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  27%|███████▎                   | 3/11 [00:00<00:01,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.46it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.46it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  45%|████████████▎              | 5/11 [00:01<00:01,  4.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  45%|████████████▎              | 5/11 [00:01<00:01,  4.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    33: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    33: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.45it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 33 training [time: 2.48s, train loss: 10.5838]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.16it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.16it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.26it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.26it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 33 evaluating [time: 0.34s, valid_score: 0.864500]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8769    recall@10 : 0.8894    mrr@5 : 0.8628    mrr@10 : 0.8645    ndcg@5 : 0.8664    ndcg@10 : 0.8704    hit@5 : 0.8769    hit@10 : 0.8894    precision@5 : 0.1754    precision@10 : 0.0889
12 Oct 19:50    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    34:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    34:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:   9%|██▍                        | 1/11 [00:00<00:02,  4.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:   9%|██▍                        | 1/11 [00:00<00:02,  4.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  18%|████▉                      | 2/11 [00:00<00:02,  3.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  18%|████▉                      | 2/11 [00:00<00:02,  3.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  27%|███████▎                   | 3/11 [00:00<00:02,  3.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  27%|███████▎                   | 3/11 [00:01<00:02,  3.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  45%|████████████▎              | 5/11 [00:01<00:01,  4.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  45%|████████████▎              | 5/11 [00:01<00:01,  4.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  64%|█████████████████▏         | 7/11 [00:02<00:00,  4.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    34: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.46it/s, GPU RAM: 1.07 G/3.68 G]
Train    34: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 34 training [time: 2.70s, train loss: 10.9606]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.59it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.59it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.94it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.94it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 10.06it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 34 evaluating [time: 0.31s, valid_score: 0.864200]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8783    recall@10 : 0.8894    mrr@5 : 0.8628    mrr@10 : 0.8642    ndcg@5 : 0.8667    ndcg@10 : 0.8702    hit@5 : 0.8783    hit@10 : 0.8894    precision@5 : 0.1757    precision@10 : 0.0889

Train    35:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    35:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:   9%|██▍                        | 1/11 [00:00<00:02,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:   9%|██▍                        | 1/11 [00:00<00:02,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  18%|████▉                      | 2/11 [00:00<00:02,  3.94it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  18%|████▉                      | 2/11 [00:00<00:02,  3.94it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  27%|███████▎                   | 3/11 [00:00<00:01,  4.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  27%|███████▎                   | 3/11 [00:00<00:01,  4.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  45%|████████████▎              | 5/11 [00:01<00:01,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  45%|████████████▎              | 5/11 [00:01<00:01,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    35: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    35: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 35 training [time: 2.51s, train loss: 10.7665]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.96it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.96it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.36it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.36it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  8.59it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 35 evaluating [time: 0.36s, valid_score: 0.863900]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8783    recall@10 : 0.8885    mrr@5 : 0.8625    mrr@10 : 0.8639    ndcg@5 : 0.8665    ndcg@10 : 0.8698    hit@5 : 0.8783    hit@10 : 0.8885    precision@5 : 0.1757    precision@10 : 0.0888

Train    36:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    36:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:   9%|██▍                        | 1/11 [00:00<00:02,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:   9%|██▍                        | 1/11 [00:00<00:02,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  18%|████▉                      | 2/11 [00:00<00:02,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  18%|████▉                      | 2/11 [00:00<00:02,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  27%|███████▎                   | 3/11 [00:00<00:01,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  27%|███████▎                   | 3/11 [00:00<00:01,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  36%|█████████▊                 | 4/11 [00:01<00:01,  5.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  45%|████████████▎              | 5/11 [00:01<00:01,  4.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  45%|████████████▎              | 5/11 [00:01<00:01,  4.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    36: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    36: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 36 training [time: 2.55s, train loss: 10.8514]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.59it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.59it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.07it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.07it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  9.08it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 36 evaluating [time: 0.34s, valid_score: 0.865700]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8773    recall@10 : 0.8903    mrr@5 : 0.8641    mrr@10 : 0.8657    ndcg@5 : 0.8675    ndcg@10 : 0.8715    hit@5 : 0.8773    hit@10 : 0.8903    precision@5 : 0.1755    precision@10 : 0.089
12 Oct 19:50    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    37:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    37:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:   9%|██▍                        | 1/11 [00:00<00:02,  3.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:   9%|██▍                        | 1/11 [00:00<00:02,  3.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  18%|████▉                      | 2/11 [00:00<00:02,  3.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  18%|████▉                      | 2/11 [00:00<00:02,  3.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  27%|███████▎                   | 3/11 [00:00<00:02,  3.67it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  27%|███████▎                   | 3/11 [00:01<00:02,  3.67it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  45%|████████████▎              | 5/11 [00:01<00:01,  3.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  45%|████████████▎              | 5/11 [00:01<00:01,  3.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  64%|█████████████████▏         | 7/11 [00:02<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    37: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    37: 100%|██████████████████████████| 11/11 [00:02<00:00,  3.98it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 37 training [time: 2.76s, train loss: 10.5769]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  8.46it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  8.46it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 11.48it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 37 evaluating [time: 0.27s, valid_score: 0.865600]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8778    recall@10 : 0.8903    mrr@5 : 0.8641    mrr@10 : 0.8656    ndcg@5 : 0.8675    ndcg@10 : 0.8715    hit@5 : 0.8778    hit@10 : 0.8903    precision@5 : 0.1756    precision@10 : 0.089

Train    38:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    38:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:   9%|██▍                        | 1/11 [00:00<00:03,  2.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:   9%|██▍                        | 1/11 [00:00<00:03,  2.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  18%|████▉                      | 2/11 [00:00<00:02,  3.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  18%|████▉                      | 2/11 [00:00<00:02,  3.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  27%|███████▎                   | 3/11 [00:00<00:02,  3.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  27%|███████▎                   | 3/11 [00:01<00:02,  3.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  45%|████████████▎              | 5/11 [00:01<00:01,  3.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  45%|████████████▎              | 5/11 [00:01<00:01,  3.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  64%|█████████████████▏         | 7/11 [00:01<00:01,  3.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  64%|█████████████████▏         | 7/11 [00:02<00:01,  3.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  73%|███████████████████▋       | 8/11 [00:02<00:00,  3.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  73%|███████████████████▋       | 8/11 [00:02<00:00,  3.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    38: 100%|██████████████████████████| 11/11 [00:02<00:00,  3.88it/s, GPU RAM: 1.07 G/3.68 G]
Train    38: 100%|██████████████████████████| 11/11 [00:02<00:00,  3.74it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 38 training [time: 2.94s, train loss: 9.9199]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.26it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.26it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.82it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.82it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  8.04it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 38 evaluating [time: 0.38s, valid_score: 0.864900]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8778    recall@10 : 0.888    mrr@5 : 0.8636    mrr@10 : 0.8649    ndcg@5 : 0.8672    ndcg@10 : 0.8704    hit@5 : 0.8778    hit@10 : 0.888    precision@5 : 0.1756    precision@10 : 0.0888

Train    39:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    39:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:   9%|██▍                        | 1/11 [00:00<00:01,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:   9%|██▍                        | 1/11 [00:00<00:01,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  18%|████▉                      | 2/11 [00:00<00:01,  4.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  18%|████▉                      | 2/11 [00:00<00:01,  4.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  27%|███████▎                   | 3/11 [00:00<00:01,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  27%|███████▎                   | 3/11 [00:00<00:01,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  45%|████████████▎              | 5/11 [00:01<00:01,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  45%|████████████▎              | 5/11 [00:01<00:01,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    39: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    39: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 39 training [time: 2.56s, train loss: 10.0618]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.06it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.06it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.98it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.98it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  9.73it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 39 evaluating [time: 0.32s, valid_score: 0.865100]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8801    recall@10 : 0.8894    mrr@5 : 0.8639    mrr@10 : 0.8651    ndcg@5 : 0.868    ndcg@10 : 0.871    hit@5 : 0.8801    hit@10 : 0.8894    precision@5 : 0.176    precision@10 : 0.0889

Train    40:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    40:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:   9%|██▍                        | 1/11 [00:00<00:01,  6.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:   9%|██▍                        | 1/11 [00:00<00:01,  6.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  18%|████▉                      | 2/11 [00:00<00:01,  5.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  18%|████▉                      | 2/11 [00:00<00:01,  5.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  27%|███████▎                   | 3/11 [00:00<00:01,  4.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  27%|███████▎                   | 3/11 [00:00<00:01,  4.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  45%|████████████▎              | 5/11 [00:01<00:01,  4.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  45%|████████████▎              | 5/11 [00:01<00:01,  4.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    40: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    40: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.53it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 40 training [time: 2.43s, train loss: 10.0084]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.38it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.38it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  7.29it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 40 evaluating [time: 0.42s, valid_score: 0.866000]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8801    recall@10 : 0.8899    mrr@5 : 0.8647    mrr@10 : 0.866    ndcg@5 : 0.8686    ndcg@10 : 0.8717    hit@5 : 0.8801    hit@10 : 0.8899    precision@5 : 0.176    precision@10 : 0.089
12 Oct 19:50    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    41:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    41:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:   9%|██▍                        | 1/11 [00:00<00:01,  5.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:   9%|██▍                        | 1/11 [00:00<00:01,  5.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  18%|████▉                      | 2/11 [00:00<00:01,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  18%|████▉                      | 2/11 [00:00<00:01,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  27%|███████▎                   | 3/11 [00:00<00:01,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  27%|███████▎                   | 3/11 [00:00<00:01,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  45%|████████████▎              | 5/11 [00:01<00:01,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  45%|████████████▎              | 5/11 [00:01<00:01,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    41: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.46it/s, GPU RAM: 1.07 G/3.68 G]
Train    41: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 41 training [time: 2.52s, train loss: 9.5766]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.98it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.98it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.91it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.91it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  8.40it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 41 evaluating [time: 0.36s, valid_score: 0.865100]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8792    recall@10 : 0.8885    mrr@5 : 0.8639    mrr@10 : 0.8651    ndcg@5 : 0.8677    ndcg@10 : 0.8707    hit@5 : 0.8792    hit@10 : 0.8885    precision@5 : 0.1758    precision@10 : 0.0888

Train    42:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    42:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:   9%|██▍                        | 1/11 [00:00<00:01,  5.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:   9%|██▍                        | 1/11 [00:00<00:01,  5.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  18%|████▉                      | 2/11 [00:00<00:02,  4.45it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  18%|████▉                      | 2/11 [00:00<00:02,  4.45it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  27%|███████▎                   | 3/11 [00:00<00:01,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  27%|███████▎                   | 3/11 [00:00<00:01,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  45%|████████████▎              | 5/11 [00:01<00:01,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  45%|████████████▎              | 5/11 [00:01<00:01,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  73%|███████████████████▋       | 8/11 [00:01<00:00,  3.84it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  73%|███████████████████▋       | 8/11 [00:02<00:00,  3.84it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    42: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.45it/s, GPU RAM: 1.07 G/3.68 G]
Train    42: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 42 training [time: 2.60s, train loss: 10.4850]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.44it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.44it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.54it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.54it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  8.62it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 42 evaluating [time: 0.35s, valid_score: 0.866900]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8792    recall@10 : 0.8913    mrr@5 : 0.8654    mrr@10 : 0.8669    ndcg@5 : 0.8688    ndcg@10 : 0.8727    hit@5 : 0.8792    hit@10 : 0.8913    precision@5 : 0.1758    precision@10 : 0.0891
12 Oct 19:50    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    43:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    43:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:   9%|██▍                        | 1/11 [00:00<00:02,  3.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:   9%|██▍                        | 1/11 [00:00<00:02,  3.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  18%|████▉                      | 2/11 [00:00<00:02,  3.92it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  18%|████▉                      | 2/11 [00:00<00:02,  3.92it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  27%|███████▎                   | 3/11 [00:00<00:02,  3.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  27%|███████▎                   | 3/11 [00:01<00:02,  3.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.99it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.99it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  45%|████████████▎              | 5/11 [00:01<00:01,  4.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  45%|████████████▎              | 5/11 [00:01<00:01,  4.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.99it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.99it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  64%|█████████████████▏         | 7/11 [00:02<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  73%|███████████████████▋       | 8/11 [00:02<00:00,  3.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  73%|███████████████████▋       | 8/11 [00:02<00:00,  3.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    43: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    43: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 43 training [time: 2.70s, train loss: 10.7268]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.68it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.68it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.02it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.02it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.80it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 43 evaluating [time: 0.46s, valid_score: 0.866500]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8787    recall@10 : 0.8889    mrr@5 : 0.8653    mrr@10 : 0.8665    ndcg@5 : 0.8686    ndcg@10 : 0.8718    hit@5 : 0.8787    hit@10 : 0.8889    precision@5 : 0.1757    precision@10 : 0.0889

Train    44:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    44:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:   9%|██▍                        | 1/11 [00:00<00:02,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:   9%|██▍                        | 1/11 [00:00<00:02,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  18%|████▉                      | 2/11 [00:00<00:02,  3.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  18%|████▉                      | 2/11 [00:00<00:02,  3.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  27%|███████▎                   | 3/11 [00:00<00:01,  4.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  27%|███████▎                   | 3/11 [00:00<00:01,  4.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  45%|████████████▎              | 5/11 [00:01<00:01,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  45%|████████████▎              | 5/11 [00:01<00:01,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    44: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    44: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.56it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 44 training [time: 2.41s, train loss: 9.9631]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.21it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.21it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.77it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.77it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  8.91it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 44 evaluating [time: 0.34s, valid_score: 0.867300]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8783    recall@10 : 0.8894    mrr@5 : 0.8659    mrr@10 : 0.8673    ndcg@5 : 0.869    ndcg@10 : 0.8725    hit@5 : 0.8783    hit@10 : 0.8894    precision@5 : 0.1757    precision@10 : 0.0889
12 Oct 19:50    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Train    45:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    45:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:   9%|██▍                        | 1/11 [00:00<00:02,  4.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:   9%|██▍                        | 1/11 [00:00<00:02,  4.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  18%|████▉                      | 2/11 [00:00<00:02,  4.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  18%|████▉                      | 2/11 [00:00<00:02,  4.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  27%|███████▎                   | 3/11 [00:00<00:01,  4.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  27%|███████▎                   | 3/11 [00:00<00:01,  4.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  45%|████████████▎              | 5/11 [00:01<00:01,  4.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  45%|████████████▎              | 5/11 [00:01<00:01,  4.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  64%|█████████████████▏         | 7/11 [00:02<00:00,  4.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  73%|███████████████████▋       | 8/11 [00:02<00:00,  3.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  73%|███████████████████▋       | 8/11 [00:02<00:00,  3.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.76it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.76it/s, GPU RAM: 1.07 G/3.68 G]
Train    45: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    45: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.02it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 45 training [time: 2.74s, train loss: 10.5084]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.86it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.86it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  5.80it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 45 evaluating [time: 0.52s, valid_score: 0.864800]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8769    recall@10 : 0.8899    mrr@5 : 0.863    mrr@10 : 0.8648    ndcg@5 : 0.8666    ndcg@10 : 0.8708    hit@5 : 0.8769    hit@10 : 0.8899    precision@5 : 0.1754    precision@10 : 0.089

Train    46:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    46:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:   9%|██▍                        | 1/11 [00:00<00:02,  4.46it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:   9%|██▍                        | 1/11 [00:00<00:02,  4.46it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  18%|████▉                      | 2/11 [00:00<00:02,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  18%|████▉                      | 2/11 [00:00<00:02,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  27%|███████▎                   | 3/11 [00:00<00:01,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  27%|███████▎                   | 3/11 [00:00<00:01,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  45%|████████████▎              | 5/11 [00:01<00:01,  4.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  45%|████████████▎              | 5/11 [00:01<00:01,  4.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    46: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    46: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.41it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 46 training [time: 2.50s, train loss: 9.2275]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.87it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.87it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  5.87it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 46 evaluating [time: 0.52s, valid_score: 0.863500]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8773    recall@10 : 0.8871    mrr@5 : 0.8621    mrr@10 : 0.8635    ndcg@5 : 0.866    ndcg@10 : 0.8691    hit@5 : 0.8773    hit@10 : 0.8871    precision@5 : 0.1755    precision@10 : 0.0887

Train    47:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    47:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:   9%|██▍                        | 1/11 [00:00<00:02,  4.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:   9%|██▍                        | 1/11 [00:00<00:02,  4.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  18%|████▉                      | 2/11 [00:00<00:02,  4.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  18%|████▉                      | 2/11 [00:00<00:02,  4.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  27%|███████▎                   | 3/11 [00:00<00:02,  3.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  27%|███████▎                   | 3/11 [00:01<00:02,  3.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  45%|████████████▎              | 5/11 [00:01<00:01,  3.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  45%|████████████▎              | 5/11 [00:01<00:01,  3.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    47: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    47: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 47 training [time: 2.51s, train loss: 10.2409]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  2.95it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  2.95it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  2.95it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  7.07it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 47 evaluating [time: 0.44s, valid_score: 0.865500]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8792    recall@10 : 0.8885    mrr@5 : 0.8642    mrr@10 : 0.8655    ndcg@5 : 0.8679    ndcg@10 : 0.871    hit@5 : 0.8792    hit@10 : 0.8885    precision@5 : 0.1758    precision@10 : 0.0888

Train    48:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    48:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:   9%|██▍                        | 1/11 [00:00<00:02,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:   9%|██▍                        | 1/11 [00:00<00:02,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  18%|████▉                      | 2/11 [00:00<00:02,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  18%|████▉                      | 2/11 [00:00<00:02,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  27%|███████▎                   | 3/11 [00:00<00:01,  4.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  27%|███████▎                   | 3/11 [00:00<00:01,  4.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  45%|████████████▎              | 5/11 [00:01<00:01,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  45%|████████████▎              | 5/11 [00:01<00:01,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  64%|█████████████████▏         | 7/11 [00:01<00:01,  3.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  64%|█████████████████▏         | 7/11 [00:02<00:01,  3.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  73%|███████████████████▋       | 8/11 [00:02<00:00,  3.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  73%|███████████████████▋       | 8/11 [00:02<00:00,  3.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    48: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    48: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 48 training [time: 2.65s, train loss: 9.6403]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.67it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.67it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  3.79it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  3.79it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  4.89it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 48 evaluating [time: 0.62s, valid_score: 0.865500]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8778    recall@10 : 0.8899    mrr@5 : 0.8639    mrr@10 : 0.8655    ndcg@5 : 0.8674    ndcg@10 : 0.8713    hit@5 : 0.8778    hit@10 : 0.8899    precision@5 : 0.1756    precision@10 : 0.089

Train    49:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    49:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:   9%|██▍                        | 1/11 [00:00<00:02,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:   9%|██▍                        | 1/11 [00:00<00:02,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  18%|████▉                      | 2/11 [00:00<00:02,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  18%|████▉                      | 2/11 [00:00<00:02,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  27%|███████▎                   | 3/11 [00:00<00:01,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  27%|███████▎                   | 3/11 [00:00<00:01,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  45%|████████████▎              | 5/11 [00:01<00:01,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  45%|████████████▎              | 5/11 [00:01<00:01,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  82%|██████████████████████     | 9/11 [00:02<00:00,  5.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    49: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    49: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.69it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 49 training [time: 2.35s, train loss: 11.4220]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.96it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.96it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.09it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.09it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.94it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 49 evaluating [time: 0.44s, valid_score: 0.865700]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8773    recall@10 : 0.8899    mrr@5 : 0.8641    mrr@10 : 0.8657    ndcg@5 : 0.8674    ndcg@10 : 0.8714    hit@5 : 0.8773    hit@10 : 0.8899    precision@5 : 0.1755    precision@10 : 0.089
12 Oct 19:50    INFO  Loading model structure and parameters from saved/BERT4Rec-Oct-12-2025_19-48-47.pth

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.58it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.58it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  5.77it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  5.50it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |    38.50 %     |
+-------------+----------------+
| GPU         | 1.07 G/3.68 G  |
+-------------+----------------+
| Memory      | 1.14 G/15.33 G |
+-------------+----------------+
12 Oct 19:51    INFO  best valid : OrderedDict({'recall@5': 0.8783, 'recall@10': 0.8894, 'mrr@5': 0.8659, 'mrr@10': 0.8673, 'ndcg@5': 0.869, 'ndcg@10': 0.8725, 'hit@5': 0.8783, 'hit@10': 0.8894, 'precision@5': 0.1757, 'precision@10': 0.0889})
12 Oct 19:51    INFO  test result: OrderedDict({'recall@5': 0.9805, 'recall@10': 0.9845, 'mrr@5': 0.9602, 'mrr@10': 0.9608, 'ndcg@5': 0.9654, 'ndcg@10': 0.9667, 'hit@5': 0.9805, 'hit@10': 0.9845, 'precision@5': 0.1961, 'precision@10': 0.0985})

2025-10-12 19:51:02,002 | INFO | Copied checkpoint /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/saved/BERT4Rec-Oct-12-2025_19-49-02.pth -> /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/BERT4Rec-Oct-12-2025_19-49-02.pth
2025-10-12 19:51:02,002 | INFO | Retraining completed in 0:02:22.388617. Latest checkpoint: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/BERT4Rec-Oct-12-2025_19-49-02.pth
2025-10-12 19:51:02,002 | INFO | === Retraining pipeline finished ===
2025-10-12 19:51:14,458 | INFO | 12 Oct 19:49    INFO  ['train_bert4rec.py']
12 Oct 19:49    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
12 Oct 19:49    INFO  ecommerce
The number of users: 2566
Average actions of users: 7.061598440545809
The number of items: 96
Average actions of items: 190.66315789473686
The number of inters: 18113
The sparsity of the dataset: 92.64703494414134%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
12 Oct 19:49    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
12 Oct 19:49    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
12 Oct 19:49    INFO  BERT4Rec(
  (item_embedding): Embedding(97, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 113888
12 Oct 19:49    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                           | 0/11 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.02 G/3.68 G]
Train     0:   9%|██▍                        | 1/11 [00:00<00:05,  1.76it/s, GPU RAM: 1.02 G/3.68 G]
Train     0:   9%|██▍                        | 1/11 [00:00<00:05,  1.76it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  18%|████▉                      | 2/11 [00:00<00:03,  2.70it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  18%|████▉                      | 2/11 [00:01<00:03,  2.70it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  27%|███████▎                   | 3/11 [00:01<00:02,  3.21it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  27%|███████▎                   | 3/11 [00:01<00:02,  3.21it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.65it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.65it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  45%|████████████▎              | 5/11 [00:01<00:01,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  45%|████████████▎              | 5/11 [00:01<00:01,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.91it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.91it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.25it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.25it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.16it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  73%|███████████████████▋       | 8/11 [00:02<00:00,  5.16it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  82%|██████████████████████     | 9/11 [00:02<00:00,  5.03it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  82%|██████████████████████     | 9/11 [00:02<00:00,  5.03it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.96it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.96it/s, GPU RAM: 1.07 G/3.68 G]
Train     0: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.82it/s, GPU RAM: 1.07 G/3.68 G]
Train     0: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 0 training [time: 2.57s, train loss: 49.7782]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.35it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.35it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.35it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  7.83it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.90it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 0 evaluating [time: 0.46s, valid_score: 0.061100]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.0959    recall@10 : 0.1805    mrr@5 : 0.0503    mrr@10 : 0.0611    ndcg@5 : 0.0615    ndcg@10 : 0.0885    hit@5 : 0.0959    hit@10 : 0.1805    precision@5 : 0.0192    precision@10 : 0.0181
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train     1:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     1:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:   9%|██▍                        | 1/11 [00:00<00:02,  4.82it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:   9%|██▍                        | 1/11 [00:00<00:02,  4.82it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  18%|████▉                      | 2/11 [00:00<00:01,  4.63it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  18%|████▉                      | 2/11 [00:00<00:01,  4.63it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  27%|███████▎                   | 3/11 [00:00<00:01,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  27%|███████▎                   | 3/11 [00:00<00:01,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  45%|████████████▎              | 5/11 [00:01<00:01,  5.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  45%|████████████▎              | 5/11 [00:01<00:01,  5.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.39it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.39it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.66it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.66it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.20it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.20it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.09it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  82%|██████████████████████     | 9/11 [00:02<00:00,  5.09it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.97it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.97it/s, GPU RAM: 1.07 G/3.68 G]
Train     1: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.95it/s, GPU RAM: 1.07 G/3.68 G]
Train     1: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.99it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 1 training [time: 2.21s, train loss: 49.0332]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.55it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.55it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  5.33it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 1 evaluating [time: 0.59s, valid_score: 0.084200]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.1531    recall@10 : 0.2392    mrr@5 : 0.073    mrr@10 : 0.0842    ndcg@5 : 0.0925    ndcg@10 : 0.1201    hit@5 : 0.1531    hit@10 : 0.2392    precision@5 : 0.0306    precision@10 : 0.0239
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train     2:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     2:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:   9%|██▍                        | 1/11 [00:00<00:02,  4.39it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:   9%|██▍                        | 1/11 [00:00<00:02,  4.39it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  18%|████▉                      | 2/11 [00:00<00:02,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  18%|████▉                      | 2/11 [00:00<00:02,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  27%|███████▎                   | 3/11 [00:00<00:01,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  27%|███████▎                   | 3/11 [00:00<00:01,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.01it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.01it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  45%|████████████▎              | 5/11 [00:00<00:01,  5.62it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  45%|████████████▎              | 5/11 [00:01<00:01,  5.62it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.89it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.89it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.16it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.16it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train     2: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
Train     2: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.63it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 2 training [time: 2.38s, train loss: 47.0335]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.71it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.71it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  5.78it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 2 evaluating [time: 0.54s, valid_score: 0.306000]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.4472    recall@10 : 0.5859    mrr@5 : 0.2878    mrr@10 : 0.306    ndcg@5 : 0.3276    ndcg@10 : 0.3721    hit@5 : 0.4472    hit@10 : 0.5859    precision@5 : 0.0894    precision@10 : 0.0586
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train     3:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     3:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:   9%|██▍                        | 1/11 [00:00<00:02,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:   9%|██▍                        | 1/11 [00:00<00:02,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  18%|████▉                      | 2/11 [00:00<00:02,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  18%|████▉                      | 2/11 [00:00<00:02,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  27%|███████▎                   | 3/11 [00:00<00:01,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  27%|███████▎                   | 3/11 [00:00<00:01,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.52it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.52it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  45%|████████████▎              | 5/11 [00:00<00:01,  5.57it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  45%|████████████▎              | 5/11 [00:01<00:01,  5.57it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.24it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.24it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.93it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.93it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.84it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.84it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.78it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.78it/s, GPU RAM: 1.07 G/3.68 G]
Train     3: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.84it/s, GPU RAM: 1.07 G/3.68 G]
Train     3: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.95it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 3 training [time: 2.22s, train loss: 42.7851]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.09it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.09it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.09it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 16.83it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 3 evaluating [time: 0.19s, valid_score: 0.569900]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.6878    recall@10 : 0.7445    mrr@5 : 0.5622    mrr@10 : 0.5699    ndcg@5 : 0.5937    ndcg@10 : 0.6123    hit@5 : 0.6878    hit@10 : 0.7445    precision@5 : 0.1376    precision@10 : 0.0745
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train     4:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     4:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:   9%|██▍                        | 1/11 [00:00<00:01,  5.23it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:   9%|██▍                        | 1/11 [00:00<00:01,  5.23it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  18%|████▉                      | 2/11 [00:00<00:01,  4.94it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  18%|████▉                      | 2/11 [00:00<00:01,  4.94it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  27%|███████▎                   | 3/11 [00:00<00:01,  4.81it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  27%|███████▎                   | 3/11 [00:00<00:01,  4.81it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.83it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.83it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  45%|████████████▎              | 5/11 [00:00<00:01,  5.31it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  45%|████████████▎              | 5/11 [00:01<00:01,  5.31it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.62it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.62it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  64%|█████████████████▏         | 7/11 [00:01<00:00,  6.07it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  64%|█████████████████▏         | 7/11 [00:01<00:00,  6.07it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  73%|███████████████████▋       | 8/11 [00:01<00:00,  6.37it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  73%|███████████████████▋       | 8/11 [00:01<00:00,  6.37it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.64it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.64it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  5.27it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.27it/s, GPU RAM: 1.07 G/3.68 G]
Train     4: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.78it/s, GPU RAM: 1.07 G/3.68 G]
Train     4: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.22it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 4 training [time: 2.11s, train loss: 38.8963]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.93it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.93it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  5.41it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 4 evaluating [time: 0.56s, valid_score: 0.622700]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.7203    recall@10 : 0.7701    mrr@5 : 0.6162    mrr@10 : 0.6227    ndcg@5 : 0.6425    ndcg@10 : 0.6584    hit@5 : 0.7203    hit@10 : 0.7701    precision@5 : 0.1441    precision@10 : 0.077
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train     5:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     5:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:   9%|██▍                        | 1/11 [00:00<00:02,  4.53it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:   9%|██▍                        | 1/11 [00:00<00:02,  4.53it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  18%|████▉                      | 2/11 [00:00<00:01,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  18%|████▉                      | 2/11 [00:00<00:01,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  27%|███████▎                   | 3/11 [00:00<00:01,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  27%|███████▎                   | 3/11 [00:00<00:01,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.72it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.72it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  45%|████████████▎              | 5/11 [00:01<00:01,  5.31it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  45%|████████████▎              | 5/11 [00:01<00:01,  5.31it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.55it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.55it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.82it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.82it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.78it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.78it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.73it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.73it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.67it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.67it/s, GPU RAM: 1.07 G/3.68 G]
Train     5: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.46it/s, GPU RAM: 1.07 G/3.68 G]
Train     5: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.80it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 5 training [time: 2.29s, train loss: 35.5257]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.09it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.09it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  5.55it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 5 evaluating [time: 0.55s, valid_score: 0.672800]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.7408    recall@10 : 0.7841    mrr@5 : 0.667    mrr@10 : 0.6728    ndcg@5 : 0.6856    ndcg@10 : 0.6996    hit@5 : 0.7408    hit@10 : 0.7841    precision@5 : 0.1482    precision@10 : 0.0784
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train     6:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     6:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:   9%|██▍                        | 1/11 [00:00<00:02,  4.60it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:   9%|██▍                        | 1/11 [00:00<00:02,  4.60it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  18%|████▉                      | 2/11 [00:00<00:01,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  18%|████▉                      | 2/11 [00:00<00:01,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  27%|███████▎                   | 3/11 [00:00<00:01,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  27%|███████▎                   | 3/11 [00:00<00:01,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.35it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.35it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  45%|████████████▎              | 5/11 [00:00<00:01,  5.64it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  45%|████████████▎              | 5/11 [00:01<00:01,  5.64it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.84it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.84it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.33it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.33it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.11it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.11it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train     6: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.37it/s, GPU RAM: 1.07 G/3.68 G]
Train     6: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 6 training [time: 2.37s, train loss: 32.1514]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.24it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.24it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.40it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.40it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.94it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 6 evaluating [time: 0.44s, valid_score: 0.699900]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.7604    recall@10 : 0.8046    mrr@5 : 0.694    mrr@10 : 0.6999    ndcg@5 : 0.7106    ndcg@10 : 0.7249    hit@5 : 0.7604    hit@10 : 0.8046    precision@5 : 0.1521    precision@10 : 0.0805
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train     7:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     7:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:   9%|██▍                        | 1/11 [00:00<00:02,  4.37it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:   9%|██▍                        | 1/11 [00:00<00:02,  4.37it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  18%|████▉                      | 2/11 [00:00<00:01,  4.67it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  18%|████▉                      | 2/11 [00:00<00:01,  4.67it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  27%|███████▎                   | 3/11 [00:00<00:01,  5.55it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  27%|███████▎                   | 3/11 [00:00<00:01,  5.55it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  36%|█████████▊                 | 4/11 [00:00<00:01,  6.16it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  36%|█████████▊                 | 4/11 [00:00<00:01,  6.16it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  45%|████████████▎              | 5/11 [00:00<00:00,  6.28it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  45%|████████████▎              | 5/11 [00:00<00:00,  6.28it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  55%|██████████████▋            | 6/11 [00:00<00:00,  6.61it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  55%|██████████████▋            | 6/11 [00:01<00:00,  6.61it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  64%|█████████████████▏         | 7/11 [00:01<00:00,  6.78it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  64%|█████████████████▏         | 7/11 [00:01<00:00,  6.78it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.90it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.90it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.36it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.36it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  5.00it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.00it/s, GPU RAM: 1.07 G/3.68 G]
Train     7: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.87it/s, GPU RAM: 1.07 G/3.68 G]
Train     7: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.43it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 7 training [time: 2.03s, train loss: 29.1467]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.92it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.92it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.44it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 7 evaluating [time: 0.49s, valid_score: 0.728400]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.7808    recall@10 : 0.8171    mrr@5 : 0.7233    mrr@10 : 0.7284    ndcg@5 : 0.7377    ndcg@10 : 0.7496    hit@5 : 0.7808    hit@10 : 0.8171    precision@5 : 0.1562    precision@10 : 0.0817
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train     8:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     8:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:   9%|██▍                        | 1/11 [00:00<00:02,  4.67it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:   9%|██▍                        | 1/11 [00:00<00:02,  4.67it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  18%|████▉                      | 2/11 [00:00<00:01,  4.56it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  18%|████▉                      | 2/11 [00:00<00:01,  4.56it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  27%|███████▎                   | 3/11 [00:00<00:01,  4.51it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  27%|███████▎                   | 3/11 [00:00<00:01,  4.51it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  45%|████████████▎              | 5/11 [00:01<00:01,  5.13it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  45%|████████████▎              | 5/11 [00:01<00:01,  5.13it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.70it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.70it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.95it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.95it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.96it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.96it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.30it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.30it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  4.89it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.89it/s, GPU RAM: 1.07 G/3.68 G]
Train     8: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.82it/s, GPU RAM: 1.07 G/3.68 G]
Train     8: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.06it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 8 training [time: 2.18s, train loss: 26.5366]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.95it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.95it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.54it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 8 evaluating [time: 0.47s, valid_score: 0.757800]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8032    recall@10 : 0.8255    mrr@5 : 0.7549    mrr@10 : 0.7578    ndcg@5 : 0.767    ndcg@10 : 0.7741    hit@5 : 0.8032    hit@10 : 0.8255    precision@5 : 0.1606    precision@10 : 0.0826
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train     9:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     9:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:   9%|██▍                        | 1/11 [00:00<00:02,  4.78it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:   9%|██▍                        | 1/11 [00:00<00:02,  4.78it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  18%|████▉                      | 2/11 [00:00<00:02,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  18%|████▉                      | 2/11 [00:00<00:02,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  27%|███████▎                   | 3/11 [00:00<00:01,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  27%|███████▎                   | 3/11 [00:00<00:01,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  45%|████████████▎              | 5/11 [00:01<00:01,  4.33it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  45%|████████████▎              | 5/11 [00:01<00:01,  4.33it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.68it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.68it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.24it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.24it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.38it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.38it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.00it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  82%|██████████████████████     | 9/11 [00:02<00:00,  5.00it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.88it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.88it/s, GPU RAM: 1.07 G/3.68 G]
Train     9: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.90it/s, GPU RAM: 1.07 G/3.68 G]
Train     9: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.76it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 9 training [time: 2.31s, train loss: 23.9185]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.81it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.81it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.10it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.10it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  9.15it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 9 evaluating [time: 0.34s, valid_score: 0.779200]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8204    recall@10 : 0.8413    mrr@5 : 0.7765    mrr@10 : 0.7792    ndcg@5 : 0.7874    ndcg@10 : 0.7941    hit@5 : 0.8204    hit@10 : 0.8413    precision@5 : 0.1641    precision@10 : 0.0841
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    10:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    10:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:   9%|██▍                        | 1/11 [00:00<00:02,  4.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:   9%|██▍                        | 1/11 [00:00<00:02,  4.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  18%|████▉                      | 2/11 [00:00<00:01,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  18%|████▉                      | 2/11 [00:00<00:01,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  27%|███████▎                   | 3/11 [00:00<00:01,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  27%|███████▎                   | 3/11 [00:00<00:01,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  36%|█████████▊                 | 4/11 [00:00<00:01,  3.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  45%|████████████▎              | 5/11 [00:01<00:01,  4.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  45%|████████████▎              | 5/11 [00:01<00:01,  4.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  82%|██████████████████████     | 9/11 [00:02<00:00,  5.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    10: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    10: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.84it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 10 training [time: 2.27s, train loss: 21.6620]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.94it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.94it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  5.48it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 10 evaluating [time: 0.56s, valid_score: 0.800900]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8325    recall@10 : 0.852    mrr@5 : 0.7984    mrr@10 : 0.8009    ndcg@5 : 0.8069    ndcg@10 : 0.8131    hit@5 : 0.8325    hit@10 : 0.852    precision@5 : 0.1665    precision@10 : 0.0852
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    11:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    11:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:   9%|██▍                        | 1/11 [00:00<00:02,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:   9%|██▍                        | 1/11 [00:00<00:02,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  18%|████▉                      | 2/11 [00:00<00:02,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  18%|████▉                      | 2/11 [00:00<00:02,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  27%|███████▎                   | 3/11 [00:00<00:01,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  27%|███████▎                   | 3/11 [00:00<00:01,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  45%|████████████▎              | 5/11 [00:01<00:01,  4.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  45%|████████████▎              | 5/11 [00:01<00:01,  4.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.12it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.12it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    11: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    11: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.63it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 11 training [time: 2.37s, train loss: 19.5760]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.96it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.96it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.96it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  9.97it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 11 evaluating [time: 0.34s, valid_score: 0.813500]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8423    recall@10 : 0.8618    mrr@5 : 0.811    mrr@10 : 0.8135    ndcg@5 : 0.8188    ndcg@10 : 0.8251    hit@5 : 0.8423    hit@10 : 0.8618    precision@5 : 0.1685    precision@10 : 0.0862
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    12:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    12:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:   9%|██▍                        | 1/11 [00:00<00:02,  4.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:   9%|██▍                        | 1/11 [00:00<00:02,  4.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  18%|████▉                      | 2/11 [00:00<00:01,  4.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  18%|████▉                      | 2/11 [00:00<00:01,  4.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  27%|███████▎                   | 3/11 [00:00<00:01,  4.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  27%|███████▎                   | 3/11 [00:00<00:01,  4.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  45%|████████████▎              | 5/11 [00:01<00:01,  4.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  45%|████████████▎              | 5/11 [00:01<00:01,  4.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.50it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.50it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  82%|██████████████████████     | 9/11 [00:01<00:00,  6.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  82%|██████████████████████     | 9/11 [00:01<00:00,  6.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  5.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    12: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    12: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.08it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 12 training [time: 2.17s, train loss: 17.9227]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.29it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 12 evaluating [time: 0.50s, valid_score: 0.823000]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8474    recall@10 : 0.8669    mrr@5 : 0.8204    mrr@10 : 0.823    ndcg@5 : 0.8271    ndcg@10 : 0.8335    hit@5 : 0.8474    hit@10 : 0.8669    precision@5 : 0.1695    precision@10 : 0.0867
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    13:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    13:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:   9%|██▍                        | 1/11 [00:00<00:02,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:   9%|██▍                        | 1/11 [00:00<00:02,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  18%|████▉                      | 2/11 [00:00<00:02,  4.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  18%|████▉                      | 2/11 [00:00<00:02,  4.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  27%|███████▎                   | 3/11 [00:00<00:01,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  27%|███████▎                   | 3/11 [00:00<00:01,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  45%|████████████▎              | 5/11 [00:01<00:01,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  45%|████████████▎              | 5/11 [00:01<00:01,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  82%|██████████████████████     | 9/11 [00:02<00:00,  5.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    13: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    13: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.87it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 13 training [time: 2.26s, train loss: 16.2580]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.44it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.44it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.09it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.09it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  5.46it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 13 evaluating [time: 0.57s, valid_score: 0.833100]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.853    recall@10 : 0.8706    mrr@5 : 0.8306    mrr@10 : 0.8331    ndcg@5 : 0.8362    ndcg@10 : 0.8421    hit@5 : 0.853    hit@10 : 0.8706    precision@5 : 0.1706    precision@10 : 0.0871
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    14:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    14:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:   9%|██▍                        | 1/11 [00:00<00:02,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:   9%|██▍                        | 1/11 [00:00<00:02,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  18%|████▉                      | 2/11 [00:00<00:02,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  18%|████▉                      | 2/11 [00:00<00:02,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  27%|███████▎                   | 3/11 [00:00<00:01,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  27%|███████▎                   | 3/11 [00:00<00:01,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  45%|████████████▎              | 5/11 [00:01<00:01,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  45%|████████████▎              | 5/11 [00:01<00:01,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  73%|███████████████████▋       | 8/11 [00:01<00:00,  5.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  82%|██████████████████████     | 9/11 [00:02<00:00,  5.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    14: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.88it/s, GPU RAM: 1.07 G/3.68 G]
Train    14: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.69it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 14 training [time: 2.35s, train loss: 15.2673]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.11it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.11it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  8.06it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 14 evaluating [time: 0.39s, valid_score: 0.838200]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8585    recall@10 : 0.8711    mrr@5 : 0.8367    mrr@10 : 0.8382    ndcg@5 : 0.8422    ndcg@10 : 0.8461    hit@5 : 0.8585    hit@10 : 0.8711    precision@5 : 0.1717    precision@10 : 0.0871
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    15:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    15:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:   9%|██▍                        | 1/11 [00:00<00:02,  4.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:   9%|██▍                        | 1/11 [00:00<00:02,  4.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  18%|████▉                      | 2/11 [00:00<00:02,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  18%|████▉                      | 2/11 [00:00<00:02,  4.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  27%|███████▎                   | 3/11 [00:00<00:01,  4.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  27%|███████▎                   | 3/11 [00:00<00:01,  4.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  45%|████████████▎              | 5/11 [00:01<00:01,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  45%|████████████▎              | 5/11 [00:01<00:01,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.52it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.52it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  82%|██████████████████████     | 9/11 [00:01<00:00,  5.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  82%|██████████████████████     | 9/11 [00:02<00:00,  5.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  5.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    15: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    15: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.82it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 15 training [time: 2.28s, train loss: 14.4478]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.89it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.89it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  8.61it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 15 evaluating [time: 0.36s, valid_score: 0.843600]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8585    recall@10 : 0.8725    mrr@5 : 0.8416    mrr@10 : 0.8436    ndcg@5 : 0.8459    ndcg@10 : 0.8505    hit@5 : 0.8585    hit@10 : 0.8725    precision@5 : 0.1717    precision@10 : 0.0872
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    16:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    16:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:   9%|██▍                        | 1/11 [00:00<00:02,  4.52it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:   9%|██▍                        | 1/11 [00:00<00:02,  4.52it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  18%|████▉                      | 2/11 [00:00<00:02,  3.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  18%|████▉                      | 2/11 [00:00<00:02,  3.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  27%|███████▎                   | 3/11 [00:00<00:01,  4.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  27%|███████▎                   | 3/11 [00:00<00:01,  4.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  45%|████████████▎              | 5/11 [00:01<00:01,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  45%|████████████▎              | 5/11 [00:01<00:01,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    16: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    16: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.44it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 16 training [time: 2.48s, train loss: 14.1635]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.28it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.28it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  8.15it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  8.15it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 11.85it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 16 evaluating [time: 0.27s, valid_score: 0.851800]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8669    recall@10 : 0.8748    mrr@5 : 0.8507    mrr@10 : 0.8518    ndcg@5 : 0.8547    ndcg@10 : 0.8573    hit@5 : 0.8669    hit@10 : 0.8748    precision@5 : 0.1734    precision@10 : 0.0875
12 Oct 19:49    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    17:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    17:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:   9%|██▍                        | 1/11 [00:00<00:02,  4.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:   9%|██▍                        | 1/11 [00:00<00:02,  4.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  18%|████▉                      | 2/11 [00:00<00:01,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  18%|████▉                      | 2/11 [00:00<00:01,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  27%|███████▎                   | 3/11 [00:00<00:01,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  27%|███████▎                   | 3/11 [00:00<00:01,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  45%|████████████▎              | 5/11 [00:01<00:01,  4.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  45%|████████████▎              | 5/11 [00:01<00:01,  4.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  73%|███████████████████▋       | 8/11 [00:01<00:00,  3.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  73%|███████████████████▋       | 8/11 [00:02<00:00,  3.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    17: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    17: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 17 training [time: 2.57s, train loss: 12.8618]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.32it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.32it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.30it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.30it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  8.70it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 17 evaluating [time: 0.36s, valid_score: 0.844400]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8604    recall@10 : 0.8753    mrr@5 : 0.8424    mrr@10 : 0.8444    ndcg@5 : 0.847    ndcg@10 : 0.8518    hit@5 : 0.8604    hit@10 : 0.8753    precision@5 : 0.1721    precision@10 : 0.0875

Train    18:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    18:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:   9%|██▍                        | 1/11 [00:00<00:02,  4.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:   9%|██▍                        | 1/11 [00:00<00:02,  4.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  18%|████▉                      | 2/11 [00:00<00:02,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  18%|████▉                      | 2/11 [00:00<00:02,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  27%|███████▎                   | 3/11 [00:00<00:01,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  27%|███████▎                   | 3/11 [00:01<00:01,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  45%|████████████▎              | 5/11 [00:01<00:01,  3.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  45%|████████████▎              | 5/11 [00:01<00:01,  3.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    18: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    18: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 18 training [time: 2.46s, train loss: 13.5155]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.65it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.65it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.68it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.68it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.86it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 18 evaluating [time: 0.46s, valid_score: 0.847500]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8646    recall@10 : 0.8758    mrr@5 : 0.846    mrr@10 : 0.8475    ndcg@5 : 0.8506    ndcg@10 : 0.8543    hit@5 : 0.8646    hit@10 : 0.8758    precision@5 : 0.1729    precision@10 : 0.0876

Train    19:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    19:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:   9%|██▍                        | 1/11 [00:00<00:02,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:   9%|██▍                        | 1/11 [00:00<00:02,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  18%|████▉                      | 2/11 [00:00<00:02,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  18%|████▉                      | 2/11 [00:00<00:02,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  27%|███████▎                   | 3/11 [00:00<00:02,  3.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  27%|███████▎                   | 3/11 [00:00<00:02,  3.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  45%|████████████▎              | 5/11 [00:01<00:01,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  45%|████████████▎              | 5/11 [00:01<00:01,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.94it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.94it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    19: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    19: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.33it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 19 training [time: 2.54s, train loss: 12.6815]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.77it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.77it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.23it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.23it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 10.68it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:49    INFO  epoch 19 evaluating [time: 0.29s, valid_score: 0.850800]
12 Oct 19:49    INFO  valid result: 
recall@5 : 0.8637    recall@10 : 0.8753    mrr@5 : 0.8492    mrr@10 : 0.8508    ndcg@5 : 0.8528    ndcg@10 : 0.8566    hit@5 : 0.8637    hit@10 : 0.8753    precision@5 : 0.1727    precision@10 : 0.0875

Train    20:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    20:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:   9%|██▍                        | 1/11 [00:00<00:01,  5.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:   9%|██▍                        | 1/11 [00:00<00:01,  5.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  18%|████▉                      | 2/11 [00:00<00:01,  4.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  18%|████▉                      | 2/11 [00:00<00:01,  4.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  27%|███████▎                   | 3/11 [00:00<00:01,  4.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  27%|███████▎                   | 3/11 [00:00<00:01,  4.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  45%|████████████▎              | 5/11 [00:01<00:01,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  45%|████████████▎              | 5/11 [00:01<00:01,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    20: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.92it/s, GPU RAM: 1.07 G/3.68 G]
Train    20: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 20 training [time: 2.37s, train loss: 12.6637]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.88it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.88it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.49it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.49it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  7.63it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 20 evaluating [time: 0.40s, valid_score: 0.854400]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8702    recall@10 : 0.8776    mrr@5 : 0.8533    mrr@10 : 0.8544    ndcg@5 : 0.8576    ndcg@10 : 0.86    hit@5 : 0.8702    hit@10 : 0.8776    precision@5 : 0.174    precision@10 : 0.0878
12 Oct 19:50    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    21:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    21:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:   9%|██▍                        | 1/11 [00:00<00:02,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:   9%|██▍                        | 1/11 [00:00<00:02,  4.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  18%|████▉                      | 2/11 [00:00<00:02,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  18%|████▉                      | 2/11 [00:00<00:02,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  27%|███████▎                   | 3/11 [00:00<00:01,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  27%|███████▎                   | 3/11 [00:00<00:01,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  45%|████████████▎              | 5/11 [00:01<00:01,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  45%|████████████▎              | 5/11 [00:01<00:01,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    21: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    21: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 21 training [time: 2.56s, train loss: 11.8802]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.18it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.18it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  8.19it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  8.19it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 21 evaluating [time: 0.34s, valid_score: 0.852500]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8692    recall@10 : 0.8795    mrr@5 : 0.8512    mrr@10 : 0.8525    ndcg@5 : 0.8558    ndcg@10 : 0.8591    hit@5 : 0.8692    hit@10 : 0.8795    precision@5 : 0.1738    precision@10 : 0.0879

Train    22:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    22:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:   9%|██▍                        | 1/11 [00:00<00:02,  3.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:   9%|██▍                        | 1/11 [00:00<00:02,  3.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  18%|████▉                      | 2/11 [00:00<00:02,  4.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  18%|████▉                      | 2/11 [00:00<00:02,  4.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  27%|███████▎                   | 3/11 [00:00<00:01,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  27%|███████▎                   | 3/11 [00:01<00:01,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  45%|████████████▎              | 5/11 [00:01<00:01,  3.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  45%|████████████▎              | 5/11 [00:01<00:01,  3.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    22: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    22: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.37it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 22 training [time: 2.52s, train loss: 11.9542]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.19it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.19it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.74it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.74it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  9.65it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 22 evaluating [time: 0.32s, valid_score: 0.853800]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.8809    mrr@5 : 0.8523    mrr@10 : 0.8538    ndcg@5 : 0.8567    ndcg@10 : 0.8603    hit@5 : 0.8697    hit@10 : 0.8809    precision@5 : 0.1739    precision@10 : 0.0881

Train    23:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    23:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:   9%|██▍                        | 1/11 [00:00<00:02,  4.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:   9%|██▍                        | 1/11 [00:00<00:02,  4.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  18%|████▉                      | 2/11 [00:00<00:02,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  18%|████▉                      | 2/11 [00:00<00:02,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  27%|███████▎                   | 3/11 [00:00<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  27%|███████▎                   | 3/11 [00:00<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  45%|████████████▎              | 5/11 [00:01<00:01,  4.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  45%|████████████▎              | 5/11 [00:01<00:01,  4.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    23: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    23: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 23 training [time: 2.46s, train loss: 12.1724]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.02it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.02it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.57it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.57it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 10.85it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 23 evaluating [time: 0.29s, valid_score: 0.853300]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8664    recall@10 : 0.8772    mrr@5 : 0.8519    mrr@10 : 0.8533    ndcg@5 : 0.8556    ndcg@10 : 0.859    hit@5 : 0.8664    hit@10 : 0.8772    precision@5 : 0.1733    precision@10 : 0.0877

Train    24:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    24:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:   9%|██▍                        | 1/11 [00:00<00:02,  4.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:   9%|██▍                        | 1/11 [00:00<00:02,  4.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  18%|████▉                      | 2/11 [00:00<00:01,  6.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  18%|████▉                      | 2/11 [00:00<00:01,  6.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  27%|███████▎                   | 3/11 [00:00<00:01,  5.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  27%|███████▎                   | 3/11 [00:00<00:01,  5.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  45%|████████████▎              | 5/11 [00:01<00:01,  4.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  45%|████████████▎              | 5/11 [00:01<00:01,  4.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    24: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    24: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.34it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 24 training [time: 2.54s, train loss: 11.3801]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.98it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.98it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.81it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.81it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  7.94it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 24 evaluating [time: 0.39s, valid_score: 0.855400]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8692    recall@10 : 0.8827    mrr@5 : 0.8537    mrr@10 : 0.8554    ndcg@5 : 0.8576    ndcg@10 : 0.8619    hit@5 : 0.8692    hit@10 : 0.8827    precision@5 : 0.1738    precision@10 : 0.0883
12 Oct 19:50    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    25:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    25:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:   9%|██▍                        | 1/11 [00:00<00:01,  5.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:   9%|██▍                        | 1/11 [00:00<00:01,  5.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  18%|████▉                      | 2/11 [00:00<00:02,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  18%|████▉                      | 2/11 [00:00<00:02,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  27%|███████▎                   | 3/11 [00:00<00:01,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  27%|███████▎                   | 3/11 [00:00<00:01,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  45%|████████████▎              | 5/11 [00:01<00:01,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  45%|████████████▎              | 5/11 [00:01<00:01,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    25: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    25: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.35it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 25 training [time: 2.53s, train loss: 11.5684]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.98it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.98it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 10.87it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 25 evaluating [time: 0.28s, valid_score: 0.854200]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8674    recall@10 : 0.879    mrr@5 : 0.8528    mrr@10 : 0.8542    ndcg@5 : 0.8565    ndcg@10 : 0.8601    hit@5 : 0.8674    hit@10 : 0.879    precision@5 : 0.1735    precision@10 : 0.0879

Train    26:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    26:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:   9%|██▍                        | 1/11 [00:00<00:01,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:   9%|██▍                        | 1/11 [00:00<00:01,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  18%|████▉                      | 2/11 [00:00<00:01,  4.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  18%|████▉                      | 2/11 [00:00<00:01,  4.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  27%|███████▎                   | 3/11 [00:00<00:01,  4.84it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  27%|███████▎                   | 3/11 [00:00<00:01,  4.84it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.45it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.45it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  45%|████████████▎              | 5/11 [00:01<00:01,  3.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  45%|████████████▎              | 5/11 [00:01<00:01,  3.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.84it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.84it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  64%|█████████████████▏         | 7/11 [00:01<00:01,  3.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  64%|█████████████████▏         | 7/11 [00:01<00:01,  3.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    26: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    26: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.12it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 26 training [time: 2.67s, train loss: 11.1131]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  9.91it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  9.91it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.00it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.00it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 10.00it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 26 evaluating [time: 0.31s, valid_score: 0.856800]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8678    recall@10 : 0.8809    mrr@5 : 0.855    mrr@10 : 0.8568    ndcg@5 : 0.8582    ndcg@10 : 0.8624    hit@5 : 0.8678    hit@10 : 0.8809    precision@5 : 0.1736    precision@10 : 0.0881
12 Oct 19:50    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    27:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    27:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:   9%|██▍                        | 1/11 [00:00<00:02,  3.50it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:   9%|██▍                        | 1/11 [00:00<00:02,  3.50it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  18%|████▉                      | 2/11 [00:00<00:02,  3.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  18%|████▉                      | 2/11 [00:00<00:02,  3.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  27%|███████▎                   | 3/11 [00:00<00:02,  3.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  27%|███████▎                   | 3/11 [00:01<00:02,  3.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  45%|████████████▎              | 5/11 [00:01<00:01,  3.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  45%|████████████▎              | 5/11 [00:01<00:01,  3.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  64%|█████████████████▏         | 7/11 [00:02<00:00,  4.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.97it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    27: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    27: 100%|██████████████████████████| 11/11 [00:02<00:00,  3.93it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 27 training [time: 2.80s, train loss: 10.4678]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.14it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.14it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.17it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  7.17it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  9.31it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 27 evaluating [time: 0.34s, valid_score: 0.852500]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8669    recall@10 : 0.8762    mrr@5 : 0.8513    mrr@10 : 0.8525    ndcg@5 : 0.8552    ndcg@10 : 0.8582    hit@5 : 0.8669    hit@10 : 0.8762    precision@5 : 0.1734    precision@10 : 0.0876

Train    28:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    28:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:   9%|██▍                        | 1/11 [00:00<00:02,  3.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:   9%|██▍                        | 1/11 [00:00<00:02,  3.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  18%|████▉                      | 2/11 [00:00<00:02,  3.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  18%|████▉                      | 2/11 [00:00<00:02,  3.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  27%|███████▎                   | 3/11 [00:00<00:02,  3.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  27%|███████▎                   | 3/11 [00:01<00:02,  3.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  36%|█████████▊                 | 4/11 [00:01<00:01,  3.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  45%|████████████▎              | 5/11 [00:01<00:01,  3.84it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  45%|████████████▎              | 5/11 [00:01<00:01,  3.84it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  64%|█████████████████▏         | 7/11 [00:01<00:01,  3.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  64%|█████████████████▏         | 7/11 [00:02<00:01,  3.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  73%|███████████████████▋       | 8/11 [00:02<00:00,  3.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  73%|███████████████████▋       | 8/11 [00:02<00:00,  3.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    28: 100%|██████████████████████████| 11/11 [00:02<00:00,  3.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    28: 100%|██████████████████████████| 11/11 [00:02<00:00,  3.84it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 28 training [time: 2.86s, train loss: 12.6122]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.01it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.01it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.21it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 28 evaluating [time: 0.49s, valid_score: 0.855400]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8711    recall@10 : 0.879    mrr@5 : 0.8543    mrr@10 : 0.8554    ndcg@5 : 0.8585    ndcg@10 : 0.8611    hit@5 : 0.8711    hit@10 : 0.879    precision@5 : 0.1742    precision@10 : 0.0879

Train    29:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    29:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:   9%|██▍                        | 1/11 [00:00<00:01,  5.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:   9%|██▍                        | 1/11 [00:00<00:01,  5.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  18%|████▉                      | 2/11 [00:00<00:02,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  18%|████▉                      | 2/11 [00:00<00:02,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  27%|███████▎                   | 3/11 [00:00<00:01,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  27%|███████▎                   | 3/11 [00:00<00:01,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  45%|████████████▎              | 5/11 [00:01<00:01,  4.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  45%|████████████▎              | 5/11 [00:01<00:01,  4.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    29: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    29: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.39it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 29 training [time: 2.50s, train loss: 10.6818]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.88it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.88it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.75it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.75it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  7.81it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 29 evaluating [time: 0.39s, valid_score: 0.856200]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8692    recall@10 : 0.8781    mrr@5 : 0.8551    mrr@10 : 0.8562    ndcg@5 : 0.8587    ndcg@10 : 0.8614    hit@5 : 0.8692    hit@10 : 0.8781    precision@5 : 0.1738    precision@10 : 0.0878

Train    30:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    30:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:   9%|██▍                        | 1/11 [00:00<00:03,  3.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:   9%|██▍                        | 1/11 [00:00<00:03,  3.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  18%|████▉                      | 2/11 [00:00<00:02,  3.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  18%|████▉                      | 2/11 [00:00<00:02,  3.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  27%|███████▎                   | 3/11 [00:00<00:02,  3.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  27%|███████▎                   | 3/11 [00:01<00:02,  3.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  45%|████████████▎              | 5/11 [00:01<00:01,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  45%|████████████▎              | 5/11 [00:01<00:01,  4.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    30: 100%|██████████████████████████| 11/11 [00:02<00:00,  5.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    30: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.38it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 30 training [time: 2.51s, train loss: 10.8979]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.05it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.05it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  8.16it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  8.16it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  9.03it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 30 evaluating [time: 0.34s, valid_score: 0.855500]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8711    recall@10 : 0.8813    mrr@5 : 0.8542    mrr@10 : 0.8555    ndcg@5 : 0.8584    ndcg@10 : 0.8617    hit@5 : 0.8711    hit@10 : 0.8813    precision@5 : 0.1742    precision@10 : 0.0881

Train    31:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    31:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:   9%|██▍                        | 1/11 [00:00<00:02,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:   9%|██▍                        | 1/11 [00:00<00:02,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  18%|████▉                      | 2/11 [00:00<00:01,  4.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  18%|████▉                      | 2/11 [00:00<00:01,  4.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  27%|███████▎                   | 3/11 [00:00<00:01,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  27%|███████▎                   | 3/11 [00:00<00:01,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  45%|████████████▎              | 5/11 [00:01<00:01,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  45%|████████████▎              | 5/11 [00:01<00:01,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    31: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    31: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.44it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 31 training [time: 2.48s, train loss: 10.9492]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.90it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  7.90it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.90it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.90it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  7.33it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 31 evaluating [time: 0.42s, valid_score: 0.855000]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8678    recall@10 : 0.8832    mrr@5 : 0.8531    mrr@10 : 0.855    ndcg@5 : 0.8568    ndcg@10 : 0.8617    hit@5 : 0.8678    hit@10 : 0.8832    precision@5 : 0.1736    precision@10 : 0.0883

Train    32:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    32:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:   9%|██▍                        | 1/11 [00:00<00:02,  4.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:   9%|██▍                        | 1/11 [00:00<00:02,  4.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  18%|████▉                      | 2/11 [00:00<00:02,  4.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  18%|████▉                      | 2/11 [00:00<00:02,  4.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  27%|███████▎                   | 3/11 [00:00<00:01,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  27%|███████▎                   | 3/11 [00:00<00:01,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  45%|████████████▎              | 5/11 [00:01<00:01,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  45%|████████████▎              | 5/11 [00:01<00:01,  4.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    32: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    32: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.46it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 32 training [time: 2.47s, train loss: 11.4505]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 12.39it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 32 evaluating [time: 0.25s, valid_score: 0.857800]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8706    recall@10 : 0.8813    mrr@5 : 0.8564    mrr@10 : 0.8578    ndcg@5 : 0.86    ndcg@10 : 0.8634    hit@5 : 0.8706    hit@10 : 0.8813    precision@5 : 0.1741    precision@10 : 0.0881
12 Oct 19:50    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    33:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    33:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:   9%|██▍                        | 1/11 [00:00<00:01,  6.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:   9%|██▍                        | 1/11 [00:00<00:01,  6.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  18%|████▉                      | 2/11 [00:00<00:01,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  18%|████▉                      | 2/11 [00:00<00:01,  4.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  27%|███████▎                   | 3/11 [00:00<00:01,  4.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  27%|███████▎                   | 3/11 [00:00<00:01,  4.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  45%|████████████▎              | 5/11 [00:01<00:01,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  45%|████████████▎              | 5/11 [00:01<00:01,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    33: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    33: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.15it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 33 training [time: 2.65s, train loss: 11.3259]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.93it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.93it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  5.93it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 11.38it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 33 evaluating [time: 0.27s, valid_score: 0.858600]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.873    recall@10 : 0.8832    mrr@5 : 0.8573    mrr@10 : 0.8586    ndcg@5 : 0.8612    ndcg@10 : 0.8645    hit@5 : 0.873    hit@10 : 0.8832    precision@5 : 0.1746    precision@10 : 0.0883
12 Oct 19:50    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    34:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    34:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:   9%|██▍                        | 1/11 [00:00<00:01,  5.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:   9%|██▍                        | 1/11 [00:00<00:01,  5.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  18%|████▉                      | 2/11 [00:00<00:01,  5.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  18%|████▉                      | 2/11 [00:00<00:01,  5.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  27%|███████▎                   | 3/11 [00:00<00:01,  4.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  27%|███████▎                   | 3/11 [00:00<00:01,  4.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  45%|████████████▎              | 5/11 [00:01<00:01,  3.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  45%|████████████▎              | 5/11 [00:01<00:01,  3.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.92it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  55%|██████████████▋            | 6/11 [00:01<00:01,  3.92it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    34: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    34: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.28it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 34 training [time: 2.57s, train loss: 10.1543]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.33it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.33it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.44it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  5.44it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  7.32it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 34 evaluating [time: 0.42s, valid_score: 0.857800]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8692    recall@10 : 0.8823    mrr@5 : 0.8562    mrr@10 : 0.8578    ndcg@5 : 0.8595    ndcg@10 : 0.8636    hit@5 : 0.8692    hit@10 : 0.8823    precision@5 : 0.1738    precision@10 : 0.0882

Train    35:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    35:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:   9%|██▍                        | 1/11 [00:00<00:01,  5.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:   9%|██▍                        | 1/11 [00:00<00:01,  5.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  18%|████▉                      | 2/11 [00:00<00:01,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  18%|████▉                      | 2/11 [00:00<00:01,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  27%|███████▎                   | 3/11 [00:00<00:01,  4.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  27%|███████▎                   | 3/11 [00:00<00:01,  4.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.46it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.46it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  45%|████████████▎              | 5/11 [00:01<00:01,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  45%|████████████▎              | 5/11 [00:01<00:01,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.12it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  73%|███████████████████▋       | 8/11 [00:02<00:00,  4.12it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    35: 100%|██████████████████████████| 11/11 [00:02<00:00,  3.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    35: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.09it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 35 training [time: 2.69s, train loss: 10.0647]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.73it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.73it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  6.73it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 12.69it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 11.65it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 35 evaluating [time: 0.26s, valid_score: 0.857700]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.873    recall@10 : 0.8832    mrr@5 : 0.8563    mrr@10 : 0.8577    ndcg@5 : 0.8605    ndcg@10 : 0.8639    hit@5 : 0.873    hit@10 : 0.8832    precision@5 : 0.1746    precision@10 : 0.0883

Train    36:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    36:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:   9%|██▍                        | 1/11 [00:00<00:01,  5.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:   9%|██▍                        | 1/11 [00:00<00:01,  5.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  18%|████▉                      | 2/11 [00:00<00:01,  6.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  18%|████▉                      | 2/11 [00:00<00:01,  6.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  27%|███████▎                   | 3/11 [00:00<00:01,  5.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  27%|███████▎                   | 3/11 [00:00<00:01,  5.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  45%|████████████▎              | 5/11 [00:01<00:01,  4.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  45%|████████████▎              | 5/11 [00:01<00:01,  4.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    36: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    36: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.70it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 36 training [time: 2.34s, train loss: 10.9366]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.23it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.23it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  7.84it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 36 evaluating [time: 0.40s, valid_score: 0.860200]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8725    recall@10 : 0.886    mrr@5 : 0.8584    mrr@10 : 0.8602    ndcg@5 : 0.862    ndcg@10 : 0.8663    hit@5 : 0.8725    hit@10 : 0.886    precision@5 : 0.1745    precision@10 : 0.0886
12 Oct 19:50    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    37:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    37:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:   9%|██▍                        | 1/11 [00:00<00:02,  4.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:   9%|██▍                        | 1/11 [00:00<00:02,  4.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  18%|████▉                      | 2/11 [00:00<00:01,  5.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  18%|████▉                      | 2/11 [00:00<00:01,  5.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  27%|███████▎                   | 3/11 [00:00<00:01,  5.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  27%|███████▎                   | 3/11 [00:00<00:01,  5.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  45%|████████████▎              | 5/11 [00:00<00:01,  4.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  45%|████████████▎              | 5/11 [00:01<00:01,  4.93it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    37: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    37: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.45it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 37 training [time: 2.47s, train loss: 9.7429]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  4.48it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.85it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.85it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  6.10it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 37 evaluating [time: 0.50s, valid_score: 0.861600]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8748    recall@10 : 0.8851    mrr@5 : 0.8602    mrr@10 : 0.8616    ndcg@5 : 0.8639    ndcg@10 : 0.8672    hit@5 : 0.8748    hit@10 : 0.8851    precision@5 : 0.175    precision@10 : 0.0885
12 Oct 19:50    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    38:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    38:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:   9%|██▍                        | 1/11 [00:00<00:02,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:   9%|██▍                        | 1/11 [00:00<00:02,  4.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  18%|████▉                      | 2/11 [00:00<00:01,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  18%|████▉                      | 2/11 [00:00<00:01,  5.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  27%|███████▎                   | 3/11 [00:00<00:01,  5.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  27%|███████▎                   | 3/11 [00:00<00:01,  5.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  36%|█████████▊                 | 4/11 [00:00<00:01,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  36%|█████████▊                 | 4/11 [00:01<00:01,  4.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  45%|████████████▎              | 5/11 [00:01<00:01,  4.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  45%|████████████▎              | 5/11 [00:01<00:01,  4.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  73%|███████████████████▋       | 8/11 [00:01<00:00,  3.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  73%|███████████████████▋       | 8/11 [00:02<00:00,  3.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  82%|██████████████████████     | 9/11 [00:02<00:00,  3.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.84it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  3.84it/s, GPU RAM: 1.07 G/3.68 G]
Train    38: 100%|██████████████████████████| 11/11 [00:02<00:00,  3.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    38: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.08it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 38 training [time: 2.70s, train loss: 10.3132]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.89it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  6.89it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  8.31it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 38 evaluating [time: 0.37s, valid_score: 0.861300]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8744    recall@10 : 0.8837    mrr@5 : 0.8601    mrr@10 : 0.8613    ndcg@5 : 0.8637    ndcg@10 : 0.8667    hit@5 : 0.8744    hit@10 : 0.8837    precision@5 : 0.1749    precision@10 : 0.0884

Train    39:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    39:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:   9%|██▍                        | 1/11 [00:00<00:02,  3.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:   9%|██▍                        | 1/11 [00:00<00:02,  3.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  18%|████▉                      | 2/11 [00:00<00:01,  4.88it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  18%|████▉                      | 2/11 [00:00<00:01,  4.88it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  27%|███████▎                   | 3/11 [00:00<00:01,  5.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  27%|███████▎                   | 3/11 [00:00<00:01,  5.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  45%|████████████▎              | 5/11 [00:00<00:01,  5.12it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  45%|████████████▎              | 5/11 [00:01<00:01,  5.12it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.76it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  55%|██████████████▋            | 6/11 [00:01<00:01,  4.76it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  64%|█████████████████▏         | 7/11 [00:01<00:00,  4.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  73%|███████████████████▋       | 8/11 [00:01<00:00,  4.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  82%|██████████████████████     | 9/11 [00:01<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  82%|██████████████████████     | 9/11 [00:02<00:00,  4.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  91%|███████████████████████▋  | 10/11 [00:02<00:00,  4.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    39: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    39: 100%|██████████████████████████| 11/11 [00:02<00:00,  4.53it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 39 training [time: 2.43s, train loss: 10.3751]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.93it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  3.93it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00,  4.65it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00,  5.85it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 39 evaluating [time: 0.52s, valid_score: 0.862000]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.8748    recall@10 : 0.8855    mrr@5 : 0.8606    mrr@10 : 0.862    ndcg@5 : 0.8642    ndcg@10 : 0.8676    hit@5 : 0.8748    hit@10 : 0.8855    precision@5 : 0.175    precision@10 : 0.0886
12 Oct 19:50    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    40:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    40:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:   9%|██▍                        | 1/11 [00:00<00:02,  4.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:   9%|██▍                        | 1/11 [00:00<00:02,  4.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  18%|████▉                      | 2/11 [00:00<00:01,  5.50it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  18%|████▉                      | 2/11 [00:00<00:01,  5.50it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  27%|███████▎                   | 3/11 [00:00<00:01,  5.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  27%|███████▎                   | 3/11 [00:00<00:01,  5.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  36%|█████████▊                 | 4/11 [00:00<00:01,  5.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  45%|████████████▎              | 5/11 [00:00<00:01,  5.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  45%|████████████▎              | 5/11 [00:01<00:01,  5.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  64%|█████████████████▏         | 7/11 [00:01<00:00,  5.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  73%|███████████████████▋       | 8/11 [00:01<00:00,  6.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  73%|███████████████████▋       | 8/11 [00:01<00:00,  6.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  82%|██████████████████████     | 9/11 [00:01<00:00,  6.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  82%|██████████████████████     | 9/11 [00:01<00:00,  6.74it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  7.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  7.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    40: 100%|██████████████████████████| 11/11 [00:01<00:00,  7.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    40: 100%|██████████████████████████| 11/11 [00:01<00:00,  6.37it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 40 training [time: 1.73s, train loss: 10.7119]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.88it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.88it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 25.01it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:50    INFO  epoch 40 evaluating [time: 0.14s, valid_score: 0.858800]
12 Oct 19:50    INFO  valid result: 
recall@5 : 0.873    recall@10 : 0.8813    mrr@5 : 0.8577    mrr@10 : 0.8588    ndcg@5 : 0.8615    ndcg@10 : 0.8642    hit@5 : 0.873    hit@10 : 0.8813    precision@5 : 0.1746    precision@10 : 0.0881

Train    41:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    41:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:   9%|██▍                        | 1/11 [00:00<00:01,  6.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:   9%|██▍                        | 1/11 [00:00<00:01,  6.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  18%|████▉                      | 2/11 [00:00<00:01,  7.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  18%|████▉                      | 2/11 [00:00<00:01,  7.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  27%|███████▎                   | 3/11 [00:00<00:01,  7.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  27%|███████▎                   | 3/11 [00:00<00:01,  7.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  45%|████████████▎              | 5/11 [00:00<00:00,  8.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  45%|████████████▎              | 5/11 [00:00<00:00,  8.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    41: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    41: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.24it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 41 training [time: 1.34s, train loss: 9.8007]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.97it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.97it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.24it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 41 evaluating [time: 0.11s, valid_score: 0.860200]
12 Oct 19:51    INFO  valid result: 
recall@5 : 0.873    recall@10 : 0.8827    mrr@5 : 0.8589    mrr@10 : 0.8602    ndcg@5 : 0.8624    ndcg@10 : 0.8656    hit@5 : 0.873    hit@10 : 0.8827    precision@5 : 0.1746    precision@10 : 0.0883

Train    42:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    42:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:   9%|██▍                        | 1/11 [00:00<00:01,  8.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:   9%|██▍                        | 1/11 [00:00<00:01,  8.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  18%|████▉                      | 2/11 [00:00<00:01,  8.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  18%|████▉                      | 2/11 [00:00<00:01,  8.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  27%|███████▎                   | 3/11 [00:00<00:00,  8.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  27%|███████▎                   | 3/11 [00:00<00:00,  8.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  45%|████████████▎              | 5/11 [00:00<00:00,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  45%|████████████▎              | 5/11 [00:00<00:00,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  64%|█████████████████▏         | 7/11 [00:00<00:00,  6.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  64%|█████████████████▏         | 7/11 [00:01<00:00,  6.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  73%|███████████████████▋       | 8/11 [00:01<00:00,  7.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  73%|███████████████████▋       | 8/11 [00:01<00:00,  7.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  82%|██████████████████████     | 9/11 [00:01<00:00,  7.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  82%|██████████████████████     | 9/11 [00:01<00:00,  7.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  7.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  7.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    42: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    42: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.05it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 42 training [time: 1.37s, train loss: 9.7537]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.31it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.31it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 25.82it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 42 evaluating [time: 0.12s, valid_score: 0.859600]
12 Oct 19:51    INFO  valid result: 
recall@5 : 0.8725    recall@10 : 0.8855    mrr@5 : 0.8578    mrr@10 : 0.8596    ndcg@5 : 0.8615    ndcg@10 : 0.8658    hit@5 : 0.8725    hit@10 : 0.8855    precision@5 : 0.1745    precision@10 : 0.0886

Train    43:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    43:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:   9%|██▍                        | 1/11 [00:00<00:01,  8.46it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:   9%|██▍                        | 1/11 [00:00<00:01,  8.46it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  18%|████▉                      | 2/11 [00:00<00:01,  8.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  18%|████▉                      | 2/11 [00:00<00:01,  8.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  27%|███████▎                   | 3/11 [00:00<00:00,  8.50it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  27%|███████▎                   | 3/11 [00:00<00:00,  8.50it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  45%|████████████▎              | 5/11 [00:00<00:00,  8.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  45%|████████████▎              | 5/11 [00:00<00:00,  8.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.76it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.76it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    43: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    43: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.64it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 43 training [time: 1.27s, train loss: 9.5303]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.82it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.82it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.01it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 43 evaluating [time: 0.11s, valid_score: 0.858300]
12 Oct 19:51    INFO  valid result: 
recall@5 : 0.873    recall@10 : 0.886    mrr@5 : 0.8566    mrr@10 : 0.8583    ndcg@5 : 0.8607    ndcg@10 : 0.8649    hit@5 : 0.873    hit@10 : 0.886    precision@5 : 0.1746    precision@10 : 0.0886

Train    44:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    44:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:   9%|██▍                        | 1/11 [00:00<00:01,  8.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:   9%|██▍                        | 1/11 [00:00<00:01,  8.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  18%|████▉                      | 2/11 [00:00<00:01,  8.92it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  18%|████▉                      | 2/11 [00:00<00:01,  8.92it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  27%|███████▎                   | 3/11 [00:00<00:00,  8.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  27%|███████▎                   | 3/11 [00:00<00:00,  8.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  45%|████████████▎              | 5/11 [00:00<00:00,  9.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  45%|████████████▎              | 5/11 [00:00<00:00,  9.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    44: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    44: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.80it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 44 training [time: 1.25s, train loss: 9.8138]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 16.81it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 16.81it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 23.79it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 44 evaluating [time: 0.13s, valid_score: 0.860200]
12 Oct 19:51    INFO  valid result: 
recall@5 : 0.8744    recall@10 : 0.8865    mrr@5 : 0.8586    mrr@10 : 0.8602    ndcg@5 : 0.8626    ndcg@10 : 0.8665    hit@5 : 0.8744    hit@10 : 0.8865    precision@5 : 0.1749    precision@10 : 0.0886

Train    45:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    45:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:   9%|██▍                        | 1/11 [00:00<00:01,  8.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:   9%|██▍                        | 1/11 [00:00<00:01,  8.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  18%|████▉                      | 2/11 [00:00<00:01,  8.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  18%|████▉                      | 2/11 [00:00<00:01,  8.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  27%|███████▎                   | 3/11 [00:00<00:00,  8.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  27%|███████▎                   | 3/11 [00:00<00:00,  8.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.70it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  45%|████████████▎              | 5/11 [00:00<00:00,  8.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  45%|████████████▎              | 5/11 [00:00<00:00,  8.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.67it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.67it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    45: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    45: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.75it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 45 training [time: 1.26s, train loss: 10.4672]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.26it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.26it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 24.50it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 45 evaluating [time: 0.14s, valid_score: 0.861300]
12 Oct 19:51    INFO  valid result: 
recall@5 : 0.8739    recall@10 : 0.886    mrr@5 : 0.8597    mrr@10 : 0.8613    ndcg@5 : 0.8633    ndcg@10 : 0.8671    hit@5 : 0.8739    hit@10 : 0.886    precision@5 : 0.1748    precision@10 : 0.0886

Train    46:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    46:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:   9%|██▍                        | 1/11 [00:00<00:01,  8.67it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:   9%|██▍                        | 1/11 [00:00<00:01,  8.67it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  18%|████▉                      | 2/11 [00:00<00:01,  8.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  18%|████▉                      | 2/11 [00:00<00:01,  8.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  27%|███████▎                   | 3/11 [00:00<00:00,  8.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  27%|███████▎                   | 3/11 [00:00<00:00,  8.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  45%|████████████▎              | 5/11 [00:00<00:00,  8.50it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  45%|████████████▎              | 5/11 [00:00<00:00,  8.50it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  55%|██████████████▋            | 6/11 [00:00<00:00,  6.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  55%|██████████████▋            | 6/11 [00:00<00:00,  6.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  64%|█████████████████▏         | 7/11 [00:00<00:00,  7.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  64%|█████████████████▏         | 7/11 [00:01<00:00,  7.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  73%|███████████████████▋       | 8/11 [00:01<00:00,  7.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  73%|███████████████████▋       | 8/11 [00:01<00:00,  7.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  82%|██████████████████████     | 9/11 [00:01<00:00,  7.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  82%|██████████████████████     | 9/11 [00:01<00:00,  7.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    46: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    46: 100%|██████████████████████████| 11/11 [00:01<00:00,  7.98it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 46 training [time: 1.38s, train loss: 10.8036]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.60it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.60it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 26.26it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 46 evaluating [time: 0.12s, valid_score: 0.862400]
12 Oct 19:51    INFO  valid result: 
recall@5 : 0.8725    recall@10 : 0.8855    mrr@5 : 0.8607    mrr@10 : 0.8624    ndcg@5 : 0.8637    ndcg@10 : 0.8679    hit@5 : 0.8725    hit@10 : 0.8855    precision@5 : 0.1745    precision@10 : 0.0886
12 Oct 19:51    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Train    47:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    47:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:   9%|██▍                        | 1/11 [00:00<00:01,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:   9%|██▍                        | 1/11 [00:00<00:01,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  18%|████▉                      | 2/11 [00:00<00:01,  8.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  18%|████▉                      | 2/11 [00:00<00:01,  8.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  27%|███████▎                   | 3/11 [00:00<00:00,  8.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  27%|███████▎                   | 3/11 [00:00<00:00,  8.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  45%|████████████▎              | 5/11 [00:00<00:00,  8.76it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  45%|████████████▎              | 5/11 [00:00<00:00,  8.76it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    47: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    47: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.84it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 47 training [time: 1.24s, train loss: 9.8617]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.22it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.22it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 24.21it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 47 evaluating [time: 0.14s, valid_score: 0.860800]
12 Oct 19:51    INFO  valid result: 
recall@5 : 0.873    recall@10 : 0.8851    mrr@5 : 0.8592    mrr@10 : 0.8608    ndcg@5 : 0.8627    ndcg@10 : 0.8666    hit@5 : 0.873    hit@10 : 0.8851    precision@5 : 0.1746    precision@10 : 0.0885

Train    48:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    48:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:   9%|██▍                        | 1/11 [00:00<00:01,  8.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:   9%|██▍                        | 1/11 [00:00<00:01,  8.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  18%|████▉                      | 2/11 [00:00<00:01,  8.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  18%|████▉                      | 2/11 [00:00<00:01,  8.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  27%|███████▎                   | 3/11 [00:00<00:00,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  27%|███████▎                   | 3/11 [00:00<00:00,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  45%|████████████▎              | 5/11 [00:00<00:00,  8.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  45%|████████████▎              | 5/11 [00:00<00:00,  8.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    48: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    48: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.61it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 48 training [time: 1.28s, train loss: 9.6099]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.13it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.13it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 26.94it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 48 evaluating [time: 0.12s, valid_score: 0.861600]
12 Oct 19:51    INFO  valid result: 
recall@5 : 0.8725    recall@10 : 0.8851    mrr@5 : 0.86    mrr@10 : 0.8616    ndcg@5 : 0.8631    ndcg@10 : 0.8671    hit@5 : 0.8725    hit@10 : 0.8851    precision@5 : 0.1745    precision@10 : 0.0885

Train    49:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    49:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:   9%|██▍                        | 1/11 [00:00<00:01,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:   9%|██▍                        | 1/11 [00:00<00:01,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  18%|████▉                      | 2/11 [00:00<00:01,  8.99it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  18%|████▉                      | 2/11 [00:00<00:01,  8.99it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  27%|███████▎                   | 3/11 [00:00<00:00,  9.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  27%|███████▎                   | 3/11 [00:00<00:00,  9.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  45%|████████████▎              | 5/11 [00:00<00:00,  8.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  45%|████████████▎              | 5/11 [00:00<00:00,  8.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.50it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.50it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.52it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.52it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    49: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.94it/s, GPU RAM: 1.07 G/3.68 G]
Train    49: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.75it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 49 training [time: 1.26s, train loss: 10.4456]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 15.86it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 15.86it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 22.59it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  epoch 49 evaluating [time: 0.14s, valid_score: 0.863100]
12 Oct 19:51    INFO  valid result: 
recall@5 : 0.8734    recall@10 : 0.8869    mrr@5 : 0.8614    mrr@10 : 0.8631    ndcg@5 : 0.8644    ndcg@10 : 0.8688    hit@5 : 0.8734    hit@10 : 0.8869    precision@5 : 0.1747    precision@10 : 0.0887
12 Oct 19:51    INFO  Saving current: saved/BERT4Rec-Oct-12-2025_19-49-02.pth
12 Oct 19:51    INFO  Loading model structure and parameters from saved/BERT4Rec-Oct-12-2025_19-49-02.pth

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 16.72it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 16.72it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 21.58it/s, GPU RAM: 1.07 G/3.68 G]
12 Oct 19:51    INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |     4.30 %     |
+-------------+----------------+
| GPU         | 1.07 G/3.68 G  |
+-------------+----------------+
| Memory      | 1.14 G/15.33 G |
+-------------+----------------+
12 Oct 19:51    INFO  best valid : OrderedDict({'recall@5': 0.8734, 'recall@10': 0.8869, 'mrr@5': 0.8614, 'mrr@10': 0.8631, 'ndcg@5': 0.8644, 'ndcg@10': 0.8688, 'hit@5': 0.8734, 'hit@10': 0.8869, 'precision@5': 0.1747, 'precision@10': 0.0887})
12 Oct 19:51    INFO  test result: OrderedDict({'recall@5': 0.9853, 'recall@10': 0.9902, 'mrr@5': 0.9683, 'mrr@10': 0.9689, 'ndcg@5': 0.9726, 'ndcg@10': 0.9742, 'hit@5': 0.9853, 'hit@10': 0.9902, 'precision@5': 0.1971, 'precision@10': 0.099})

2025-10-12 19:51:14,462 | INFO | Copied checkpoint /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/saved/BERT4Rec-Oct-12-2025_19-49-02.pth -> /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/BERT4Rec-Oct-12-2025_19-49-02.pth
2025-10-12 19:51:14,462 | INFO | Retraining completed in 0:02:18.237511. Latest checkpoint: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/BERT4Rec-Oct-12-2025_19-49-02.pth
2025-10-12 19:51:14,462 | INFO | === Retraining pipeline finished ===
2025-10-12 20:13:21,229 | INFO | === Retraining pipeline started ===
2025-10-12 20:13:21,230 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 20:13:21,990 | INFO | 🔄 Đang trích xuất data từ Postgres...
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 49, in export_via_psql
    process = subprocess.run(
              ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/subprocess.py", line 548, in run
    with Popen(*popenargs, **kwargs) as process:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: 'psql'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 95, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 70, in main
    df = export_via_psql(conn)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 57, in export_via_psql
    raise RuntimeError("Không tìm thấy lệnh psql. Vui lòng cài đặt PostgreSQL client.") from exc
RuntimeError: Không tìm thấy lệnh psql. Vui lòng cài đặt PostgreSQL client.

2025-10-12 20:13:21,991 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 75, in main
    run_step([sys.executable, "user_behavior_advanced.py"], PROJECT_ROOT / "data" / "preprocessing")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 20:14:27,910 | INFO | === Retraining pipeline started ===
2025-10-12 20:14:27,911 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 20:14:28,910 | INFO | 🔄 Đang trích xuất data từ Postgres...
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 50, in export_via_psql
    process = subprocess.run(
              ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/subprocess.py", line 548, in run
    with Popen(*popenargs, **kwargs) as process:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: 'psql'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 96, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 71, in main
    df = export_via_psql(conn)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 58, in export_via_psql
    raise RuntimeError("Không tìm thấy lệnh psql. Vui lòng cài đặt PostgreSQL client.") from exc
RuntimeError: Không tìm thấy lệnh psql. Vui lòng cài đặt PostgreSQL client.

2025-10-12 20:14:28,911 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 75, in main
    run_step([sys.executable, "user_behavior_advanced.py"], PROJECT_ROOT / "data" / "preprocessing")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 20:14:36,764 | INFO | === Retraining pipeline started ===
2025-10-12 20:14:36,764 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 20:14:37,192 | INFO | 🔄 Đang trích xuất data từ Postgres...
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 50, in export_via_psql
    process = subprocess.run(
              ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/subprocess.py", line 548, in run
    with Popen(*popenargs, **kwargs) as process:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: 'psql'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 96, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 71, in main
    df = export_via_psql(conn)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 58, in export_via_psql
    raise RuntimeError("Không tìm thấy lệnh psql. Vui lòng cài đặt PostgreSQL client.") from exc
RuntimeError: Không tìm thấy lệnh psql. Vui lòng cài đặt PostgreSQL client.

2025-10-12 20:14:37,193 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 75, in main
    run_step([sys.executable, "user_behavior_advanced.py"], PROJECT_ROOT / "data" / "preprocessing")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 20:14:51,007 | INFO | === Retraining pipeline started ===
2025-10-12 20:14:51,007 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 20:14:51,319 | INFO | 🔄 Đang trích xuất data từ Postgres...
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 50, in export_via_psql
    process = subprocess.run(
              ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/subprocess.py", line 548, in run
    with Popen(*popenargs, **kwargs) as process:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: 'psql'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 96, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 71, in main
    df = export_via_psql(conn)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 58, in export_via_psql
    raise RuntimeError("Không tìm thấy lệnh psql. Vui lòng cài đặt PostgreSQL client.") from exc
RuntimeError: Không tìm thấy lệnh psql. Vui lòng cài đặt PostgreSQL client.

2025-10-12 20:14:51,319 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 75, in main
    run_step([sys.executable, "user_behavior_advanced.py"], PROJECT_ROOT / "data" / "preprocessing")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 20:16:23,896 | INFO | === Retraining pipeline started ===
2025-10-12 20:16:23,896 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 20:16:24,373 | INFO | 🔄 Đang trích xuất data từ Postgres...
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 50, in export_via_psql
    process = subprocess.run(
              ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/subprocess.py", line 548, in run
    with Popen(*popenargs, **kwargs) as process:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: 'psql'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 96, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 71, in main
    df = export_via_psql(conn)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 58, in export_via_psql
    raise RuntimeError("Không tìm thấy lệnh psql. Vui lòng cài đặt PostgreSQL client.") from exc
RuntimeError: Không tìm thấy lệnh psql. Vui lòng cài đặt PostgreSQL client.

2025-10-12 20:16:24,373 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 75, in main
    run_step([sys.executable, "user_behavior_advanced.py"], PROJECT_ROOT / "data" / "preprocessing")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 20:44:08,423 | INFO | === Retraining pipeline started ===
2025-10-12 20:44:08,424 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 20:44:09,391 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 13
Số user: 1
Số sản phẩm: 4
Các loại event: {'view': 0.692, 'add_to_cart': 0.308}
                                user_id  ...               timestamp
0  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 09:47:27.874
1  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 09:47:29.740
2  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:51:21.425
3  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:51:24.279
4  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:51:35.772
5  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:51:42.106
6  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:51:42.248
7  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:57:04.963
8  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:58:02.336
9  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 13:13:30.934

[10 rows x 4 columns]

2025-10-12 20:44:09,391 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 20:44:09,934 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce.inter (13 dòng)
                                user_id  ... label
0  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
1  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
2  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
3  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
4  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
5  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
6  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
7  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
8  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
9  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0

[10 rows x 4 columns]

2025-10-12 20:44:09,934 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 20:44:49,225 | INFO | === Retraining pipeline started ===
2025-10-12 20:44:49,225 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 20:44:49,961 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 13
Số user: 1
Số sản phẩm: 4
Các loại event: {'view': 0.692, 'add_to_cart': 0.308}
                                user_id  ...               timestamp
0  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 09:47:27.874
1  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 09:47:29.740
2  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:51:21.425
3  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:51:24.279
4  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:51:35.772
5  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:51:42.106
6  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:51:42.248
7  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:57:04.963
8  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:58:02.336
9  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 13:13:30.934

[10 rows x 4 columns]

2025-10-12 20:44:49,961 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 20:44:50,311 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce.inter (13 dòng)
                                user_id  ... label
0  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
1  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
2  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
3  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
4  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
5  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
6  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
7  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
8  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
9  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0

[10 rows x 4 columns]

2025-10-12 20:44:50,311 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 21:47:09,847 | INFO | === Retraining pipeline started ===
2025-10-12 21:47:09,848 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 21:47:10,642 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 13
Số user: 1
Số sản phẩm: 4
Các loại event: {'view': 0.692, 'add_to_cart': 0.308}
                                user_id  ...               timestamp
0  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 09:47:27.874
1  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 09:47:29.740
2  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:51:21.425
3  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:51:24.279
4  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:51:35.772
5  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:51:42.106
6  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:51:42.248
7  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:57:04.963
8  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 12:58:02.336
9  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 13:13:30.934

[10 rows x 4 columns]

2025-10-12 21:47:10,643 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 21:47:11,348 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce.inter (13 dòng)
                                user_id  ... label
0  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
1  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
2  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
3  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
4  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
5  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
6  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
7  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
8  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
9  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0

[10 rows x 4 columns]

2025-10-12 21:47:11,348 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 22:33:57,026 | INFO | === Retraining pipeline started ===
2025-10-12 22:33:57,028 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 22:33:58,378 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 1
Số user: 1
Số sản phẩm: 1
Các loại event: {'add_to_cart': 1.0}
                                user_id  ...               timestamp
0  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:21:15.029

[1 rows x 4 columns]

2025-10-12 22:33:58,378 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 22:33:59,147 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce.inter (1 dòng)
                                user_id  ... label
0  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0

[1 rows x 4 columns]

2025-10-12 22:33:59,147 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 22:34:08,141 | INFO | 12 Oct 22:34    INFO  ['train_bert4rec.py']
12 Oct 22:34    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
12 Oct 22:34    INFO  ecommerce
The number of users: 2
Average actions of users: 1.0
The number of items: 2
Average actions of items: 1.0
The number of inters: 1
The sparsity of the dataset: 75.0%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 133, in run_recbole
    train_data, valid_data, test_data = data_preparation(config, dataset)
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/utils.py", line 174, in data_preparation
    train_data = get_dataloader(config, "train")(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataloader/general_dataloader.py", line 45, in __init__
    super().__init__(config, dataset, sampler, shuffle=shuffle)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataloader/abstract_dataloader.py", line 130, in __init__
    super().__init__(config, dataset, sampler, shuffle=shuffle)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataloader/abstract_dataloader.py", line 65, in __init__
    super().__init__(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 388, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/torch/utils/data/sampler.py", line 156, in __init__
    raise ValueError(
ValueError: num_samples should be a positive integer value, but got num_samples=0

2025-10-12 22:34:08,142 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 77, in main
    run_step([sys.executable, "train_bert4rec.py"], PROJECT_ROOT / "recommender" / "training")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 23:00:29,439 | INFO | === Retraining pipeline started ===
2025-10-12 23:00:29,440 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 23:00:30,656 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 8
Số user: 1
Số sản phẩm: 6
Các loại event: {'add_to_cart': 0.5, 'view': 0.5}
                                user_id  ...               timestamp
0  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:21:15.029
1  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:34:09.433
2  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:34:48.328
3  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:34:49.143
4  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:45:00.787
5  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:45:02.820
6  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:45:18.447
7  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:45:22.821

[8 rows x 4 columns]

2025-10-12 23:00:30,656 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 23:00:31,190 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce.inter (8 dòng)
                                user_id  ... label
0  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
1  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
2  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
3  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
4  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
5  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
6  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
7  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0

[8 rows x 4 columns]

2025-10-12 23:00:31,190 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 23:00:40,833 | INFO | 12 Oct 23:00    INFO  ['train_bert4rec.py']
12 Oct 23:00    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
12 Oct 23:00    INFO  ecommerce
The number of users: 2
Average actions of users: 8.0
The number of items: 7
Average actions of items: 1.3333333333333333
The number of inters: 8
The sparsity of the dataset: 42.85714285714286%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
12 Oct 23:00    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
12 Oct 23:00    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
12 Oct 23:00    INFO  BERT4Rec(
  (item_embedding): Embedding(8, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 108103
12 Oct 23:00    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  4.77it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  4.76it/s, GPU RAM: 0.03 G/3.68 G]
12 Oct 23:00    INFO  epoch 0 training [time: 0.21s, train loss: 1.9735]

Evaluate   :   0%|                                                            | 0/1 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 148, in run_recbole
    best_valid_score, best_valid_result = trainer.fit(
                                          ^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 464, in fit
    valid_score, valid_result = self._valid_epoch(
                                ^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 283, in _valid_epoch
    valid_result = self.evaluate(
                   ^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 621, in evaluate
    self.eval_collector.eval_batch_collect(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/evaluator/collector.py", line 159, in eval_batch_collect
    _, topk_idx = torch.topk(
                  ^^^^^^^^^^^
RuntimeError: selected index k out of range

2025-10-12 23:00:40,833 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 77, in main
    run_step([sys.executable, "train_bert4rec.py"], PROJECT_ROOT / "recommender" / "training")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 23:46:32,108 | INFO | === Retraining pipeline started ===
2025-10-12 23:46:32,108 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-12 23:46:33,120 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 8
Số user: 1
Số sản phẩm: 6
Các loại event: {'add_to_cart': 0.5, 'view': 0.5}
                                user_id  ...               timestamp
0  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:21:15.029
1  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:34:09.433
2  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:34:48.328
3  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:34:49.143
4  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:45:00.787
5  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:45:02.820
6  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:45:18.447
7  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:45:22.821

[8 rows x 4 columns]

2025-10-12 23:46:33,120 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-12 23:46:33,705 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce.inter (8 dòng)
                                user_id  ... label
0  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
1  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
2  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
3  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
4  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
5  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
6  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
7  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0

[8 rows x 4 columns]

2025-10-12 23:46:33,705 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-12 23:46:44,332 | INFO | 12 Oct 23:46    INFO  ['train_bert4rec.py']
12 Oct 23:46    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
12 Oct 23:46    INFO  ecommerce
The number of users: 2
Average actions of users: 8.0
The number of items: 7
Average actions of items: 1.3333333333333333
The number of inters: 8
The sparsity of the dataset: 42.85714285714286%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
12 Oct 23:46    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
12 Oct 23:46    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
12 Oct 23:46    INFO  BERT4Rec(
  (item_embedding): Embedding(8, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 108103
12 Oct 23:46    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  4.96it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  4.95it/s, GPU RAM: 0.03 G/3.68 G]
12 Oct 23:46    INFO  epoch 0 training [time: 0.20s, train loss: 1.9735]

Evaluate   :   0%|                                                            | 0/1 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 148, in run_recbole
    best_valid_score, best_valid_result = trainer.fit(
                                          ^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 464, in fit
    valid_score, valid_result = self._valid_epoch(
                                ^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 283, in _valid_epoch
    valid_result = self.evaluate(
                   ^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 621, in evaluate
    self.eval_collector.eval_batch_collect(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/evaluator/collector.py", line 159, in eval_batch_collect
    _, topk_idx = torch.topk(
                  ^^^^^^^^^^^
RuntimeError: selected index k out of range

2025-10-12 23:46:44,333 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 77, in main
    run_step([sys.executable, "train_bert4rec.py"], PROJECT_ROOT / "recommender" / "training")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 00:03:02,222 | INFO | === Retraining pipeline started ===
2025-10-13 00:03:02,222 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-13 00:03:03,361 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 8
Số user: 1
Số sản phẩm: 6
Các loại event: {'add_to_cart': 0.5, 'view': 0.5}
                                user_id  ...               timestamp
0  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:21:15.029
1  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:34:09.433
2  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:34:48.328
3  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:34:49.143
4  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:45:00.787
5  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:45:02.820
6  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:45:18.447
7  62bb3b9e-82e5-45bb-8053-6765cad22c23  ... 2025-10-12 15:45:22.821

[8 rows x 4 columns]

2025-10-13 00:03:03,361 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-13 00:03:03,907 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce.inter (8 dòng)
                                user_id  ... label
0  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
1  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
2  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
3  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
4  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
5  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
6  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0
7  62bb3b9e-82e5-45bb-8053-6765cad22c23  ...     0

[8 rows x 4 columns]

2025-10-13 00:03:03,907 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 00:03:12,542 | INFO | 13 Oct 00:03    INFO  ['train_bert4rec.py']
13 Oct 00:03    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 00:03    INFO  ecommerce
The number of users: 2
Average actions of users: 8.0
The number of items: 7
Average actions of items: 1.3333333333333333
The number of inters: 8
The sparsity of the dataset: 42.85714285714286%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 00:03    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 00:03    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 00:03    INFO  BERT4Rec(
  (item_embedding): Embedding(8, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 108103
13 Oct 00:03    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  3.81it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  3.79it/s, GPU RAM: 0.03 G/3.68 G]
13 Oct 00:03    INFO  epoch 0 training [time: 0.27s, train loss: 1.9735]

Evaluate   :   0%|                                                            | 0/1 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 148, in run_recbole
    best_valid_score, best_valid_result = trainer.fit(
                                          ^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 464, in fit
    valid_score, valid_result = self._valid_epoch(
                                ^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 283, in _valid_epoch
    valid_result = self.evaluate(
                   ^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 621, in evaluate
    self.eval_collector.eval_batch_collect(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/evaluator/collector.py", line 159, in eval_batch_collect
    _, topk_idx = torch.topk(
                  ^^^^^^^^^^^
RuntimeError: selected index k out of range

2025-10-13 00:03:12,542 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 77, in main
    run_step([sys.executable, "train_bert4rec.py"], PROJECT_ROOT / "recommender" / "training")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 00:08:01,540 | INFO | === Retraining pipeline started ===
2025-10-13 00:08:01,540 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-13 00:08:02,602 | INFO | 🔄 Đang trích xuất data từ Postgres...
⚠️  Không có dữ liệu khả dụng trong ai_interaction_events

2025-10-13 00:08:02,603 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-13 00:08:03,208 | INFO | Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/prepare_interactions_for_recbole.py", line 44, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/prepare_interactions_for_recbole.py", line 20, in main
    df = pd.read_csv(SOURCE_FILE)
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file

2025-10-13 00:08:03,208 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 87, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 76, in main
    run_step([sys.executable, "prepare_interactions_for_recbole.py"], PROJECT_ROOT / "data" / "preprocessing")
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 48, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-13 00:21:23,857 | INFO | === Retraining pipeline started ===
2025-10-13 00:21:23,860 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-13 00:21:25,302 | INFO | 🔄 Đang trích xuất data từ Postgres...
⚠️  Không có dữ liệu khả dụng trong ai_interaction_events

2025-10-13 00:21:25,302 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py
2025-10-13 00:21:26,119 | INFO | ✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce.inter (18230 dòng)
   user_id  item_id   timestamp  label
0        3       25  1704067200      0
1        3       25  1704068520      0
2        3       89  1707264000      0
3        3       89  1707264300      0
4        3       89  1707265440      0
5        3       89  1707266820      1
6        3       12  1708041600      0
7        3       12  1708044480      0
8        4        4  1707436800      0
9        4        4  1707437100      0

2025-10-13 00:21:26,119 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 00:22:46,827 | INFO | 13 Oct 00:21    INFO  ['train_bert4rec.py']
13 Oct 00:21    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 00:21    INFO  ecommerce
The number of users: 2606
Average actions of users: 6.998080614203455
The number of items: 96
Average actions of items: 191.89473684210526
The number of inters: 18230
The sparsity of the dataset: 92.71312995651061%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 00:21    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 00:21    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 00:21    INFO  BERT4Rec(
  (item_embedding): Embedding(97, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 113888
13 Oct 00:21    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                           | 0/11 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.02 G/3.68 G]
Train     0:   9%|██▍                        | 1/11 [00:00<00:04,  2.40it/s, GPU RAM: 1.02 G/3.68 G]
Train     0:   9%|██▍                        | 1/11 [00:00<00:04,  2.40it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  18%|████▉                      | 2/11 [00:00<00:02,  4.11it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  18%|████▉                      | 2/11 [00:00<00:02,  4.11it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  27%|███████▎                   | 3/11 [00:00<00:01,  5.44it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  27%|███████▎                   | 3/11 [00:00<00:01,  5.44it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  36%|█████████▊                 | 4/11 [00:00<00:01,  6.54it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  36%|█████████▊                 | 4/11 [00:00<00:01,  6.54it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  45%|████████████▎              | 5/11 [00:00<00:00,  7.32it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  45%|████████████▎              | 5/11 [00:00<00:00,  7.32it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  55%|██████████████▋            | 6/11 [00:00<00:00,  7.91it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  55%|██████████████▋            | 6/11 [00:01<00:00,  7.91it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  64%|█████████████████▏         | 7/11 [00:01<00:00,  8.35it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  64%|█████████████████▏         | 7/11 [00:01<00:00,  8.35it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.58it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.58it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.82it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.82it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.86it/s, GPU RAM: 1.07 G/3.68 G]
Train     0:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.86it/s, GPU RAM: 1.07 G/3.68 G]
Train     0: 100%|██████████████████████████| 11/11 [00:01<00:00,  7.31it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 0 training [time: 1.51s, train loss: 49.8206]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 16.45it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 16.45it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 22.86it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 0 evaluating [time: 0.15s, valid_score: 0.060700]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.0951    recall@10 : 0.1821    mrr@5 : 0.0492    mrr@10 : 0.0607    ndcg@5 : 0.0605    ndcg@10 : 0.0885    hit@5 : 0.0951    hit@10 : 0.1821    precision@5 : 0.019    precision@10 : 0.0182
13 Oct 00:21    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train     1:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     1:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:   9%|██▍                        | 1/11 [00:00<00:01,  8.90it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:   9%|██▍                        | 1/11 [00:00<00:01,  8.90it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  18%|████▉                      | 2/11 [00:00<00:00,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  18%|████▉                      | 2/11 [00:00<00:00,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  27%|███████▎                   | 3/11 [00:00<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  27%|███████▎                   | 3/11 [00:00<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.10it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.10it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  45%|████████████▎              | 5/11 [00:00<00:00,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  45%|████████████▎              | 5/11 [00:00<00:00,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.40it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.40it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train     1:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train     1: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 1 training [time: 1.18s, train loss: 48.9197]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.41it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.41it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 25.51it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 1 evaluating [time: 0.13s, valid_score: 0.086500]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.1334    recall@10 : 0.2604    mrr@5 : 0.0701    mrr@10 : 0.0865    ndcg@5 : 0.0856    ndcg@10 : 0.1261    hit@5 : 0.1334    hit@10 : 0.2604    precision@5 : 0.0267    precision@10 : 0.026
13 Oct 00:21    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train     2:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     2:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:   9%|██▍                        | 1/11 [00:00<00:01,  9.16it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:   9%|██▍                        | 1/11 [00:00<00:01,  9.16it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  18%|████▉                      | 2/11 [00:00<00:01,  8.98it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  18%|████▉                      | 2/11 [00:00<00:01,  8.98it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  27%|███████▎                   | 3/11 [00:00<00:00,  8.86it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  27%|███████▎                   | 3/11 [00:00<00:00,  8.86it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  45%|████████████▎              | 5/11 [00:00<00:01,  4.89it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  45%|████████████▎              | 5/11 [00:00<00:01,  4.89it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  55%|██████████████▋            | 6/11 [00:00<00:00,  5.69it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  55%|██████████████▋            | 6/11 [00:01<00:00,  5.69it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  64%|█████████████████▏         | 7/11 [00:01<00:00,  6.32it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  64%|█████████████████▏         | 7/11 [00:01<00:00,  6.32it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  73%|███████████████████▋       | 8/11 [00:01<00:00,  6.77it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  73%|███████████████████▋       | 8/11 [00:01<00:00,  6.77it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  82%|██████████████████████     | 9/11 [00:01<00:00,  7.03it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  82%|██████████████████████     | 9/11 [00:01<00:00,  7.03it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  7.38it/s, GPU RAM: 1.07 G/3.68 G]
Train     2:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  7.38it/s, GPU RAM: 1.07 G/3.68 G]
Train     2: 100%|██████████████████████████| 11/11 [00:01<00:00,  7.64it/s, GPU RAM: 1.07 G/3.68 G]
Train     2: 100%|██████████████████████████| 11/11 [00:01<00:00,  7.06it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 2 training [time: 1.56s, train loss: 47.0340]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.97it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.97it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  33%|█████████▎                  | 1/3 [00:00<00:00,  8.97it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 14.29it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 13.47it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 2 evaluating [time: 0.26s, valid_score: 0.312200]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.4433    recall@10 : 0.543    mrr@5 : 0.2991    mrr@10 : 0.3122    ndcg@5 : 0.3351    ndcg@10 : 0.3672    hit@5 : 0.4433    hit@10 : 0.543    precision@5 : 0.0887    precision@10 : 0.0543
13 Oct 00:21    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train     3:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     3:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:   9%|██▍                        | 1/11 [00:00<00:01,  7.44it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:   9%|██▍                        | 1/11 [00:00<00:01,  7.44it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  18%|████▉                      | 2/11 [00:00<00:01,  8.09it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  18%|████▉                      | 2/11 [00:00<00:01,  8.09it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  27%|███████▎                   | 3/11 [00:00<00:00,  8.45it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  27%|███████▎                   | 3/11 [00:00<00:00,  8.45it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.77it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.77it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  45%|████████████▎              | 5/11 [00:00<00:00,  8.93it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  45%|████████████▎              | 5/11 [00:00<00:00,  8.93it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.07it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.07it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.16it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.16it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  73%|███████████████████▋       | 8/11 [00:01<00:00,  9.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.16it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.16it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     3:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     3: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.05it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 3 training [time: 1.22s, train loss: 42.7349]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 30.96it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 3 evaluating [time: 0.10s, valid_score: 0.519000]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.6381    recall@10 : 0.7142    mrr@5 : 0.5086    mrr@10 : 0.519    ndcg@5 : 0.5408    ndcg@10 : 0.5658    hit@5 : 0.6381    hit@10 : 0.7142    precision@5 : 0.1276    precision@10 : 0.0714
13 Oct 00:21    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train     4:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     4:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:   9%|██▍                        | 1/11 [00:00<00:01,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:   9%|██▍                        | 1/11 [00:00<00:01,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  18%|████▉                      | 2/11 [00:00<00:00,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  18%|████▉                      | 2/11 [00:00<00:00,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  27%|███████▎                   | 3/11 [00:00<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  27%|███████▎                   | 3/11 [00:00<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.25it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.25it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  45%|████████████▎              | 5/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  45%|████████████▎              | 5/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.49it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.49it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train     4:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train     4: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.48it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 4 training [time: 1.16s, train loss: 38.8044]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.23it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.23it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 24.57it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 4 evaluating [time: 0.14s, valid_score: 0.657500]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.7442    recall@10 : 0.7852    mrr@5 : 0.652    mrr@10 : 0.6575    ndcg@5 : 0.6752    ndcg@10 : 0.6884    hit@5 : 0.7442    hit@10 : 0.7852    precision@5 : 0.1488    precision@10 : 0.0785
13 Oct 00:21    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train     5:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     5:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:   9%|██▍                        | 1/11 [00:00<00:01,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:   9%|██▍                        | 1/11 [00:00<00:01,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  18%|████▉                      | 2/11 [00:00<00:00,  9.48it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  18%|████▉                      | 2/11 [00:00<00:00,  9.48it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  27%|███████▎                   | 3/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  27%|███████▎                   | 3/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  45%|████████████▎              | 5/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  45%|████████████▎              | 5/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train     5:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train     5: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 5 training [time: 1.18s, train loss: 35.1426]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.26it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.26it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 24.72it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 5 evaluating [time: 0.14s, valid_score: 0.683600]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.7569    recall@10 : 0.7984    mrr@5 : 0.678    mrr@10 : 0.6836    ndcg@5 : 0.6978    ndcg@10 : 0.7113    hit@5 : 0.7569    hit@10 : 0.7984    precision@5 : 0.1514    precision@10 : 0.0798
13 Oct 00:21    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train     6:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     6:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:   9%|██▍                        | 1/11 [00:00<00:01,  9.12it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:   9%|██▍                        | 1/11 [00:00<00:01,  9.12it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  18%|████▉                      | 2/11 [00:00<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  18%|████▉                      | 2/11 [00:00<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  27%|███████▎                   | 3/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  27%|███████▎                   | 3/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  45%|████████████▎              | 5/11 [00:00<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  45%|████████████▎              | 5/11 [00:00<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.45it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.45it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  64%|█████████████████▏         | 7/11 [00:00<00:00,  7.52it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  64%|█████████████████▏         | 7/11 [00:00<00:00,  7.52it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  73%|███████████████████▋       | 8/11 [00:00<00:00,  7.95it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  73%|███████████████████▋       | 8/11 [00:01<00:00,  7.95it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.24it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.24it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.44it/s, GPU RAM: 1.07 G/3.68 G]
Train     6:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.44it/s, GPU RAM: 1.07 G/3.68 G]
Train     6: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 6 training [time: 1.26s, train loss: 31.7919]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.85it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.85it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 24.16it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 6 evaluating [time: 0.14s, valid_score: 0.720300]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.7797    recall@10 : 0.8175    mrr@5 : 0.7152    mrr@10 : 0.7203    ndcg@5 : 0.7314    ndcg@10 : 0.7436    hit@5 : 0.7797    hit@10 : 0.8175    precision@5 : 0.1559    precision@10 : 0.0817
13 Oct 00:21    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train     7:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     7:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:   9%|██▍                        | 1/11 [00:00<00:01,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:   9%|██▍                        | 1/11 [00:00<00:01,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  18%|████▉                      | 2/11 [00:00<00:00,  9.05it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  18%|████▉                      | 2/11 [00:00<00:00,  9.05it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  27%|███████▎                   | 3/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  27%|███████▎                   | 3/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.30it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.30it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  45%|████████████▎              | 5/11 [00:00<00:00,  9.37it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  45%|████████████▎              | 5/11 [00:00<00:00,  9.37it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.43it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.43it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train     7:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train     7: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 7 training [time: 1.18s, train loss: 28.8576]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.95it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.95it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 26.28it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 7 evaluating [time: 0.13s, valid_score: 0.748800]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.7997    recall@10 : 0.8302    mrr@5 : 0.7447    mrr@10 : 0.7488    ndcg@5 : 0.7585    ndcg@10 : 0.7683    hit@5 : 0.7997    hit@10 : 0.8302    precision@5 : 0.1599    precision@10 : 0.083
13 Oct 00:21    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train     8:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     8:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:   9%|██▍                        | 1/11 [00:00<00:01,  9.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:   9%|██▍                        | 1/11 [00:00<00:01,  9.15it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  18%|████▉                      | 2/11 [00:00<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  18%|████▉                      | 2/11 [00:00<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  27%|███████▎                   | 3/11 [00:00<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  27%|███████▎                   | 3/11 [00:00<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  45%|████████████▎              | 5/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  45%|████████████▎              | 5/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.58it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.58it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.53it/s, GPU RAM: 1.07 G/3.68 G]
Train     8:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.53it/s, GPU RAM: 1.07 G/3.68 G]
Train     8: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.48it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 8 training [time: 1.16s, train loss: 25.8287]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.65it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.65it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 23.37it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 8 evaluating [time: 0.14s, valid_score: 0.778100]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.8248    recall@10 : 0.848    mrr@5 : 0.7752    mrr@10 : 0.7781    ndcg@5 : 0.7876    ndcg@10 : 0.7949    hit@5 : 0.8248    hit@10 : 0.848    precision@5 : 0.165    precision@10 : 0.0848
13 Oct 00:21    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train     9:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     9:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:   9%|██▍                        | 1/11 [00:00<00:01,  8.96it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:   9%|██▍                        | 1/11 [00:00<00:01,  8.96it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  18%|████▉                      | 2/11 [00:00<00:01,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  18%|████▉                      | 2/11 [00:00<00:01,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  27%|███████▎                   | 3/11 [00:00<00:00,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  27%|███████▎                   | 3/11 [00:00<00:00,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  45%|████████████▎              | 5/11 [00:00<00:00,  8.98it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  45%|████████████▎              | 5/11 [00:00<00:00,  8.98it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.08it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.08it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.16it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.16it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.69it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.69it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.93it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.93it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train     9:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train     9: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.12it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 9 training [time: 1.21s, train loss: 22.9784]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.60it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.54it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 9 evaluating [time: 0.11s, valid_score: 0.807400]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.8407    recall@10 : 0.8566    mrr@5 : 0.8052    mrr@10 : 0.8074    ndcg@5 : 0.8141    ndcg@10 : 0.8193    hit@5 : 0.8407    hit@10 : 0.8566    precision@5 : 0.1681    precision@10 : 0.0857
13 Oct 00:21    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    10:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    10:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:   9%|██▍                        | 1/11 [00:00<00:01,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:   9%|██▍                        | 1/11 [00:00<00:01,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  18%|████▉                      | 2/11 [00:00<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  18%|████▉                      | 2/11 [00:00<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  27%|███████▎                   | 3/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  27%|███████▎                   | 3/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  45%|████████████▎              | 5/11 [00:00<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  45%|████████████▎              | 5/11 [00:00<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  64%|█████████████████▏         | 7/11 [00:00<00:00,  7.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  64%|█████████████████▏         | 7/11 [00:00<00:00,  7.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    10:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    10: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.92it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 10 training [time: 1.23s, train loss: 20.6112]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.51it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.42it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 10 evaluating [time: 0.11s, valid_score: 0.821100]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.8484    recall@10 : 0.8666    mrr@5 : 0.8188    mrr@10 : 0.8211    ndcg@5 : 0.8263    ndcg@10 : 0.8321    hit@5 : 0.8484    hit@10 : 0.8666    precision@5 : 0.1697    precision@10 : 0.0867
13 Oct 00:21    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    11:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    11:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:   9%|██▍                        | 1/11 [00:00<00:01,  9.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:   9%|██▍                        | 1/11 [00:00<00:01,  9.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  18%|████▉                      | 2/11 [00:00<00:00,  9.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  18%|████▉                      | 2/11 [00:00<00:00,  9.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  27%|███████▎                   | 3/11 [00:00<00:00,  9.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  27%|███████▎                   | 3/11 [00:00<00:00,  9.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  45%|████████████▎              | 5/11 [00:00<00:00,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  45%|████████████▎              | 5/11 [00:00<00:00,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    11:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    11: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.51it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 11 training [time: 1.16s, train loss: 18.5119]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.24it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.19it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 11 evaluating [time: 0.11s, valid_score: 0.836900]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.858    recall@10 : 0.8703    mrr@5 : 0.8352    mrr@10 : 0.8369    ndcg@5 : 0.841    ndcg@10 : 0.845    hit@5 : 0.858    hit@10 : 0.8703    precision@5 : 0.1716    precision@10 : 0.087
13 Oct 00:21    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    12:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    12:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:   9%|██▍                        | 1/11 [00:00<00:01,  9.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:   9%|██▍                        | 1/11 [00:00<00:01,  9.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  18%|████▉                      | 2/11 [00:00<00:00,  9.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  18%|████▉                      | 2/11 [00:00<00:00,  9.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  27%|███████▎                   | 3/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  27%|███████▎                   | 3/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  45%|████████████▎              | 5/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  45%|████████████▎              | 5/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    12:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    12: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.50it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 12 training [time: 1.16s, train loss: 16.8999]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 30.27it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 12 evaluating [time: 0.10s, valid_score: 0.831700]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.8566    recall@10 : 0.8707    mrr@5 : 0.8298    mrr@10 : 0.8317    ndcg@5 : 0.8366    ndcg@10 : 0.8412    hit@5 : 0.8566    hit@10 : 0.8707    precision@5 : 0.1713    precision@10 : 0.0871

Train    13:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    13:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:   9%|██▍                        | 1/11 [00:00<00:01,  9.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:   9%|██▍                        | 1/11 [00:00<00:01,  9.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  18%|████▉                      | 2/11 [00:00<00:00,  9.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  18%|████▉                      | 2/11 [00:00<00:00,  9.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  27%|███████▎                   | 3/11 [00:00<00:00,  9.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  27%|███████▎                   | 3/11 [00:00<00:00,  9.63it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.67it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.67it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  45%|████████████▎              | 5/11 [00:00<00:00,  9.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  45%|████████████▎              | 5/11 [00:00<00:00,  9.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.69it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.68it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    13:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    13: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.76it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 13 training [time: 1.13s, train loss: 15.7223]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.43it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.38it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 13 evaluating [time: 0.11s, valid_score: 0.848000]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.8648    recall@10 : 0.8762    mrr@5 : 0.8466    mrr@10 : 0.848    ndcg@5 : 0.8512    ndcg@10 : 0.8548    hit@5 : 0.8648    hit@10 : 0.8762    precision@5 : 0.173    precision@10 : 0.0876
13 Oct 00:21    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    14:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    14:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:   9%|██▍                        | 1/11 [00:00<00:01,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:   9%|██▍                        | 1/11 [00:00<00:01,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  18%|████▉                      | 2/11 [00:00<00:00,  9.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  18%|████▉                      | 2/11 [00:00<00:00,  9.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  27%|███████▎                   | 3/11 [00:00<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  27%|███████▎                   | 3/11 [00:00<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  36%|█████████▊                 | 4/11 [00:00<00:00,  7.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  36%|█████████▊                 | 4/11 [00:00<00:00,  7.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  45%|████████████▎              | 5/11 [00:00<00:00,  8.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  45%|████████████▎              | 5/11 [00:00<00:00,  8.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.46it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.46it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    14:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    14: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.82it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 14 training [time: 1.25s, train loss: 14.4860]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.93it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.88it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 14 evaluating [time: 0.11s, valid_score: 0.850700]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.8666    recall@10 : 0.8771    mrr@5 : 0.8492    mrr@10 : 0.8507    ndcg@5 : 0.8536    ndcg@10 : 0.857    hit@5 : 0.8666    hit@10 : 0.8771    precision@5 : 0.1733    precision@10 : 0.0877
13 Oct 00:21    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    15:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    15:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:   9%|██▍                        | 1/11 [00:00<00:01,  7.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:   9%|██▍                        | 1/11 [00:00<00:01,  7.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  18%|████▉                      | 2/11 [00:00<00:01,  8.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  18%|████▉                      | 2/11 [00:00<00:01,  8.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  27%|███████▎                   | 3/11 [00:00<00:00,  8.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  27%|███████▎                   | 3/11 [00:00<00:00,  8.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.92it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.92it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  45%|████████████▎              | 5/11 [00:00<00:00,  9.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  45%|████████████▎              | 5/11 [00:00<00:00,  9.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    15:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    15: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 15 training [time: 1.20s, train loss: 13.9736]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.48it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.41it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:21    INFO  epoch 15 evaluating [time: 0.11s, valid_score: 0.852800]
13 Oct 00:21    INFO  valid result: 
recall@5 : 0.8685    recall@10 : 0.8776    mrr@5 : 0.8516    mrr@10 : 0.8528    ndcg@5 : 0.8558    ndcg@10 : 0.8587    hit@5 : 0.8685    hit@10 : 0.8776    precision@5 : 0.1737    precision@10 : 0.0878
13 Oct 00:21    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    16:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    16:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:   9%|██▍                        | 1/11 [00:00<00:01,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:   9%|██▍                        | 1/11 [00:00<00:01,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  18%|████▉                      | 2/11 [00:00<00:00,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  18%|████▉                      | 2/11 [00:00<00:00,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  27%|███████▎                   | 3/11 [00:00<00:00,  9.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  27%|███████▎                   | 3/11 [00:00<00:00,  9.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  45%|████████████▎              | 5/11 [00:00<00:00,  9.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  45%|████████████▎              | 5/11 [00:00<00:00,  9.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    16:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.61it/s, GPU RAM: 1.07 G/3.68 G]
Train    16: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.69it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 16 training [time: 1.14s, train loss: 13.4130]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 15.28it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 15.28it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 20.71it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 16 evaluating [time: 0.16s, valid_score: 0.854200]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8689    recall@10 : 0.8785    mrr@5 : 0.8529    mrr@10 : 0.8542    ndcg@5 : 0.8569    ndcg@10 : 0.86    hit@5 : 0.8689    hit@10 : 0.8785    precision@5 : 0.1738    precision@10 : 0.0878
13 Oct 00:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    17:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    17:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:   9%|██▍                        | 1/11 [00:00<00:01,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:   9%|██▍                        | 1/11 [00:00<00:01,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  18%|████▉                      | 2/11 [00:00<00:01,  8.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  18%|████▉                      | 2/11 [00:00<00:01,  8.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  27%|███████▎                   | 3/11 [00:00<00:00,  8.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  27%|███████▎                   | 3/11 [00:00<00:00,  8.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  45%|████████████▎              | 5/11 [00:00<00:00,  9.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  45%|████████████▎              | 5/11 [00:00<00:00,  9.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    17:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    17: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.19it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 17 training [time: 1.20s, train loss: 12.4639]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.65it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.65it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 24.77it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 17 evaluating [time: 0.13s, valid_score: 0.852800]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.868    recall@10 : 0.8794    mrr@5 : 0.8514    mrr@10 : 0.8528    ndcg@5 : 0.8556    ndcg@10 : 0.8592    hit@5 : 0.868    hit@10 : 0.8794    precision@5 : 0.1736    precision@10 : 0.0879

Train    18:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    18:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:   9%|██▍                        | 1/11 [00:00<00:01,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:   9%|██▍                        | 1/11 [00:00<00:01,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  18%|████▉                      | 2/11 [00:00<00:00,  9.52it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  18%|████▉                      | 2/11 [00:00<00:00,  9.52it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  27%|███████▎                   | 3/11 [00:00<00:00,  9.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  27%|███████▎                   | 3/11 [00:00<00:00,  9.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  36%|█████████▊                 | 4/11 [00:00<00:00,  7.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  36%|█████████▊                 | 4/11 [00:00<00:00,  7.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  45%|████████████▎              | 5/11 [00:00<00:00,  7.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  45%|████████████▎              | 5/11 [00:00<00:00,  7.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    18:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    18: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.96it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 18 training [time: 1.23s, train loss: 12.8886]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.67it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.62it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 18 evaluating [time: 0.11s, valid_score: 0.853100]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8671    recall@10 : 0.8766    mrr@5 : 0.8518    mrr@10 : 0.8531    ndcg@5 : 0.8556    ndcg@10 : 0.8587    hit@5 : 0.8671    hit@10 : 0.8766    precision@5 : 0.1734    precision@10 : 0.0877

Train    19:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    19:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:   9%|██▍                        | 1/11 [00:00<00:01,  9.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:   9%|██▍                        | 1/11 [00:00<00:01,  9.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  18%|████▉                      | 2/11 [00:00<00:01,  8.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  18%|████▉                      | 2/11 [00:00<00:01,  8.64it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  27%|███████▎                   | 3/11 [00:00<00:00,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  27%|███████▎                   | 3/11 [00:00<00:00,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  45%|████████████▎              | 5/11 [00:00<00:00,  8.92it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  45%|████████████▎              | 5/11 [00:00<00:00,  8.92it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.92it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.92it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.94it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.94it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  7.88it/s, GPU RAM: 1.07 G/3.68 G]
Train    19:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  7.88it/s, GPU RAM: 1.07 G/3.68 G]
Train    19: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.67it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 19 training [time: 1.27s, train loss: 12.7519]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.65it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.58it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 19 evaluating [time: 0.12s, valid_score: 0.854500]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8685    recall@10 : 0.8766    mrr@5 : 0.8535    mrr@10 : 0.8545    ndcg@5 : 0.8572    ndcg@10 : 0.8599    hit@5 : 0.8685    hit@10 : 0.8766    precision@5 : 0.1737    precision@10 : 0.0877
13 Oct 00:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    20:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    20:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:   9%|██▍                        | 1/11 [00:00<00:01,  9.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:   9%|██▍                        | 1/11 [00:00<00:01,  9.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  18%|████▉                      | 2/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  18%|████▉                      | 2/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  27%|███████▎                   | 3/11 [00:00<00:00,  9.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  27%|███████▎                   | 3/11 [00:00<00:00,  9.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  45%|████████████▎              | 5/11 [00:00<00:00,  8.87it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  45%|████████████▎              | 5/11 [00:00<00:00,  8.87it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.91it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.05it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    20:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    20: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 20 training [time: 1.18s, train loss: 12.1903]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.17it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.11it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 20 evaluating [time: 0.11s, valid_score: 0.856700]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8689    recall@10 : 0.8789    mrr@5 : 0.8555    mrr@10 : 0.8567    ndcg@5 : 0.8589    ndcg@10 : 0.862    hit@5 : 0.8689    hit@10 : 0.8789    precision@5 : 0.1738    precision@10 : 0.0879
13 Oct 00:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    21:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    21:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:   9%|██▍                        | 1/11 [00:00<00:01,  9.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:   9%|██▍                        | 1/11 [00:00<00:01,  9.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  18%|████▉                      | 2/11 [00:00<00:00,  9.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  18%|████▉                      | 2/11 [00:00<00:00,  9.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  27%|███████▎                   | 3/11 [00:00<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  27%|███████▎                   | 3/11 [00:00<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  45%|████████████▎              | 5/11 [00:00<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  45%|████████████▎              | 5/11 [00:00<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    21:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    21: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.65it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 21 training [time: 1.14s, train loss: 11.5639]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.62it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.54it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 21 evaluating [time: 0.11s, valid_score: 0.857300]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8698    recall@10 : 0.8821    mrr@5 : 0.8556    mrr@10 : 0.8573    ndcg@5 : 0.8592    ndcg@10 : 0.8632    hit@5 : 0.8698    hit@10 : 0.8821    precision@5 : 0.174    precision@10 : 0.0882
13 Oct 00:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    22:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    22:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:   9%|██▍                        | 1/11 [00:00<00:01,  8.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:   9%|██▍                        | 1/11 [00:00<00:01,  8.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  18%|████▉                      | 2/11 [00:00<00:00,  9.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  18%|████▉                      | 2/11 [00:00<00:00,  9.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  27%|███████▎                   | 3/11 [00:00<00:00,  9.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  27%|███████▎                   | 3/11 [00:00<00:00,  9.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  45%|████████████▎              | 5/11 [00:00<00:00,  7.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  45%|████████████▎              | 5/11 [00:00<00:00,  7.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  55%|██████████████▋            | 6/11 [00:00<00:00,  7.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  55%|██████████████▋            | 6/11 [00:00<00:00,  7.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.71it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    22:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    22: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.83it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 22 training [time: 1.25s, train loss: 11.7601]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.30it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.30it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 26.13it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 22 evaluating [time: 0.13s, valid_score: 0.857000]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8703    recall@10 : 0.8798    mrr@5 : 0.8558    mrr@10 : 0.857    ndcg@5 : 0.8594    ndcg@10 : 0.8624    hit@5 : 0.8703    hit@10 : 0.8798    precision@5 : 0.1741    precision@10 : 0.088

Train    23:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    23:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:   9%|██▍                        | 1/11 [00:00<00:01,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:   9%|██▍                        | 1/11 [00:00<00:01,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  18%|████▉                      | 2/11 [00:00<00:00,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  18%|████▉                      | 2/11 [00:00<00:00,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  27%|███████▎                   | 3/11 [00:00<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  27%|███████▎                   | 3/11 [00:00<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  45%|████████████▎              | 5/11 [00:00<00:00,  9.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  45%|████████████▎              | 5/11 [00:00<00:00,  9.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    23:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    23: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 23 training [time: 1.17s, train loss: 12.1044]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.90it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.83it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 23 evaluating [time: 0.11s, valid_score: 0.857900]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8703    recall@10 : 0.8812    mrr@5 : 0.8565    mrr@10 : 0.8579    ndcg@5 : 0.8599    ndcg@10 : 0.8634    hit@5 : 0.8703    hit@10 : 0.8812    precision@5 : 0.1741    precision@10 : 0.0881
13 Oct 00:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    24:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    24:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:   9%|██▍                        | 1/11 [00:00<00:01,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:   9%|██▍                        | 1/11 [00:00<00:01,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  18%|████▉                      | 2/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  18%|████▉                      | 2/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  27%|███████▎                   | 3/11 [00:00<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  27%|███████▎                   | 3/11 [00:00<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  45%|████████████▎              | 5/11 [00:00<00:00,  9.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  45%|████████████▎              | 5/11 [00:00<00:00,  9.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    24:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    24: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 24 training [time: 1.17s, train loss: 11.5184]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.64it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.64it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 27.24it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 24 evaluating [time: 0.12s, valid_score: 0.858900]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8712    recall@10 : 0.8821    mrr@5 : 0.8574    mrr@10 : 0.8589    ndcg@5 : 0.8608    ndcg@10 : 0.8645    hit@5 : 0.8712    hit@10 : 0.8821    precision@5 : 0.1742    precision@10 : 0.0882
13 Oct 00:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    25:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    25:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:   9%|██▍                        | 1/11 [00:00<00:01,  9.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:   9%|██▍                        | 1/11 [00:00<00:01,  9.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  18%|████▉                      | 2/11 [00:00<00:00,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  18%|████▉                      | 2/11 [00:00<00:00,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  27%|███████▎                   | 3/11 [00:00<00:00,  8.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  27%|███████▎                   | 3/11 [00:00<00:00,  8.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.94it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.94it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  45%|████████████▎              | 5/11 [00:00<00:00,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  45%|████████████▎              | 5/11 [00:00<00:00,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    25:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    25: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 25 training [time: 1.18s, train loss: 11.6951]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.69it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.69it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 27.32it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 25 evaluating [time: 0.12s, valid_score: 0.858700]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.873    recall@10 : 0.8848    mrr@5 : 0.8572    mrr@10 : 0.8587    ndcg@5 : 0.8611    ndcg@10 : 0.8649    hit@5 : 0.873    hit@10 : 0.8848    precision@5 : 0.1746    precision@10 : 0.0885

Train    26:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    26:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:   9%|██▍                        | 1/11 [00:00<00:01,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:   9%|██▍                        | 1/11 [00:00<00:01,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  18%|████▉                      | 2/11 [00:00<00:01,  6.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  18%|████▉                      | 2/11 [00:00<00:01,  6.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  27%|███████▎                   | 3/11 [00:00<00:01,  7.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  27%|███████▎                   | 3/11 [00:00<00:01,  7.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  45%|████████████▎              | 5/11 [00:00<00:00,  8.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  45%|████████████▎              | 5/11 [00:00<00:00,  8.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.58it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.86it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  73%|███████████████████▋       | 8/11 [00:01<00:00,  9.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    26:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    26: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.86it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 26 training [time: 1.24s, train loss: 10.8285]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 27.89it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 27.83it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 26 evaluating [time: 0.11s, valid_score: 0.859300]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8703    recall@10 : 0.8853    mrr@5 : 0.8574    mrr@10 : 0.8593    ndcg@5 : 0.8606    ndcg@10 : 0.8654    hit@5 : 0.8703    hit@10 : 0.8853    precision@5 : 0.1741    precision@10 : 0.0885
13 Oct 00:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    27:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    27:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:   9%|██▍                        | 1/11 [00:00<00:01,  8.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:   9%|██▍                        | 1/11 [00:00<00:01,  8.96it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  18%|████▉                      | 2/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  18%|████▉                      | 2/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  27%|███████▎                   | 3/11 [00:00<00:00,  9.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  27%|███████▎                   | 3/11 [00:00<00:00,  9.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  45%|████████████▎              | 5/11 [00:00<00:00,  9.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  45%|████████████▎              | 5/11 [00:00<00:00,  9.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    27:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    27: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 27 training [time: 1.18s, train loss: 11.4159]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 27.73it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 27.62it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 27 evaluating [time: 0.12s, valid_score: 0.858400]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8707    recall@10 : 0.8858    mrr@5 : 0.8565    mrr@10 : 0.8584    ndcg@5 : 0.8601    ndcg@10 : 0.8648    hit@5 : 0.8707    hit@10 : 0.8858    precision@5 : 0.1741    precision@10 : 0.0886

Train    28:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    28:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:   9%|██▍                        | 1/11 [00:00<00:01,  8.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:   9%|██▍                        | 1/11 [00:00<00:01,  8.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  18%|████▉                      | 2/11 [00:00<00:01,  8.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  18%|████▉                      | 2/11 [00:00<00:01,  8.66it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  27%|███████▎                   | 3/11 [00:00<00:00,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  27%|███████▎                   | 3/11 [00:00<00:00,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  45%|████████████▎              | 5/11 [00:00<00:00,  8.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  45%|████████████▎              | 5/11 [00:00<00:00,  8.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.65it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.87it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.87it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    28:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    28: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.05it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 28 training [time: 1.22s, train loss: 11.2418]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.20it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.14it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 28 evaluating [time: 0.11s, valid_score: 0.860900]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8716    recall@10 : 0.8844    mrr@5 : 0.8593    mrr@10 : 0.8609    ndcg@5 : 0.8624    ndcg@10 : 0.8664    hit@5 : 0.8716    hit@10 : 0.8844    precision@5 : 0.1743    precision@10 : 0.0884
13 Oct 00:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    29:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    29:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:   9%|██▍                        | 1/11 [00:00<00:01,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:   9%|██▍                        | 1/11 [00:00<00:01,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  18%|████▉                      | 2/11 [00:00<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  18%|████▉                      | 2/11 [00:00<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  27%|███████▎                   | 3/11 [00:00<00:00,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  27%|███████▎                   | 3/11 [00:00<00:00,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  45%|████████████▎              | 5/11 [00:00<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  45%|████████████▎              | 5/11 [00:00<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.10it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    29:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    29: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.40it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 29 training [time: 1.17s, train loss: 10.8592]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 30.27it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 29 evaluating [time: 0.10s, valid_score: 0.861500]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8694    recall@10 : 0.8835    mrr@5 : 0.8597    mrr@10 : 0.8615    ndcg@5 : 0.8622    ndcg@10 : 0.8667    hit@5 : 0.8694    hit@10 : 0.8835    precision@5 : 0.1739    precision@10 : 0.0883
13 Oct 00:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    30:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    30:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:   9%|██▍                        | 1/11 [00:00<00:01,  9.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:   9%|██▍                        | 1/11 [00:00<00:01,  9.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  18%|████▉                      | 2/11 [00:00<00:01,  6.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  18%|████▉                      | 2/11 [00:00<00:01,  6.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  27%|███████▎                   | 3/11 [00:00<00:01,  7.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  27%|███████▎                   | 3/11 [00:00<00:01,  7.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  45%|████████████▎              | 5/11 [00:00<00:00,  8.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  45%|████████████▎              | 5/11 [00:00<00:00,  8.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  73%|███████████████████▋       | 8/11 [00:01<00:00,  9.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    30:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    30: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.84it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 30 training [time: 1.25s, train loss: 11.4185]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.17it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 17.17it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 23.06it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 30 evaluating [time: 0.15s, valid_score: 0.862600]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8726    recall@10 : 0.8844    mrr@5 : 0.861    mrr@10 : 0.8626    ndcg@5 : 0.8639    ndcg@10 : 0.8678    hit@5 : 0.8726    hit@10 : 0.8844    precision@5 : 0.1745    precision@10 : 0.0884
13 Oct 00:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    31:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    31:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:   9%|██▍                        | 1/11 [00:00<00:01,  8.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:   9%|██▍                        | 1/11 [00:00<00:01,  8.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  18%|████▉                      | 2/11 [00:00<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  18%|████▉                      | 2/11 [00:00<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  27%|███████▎                   | 3/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  27%|███████▎                   | 3/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  45%|████████████▎              | 5/11 [00:00<00:00,  9.45it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  45%|████████████▎              | 5/11 [00:00<00:00,  9.45it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.57it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    31:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    31: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.45it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 31 training [time: 1.16s, train loss: 10.7554]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.93it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.88it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 31 evaluating [time: 0.11s, valid_score: 0.861000]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8707    recall@10 : 0.8844    mrr@5 : 0.8591    mrr@10 : 0.861    ndcg@5 : 0.862    ndcg@10 : 0.8665    hit@5 : 0.8707    hit@10 : 0.8844    precision@5 : 0.1741    precision@10 : 0.0884

Train    32:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    32:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:   9%|██▍                        | 1/11 [00:00<00:01,  9.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:   9%|██▍                        | 1/11 [00:00<00:01,  9.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  18%|████▉                      | 2/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  18%|████▉                      | 2/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  27%|███████▎                   | 3/11 [00:00<00:00,  9.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  27%|███████▎                   | 3/11 [00:00<00:00,  9.30it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  45%|████████████▎              | 5/11 [00:00<00:00,  9.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  45%|████████████▎              | 5/11 [00:00<00:00,  9.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.48it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    32:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    32: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.53it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 32 training [time: 1.15s, train loss: 11.0044]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.99it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.94it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 32 evaluating [time: 0.11s, valid_score: 0.861400]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8716    recall@10 : 0.8826    mrr@5 : 0.8599    mrr@10 : 0.8614    ndcg@5 : 0.8629    ndcg@10 : 0.8664    hit@5 : 0.8716    hit@10 : 0.8826    precision@5 : 0.1743    precision@10 : 0.0883

Train    33:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    33:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:   9%|██▍                        | 1/11 [00:00<00:01,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:   9%|██▍                        | 1/11 [00:00<00:01,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  18%|████▉                      | 2/11 [00:00<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  18%|████▉                      | 2/11 [00:00<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  27%|███████▎                   | 3/11 [00:00<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  27%|███████▎                   | 3/11 [00:00<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  45%|████████████▎              | 5/11 [00:00<00:00,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  45%|████████████▎              | 5/11 [00:00<00:00,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.98it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.15it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    33:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.18it/s, GPU RAM: 1.07 G/3.68 G]
Train    33: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 33 training [time: 1.19s, train loss: 10.4603]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.81it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 18.81it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 26.08it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 33 evaluating [time: 0.12s, valid_score: 0.860300]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8712    recall@10 : 0.883    mrr@5 : 0.8587    mrr@10 : 0.8603    ndcg@5 : 0.8619    ndcg@10 : 0.8657    hit@5 : 0.8712    hit@10 : 0.883    precision@5 : 0.1742    precision@10 : 0.0883

Train    34:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    34:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:   9%|██▍                        | 1/11 [00:00<00:01,  9.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:   9%|██▍                        | 1/11 [00:00<00:01,  9.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  18%|████▉                      | 2/11 [00:00<00:00,  9.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  18%|████▉                      | 2/11 [00:00<00:00,  9.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  27%|███████▎                   | 3/11 [00:00<00:01,  6.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  27%|███████▎                   | 3/11 [00:00<00:01,  6.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  36%|█████████▊                 | 4/11 [00:00<00:00,  7.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  36%|█████████▊                 | 4/11 [00:00<00:00,  7.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  45%|████████████▎              | 5/11 [00:00<00:00,  7.87it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  45%|████████████▎              | 5/11 [00:00<00:00,  7.87it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.62it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.82it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    34:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    34: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.48it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 34 training [time: 1.30s, train loss: 10.4678]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 16.78it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 16.78it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 23.65it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 34 evaluating [time: 0.13s, valid_score: 0.861600]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8726    recall@10 : 0.8821    mrr@5 : 0.8604    mrr@10 : 0.8616    ndcg@5 : 0.8634    ndcg@10 : 0.8665    hit@5 : 0.8726    hit@10 : 0.8821    precision@5 : 0.1745    precision@10 : 0.0882

Train    35:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    35:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:   9%|██▍                        | 1/11 [00:00<00:01,  9.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:   9%|██▍                        | 1/11 [00:00<00:01,  9.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  18%|████▉                      | 2/11 [00:00<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  18%|████▉                      | 2/11 [00:00<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  27%|███████▎                   | 3/11 [00:00<00:00,  9.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  27%|███████▎                   | 3/11 [00:00<00:00,  9.60it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.54it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  45%|████████████▎              | 5/11 [00:00<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  45%|████████████▎              | 5/11 [00:00<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.45it/s, GPU RAM: 1.07 G/3.68 G]
Train    35:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.45it/s, GPU RAM: 1.07 G/3.68 G]
Train    35: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.56it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 35 training [time: 1.15s, train loss: 10.2702]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.79it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.74it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 35 evaluating [time: 0.11s, valid_score: 0.861700]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8721    recall@10 : 0.8835    mrr@5 : 0.8603    mrr@10 : 0.8617    ndcg@5 : 0.8633    ndcg@10 : 0.8669    hit@5 : 0.8721    hit@10 : 0.8835    precision@5 : 0.1744    precision@10 : 0.0883

Train    36:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    36:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:   9%|██▍                        | 1/11 [00:00<00:01,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:   9%|██▍                        | 1/11 [00:00<00:01,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  18%|████▉                      | 2/11 [00:00<00:00,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  18%|████▉                      | 2/11 [00:00<00:00,  9.47it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  27%|███████▎                   | 3/11 [00:00<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  27%|███████▎                   | 3/11 [00:00<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  45%|████████████▎              | 5/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  45%|████████████▎              | 5/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.03it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    36:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    36: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.53it/s, GPU RAM: 1.07 G/3.68 G]
Train    36: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 36 training [time: 1.18s, train loss: 9.4555]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.87it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.87it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 27.44it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 36 evaluating [time: 0.12s, valid_score: 0.860800]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8744    recall@10 : 0.8844    mrr@5 : 0.8595    mrr@10 : 0.8608    ndcg@5 : 0.8632    ndcg@10 : 0.8664    hit@5 : 0.8744    hit@10 : 0.8844    precision@5 : 0.1749    precision@10 : 0.0884

Train    37:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    37:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:   9%|██▍                        | 1/11 [00:00<00:01,  8.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:   9%|██▍                        | 1/11 [00:00<00:01,  8.85it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  18%|████▉                      | 2/11 [00:00<00:01,  8.99it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  18%|████▉                      | 2/11 [00:00<00:01,  8.99it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  27%|███████▎                   | 3/11 [00:00<00:00,  8.87it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  27%|███████▎                   | 3/11 [00:00<00:00,  8.87it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  36%|█████████▊                 | 4/11 [00:00<00:00,  8.89it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  45%|████████████▎              | 5/11 [00:00<00:00,  6.84it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  45%|████████████▎              | 5/11 [00:00<00:00,  6.84it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  55%|██████████████▋            | 6/11 [00:00<00:00,  7.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  55%|██████████████▋            | 6/11 [00:00<00:00,  7.49it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    37:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.72it/s, GPU RAM: 1.07 G/3.68 G]
Train    37: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.46it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 37 training [time: 1.30s, train loss: 10.4089]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.68it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.68it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 27.21it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 37 evaluating [time: 0.12s, valid_score: 0.861800]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8721    recall@10 : 0.8817    mrr@5 : 0.8606    mrr@10 : 0.8618    ndcg@5 : 0.8635    ndcg@10 : 0.8666    hit@5 : 0.8721    hit@10 : 0.8817    precision@5 : 0.1744    precision@10 : 0.0882

Train    38:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    38:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:   9%|██▍                        | 1/11 [00:00<00:01,  8.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:   9%|██▍                        | 1/11 [00:00<00:01,  8.80it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  18%|████▉                      | 2/11 [00:00<00:00,  9.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  18%|████▉                      | 2/11 [00:00<00:00,  9.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  27%|███████▎                   | 3/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  27%|███████▎                   | 3/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  45%|████████████▎              | 5/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  45%|████████████▎              | 5/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.16it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.23it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    38:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    38: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 38 training [time: 1.18s, train loss: 8.9151]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.31it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.31it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 26.52it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 38 evaluating [time: 0.13s, valid_score: 0.862000]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.873    recall@10 : 0.8835    mrr@5 : 0.8607    mrr@10 : 0.862    ndcg@5 : 0.8638    ndcg@10 : 0.8671    hit@5 : 0.873    hit@10 : 0.8835    precision@5 : 0.1746    precision@10 : 0.0883

Train    39:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    39:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:   9%|██▍                        | 1/11 [00:00<00:01,  9.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:   9%|██▍                        | 1/11 [00:00<00:01,  9.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  18%|████▉                      | 2/11 [00:00<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  18%|████▉                      | 2/11 [00:00<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  27%|███████▎                   | 3/11 [00:00<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  27%|███████▎                   | 3/11 [00:00<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  45%|████████████▎              | 5/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  45%|████████████▎              | 5/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.31it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    39:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.40it/s, GPU RAM: 1.07 G/3.68 G]
Train    39: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.52it/s, GPU RAM: 1.07 G/3.68 G]
Train    39: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 39 training [time: 1.17s, train loss: 9.8798]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.52it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 29.40it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 39 evaluating [time: 0.12s, valid_score: 0.863300]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8739    recall@10 : 0.8853    mrr@5 : 0.8618    mrr@10 : 0.8633    ndcg@5 : 0.8649    ndcg@10 : 0.8685    hit@5 : 0.8739    hit@10 : 0.8853    precision@5 : 0.1748    precision@10 : 0.0885
13 Oct 00:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    40:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    40:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:   9%|██▍                        | 1/11 [00:00<00:01,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:   9%|██▍                        | 1/11 [00:00<00:01,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  18%|████▉                      | 2/11 [00:00<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  18%|████▉                      | 2/11 [00:00<00:00,  9.29it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  27%|███████▎                   | 3/11 [00:00<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  27%|███████▎                   | 3/11 [00:00<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.25it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  45%|████████████▎              | 5/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  45%|████████████▎              | 5/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    40:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    40: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.42it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 40 training [time: 1.17s, train loss: 9.0877]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.80it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.75it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 40 evaluating [time: 0.11s, valid_score: 0.862900]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8735    recall@10 : 0.8835    mrr@5 : 0.8616    mrr@10 : 0.8629    ndcg@5 : 0.8646    ndcg@10 : 0.8678    hit@5 : 0.8735    hit@10 : 0.8835    precision@5 : 0.1747    precision@10 : 0.0883

Train    41:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    41:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:   9%|██▍                        | 1/11 [00:00<00:01,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:   9%|██▍                        | 1/11 [00:00<00:01,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  18%|████▉                      | 2/11 [00:00<00:00,  9.52it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  18%|████▉                      | 2/11 [00:00<00:00,  9.52it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  27%|███████▎                   | 3/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  27%|███████▎                   | 3/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  45%|████████████▎              | 5/11 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  45%|████████████▎              | 5/11 [00:00<00:00,  9.27it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    41:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    41: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.41it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 41 training [time: 1.17s, train loss: 9.9823]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.19it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.19it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 26.61it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 41 evaluating [time: 0.12s, valid_score: 0.862100]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8748    recall@10 : 0.8862    mrr@5 : 0.8606    mrr@10 : 0.8621    ndcg@5 : 0.8642    ndcg@10 : 0.8678    hit@5 : 0.8748    hit@10 : 0.8862    precision@5 : 0.175    precision@10 : 0.0886

Train    42:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    42:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:   9%|██▍                        | 1/11 [00:00<00:01,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:   9%|██▍                        | 1/11 [00:00<00:01,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  18%|████▉                      | 2/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  18%|████▉                      | 2/11 [00:00<00:00,  9.39it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  27%|███████▎                   | 3/11 [00:00<00:01,  6.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  27%|███████▎                   | 3/11 [00:00<00:01,  6.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  36%|█████████▊                 | 4/11 [00:00<00:00,  7.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  36%|█████████▊                 | 4/11 [00:00<00:00,  7.59it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  45%|████████████▎              | 5/11 [00:00<00:00,  8.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  45%|████████████▎              | 5/11 [00:00<00:00,  8.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.32it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.55it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.75it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.94it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.94it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    42:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    42: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.69it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 42 training [time: 1.27s, train loss: 10.6250]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.62it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :  67%|██████████████████▋         | 2/3 [00:00<00:00, 19.62it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 26.61it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 42 evaluating [time: 0.13s, valid_score: 0.861600]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8726    recall@10 : 0.8848    mrr@5 : 0.86    mrr@10 : 0.8616    ndcg@5 : 0.8632    ndcg@10 : 0.8671    hit@5 : 0.8726    hit@10 : 0.8848    precision@5 : 0.1745    precision@10 : 0.0885

Train    43:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    43:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:   9%|██▍                        | 1/11 [00:00<00:01,  7.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:   9%|██▍                        | 1/11 [00:00<00:01,  7.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  18%|████▉                      | 2/11 [00:00<00:01,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  18%|████▉                      | 2/11 [00:00<00:01,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  27%|███████▎                   | 3/11 [00:00<00:00,  9.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  27%|███████▎                   | 3/11 [00:00<00:00,  9.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  45%|████████████▎              | 5/11 [00:00<00:00,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  45%|████████████▎              | 5/11 [00:00<00:00,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    43:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.20it/s, GPU RAM: 1.07 G/3.68 G]
Train    43: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.18it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 43 training [time: 1.20s, train loss: 9.6977]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.45it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.37it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 43 evaluating [time: 0.11s, valid_score: 0.863400]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8762    recall@10 : 0.8885    mrr@5 : 0.8618    mrr@10 : 0.8634    ndcg@5 : 0.8654    ndcg@10 : 0.8693    hit@5 : 0.8762    hit@10 : 0.8885    precision@5 : 0.1752    precision@10 : 0.0888
13 Oct 00:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    44:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    44:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:   9%|██▍                        | 1/11 [00:00<00:01,  9.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:   9%|██▍                        | 1/11 [00:00<00:01,  9.37it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  18%|████▉                      | 2/11 [00:00<00:00,  9.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  18%|████▉                      | 2/11 [00:00<00:00,  9.43it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  27%|███████▎                   | 3/11 [00:00<00:00,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  27%|███████▎                   | 3/11 [00:00<00:00,  9.44it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  45%|████████████▎              | 5/11 [00:00<00:00,  9.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  45%|████████████▎              | 5/11 [00:00<00:00,  9.01it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.95it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.90it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.00it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    44:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    44: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.25it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 44 training [time: 1.19s, train loss: 9.5031]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 27.63it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 27.56it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 44 evaluating [time: 0.12s, valid_score: 0.863200]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8735    recall@10 : 0.8867    mrr@5 : 0.8615    mrr@10 : 0.8632    ndcg@5 : 0.8645    ndcg@10 : 0.8687    hit@5 : 0.8735    hit@10 : 0.8867    precision@5 : 0.1747    precision@10 : 0.0887

Train    45:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    45:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:   9%|██▍                        | 1/11 [00:00<00:01,  8.88it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:   9%|██▍                        | 1/11 [00:00<00:01,  8.88it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  18%|████▉                      | 2/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  18%|████▉                      | 2/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  27%|███████▎                   | 3/11 [00:00<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  27%|███████▎                   | 3/11 [00:00<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  45%|████████████▎              | 5/11 [00:00<00:00,  9.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  45%|████████████▎              | 5/11 [00:00<00:00,  9.19it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.06it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.11it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    45:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    45: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.24it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 45 training [time: 1.19s, train loss: 9.5999]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.85it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.79it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 45 evaluating [time: 0.11s, valid_score: 0.862000]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8712    recall@10 : 0.8867    mrr@5 : 0.8601    mrr@10 : 0.862    ndcg@5 : 0.8629    ndcg@10 : 0.8677    hit@5 : 0.8712    hit@10 : 0.8867    precision@5 : 0.1742    precision@10 : 0.0887

Train    46:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    46:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:   9%|██▍                        | 1/11 [00:00<00:01,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:   9%|██▍                        | 1/11 [00:00<00:01,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  18%|████▉                      | 2/11 [00:00<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  18%|████▉                      | 2/11 [00:00<00:00,  9.36it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  27%|███████▎                   | 3/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  27%|███████▎                   | 3/11 [00:00<00:00,  9.34it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.33it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  45%|████████████▎              | 5/11 [00:00<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  45%|████████████▎              | 5/11 [00:00<00:00,  9.35it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.38it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  64%|█████████████████▏         | 7/11 [00:00<00:00,  7.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  64%|█████████████████▏         | 7/11 [00:00<00:00,  7.51it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.50it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.50it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    46:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.77it/s, GPU RAM: 1.07 G/3.68 G]
Train    46: 100%|██████████████████████████| 11/11 [00:01<00:00,  8.90it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 46 training [time: 1.24s, train loss: 9.5494]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 27.75it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 27.68it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 46 evaluating [time: 0.12s, valid_score: 0.862700]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8735    recall@10 : 0.8862    mrr@5 : 0.8609    mrr@10 : 0.8627    ndcg@5 : 0.8641    ndcg@10 : 0.8683    hit@5 : 0.8735    hit@10 : 0.8862    precision@5 : 0.1747    precision@10 : 0.0886

Train    47:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    47:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:   9%|██▍                        | 1/11 [00:00<00:01,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:   9%|██▍                        | 1/11 [00:00<00:01,  9.04it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  18%|████▉                      | 2/11 [00:00<00:00,  9.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  18%|████▉                      | 2/11 [00:00<00:00,  9.02it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  27%|███████▎                   | 3/11 [00:00<00:00,  9.12it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  27%|███████▎                   | 3/11 [00:00<00:00,  9.12it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.21it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  45%|████████████▎              | 5/11 [00:00<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  45%|████████████▎              | 5/11 [00:00<00:00,  9.13it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  55%|██████████████▋            | 6/11 [00:00<00:00,  8.79it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  64%|█████████████████▏         | 7/11 [00:00<00:00,  8.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  73%|███████████████████▋       | 8/11 [00:00<00:00,  8.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  73%|███████████████████▋       | 8/11 [00:01<00:00,  8.78it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.81it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.88it/s, GPU RAM: 1.07 G/3.68 G]
Train    47:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.88it/s, GPU RAM: 1.07 G/3.68 G]
Train    47: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.05it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 47 training [time: 1.22s, train loss: 9.6177]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.57it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.51it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 47 evaluating [time: 0.11s, valid_score: 0.862700]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8739    recall@10 : 0.8867    mrr@5 : 0.8609    mrr@10 : 0.8627    ndcg@5 : 0.8642    ndcg@10 : 0.8684    hit@5 : 0.8739    hit@10 : 0.8867    precision@5 : 0.1748    precision@10 : 0.0887

Train    48:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    48:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:   9%|██▍                        | 1/11 [00:00<00:01,  8.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:   9%|██▍                        | 1/11 [00:00<00:01,  8.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  18%|████▉                      | 2/11 [00:00<00:01,  8.92it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  18%|████▉                      | 2/11 [00:00<00:01,  8.92it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  27%|███████▎                   | 3/11 [00:00<00:00,  9.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  27%|███████▎                   | 3/11 [00:00<00:00,  9.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.08it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  45%|████████████▎              | 5/11 [00:00<00:00,  9.12it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  45%|████████████▎              | 5/11 [00:00<00:00,  9.12it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.22it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  73%|███████████████████▋       | 8/11 [00:01<00:00,  9.09it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  82%|██████████████████████     | 9/11 [00:01<00:00,  8.73it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    48:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  8.83it/s, GPU RAM: 1.07 G/3.68 G]
Train    48: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.09it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 48 training [time: 1.21s, train loss: 10.2798]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.41it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 28.32it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 48 evaluating [time: 0.11s, valid_score: 0.864800]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8776    recall@10 : 0.8867    mrr@5 : 0.8635    mrr@10 : 0.8648    ndcg@5 : 0.867    ndcg@10 : 0.87    hit@5 : 0.8776    hit@10 : 0.8867    precision@5 : 0.1755    precision@10 : 0.0887
13 Oct 00:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Train    49:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    49:   0%|                                   | 0/11 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:   9%|██▍                        | 1/11 [00:00<00:01,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:   9%|██▍                        | 1/11 [00:00<00:01,  9.17it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  18%|████▉                      | 2/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  18%|████▉                      | 2/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  27%|███████▎                   | 3/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  27%|███████▎                   | 3/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  36%|█████████▊                 | 4/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  45%|████████████▎              | 5/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  45%|████████████▎              | 5/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  55%|██████████████▋            | 6/11 [00:00<00:00,  9.26it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  64%|█████████████████▏         | 7/11 [00:00<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  73%|███████████████████▋       | 8/11 [00:00<00:00,  9.24it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  82%|██████████████████████     | 9/11 [00:00<00:00,  9.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  82%|██████████████████████     | 9/11 [00:01<00:00,  9.14it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    49:  91%|███████████████████████▋  | 10/11 [00:01<00:00,  9.07it/s, GPU RAM: 1.07 G/3.68 G]
Train    49: 100%|██████████████████████████| 11/11 [00:01<00:00,  9.28it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 49 training [time: 1.19s, train loss: 10.4258]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 27.69it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 27.64it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  epoch 49 evaluating [time: 0.11s, valid_score: 0.866300]
13 Oct 00:22    INFO  valid result: 
recall@5 : 0.8771    recall@10 : 0.8876    mrr@5 : 0.865    mrr@10 : 0.8663    ndcg@5 : 0.868    ndcg@10 : 0.8713    hit@5 : 0.8771    hit@10 : 0.8876    precision@5 : 0.1754    precision@10 : 0.0888
13 Oct 00:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_00-21-35.pth
13 Oct 00:22    INFO  Loading model structure and parameters from saved/BERT4Rec-Oct-13-2025_00-21-35.pth

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   :   0%|                                    | 0/3 [00:00<?, ?it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 25.63it/s, GPU RAM: 1.07 G/3.68 G]
Evaluate   : 100%|████████████████████████████| 3/3 [00:00<00:00, 25.58it/s, GPU RAM: 1.07 G/3.68 G]
13 Oct 00:22    INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |     2.30 %     |
+-------------+----------------+
| GPU         | 1.07 G/3.68 G  |
+-------------+----------------+
| Memory      | 1.22 G/15.33 G |
+-------------+----------------+
13 Oct 00:22    INFO  best valid : OrderedDict({'recall@5': 0.8771, 'recall@10': 0.8876, 'mrr@5': 0.865, 'mrr@10': 0.8663, 'ndcg@5': 0.868, 'ndcg@10': 0.8713, 'hit@5': 0.8771, 'hit@10': 0.8876, 'precision@5': 0.1754, 'precision@10': 0.0888})
13 Oct 00:22    INFO  test result: OrderedDict({'recall@5': 0.9838, 'recall@10': 0.9878, 'mrr@5': 0.9665, 'mrr@10': 0.967, 'ndcg@5': 0.9709, 'ndcg@10': 0.9722, 'hit@5': 0.9838, 'hit@10': 0.9878, 'precision@5': 0.1968, 'precision@10': 0.0988})

2025-10-13 00:22:46,829 | INFO | Copied checkpoint /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/saved/BERT4Rec-Oct-13-2025_00-21-35.pth -> /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/BERT4Rec-Oct-13-2025_00-21-35.pth
2025-10-13 00:22:46,830 | INFO | Retraining completed in 0:01:22.969744. Latest checkpoint: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/BERT4Rec-Oct-13-2025_00-21-35.pth
2025-10-13 00:22:46,830 | INFO | === Retraining pipeline finished ===
2025-10-13 01:37:26,904 | INFO | Starting scheduler mode (interval=300s, keep=6)
2025-10-13 01:37:26,908 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 01:37:28,283 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 3
Số user: 1
Số sản phẩm: 2
Các loại event: {'add_to_cart': 0.667, 'view': 0.333}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[3 rows x 5 columns]
2025-10-13 01:37:28,283 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 01:37:28,992 | INFO | ✅ Đã tạo snapshot 20251012-183728 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-183728/ecommerce.inter) với 3 dòng
👥  User: 1 | 🛒  Sản phẩm: 2
🏷️   Nhãn mua hàng (label=1): 0
   user_id  item_id   timestamp  label
0     4001        7  1760289978      0
1     4001        7  1760290034      0
2     4001        9  1760290038      0
2025-10-13 01:37:28,992 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 01:37:39,054 | INFO | 13 Oct 01:37    INFO  ['train_bert4rec.py']
13 Oct 01:37    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 01:37    INFO  ecommerce
The number of users: 2
Average actions of users: 3.0
The number of items: 3
Average actions of items: 1.5
The number of inters: 3
The sparsity of the dataset: 50.0%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 01:37    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 01:37    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 01:37    INFO  BERT4Rec(
  (item_embedding): Embedding(4, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 107843
13 Oct 01:37    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 148, in run_recbole
    best_valid_score, best_valid_result = trainer.fit(
                                          ^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 439, in fit
    train_loss = self._train_epoch(
                 ^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 260, in _train_epoch
    self._check_nan(loss)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 346, in _check_nan
    raise ValueError("Training loss is nan")
ValueError: Training loss is nan
2025-10-13 01:37:39,056 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 305, in run_once
    result = execute_pipeline(keep_versions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 276, in execute_pipeline
    run_step([sys.executable, "train_bert4rec.py"], TRAINING_DIR)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 196, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 01:37:39,056 | WARNING | Scheduled run exited with code 1
2025-10-13 01:38:13,392 | INFO | Starting single retraining run (timeout=0)
2025-10-13 01:38:13,392 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 01:38:13,884 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 3
Số user: 1
Số sản phẩm: 2
Các loại event: {'add_to_cart': 0.667, 'view': 0.333}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[3 rows x 5 columns]
2025-10-13 01:38:13,884 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 01:38:14,189 | INFO | ✅ Đã tạo snapshot 20251012-183814 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-183814/ecommerce.inter) với 3 dòng
👥  User: 1 | 🛒  Sản phẩm: 2
🏷️   Nhãn mua hàng (label=1): 0
   user_id  item_id   timestamp  label
0     4001        7  1760289978      0
1     4001        7  1760290034      0
2     4001        9  1760290038      0
2025-10-13 01:38:14,190 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 01:38:17,931 | INFO | 13 Oct 01:38    INFO  ['train_bert4rec.py']
13 Oct 01:38    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 01:38    INFO  ecommerce
The number of users: 2
Average actions of users: 3.0
The number of items: 3
Average actions of items: 1.5
The number of inters: 3
The sparsity of the dataset: 50.0%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 01:38    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 01:38    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 01:38    INFO  BERT4Rec(
  (item_embedding): Embedding(4, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 107843
13 Oct 01:38    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 148, in run_recbole
    best_valid_score, best_valid_result = trainer.fit(
                                          ^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 439, in fit
    train_loss = self._train_epoch(
                 ^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 260, in _train_epoch
    self._check_nan(loss)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 346, in _check_nan
    raise ValueError("Training loss is nan")
ValueError: Training loss is nan
2025-10-13 01:38:17,934 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 305, in run_once
    result = execute_pipeline(keep_versions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 276, in execute_pipeline
    run_step([sys.executable, "train_bert4rec.py"], TRAINING_DIR)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 196, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 01:43:45,346 | INFO | Starting scheduler mode (interval=120s, keep=6)
2025-10-13 01:43:45,348 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 01:43:46,474 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 3
Số user: 1
Số sản phẩm: 2
Các loại event: {'add_to_cart': 0.667, 'view': 0.333}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[3 rows x 5 columns]
2025-10-13 01:43:46,475 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 01:43:46,981 | INFO | ✅ Đã tạo snapshot 20251012-184346 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-184346/ecommerce.inter) với 3 dòng
👥  User: 1 | 🛒  Sản phẩm: 2
🏷️   Nhãn mua hàng (label=1): 0
   user_id  item_id   timestamp  label
0     4001        7  1760289978      0
1     4001        7  1760290034      0
2     4001        9  1760290038      0
2025-10-13 01:43:46,982 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 01:43:56,234 | INFO | 13 Oct 01:43    INFO  ['train_bert4rec.py']
13 Oct 01:43    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 01:43    INFO  ecommerce
The number of users: 2
Average actions of users: 3.0
The number of items: 3
Average actions of items: 1.5
The number of inters: 3
The sparsity of the dataset: 50.0%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 01:43    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 01:43    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 01:43    INFO  BERT4Rec(
  (item_embedding): Embedding(4, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 107843
13 Oct 01:43    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 148, in run_recbole
    best_valid_score, best_valid_result = trainer.fit(
                                          ^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 439, in fit
    train_loss = self._train_epoch(
                 ^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 260, in _train_epoch
    self._check_nan(loss)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 346, in _check_nan
    raise ValueError("Training loss is nan")
ValueError: Training loss is nan
2025-10-13 01:43:56,236 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 305, in run_once
    result = execute_pipeline(keep_versions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 276, in execute_pipeline
    run_step([sys.executable, "train_bert4rec.py"], TRAINING_DIR)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 196, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 01:43:56,236 | WARNING | Scheduled run exited with code 1
2025-10-13 01:58:58,675 | INFO | Starting scheduler mode (interval=120s, keep=6)
2025-10-13 01:58:58,677 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 01:58:59,525 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 3
Số user: 1
Số sản phẩm: 2
Các loại event: {'add_to_cart': 0.667, 'view': 0.333}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[3 rows x 5 columns]
2025-10-13 01:58:59,528 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 01:59:00,387 | INFO | ✅ Đã tạo snapshot 20251012-185900 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-185900/ecommerce.inter) với 3 dòng
👥  User: 1 | 🛒  Sản phẩm: 2
🏷️   Nhãn mua hàng (label=1): 0
       user_id  item_id   timestamp  label
18233     4001        7  1760289978      0
18234     4001        7  1760290034      0
18235     4001        9  1760290038      0
2025-10-13 01:59:00,388 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 01:59:10,025 | INFO | 13 Oct 01:59    INFO  ['train_bert4rec.py']
13 Oct 01:59    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 01:59    INFO  ecommerce
The number of users: 2
Average actions of users: 3.0
The number of items: 3
Average actions of items: 1.5
The number of inters: 3
The sparsity of the dataset: 50.0%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 01:59    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 01:59    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 01:59    INFO  BERT4Rec(
  (item_embedding): Embedding(4, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 107843
13 Oct 01:59    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 148, in run_recbole
    best_valid_score, best_valid_result = trainer.fit(
                                          ^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 439, in fit
    train_loss = self._train_epoch(
                 ^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 260, in _train_epoch
    self._check_nan(loss)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 346, in _check_nan
    raise ValueError("Training loss is nan")
ValueError: Training loss is nan
2025-10-13 01:59:10,028 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 305, in run_once
    result = execute_pipeline(keep_versions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 276, in execute_pipeline
    run_step([sys.executable, "train_bert4rec.py"], TRAINING_DIR)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 196, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 01:59:10,028 | WARNING | Scheduled run exited with code 1
2025-10-13 02:01:10,032 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:01:10,555 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 3
Số user: 1
Số sản phẩm: 2
Các loại event: {'add_to_cart': 0.667, 'view': 0.333}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[3 rows x 5 columns]
2025-10-13 02:01:10,555 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:01:10,887 | INFO | ✅ Đã tạo snapshot 20251012-190110 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-190110/ecommerce.inter) với 3 dòng
👥  User: 1 | 🛒  Sản phẩm: 2
🏷️   Nhãn mua hàng (label=1): 0
       user_id  item_id   timestamp  label
18233     4001        7  1760289978      0
18234     4001        7  1760290034      0
18235     4001        9  1760290038      0
2025-10-13 02:01:10,887 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 02:01:14,850 | INFO | 13 Oct 02:01    INFO  ['train_bert4rec.py']
13 Oct 02:01    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 02:01    INFO  ecommerce
The number of users: 2
Average actions of users: 3.0
The number of items: 3
Average actions of items: 1.5
The number of inters: 3
The sparsity of the dataset: 50.0%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 02:01    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 02:01    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 02:01    INFO  BERT4Rec(
  (item_embedding): Embedding(4, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 107843
13 Oct 02:01    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 148, in run_recbole
    best_valid_score, best_valid_result = trainer.fit(
                                          ^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 439, in fit
    train_loss = self._train_epoch(
                 ^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 260, in _train_epoch
    self._check_nan(loss)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 346, in _check_nan
    raise ValueError("Training loss is nan")
ValueError: Training loss is nan
2025-10-13 02:01:14,852 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 305, in run_once
    result = execute_pipeline(keep_versions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 276, in execute_pipeline
    run_step([sys.executable, "train_bert4rec.py"], TRAINING_DIR)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 196, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 02:01:14,852 | WARNING | Scheduled run exited with code 1
2025-10-13 02:03:05,327 | INFO | Starting scheduler mode (interval=120s, keep=6)
2025-10-13 02:03:05,329 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:03:06,095 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 3
Số user: 1
Số sản phẩm: 2
Các loại event: {'add_to_cart': 0.667, 'view': 0.333}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[3 rows x 5 columns]
2025-10-13 02:03:06,095 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:03:06,928 | INFO | ✅ Đã tạo snapshot 20251012-190306 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-190306/ecommerce.inter) với 3 dòng
👥  User: 1 | 🛒  Sản phẩm: 2
🏷️   Nhãn mua hàng (label=1): 0
       user_id  item_id   timestamp  label
18233     4001        7  1760289978      0
18234     4001        7  1760290034      0
18235     4001        9  1760290038      0
2025-10-13 02:03:06,929 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-183728
2025-10-13 02:03:06,930 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 02:03:13,898 | INFO | 13 Oct 02:03    INFO  ['train_bert4rec.py']
13 Oct 02:03    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 02:03    INFO  ecommerce
The number of users: 2
Average actions of users: 3.0
The number of items: 3
Average actions of items: 1.5
The number of inters: 3
The sparsity of the dataset: 50.0%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 02:03    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 02:03    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 02:03    INFO  BERT4Rec(
  (item_embedding): Embedding(4, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 107843
13 Oct 02:03    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 148, in run_recbole
    best_valid_score, best_valid_result = trainer.fit(
                                          ^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 439, in fit
    train_loss = self._train_epoch(
                 ^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 260, in _train_epoch
    self._check_nan(loss)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 346, in _check_nan
    raise ValueError("Training loss is nan")
ValueError: Training loss is nan
2025-10-13 02:03:13,899 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 305, in run_once
    result = execute_pipeline(keep_versions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 276, in execute_pipeline
    run_step([sys.executable, "train_bert4rec.py"], TRAINING_DIR)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 196, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 02:03:13,899 | WARNING | Scheduled run exited with code 1
2025-10-13 02:05:13,900 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:05:14,269 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 6
Số user: 1
Số sản phẩm: 4
Các loại event: {'add_to_cart': 0.5, 'view': 0.333, 'purchase': 0.167}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...     purchase

[6 rows x 5 columns]
2025-10-13 02:05:14,269 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:05:14,614 | INFO | ✅ Đã tạo snapshot 20251012-190514 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-190514/ecommerce.inter) với 9 dòng
👥  User: 1 | 🛒  Sản phẩm: 6
🏷️   Nhãn mua hàng (label=1): 1
       user_id                   item_id   timestamp  label
0         4001                         7  1760289978      0
18236     4001                         7  1760289978      0
1         4001                         7  1760290034      0
18237     4001                         7  1760290034      0
2         4001                         9  1760290038      0
18238     4001                         9  1760290038      0
3         4001                         1  1760295899      0
4         4001                         1  1760295900      0
5         4001  68e4be7232d9fbfbe50b96d9  1760295906      1
2025-10-13 02:05:14,615 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-183814
2025-10-13 02:05:14,615 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 02:05:19,192 | INFO | 13 Oct 02:05    INFO  ['train_bert4rec.py']
13 Oct 02:05    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 02:05    INFO  ecommerce
The number of users: 2
Average actions of users: 9.0
The number of items: 5
Average actions of items: 2.25
The number of inters: 9
The sparsity of the dataset: 9.999999999999998%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 02:05    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 02:05    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 02:05    INFO  BERT4Rec(
  (item_embedding): Embedding(6, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 107973
13 Oct 02:05    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  6.00it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  5.99it/s, GPU RAM: 0.03 G/3.68 G]
13 Oct 02:05    INFO  epoch 0 training [time: 0.17s, train loss: 1.5582]

Evaluate   :   0%|                                                            | 0/1 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 148, in run_recbole
    best_valid_score, best_valid_result = trainer.fit(
                                          ^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 464, in fit
    valid_score, valid_result = self._valid_epoch(
                                ^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 283, in _valid_epoch
    valid_result = self.evaluate(
                   ^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 621, in evaluate
    self.eval_collector.eval_batch_collect(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/evaluator/collector.py", line 159, in eval_batch_collect
    _, topk_idx = torch.topk(
                  ^^^^^^^^^^^
RuntimeError: selected index k out of range
2025-10-13 02:05:19,199 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 305, in run_once
    result = execute_pipeline(keep_versions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 276, in execute_pipeline
    run_step([sys.executable, "train_bert4rec.py"], TRAINING_DIR)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 196, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 02:05:19,199 | WARNING | Scheduled run exited with code 1
2025-10-13 02:07:19,203 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:07:19,563 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 10
Số user: 1
Số sản phẩm: 5
Các loại event: {'add_to_cart': 0.6, 'view': 0.3, 'purchase': 0.1}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...     purchase

[10 rows x 5 columns]
2025-10-13 02:07:19,563 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:07:19,900 | INFO | ✅ Đã tạo snapshot 20251012-190719 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-190719/ecommerce.inter) với 13 dòng
👥  User: 1 | 🛒  Sản phẩm: 7
🏷️   Nhãn mua hàng (label=1): 1
       user_id item_id   timestamp  label
0         4001       7  1760289978      0
18240     4001       7  1760289978      0
1         4001       7  1760290034      0
18241     4001       7  1760290034      0
2         4001       9  1760290038      0
18242     4001       9  1760290038      0
3         4001       1  1760295899      0
4         4001       1  1760295900      0
5         4001      17  1760295946      0
6         4001      17  1760295948      0
2025-10-13 02:07:19,900 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-184346
2025-10-13 02:07:19,900 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 02:07:23,765 | INFO | 13 Oct 02:07    INFO  ['train_bert4rec.py']
13 Oct 02:07    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 02:07    INFO  ecommerce
The number of users: 2
Average actions of users: 13.0
The number of items: 6
Average actions of items: 2.6
The number of inters: 13
The sparsity of the dataset: -8.333333333333325%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 02:07    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 02:07    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 02:07    INFO  BERT4Rec(
  (item_embedding): Embedding(7, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 108038
13 Oct 02:07    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  9.63it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  9.62it/s, GPU RAM: 0.03 G/3.68 G]
13 Oct 02:07    INFO  epoch 0 training [time: 0.10s, train loss: 1.7771]

Evaluate   :   0%|                                                            | 0/1 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 148, in run_recbole
    best_valid_score, best_valid_result = trainer.fit(
                                          ^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 464, in fit
    valid_score, valid_result = self._valid_epoch(
                                ^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 283, in _valid_epoch
    valid_result = self.evaluate(
                   ^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 621, in evaluate
    self.eval_collector.eval_batch_collect(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/evaluator/collector.py", line 159, in eval_batch_collect
    _, topk_idx = torch.topk(
                  ^^^^^^^^^^^
RuntimeError: selected index k out of range
2025-10-13 02:07:23,768 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 305, in run_once
    result = execute_pipeline(keep_versions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 276, in execute_pipeline
    run_step([sys.executable, "train_bert4rec.py"], TRAINING_DIR)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 196, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 02:07:23,769 | WARNING | Scheduled run exited with code 1
2025-10-13 02:09:23,772 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:09:24,200 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 10
Số user: 1
Số sản phẩm: 5
Các loại event: {'add_to_cart': 0.6, 'view': 0.3, 'purchase': 0.1}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...     purchase

[10 rows x 5 columns]
2025-10-13 02:09:24,200 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:09:24,629 | INFO | ✅ Đã tạo snapshot 20251012-190924 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-190924/ecommerce.inter) với 13 dòng
👥  User: 1 | 🛒  Sản phẩm: 7
🏷️   Nhãn mua hàng (label=1): 1
       user_id item_id   timestamp  label
0         4001       7  1760289978      0
18240     4001       7  1760289978      0
1         4001       7  1760290034      0
18241     4001       7  1760290034      0
2         4001       9  1760290038      0
18242     4001       9  1760290038      0
3         4001       1  1760295899      0
4         4001       1  1760295900      0
5         4001      17  1760295946      0
6         4001      17  1760295948      0
2025-10-13 02:09:24,630 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-185724
2025-10-13 02:09:24,630 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 02:09:28,953 | INFO | 13 Oct 02:09    INFO  ['train_bert4rec.py']
13 Oct 02:09    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 02:09    INFO  ecommerce
The number of users: 2
Average actions of users: 13.0
The number of items: 6
Average actions of items: 2.6
The number of inters: 13
The sparsity of the dataset: -8.333333333333325%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 02:09    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 02:09    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 02:09    INFO  BERT4Rec(
  (item_embedding): Embedding(7, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 108038
13 Oct 02:09    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  6.27it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  6.27it/s, GPU RAM: 0.03 G/3.68 G]
13 Oct 02:09    INFO  epoch 0 training [time: 0.16s, train loss: 1.7771]

Evaluate   :   0%|                                                            | 0/1 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 148, in run_recbole
    best_valid_score, best_valid_result = trainer.fit(
                                          ^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 464, in fit
    valid_score, valid_result = self._valid_epoch(
                                ^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 283, in _valid_epoch
    valid_result = self.evaluate(
                   ^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 621, in evaluate
    self.eval_collector.eval_batch_collect(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/evaluator/collector.py", line 159, in eval_batch_collect
    _, topk_idx = torch.topk(
                  ^^^^^^^^^^^
RuntimeError: selected index k out of range
2025-10-13 02:09:28,954 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 305, in run_once
    result = execute_pipeline(keep_versions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 276, in execute_pipeline
    run_step([sys.executable, "train_bert4rec.py"], TRAINING_DIR)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 196, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 02:09:28,954 | WARNING | Scheduled run exited with code 1
2025-10-13 02:11:28,958 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:11:29,462 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 10
Số user: 1
Số sản phẩm: 5
Các loại event: {'add_to_cart': 0.6, 'view': 0.3, 'purchase': 0.1}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...     purchase

[10 rows x 5 columns]
2025-10-13 02:11:29,462 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:11:29,921 | INFO | ✅ Đã tạo snapshot 20251012-191129 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-191129/ecommerce.inter) với 13 dòng
👥  User: 1 | 🛒  Sản phẩm: 7
🏷️   Nhãn mua hàng (label=1): 1
       user_id item_id   timestamp  label
0         4001       7  1760289978      0
18240     4001       7  1760289978      0
1         4001       7  1760290034      0
18241     4001       7  1760290034      0
2         4001       9  1760290038      0
18242     4001       9  1760290038      0
3         4001       1  1760295899      0
4         4001       1  1760295900      0
5         4001      17  1760295946      0
6         4001      17  1760295948      0
2025-10-13 02:11:29,922 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-185900
2025-10-13 02:11:29,922 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 02:11:33,785 | INFO | 13 Oct 02:11    INFO  ['train_bert4rec.py']
13 Oct 02:11    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 02:11    INFO  ecommerce
The number of users: 2
Average actions of users: 13.0
The number of items: 6
Average actions of items: 2.6
The number of inters: 13
The sparsity of the dataset: -8.333333333333325%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 02:11    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 02:11    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 02:11    INFO  BERT4Rec(
  (item_embedding): Embedding(7, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 108038
13 Oct 02:11    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  7.44it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  7.43it/s, GPU RAM: 0.03 G/3.68 G]
13 Oct 02:11    INFO  epoch 0 training [time: 0.14s, train loss: 1.7771]

Evaluate   :   0%|                                                            | 0/1 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 148, in run_recbole
    best_valid_score, best_valid_result = trainer.fit(
                                          ^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 464, in fit
    valid_score, valid_result = self._valid_epoch(
                                ^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 283, in _valid_epoch
    valid_result = self.evaluate(
                   ^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 621, in evaluate
    self.eval_collector.eval_batch_collect(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/evaluator/collector.py", line 159, in eval_batch_collect
    _, topk_idx = torch.topk(
                  ^^^^^^^^^^^
RuntimeError: selected index k out of range
2025-10-13 02:11:33,792 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 305, in run_once
    result = execute_pipeline(keep_versions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 276, in execute_pipeline
    run_step([sys.executable, "train_bert4rec.py"], TRAINING_DIR)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 196, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 02:11:33,792 | WARNING | Scheduled run exited with code 1
2025-10-13 02:12:05,869 | INFO | Starting scheduler mode (interval=120s, keep=6)
2025-10-13 02:12:05,874 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:12:07,064 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 10
Số user: 1
Số sản phẩm: 5
Các loại event: {'add_to_cart': 0.6, 'view': 0.3, 'purchase': 0.1}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...     purchase

[10 rows x 5 columns]
2025-10-13 02:12:07,064 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:12:07,814 | INFO | ✅ Đã tạo snapshot 20251012-191207 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-191207/ecommerce.inter) với 13 dòng
👥  User: 1 | 🛒  Sản phẩm: 7
🏷️   Nhãn mua hàng (label=1): 1
       user_id item_id   timestamp  label
0         4001       7  1760289978      0
18240     4001       7  1760289978      0
1         4001       7  1760290034      0
18241     4001       7  1760290034      0
2         4001       9  1760290038      0
18242     4001       9  1760290038      0
3         4001       1  1760295899      0
4         4001       1  1760295900      0
5         4001      17  1760295946      0
6         4001      17  1760295948      0
2025-10-13 02:12:07,819 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-190110
2025-10-13 02:12:07,819 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 02:12:18,115 | INFO | 13 Oct 02:12    INFO  ['train_bert4rec.py']
13 Oct 02:12    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 02:12    INFO  ecommerce
The number of users: 2
Average actions of users: 13.0
The number of items: 6
Average actions of items: 2.6
The number of inters: 13
The sparsity of the dataset: -8.333333333333325%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 02:12    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 02:12    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 02:12    INFO  BERT4Rec(
  (item_embedding): Embedding(7, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 108038
13 Oct 02:12    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  5.44it/s, GPU RAM: 0.03 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  5.43it/s, GPU RAM: 0.03 G/3.68 G]
13 Oct 02:12    INFO  epoch 0 training [time: 0.19s, train loss: 1.7771]

Evaluate   :   0%|                                                            | 0/1 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.03 G/3.68 G]
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 148, in run_recbole
    best_valid_score, best_valid_result = trainer.fit(
                                          ^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 464, in fit
    valid_score, valid_result = self._valid_epoch(
                                ^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 283, in _valid_epoch
    valid_result = self.evaluate(
                   ^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 621, in evaluate
    self.eval_collector.eval_batch_collect(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/evaluator/collector.py", line 159, in eval_batch_collect
    _, topk_idx = torch.topk(
                  ^^^^^^^^^^^
RuntimeError: selected index k out of range
2025-10-13 02:12:18,117 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 305, in run_once
    result = execute_pipeline(keep_versions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 276, in execute_pipeline
    run_step([sys.executable, "train_bert4rec.py"], TRAINING_DIR)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 196, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 02:12:18,118 | WARNING | Scheduled run exited with code 1
2025-10-13 02:14:18,121 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:14:18,731 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 17
Số user: 1
Số sản phẩm: 6
Các loại event: {'add_to_cart': 0.529, 'view': 0.353, 'purchase': 0.118}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[10 rows x 5 columns]
2025-10-13 02:14:18,731 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:14:19,086 | INFO | ✅ Đã tạo snapshot 20251012-191419 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-191419/ecommerce.inter) với 17 dòng
👥  User: 1 | 🛒  Sản phẩm: 6
🏷️   Nhãn mua hàng (label=1): 2
       user_id  item_id   timestamp  label
18247     4001        7  1760289978      0
18248     4001        7  1760290034      0
18249     4001        9  1760290038      0
3         4001        1  1760295899      0
4         4001        1  1760295900      0
5         4001       17  1760295946      0
6         4001       17  1760295948      0
7         4001       17  1760295949      0
8         4001       17  1760295950      0
9         4001        2  1760296342      0
2025-10-13 02:14:19,088 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-190306
2025-10-13 02:14:19,088 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 02:14:23,358 | INFO | 13 Oct 02:14    INFO  ['train_bert4rec.py']
13 Oct 02:14    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 02:14    INFO  ecommerce
The number of users: 2
Average actions of users: 17.0
The number of items: 7
Average actions of items: 2.8333333333333335
The number of inters: 17
The sparsity of the dataset: -21.42857142857142%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 02:14    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 02:14    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 02:14    INFO  BERT4Rec(
  (item_embedding): Embedding(8, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 108103
13 Oct 02:14    INFO  FLOPs: 5194664.0

Train     0:   0%|                                                            | 0/1 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.04 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  8.78it/s, GPU RAM: 0.04 G/3.68 G]
Train     0: 100%|████████████████████████████| 1/1 [00:00<00:00,  8.77it/s, GPU RAM: 0.04 G/3.68 G]
13 Oct 02:14    INFO  epoch 0 training [time: 0.12s, train loss: 2.0691]

Evaluate   :   0%|                                                            | 0/1 [00:00<?, ?it/s]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.04 G/3.68 G]
Evaluate   :   0%|                                    | 0/1 [00:00<?, ?it/s, GPU RAM: 0.04 G/3.68 G]
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/train_bert4rec.py", line 13, in <module>
    run_recbole(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/quick_start/quick_start.py", line 148, in run_recbole
    best_valid_score, best_valid_result = trainer.fit(
                                          ^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 464, in fit
    valid_score, valid_result = self._valid_epoch(
                                ^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 283, in _valid_epoch
    valid_result = self.evaluate(
                   ^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py", line 621, in evaluate
    self.eval_collector.eval_batch_collect(
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/evaluator/collector.py", line 159, in eval_batch_collect
    _, topk_idx = torch.topk(
                  ^^^^^^^^^^^
RuntimeError: selected index k out of range
2025-10-13 02:14:23,360 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 305, in run_once
    result = execute_pipeline(keep_versions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 276, in execute_pipeline
    run_step([sys.executable, "train_bert4rec.py"], TRAINING_DIR)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 196, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py
2025-10-13 02:14:23,360 | WARNING | Scheduled run exited with code 1
2025-10-13 02:16:23,363 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:16:23,715 | INFO | 🔄 Đang trích xuất data từ Postgres...
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 22
Số user: 1
Số sản phẩm: 6
Các loại event: {'add_to_cart': 0.5, 'view': 0.364, 'purchase': 0.136}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[10 rows x 5 columns]
2025-10-13 02:16:23,715 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 02:16:24,052 | INFO | ✅ Đã tạo snapshot 20251012-191624 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-191624/ecommerce.inter) với 22 dòng
👥  User: 1 | 🛒  Sản phẩm: 6
🏷️   Nhãn mua hàng (label=1): 3
       user_id  item_id   timestamp  label
18252     4001        7  1760289978      0
18253     4001        7  1760290034      0
18254     4001        9  1760290038      0
3         4001        1  1760295899      0
4         4001        1  1760295900      0
5         4001       17  1760295946      0
6         4001       17  1760295948      0
7         4001       17  1760295949      0
8         4001       17  1760295950      0
9         4001        2  1760296342      0
2025-10-13 02:16:24,052 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-190514
2025-10-13 02:16:24,052 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 02:27:15,247 | INFO | Starting scheduler mode (interval=120s, keep=6)
2025-10-13 02:27:56,878 | INFO | Starting scheduler mode (interval=120s, keep=6)
2025-10-13 02:38:17,507 | INFO | Starting scheduler mode (interval=120s, keep=6)
2025-10-13 02:42:18,156 | INFO | Starting scheduler mode (interval=120s, keep=6)
2025-10-13 02:43:08,711 | INFO | Starting scheduler mode (interval=120s, keep=6)
2025-10-13 02:44:41,787 | INFO | Starting scheduler mode (interval=120s, keep=6)
2025-10-13 03:11:11,905 | INFO | Starting scheduler mode (interval=120s, keep=6)
2025-10-13 03:21:48,259 | INFO | Starting single retraining run (timeout=60)
2025-10-13 03:21:48,259 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:21:49,204 | INFO | 🔄 Đang trích xuất data từ Postgres...
⚠️  psycopg không khả dụng hoặc lỗi: connection is bad: no error details available
➡️  Thử fallback sang psql CLI...
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 103, in main
    df = export_via_psycopg(conn)
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 80, in export_via_psycopg
    with psycopg.connect(
         ^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/psycopg/connection.py", line 120, in connect
    raise last_ex.with_traceback(None)
psycopg.OperationalError: connection is bad: no error details available

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 58, in export_via_psql
    process = subprocess.run(
              ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['psql', 'host=localhost port=5432 user=nemmer dbname=secondhand_ai', '-c', 'COPY (\nSELECT\n    "sessionId" AS session_id,\n    "userId" AS user_id,\n    "productId" AS product_id,\n    "eventType" AS event_type,\n    "occurredAt" AS occurred_at\nFROM ai_interaction_events\nWHERE "userId" IS NOT NULL\n  AND "productId" IS NOT NULL\nORDER BY "occurredAt" ASC\n) TO STDOUT WITH CSV HEADER']' returned non-zero exit status 2.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 136, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 108, in main
    df = export_via_psql(conn)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 68, in export_via_psql
    raise RuntimeError(f"Không thể thực thi truy vấn Postgres: {exc.stderr}") from exc
RuntimeError: Không thể thực thi truy vấn Postgres: psql: error:
2025-10-13 03:21:49,205 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 305, in run_once
    result = execute_pipeline(keep_versions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 270, in execute_pipeline
    run_step([sys.executable, "user_behavior_advanced.py"], DATA_PREP_DIR)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 196, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-13 03:21:59,275 | INFO | Starting single retraining run (timeout=60)
2025-10-13 03:21:59,275 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:21:59,727 | INFO | 🔄 Đang trích xuất data từ Postgres...
⚠️  psycopg không khả dụng hoặc lỗi: connection is bad: no error details available
➡️  Thử fallback sang psql CLI...
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 103, in main
    df = export_via_psycopg(conn)
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 80, in export_via_psycopg
    with psycopg.connect(
         ^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/psycopg/connection.py", line 120, in connect
    raise last_ex.with_traceback(None)
psycopg.OperationalError: connection is bad: no error details available

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 58, in export_via_psql
    process = subprocess.run(
              ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['psql', 'host=localhost port=5432 user=nemmer dbname=secondhand_ai', '-c', 'COPY (\nSELECT\n    "sessionId" AS session_id,\n    "userId" AS user_id,\n    "productId" AS product_id,\n    "eventType" AS event_type,\n    "occurredAt" AS occurred_at\nFROM ai_interaction_events\nWHERE "userId" IS NOT NULL\n  AND "productId" IS NOT NULL\nORDER BY "occurredAt" ASC\n) TO STDOUT WITH CSV HEADER']' returned non-zero exit status 2.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 136, in <module>
    main()
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 108, in main
    df = export_via_psql(conn)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing/user_behavior_advanced.py", line 68, in export_via_psql
    raise RuntimeError(f"Không thể thực thi truy vấn Postgres: {exc.stderr}") from exc
RuntimeError: Không thể thực thi truy vấn Postgres: psql: error:
2025-10-13 03:21:59,728 | ERROR | Retraining pipeline failed: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
Traceback (most recent call last):
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 305, in run_once
    result = execute_pipeline(keep_versions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 270, in execute_pipeline
    run_step([sys.executable, "user_behavior_advanced.py"], DATA_PREP_DIR)
  File "/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/tasks/retrain.py", line 196, in run_step
    raise RuntimeError(f"Command failed ({result.returncode}): {' '.join(command)}")
RuntimeError: Command failed (1): /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py
2025-10-13 03:22:41,982 | INFO | Starting scheduler mode (interval=30s, keep=6)
2025-10-13 03:22:41,983 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:22:43,224 | INFO | 🔄 Đang trích xuất data từ Postgres...
🐘 Đã trích xuất bằng psycopg.
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 48
Số user: 1
Số sản phẩm: 10
Các loại event: {'add_to_cart': 0.438, 'view': 0.375, 'purchase': 0.188}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[10 rows x 5 columns]
2025-10-13 03:22:43,224 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:22:44,050 | INFO | 🗂  Đã cập nhật /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/interactions.csv (tổng 18318 bản ghi).
✅ Đã tạo snapshot 20251012-202243 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-202243/ecommerce.inter) với 18318 dòng
👥  User: 2607 | 🛒  Sản phẩm: 105
🏷️   Nhãn mua hàng (label=1): 2982
      user_id item_id   timestamp  label
4952        3      25  1704067200      0
4953        3      25  1704068520      0
18196       3      89  1707264000      0
18197       3      89  1707264300      0
18198       3      89  1707265440      0
18199       3      89  1707266820      1
1123        3      12  1708041600      0
1124        3      12  1708044480      0
10396       4       4  1707436800      0
10397       4       4  1707437100      0
2025-10-13 03:22:44,051 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-192844
2025-10-13 03:22:44,052 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-192651
2025-10-13 03:22:44,052 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-191624
2025-10-13 03:22:44,052 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-191419
2025-10-13 03:22:44,052 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-191207
2025-10-13 03:22:44,052 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-191129
2025-10-13 03:22:44,052 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-190924
2025-10-13 03:22:44,052 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-190719
2025-10-13 03:22:44,052 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 03:24:11,727 | INFO | 13 Oct 03:22    INFO  ['train_bert4rec.py']
13 Oct 03:22    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = False
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
device = cuda
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 03:22    INFO  ecommerce
The number of users: 2607
Average actions of users: 7.029163468917882
The number of items: 96
Average actions of items: 192.82105263157894
The number of inters: 18318
The sparsity of the dataset: 92.68076332949751%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 03:22    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 03:22    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 03:22    INFO  BERT4Rec(
  (item_embedding): Embedding(97, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 113888
13 Oct 03:22    INFO  FLOPs: 5194664.0
🔧 Sử dụng topk=[5, 10], valid_metric=MRR@10, device=cpu

Train     0:   0%|                                                           | 0/11 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   9%|████▋                                              | 1/11 [00:00<00:04,  2.19it/s]
Train     0:  18%|█████████▎                                         | 2/11 [00:00<00:02,  3.63it/s]
Train     0:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  4.98it/s]
Train     0:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  5.99it/s]
Train     0:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.81it/s]
Train     0:  55%|███████████████████████████▊                       | 6/11 [00:01<00:00,  7.46it/s]
Train     0:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  7.91it/s]
Train     0:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.26it/s]
Train     0:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.57it/s]
Train     0:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.75it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.06it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.92it/s]
13 Oct 03:22    INFO  epoch 0 training [time: 1.59s, train loss: 49.8415]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.63it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.61it/s]
13 Oct 03:22    INFO  epoch 0 evaluating [time: 0.13s, valid_score: 0.058500]
13 Oct 03:22    INFO  valid result: 
recall@5 : 0.0939    recall@10 : 0.1732    mrr@5 : 0.0479    mrr@10 : 0.0585    ndcg@5 : 0.0592    ndcg@10 : 0.0848    hit@5 : 0.0939    hit@10 : 0.1732    precision@5 : 0.0188    precision@10 : 0.0173
13 Oct 03:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train     1:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     1:   9%|████▋                                              | 1/11 [00:00<00:01,  9.12it/s]
Train     1:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.01it/s]
Train     1:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.05it/s]
Train     1:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.08it/s]
Train     1:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.08it/s]
Train     1:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.07it/s]
Train     1:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.15it/s]
Train     1:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.10it/s]
Train     1:  82%|█████████████████████████████████████████▋         | 9/11 [00:00<00:00,  9.08it/s]
Train     1:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.08it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.19it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.11it/s]
13 Oct 03:22    INFO  epoch 1 training [time: 1.21s, train loss: 49.0543]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.06it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.60it/s]
13 Oct 03:22    INFO  epoch 1 evaluating [time: 0.15s, valid_score: 0.089500]
13 Oct 03:22    INFO  valid result: 
recall@5 : 0.1587    recall@10 : 0.2599    mrr@5 : 0.0766    mrr@10 : 0.0895    ndcg@5 : 0.0968    ndcg@10 : 0.129    hit@5 : 0.1587    hit@10 : 0.2599    precision@5 : 0.0317    precision@10 : 0.026
13 Oct 03:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train     2:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     2:   9%|████▋                                              | 1/11 [00:00<00:02,  4.46it/s]
Train     2:  18%|█████████▎                                         | 2/11 [00:00<00:01,  6.46it/s]
Train     2:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.46it/s]
Train     2:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.11it/s]
Train     2:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.45it/s]
Train     2:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.71it/s]
Train     2:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.85it/s]
Train     2:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.85it/s]
Train     2:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.93it/s]
Train     2:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.97it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.14it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.39it/s]
13 Oct 03:22    INFO  epoch 2 training [time: 1.31s, train loss: 46.8481]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.35it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.70it/s]
13 Oct 03:22    INFO  epoch 2 evaluating [time: 0.13s, valid_score: 0.274400]
13 Oct 03:22    INFO  valid result: 
recall@5 : 0.4372    recall@10 : 0.5696    mrr@5 : 0.2563    mrr@10 : 0.2744    ndcg@5 : 0.3012    ndcg@10 : 0.3443    hit@5 : 0.4372    hit@10 : 0.5696    precision@5 : 0.0874    precision@10 : 0.057
13 Oct 03:22    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train     3:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     3:   9%|████▋                                              | 1/11 [00:00<00:01,  8.81it/s]
Train     3:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.96it/s]
Train     3:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.14it/s]
Train     3:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.28it/s]
Train     3:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.35it/s]
Train     3:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.44it/s]
Train     3:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.06it/s]
Train     3:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.19it/s]
Train     3:  82%|█████████████████████████████████████████▋         | 9/11 [00:00<00:00,  9.28it/s]
Train     3:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.19it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.29it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.23it/s]
13 Oct 03:23    INFO  epoch 3 training [time: 1.19s, train loss: 42.8199]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.43it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.22it/s]
13 Oct 03:23    INFO  epoch 3 evaluating [time: 0.14s, valid_score: 0.498400]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.624    recall@10 : 0.7098    mrr@5 : 0.4873    mrr@10 : 0.4984    ndcg@5 : 0.5219    ndcg@10 : 0.5493    hit@5 : 0.624    hit@10 : 0.7098    precision@5 : 0.1248    precision@10 : 0.071
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train     4:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     4:   9%|████▋                                              | 1/11 [00:00<00:01,  8.98it/s]
Train     4:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.86it/s]
Train     4:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.61it/s]
Train     4:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.80it/s]
Train     4:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.86it/s]
Train     4:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.83it/s]
Train     4:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.89it/s]
Train     4:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.96it/s]
Train     4:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.95it/s]
Train     4:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.94it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.15it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.95it/s]
13 Oct 03:23    INFO  epoch 4 training [time: 1.23s, train loss: 39.0008]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.78it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.65it/s]
13 Oct 03:23    INFO  epoch 4 evaluating [time: 0.13s, valid_score: 0.614800]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.7179    recall@10 : 0.7678    mrr@5 : 0.608    mrr@10 : 0.6148    ndcg@5 : 0.6357    ndcg@10 : 0.6521    hit@5 : 0.7179    hit@10 : 0.7678    precision@5 : 0.1436    precision@10 : 0.0768
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train     5:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     5:   9%|████▋                                              | 1/11 [00:00<00:01,  9.30it/s]
Train     5:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.35it/s]
Train     5:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.26it/s]
Train     5:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.10it/s]
Train     5:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.12it/s]
Train     5:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.11it/s]
Train     5:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.11it/s]
Train     5:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.24it/s]
Train     5:  82%|█████████████████████████████████████████▋         | 9/11 [00:00<00:00,  9.27it/s]
Train     5:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.32it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.30it/s]
13 Oct 03:23    INFO  epoch 5 training [time: 1.18s, train loss: 35.3064]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.27it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.55it/s]
13 Oct 03:23    INFO  epoch 5 evaluating [time: 0.16s, valid_score: 0.682400]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.7556    recall@10 : 0.7937    mrr@5 : 0.6772    mrr@10 : 0.6824    ndcg@5 : 0.697    ndcg@10 : 0.7094    hit@5 : 0.7556    hit@10 : 0.7937    precision@5 : 0.1511    precision@10 : 0.0794
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train     6:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     6:   9%|████▋                                              | 1/11 [00:00<00:01,  8.78it/s]
Train     6:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.32it/s]
Train     6:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.43it/s]
Train     6:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.62it/s]
Train     6:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.64it/s]
Train     6:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.62it/s]
Train     6:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.17it/s]
Train     6:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.51it/s]
Train     6:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.93it/s]
Train     6:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.17it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.36it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.99it/s]
13 Oct 03:23    INFO  epoch 6 training [time: 1.38s, train loss: 31.7454]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.67it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.12it/s]
13 Oct 03:23    INFO  epoch 6 evaluating [time: 0.17s, valid_score: 0.696800]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.7642    recall@10 : 0.8068    mrr@5 : 0.6912    mrr@10 : 0.6968    ndcg@5 : 0.7095    ndcg@10 : 0.7232    hit@5 : 0.7642    hit@10 : 0.8068    precision@5 : 0.1528    precision@10 : 0.0807
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train     7:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     7:   9%|████▋                                              | 1/11 [00:00<00:01,  7.42it/s]
Train     7:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.46it/s]
Train     7:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.45it/s]
Train     7:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.19it/s]
Train     7:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.56it/s]
Train     7:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.14it/s]
Train     7:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.32it/s]
Train     7:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.03it/s]
Train     7:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.93it/s]
Train     7:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.50it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.68it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.00it/s]
13 Oct 03:23    INFO  epoch 7 training [time: 1.57s, train loss: 28.8302]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.02it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 17.06it/s]
13 Oct 03:23    INFO  epoch 7 evaluating [time: 0.20s, valid_score: 0.722500]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.7832    recall@10 : 0.82    mrr@5 : 0.7177    mrr@10 : 0.7225    ndcg@5 : 0.7342    ndcg@10 : 0.746    hit@5 : 0.7832    hit@10 : 0.82    precision@5 : 0.1566    precision@10 : 0.082
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train     8:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     8:   9%|████▋                                              | 1/11 [00:00<00:01,  7.05it/s]
Train     8:  18%|█████████▎                                         | 2/11 [00:00<00:01,  6.24it/s]
Train     8:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  5.82it/s]
Train     8:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  5.85it/s]
Train     8:  45%|███████████████████████▏                           | 5/11 [00:00<00:01,  5.96it/s]
Train     8:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.54it/s]
Train     8:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  7.04it/s]
Train     8:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.29it/s]
Train     8:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.69it/s]
Train     8:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.85it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.59it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.54it/s]
13 Oct 03:23    INFO  epoch 8 training [time: 1.69s, train loss: 25.9885]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  8.56it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00,  7.58it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00,  9.88it/s]
13 Oct 03:23    INFO  epoch 8 evaluating [time: 0.32s, valid_score: 0.766800]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8154    recall@10 : 0.8444    mrr@5 : 0.7631    mrr@10 : 0.7668    ndcg@5 : 0.7761    ndcg@10 : 0.7854    hit@5 : 0.8154    hit@10 : 0.8444    precision@5 : 0.1631    precision@10 : 0.0844
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train     9:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     9:   9%|████▋                                              | 1/11 [00:00<00:01,  6.62it/s]
Train     9:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.72it/s]
Train     9:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.37it/s]
Train     9:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.68it/s]
Train     9:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.92it/s]
Train     9:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.90it/s]
Train     9:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.79it/s]
Train     9:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.75it/s]
Train     9:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.73it/s]
Train     9:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.66it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.92it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.66it/s]
13 Oct 03:23    INFO  epoch 9 training [time: 1.27s, train loss: 23.1397]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.86it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.80it/s]
13 Oct 03:23    INFO  epoch 9 evaluating [time: 0.12s, valid_score: 0.805200]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8413    recall@10 : 0.8608    mrr@5 : 0.8027    mrr@10 : 0.8052    ndcg@5 : 0.8124    ndcg@10 : 0.8186    hit@5 : 0.8413    hit@10 : 0.8608    precision@5 : 0.1683    precision@10 : 0.0861
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    10:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    10:   9%|████▋                                              | 1/11 [00:00<00:02,  4.07it/s]
Train    10:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.97it/s]
Train    10:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.11it/s]
Train    10:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.85it/s]
Train    10:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.24it/s]
Train    10:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.07it/s]
Train    10:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.41it/s]
Train    10:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.71it/s]
Train    10:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.82it/s]
Train    10:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.51it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.51it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.95it/s]
13 Oct 03:23    INFO  epoch 10 training [time: 1.38s, train loss: 20.8776]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.97it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.02it/s]
13 Oct 03:23    INFO  epoch 10 evaluating [time: 0.17s, valid_score: 0.819800]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8481    recall@10 : 0.8644    mrr@5 : 0.8176    mrr@10 : 0.8198    ndcg@5 : 0.8254    ndcg@10 : 0.8306    hit@5 : 0.8481    hit@10 : 0.8644    precision@5 : 0.1696    precision@10 : 0.0864
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    11:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    11:   9%|████▋                                              | 1/11 [00:00<00:01,  7.89it/s]
Train    11:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.99it/s]
Train    11:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.03it/s]
Train    11:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.77it/s]
Train    11:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.79it/s]
Train    11:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.74it/s]
Train    11:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.84it/s]
Train    11:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.50it/s]
Train    11:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.18it/s]
Train    11:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.02it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.96it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.40it/s]
13 Oct 03:23    INFO  epoch 11 training [time: 1.49s, train loss: 19.3311]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.57it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.08it/s]
13 Oct 03:23    INFO  epoch 11 evaluating [time: 0.17s, valid_score: 0.828400]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8517    recall@10 : 0.8658    mrr@5 : 0.8264    mrr@10 : 0.8284    ndcg@5 : 0.8328    ndcg@10 : 0.8375    hit@5 : 0.8517    hit@10 : 0.8658    precision@5 : 0.1703    precision@10 : 0.0866
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    12:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    12:   9%|████▋                                              | 1/11 [00:00<00:01,  7.01it/s]
Train    12:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.63it/s]
Train    12:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.15it/s]
Train    12:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.52it/s]
Train    12:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.74it/s]
Train    12:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.69it/s]
Train    12:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.78it/s]
Train    12:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.88it/s]
Train    12:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.96it/s]
Train    12:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.12it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.36it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.80it/s]
13 Oct 03:23    INFO  epoch 12 training [time: 1.25s, train loss: 17.1690]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.70it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.28it/s]
13 Oct 03:23    INFO  epoch 12 evaluating [time: 0.14s, valid_score: 0.835200]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8571    recall@10 : 0.8707    mrr@5 : 0.8336    mrr@10 : 0.8352    ndcg@5 : 0.8395    ndcg@10 : 0.8437    hit@5 : 0.8571    hit@10 : 0.8707    precision@5 : 0.1714    precision@10 : 0.0871
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    13:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    13:   9%|████▋                                              | 1/11 [00:00<00:01,  9.12it/s]
Train    13:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.84it/s]
Train    13:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.99it/s]
Train    13:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.08it/s]
Train    13:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.10it/s]
Train    13:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.21it/s]
Train    13:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.26it/s]
Train    13:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.27it/s]
Train    13:  82%|█████████████████████████████████████████▋         | 9/11 [00:00<00:00,  9.18it/s]
Train    13:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.06it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.35it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.78it/s]
13 Oct 03:23    INFO  epoch 13 training [time: 1.25s, train loss: 16.3492]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.71it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.01it/s]
13 Oct 03:23    INFO  epoch 13 evaluating [time: 0.14s, valid_score: 0.842700]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8571    recall@10 : 0.8739    mrr@5 : 0.8406    mrr@10 : 0.8427    ndcg@5 : 0.8448    ndcg@10 : 0.8501    hit@5 : 0.8571    hit@10 : 0.8739    precision@5 : 0.1714    precision@10 : 0.0874
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    14:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    14:   9%|████▋                                              | 1/11 [00:00<00:01,  9.23it/s]
Train    14:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.91it/s]
Train    14:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.95it/s]
Train    14:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.71it/s]
Train    14:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.20it/s]
Train    14:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.54it/s]
Train    14:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.67it/s]
Train    14:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.70it/s]
Train    14:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.49it/s]
Train    14:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.65it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.83it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.29it/s]
13 Oct 03:23    INFO  epoch 14 training [time: 1.33s, train loss: 14.6912]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.02it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.14it/s]
13 Oct 03:23    INFO  epoch 14 evaluating [time: 0.15s, valid_score: 0.846700]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.863    recall@10 : 0.8753    mrr@5 : 0.8452    mrr@10 : 0.8467    ndcg@5 : 0.8497    ndcg@10 : 0.8536    hit@5 : 0.863    hit@10 : 0.8753    precision@5 : 0.1726    precision@10 : 0.0875
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    15:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    15:   9%|████▋                                              | 1/11 [00:00<00:01,  8.67it/s]
Train    15:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.88it/s]
Train    15:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.96it/s]
Train    15:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.93it/s]
Train    15:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.05it/s]
Train    15:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.89it/s]
Train    15:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.97it/s]
Train    15:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.80it/s]
Train    15:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.83it/s]
Train    15:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.77it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.70it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.83it/s]
13 Oct 03:23    INFO  epoch 15 training [time: 1.25s, train loss: 14.0030]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.35it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.16it/s]
13 Oct 03:23    INFO  epoch 15 evaluating [time: 0.14s, valid_score: 0.847900]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8653    recall@10 : 0.8785    mrr@5 : 0.8463    mrr@10 : 0.8479    ndcg@5 : 0.851    ndcg@10 : 0.8552    hit@5 : 0.8653    hit@10 : 0.8785    precision@5 : 0.1731    precision@10 : 0.0878
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    16:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    16:   9%|████▋                                              | 1/11 [00:00<00:01,  8.30it/s]
Train    16:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.43it/s]
Train    16:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.70it/s]
Train    16:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.85it/s]
Train    16:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.06it/s]
Train    16:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.18it/s]
Train    16:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.26it/s]
Train    16:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.32it/s]
Train    16:  82%|█████████████████████████████████████████▋         | 9/11 [00:00<00:00,  9.36it/s]
Train    16:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.34it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.42it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.17it/s]
13 Oct 03:23    INFO  epoch 16 training [time: 1.20s, train loss: 13.4260]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.64it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.00it/s]
13 Oct 03:23    INFO  epoch 16 evaluating [time: 0.13s, valid_score: 0.845900]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8644    recall@10 : 0.8789    mrr@5 : 0.844    mrr@10 : 0.8459    ndcg@5 : 0.8491    ndcg@10 : 0.8537    hit@5 : 0.8644    hit@10 : 0.8789    precision@5 : 0.1729    precision@10 : 0.0879

Train    17:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    17:   9%|████▋                                              | 1/11 [00:00<00:01,  8.76it/s]
Train    17:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.78it/s]
Train    17:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.93it/s]
Train    17:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.94it/s]
Train    17:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.96it/s]
Train    17:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.09it/s]
Train    17:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.18it/s]
Train    17:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.20it/s]
Train    17:  82%|█████████████████████████████████████████▋         | 9/11 [00:00<00:00,  9.22it/s]
Train    17:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.12it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.17it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.09it/s]
13 Oct 03:23    INFO  epoch 17 training [time: 1.21s, train loss: 13.4915]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.46it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.59it/s]
13 Oct 03:23    INFO  epoch 17 evaluating [time: 0.13s, valid_score: 0.850000]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8644    recall@10 : 0.8776    mrr@5 : 0.8483    mrr@10 : 0.85    ndcg@5 : 0.8524    ndcg@10 : 0.8566    hit@5 : 0.8644    hit@10 : 0.8776    precision@5 : 0.1729    precision@10 : 0.0878
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    18:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    18:   9%|████▋                                              | 1/11 [00:00<00:02,  4.78it/s]
Train    18:  18%|█████████▎                                         | 2/11 [00:00<00:01,  6.67it/s]
Train    18:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.56it/s]
Train    18:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.07it/s]
Train    18:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.50it/s]
Train    18:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.07it/s]
Train    18:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.24it/s]
Train    18:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.78it/s]
Train    18:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.10it/s]
Train    18:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.05it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.60it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.28it/s]
13 Oct 03:23    INFO  epoch 18 training [time: 1.51s, train loss: 12.8911]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.98it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.37it/s]
13 Oct 03:23    INFO  epoch 18 evaluating [time: 0.17s, valid_score: 0.852900]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8671    recall@10 : 0.8771    mrr@5 : 0.8517    mrr@10 : 0.8529    ndcg@5 : 0.8556    ndcg@10 : 0.8587    hit@5 : 0.8671    hit@10 : 0.8771    precision@5 : 0.1734    precision@10 : 0.0877
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    19:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    19:   9%|████▋                                              | 1/11 [00:00<00:01,  8.49it/s]
Train    19:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.31it/s]
Train    19:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.64it/s]
Train    19:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.19it/s]
Train    19:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.45it/s]
Train    19:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.99it/s]
Train    19:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.36it/s]
Train    19:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.65it/s]
Train    19:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.86it/s]
Train    19:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.01it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.07it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.37it/s]
13 Oct 03:23    INFO  epoch 19 training [time: 1.32s, train loss: 12.3973]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.35it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.12it/s]
13 Oct 03:23    INFO  epoch 19 evaluating [time: 0.13s, valid_score: 0.854800]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8698    recall@10 : 0.8821    mrr@5 : 0.8532    mrr@10 : 0.8548    ndcg@5 : 0.8574    ndcg@10 : 0.8613    hit@5 : 0.8698    hit@10 : 0.8821    precision@5 : 0.174    precision@10 : 0.0882
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    20:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    20:   9%|████▋                                              | 1/11 [00:00<00:01,  9.15it/s]
Train    20:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.24it/s]
Train    20:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.29it/s]
Train    20:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.32it/s]
Train    20:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.24it/s]
Train    20:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.26it/s]
Train    20:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.28it/s]
Train    20:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.30it/s]
Train    20:  82%|█████████████████████████████████████████▋         | 9/11 [00:00<00:00,  9.31it/s]
Train    20:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.26it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.11it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.22it/s]
13 Oct 03:23    INFO  epoch 20 training [time: 1.19s, train loss: 11.8433]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.75it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.11it/s]
13 Oct 03:23    INFO  epoch 20 evaluating [time: 0.14s, valid_score: 0.855100]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8698    recall@10 : 0.8807    mrr@5 : 0.8537    mrr@10 : 0.8551    ndcg@5 : 0.8577    ndcg@10 : 0.8612    hit@5 : 0.8698    hit@10 : 0.8807    precision@5 : 0.174    precision@10 : 0.0881
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    21:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    21:   9%|████▋                                              | 1/11 [00:00<00:01,  8.09it/s]
Train    21:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.56it/s]
Train    21:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.58it/s]
Train    21:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.71it/s]
Train    21:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.66it/s]
Train    21:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.88it/s]
Train    21:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.99it/s]
Train    21:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.05it/s]
Train    21:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  9.03it/s]
Train    21:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.09it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.29it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.96it/s]
13 Oct 03:23    INFO  epoch 21 training [time: 1.23s, train loss: 11.4876]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.35it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.32it/s]
13 Oct 03:23    INFO  epoch 21 evaluating [time: 0.12s, valid_score: 0.851200]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.868    recall@10 : 0.8776    mrr@5 : 0.85    mrr@10 : 0.8512    ndcg@5 : 0.8545    ndcg@10 : 0.8575    hit@5 : 0.868    hit@10 : 0.8776    precision@5 : 0.1736    precision@10 : 0.0878

Train    22:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    22:   9%|████▋                                              | 1/11 [00:00<00:02,  3.49it/s]
Train    22:  18%|█████████▎                                         | 2/11 [00:00<00:01,  4.70it/s]
Train    22:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  5.70it/s]
Train    22:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.43it/s]
Train    22:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.21it/s]
Train    22:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.71it/s]
Train    22:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  8.07it/s]
Train    22:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.29it/s]
Train    22:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.44it/s]
Train    22:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.52it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.71it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.39it/s]
13 Oct 03:23    INFO  epoch 22 training [time: 1.49s, train loss: 12.0743]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.76it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.67it/s]
13 Oct 03:23    INFO  epoch 22 evaluating [time: 0.13s, valid_score: 0.853700]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8694    recall@10 : 0.8794    mrr@5 : 0.8525    mrr@10 : 0.8537    ndcg@5 : 0.8567    ndcg@10 : 0.8598    hit@5 : 0.8694    hit@10 : 0.8794    precision@5 : 0.1739    precision@10 : 0.0879

Train    23:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    23:   9%|████▋                                              | 1/11 [00:00<00:01,  8.88it/s]
Train    23:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.97it/s]
Train    23:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.97it/s]
Train    23:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.99it/s]
Train    23:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.04it/s]
Train    23:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.05it/s]
Train    23:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.03it/s]
Train    23:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.07it/s]
Train    23:  82%|█████████████████████████████████████████▋         | 9/11 [00:00<00:00,  9.02it/s]
Train    23:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.03it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.12it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.05it/s]
13 Oct 03:23    INFO  epoch 23 training [time: 1.22s, train loss: 11.1881]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.20it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.31it/s]
13 Oct 03:23    INFO  epoch 23 evaluating [time: 0.15s, valid_score: 0.853500]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.868    recall@10 : 0.8794    mrr@5 : 0.852    mrr@10 : 0.8535    ndcg@5 : 0.8561    ndcg@10 : 0.8597    hit@5 : 0.868    hit@10 : 0.8794    precision@5 : 0.1736    precision@10 : 0.0879

Train    24:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    24:   9%|████▋                                              | 1/11 [00:00<00:01,  9.09it/s]
Train    24:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.67it/s]
Train    24:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.79it/s]
Train    24:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.84it/s]
Train    24:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.89it/s]
Train    24:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.98it/s]
Train    24:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.99it/s]
Train    24:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.04it/s]
Train    24:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  9.08it/s]
Train    24:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.08it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.24it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.04it/s]
13 Oct 03:23    INFO  epoch 24 training [time: 1.22s, train loss: 10.5378]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.93it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.83it/s]
13 Oct 03:23    INFO  epoch 24 evaluating [time: 0.14s, valid_score: 0.854300]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8667    recall@10 : 0.8789    mrr@5 : 0.8526    mrr@10 : 0.8543    ndcg@5 : 0.8562    ndcg@10 : 0.8602    hit@5 : 0.8667    hit@10 : 0.8789    precision@5 : 0.1733    precision@10 : 0.0879

Train    25:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    25:   9%|████▋                                              | 1/11 [00:00<00:01,  8.91it/s]
Train    25:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.98it/s]
Train    25:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.98it/s]
Train    25:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.80it/s]
Train    25:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.85it/s]
Train    25:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.97it/s]
Train    25:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.05it/s]
Train    25:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.93it/s]
Train    25:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.87it/s]
Train    25:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.00it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.19it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.01it/s]
13 Oct 03:23    INFO  epoch 25 training [time: 1.22s, train loss: 11.6388]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.34it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.27it/s]
13 Oct 03:23    INFO  epoch 25 evaluating [time: 0.16s, valid_score: 0.855700]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8698    recall@10 : 0.8789    mrr@5 : 0.8545    mrr@10 : 0.8557    ndcg@5 : 0.8584    ndcg@10 : 0.8613    hit@5 : 0.8698    hit@10 : 0.8789    precision@5 : 0.174    precision@10 : 0.0879
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    26:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    26:   9%|████▋                                              | 1/11 [00:00<00:01,  8.97it/s]
Train    26:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.98it/s]
Train    26:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.05it/s]
Train    26:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.92it/s]
Train    26:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.62it/s]
Train    26:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.27it/s]
Train    26:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.71it/s]
Train    26:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.07it/s]
Train    26:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.36it/s]
Train    26:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.55it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.85it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.28it/s]
13 Oct 03:23    INFO  epoch 26 training [time: 1.33s, train loss: 10.4909]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.04it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.47it/s]
13 Oct 03:23    INFO  epoch 26 evaluating [time: 0.14s, valid_score: 0.857300]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8721    recall@10 : 0.8839    mrr@5 : 0.8559    mrr@10 : 0.8573    ndcg@5 : 0.8599    ndcg@10 : 0.8636    hit@5 : 0.8721    hit@10 : 0.8839    precision@5 : 0.1744    precision@10 : 0.0884
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    27:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    27:   9%|████▋                                              | 1/11 [00:00<00:01,  8.72it/s]
Train    27:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.89it/s]
Train    27:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.93it/s]
Train    27:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.92it/s]
Train    27:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.08it/s]
Train    27:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.09it/s]
Train    27:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.08it/s]
Train    27:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.03it/s]
Train    27:  82%|█████████████████████████████████████████▋         | 9/11 [00:00<00:00,  9.06it/s]
Train    27:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.09it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.23it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.08it/s]
13 Oct 03:23    INFO  epoch 27 training [time: 1.21s, train loss: 11.4272]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.88it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.89it/s]
13 Oct 03:23    INFO  epoch 27 evaluating [time: 0.13s, valid_score: 0.857900]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8712    recall@10 : 0.8816    mrr@5 : 0.8566    mrr@10 : 0.8579    ndcg@5 : 0.8603    ndcg@10 : 0.8636    hit@5 : 0.8712    hit@10 : 0.8816    precision@5 : 0.1742    precision@10 : 0.0882
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    28:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    28:   9%|████▋                                              | 1/11 [00:00<00:01,  9.23it/s]
Train    28:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.32it/s]
Train    28:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.18it/s]
Train    28:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.27it/s]
Train    28:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.34it/s]
Train    28:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.31it/s]
Train    28:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.91it/s]
Train    28:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.90it/s]
Train    28:  82%|█████████████████████████████████████████▋         | 9/11 [00:00<00:00,  9.08it/s]
Train    28:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.06it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.12it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.13it/s]
13 Oct 03:23    INFO  epoch 28 training [time: 1.21s, train loss: 9.8512]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.23it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.82it/s]
13 Oct 03:23    INFO  epoch 28 evaluating [time: 0.14s, valid_score: 0.853600]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8698    recall@10 : 0.8812    mrr@5 : 0.8521    mrr@10 : 0.8536    ndcg@5 : 0.8565    ndcg@10 : 0.8602    hit@5 : 0.8698    hit@10 : 0.8812    precision@5 : 0.174    precision@10 : 0.0881

Train    29:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    29:   9%|████▋                                              | 1/11 [00:00<00:01,  9.16it/s]
Train    29:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.06it/s]
Train    29:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.19it/s]
Train    29:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.91it/s]
Train    29:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.96it/s]
Train    29:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.02it/s]
Train    29:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.93it/s]
Train    29:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.91it/s]
Train    29:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.93it/s]
Train    29:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.50it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.77it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.87it/s]
13 Oct 03:23    INFO  epoch 29 training [time: 1.24s, train loss: 11.2749]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.62it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.42it/s]
13 Oct 03:23    INFO  epoch 29 evaluating [time: 0.12s, valid_score: 0.857200]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8689    recall@10 : 0.8821    mrr@5 : 0.8554    mrr@10 : 0.8572    ndcg@5 : 0.8588    ndcg@10 : 0.8631    hit@5 : 0.8689    hit@10 : 0.8821    precision@5 : 0.1738    precision@10 : 0.0882

Train    30:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    30:   9%|████▋                                              | 1/11 [00:00<00:01,  8.94it/s]
Train    30:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.10it/s]
Train    30:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.12it/s]
Train    30:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.51it/s]
Train    30:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.29it/s]
Train    30:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.88it/s]
Train    30:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.23it/s]
Train    30:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.54it/s]
Train    30:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.70it/s]
Train    30:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.87it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.00it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.40it/s]
13 Oct 03:23    INFO  epoch 30 training [time: 1.31s, train loss: 11.0674]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.01it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.84it/s]
13 Oct 03:23    INFO  epoch 30 evaluating [time: 0.14s, valid_score: 0.858200]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8694    recall@10 : 0.8816    mrr@5 : 0.8566    mrr@10 : 0.8582    ndcg@5 : 0.8599    ndcg@10 : 0.8637    hit@5 : 0.8694    hit@10 : 0.8816    precision@5 : 0.1739    precision@10 : 0.0882
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    31:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    31:   9%|████▋                                              | 1/11 [00:00<00:01,  8.91it/s]
Train    31:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.10it/s]
Train    31:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.16it/s]
Train    31:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.14it/s]
Train    31:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.85it/s]
Train    31:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.73it/s]
Train    31:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.76it/s]
Train    31:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.82it/s]
Train    31:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.57it/s]
Train    31:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.45it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.45it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.69it/s]
13 Oct 03:23    INFO  epoch 31 training [time: 1.27s, train loss: 10.2525]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  9.92it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 17.81it/s]
13 Oct 03:23    INFO  epoch 31 evaluating [time: 0.19s, valid_score: 0.858600]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8712    recall@10 : 0.8839    mrr@5 : 0.857    mrr@10 : 0.8586    ndcg@5 : 0.8606    ndcg@10 : 0.8646    hit@5 : 0.8712    hit@10 : 0.8839    precision@5 : 0.1742    precision@10 : 0.0884
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    32:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    32:   9%|████▋                                              | 1/11 [00:00<00:01,  7.41it/s]
Train    32:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.37it/s]
Train    32:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.75it/s]
Train    32:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.85it/s]
Train    32:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.92it/s]
Train    32:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.70it/s]
Train    32:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.43it/s]
Train    32:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.02it/s]
Train    32:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.90it/s]
Train    32:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.00it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.18it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.30it/s]
13 Oct 03:23    INFO  epoch 32 training [time: 1.33s, train loss: 11.0095]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.05it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.91it/s]
13 Oct 03:23    INFO  epoch 32 evaluating [time: 0.14s, valid_score: 0.858100]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8712    recall@10 : 0.8834    mrr@5 : 0.8564    mrr@10 : 0.8581    ndcg@5 : 0.8601    ndcg@10 : 0.8641    hit@5 : 0.8712    hit@10 : 0.8834    precision@5 : 0.1742    precision@10 : 0.0883

Train    33:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    33:   9%|████▋                                              | 1/11 [00:00<00:01,  9.09it/s]
Train    33:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.09it/s]
Train    33:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.96it/s]
Train    33:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.00it/s]
Train    33:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.06it/s]
Train    33:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.60it/s]
Train    33:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.94it/s]
Train    33:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.21it/s]
Train    33:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.37it/s]
Train    33:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.36it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.15it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.44it/s]
13 Oct 03:23    INFO  epoch 33 training [time: 1.31s, train loss: 10.0090]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  9.63it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 15.78it/s]
13 Oct 03:23    INFO  epoch 33 evaluating [time: 0.21s, valid_score: 0.856300]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8698    recall@10 : 0.8844    mrr@5 : 0.8543    mrr@10 : 0.8563    ndcg@5 : 0.8582    ndcg@10 : 0.8629    hit@5 : 0.8698    hit@10 : 0.8844    precision@5 : 0.174    precision@10 : 0.0884

Train    34:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    34:   9%|████▋                                              | 1/11 [00:00<00:01,  8.75it/s]
Train    34:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.58it/s]
Train    34:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.85it/s]
Train    34:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.69it/s]
Train    34:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.11it/s]
Train    34:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.34it/s]
Train    34:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.50it/s]
Train    34:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.64it/s]
Train    34:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.78it/s]
Train    34:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.88it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.12it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.31it/s]
13 Oct 03:23    INFO  epoch 34 training [time: 1.32s, train loss: 9.2744]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.73it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.55it/s]
13 Oct 03:23    INFO  epoch 34 evaluating [time: 0.15s, valid_score: 0.857600]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8717    recall@10 : 0.8816    mrr@5 : 0.8563    mrr@10 : 0.8576    ndcg@5 : 0.8602    ndcg@10 : 0.8634    hit@5 : 0.8717    hit@10 : 0.8816    precision@5 : 0.1743    precision@10 : 0.0882

Train    35:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    35:   9%|████▋                                              | 1/11 [00:00<00:01,  8.80it/s]
Train    35:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.92it/s]
Train    35:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.03it/s]
Train    35:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.86it/s]
Train    35:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.83it/s]
Train    35:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.82it/s]
Train    35:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.73it/s]
Train    35:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.76it/s]
Train    35:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.76it/s]
Train    35:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.62it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.38it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.67it/s]
13 Oct 03:23    INFO  epoch 35 training [time: 1.27s, train loss: 11.0407]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.60it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.23it/s]
13 Oct 03:23    INFO  epoch 35 evaluating [time: 0.13s, valid_score: 0.858500]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8721    recall@10 : 0.8821    mrr@5 : 0.8572    mrr@10 : 0.8585    ndcg@5 : 0.861    ndcg@10 : 0.8641    hit@5 : 0.8721    hit@10 : 0.8821    precision@5 : 0.1744    precision@10 : 0.0882

Train    36:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    36:   9%|████▋                                              | 1/11 [00:00<00:01,  8.86it/s]
Train    36:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.97it/s]
Train    36:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.02it/s]
Train    36:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.89it/s]
Train    36:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.78it/s]
Train    36:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.50it/s]
Train    36:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.12it/s]
Train    36:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.28it/s]
Train    36:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.48it/s]
Train    36:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.54it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.72it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.62it/s]
13 Oct 03:23    INFO  epoch 36 training [time: 1.28s, train loss: 10.9153]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.43it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.25it/s]
13 Oct 03:23    INFO  epoch 36 evaluating [time: 0.15s, valid_score: 0.861500]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8721    recall@10 : 0.8825    mrr@5 : 0.8602    mrr@10 : 0.8615    ndcg@5 : 0.8632    ndcg@10 : 0.8665    hit@5 : 0.8721    hit@10 : 0.8825    precision@5 : 0.1744    precision@10 : 0.0883
13 Oct 03:23    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    37:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    37:   9%|████▋                                              | 1/11 [00:00<00:01,  8.80it/s]
Train    37:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.77it/s]
Train    37:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.76it/s]
Train    37:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.72it/s]
Train    37:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.78it/s]
Train    37:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.55it/s]
Train    37:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.33it/s]
Train    37:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.19it/s]
Train    37:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.30it/s]
Train    37:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.44it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.79it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.59it/s]
13 Oct 03:23    INFO  epoch 37 training [time: 1.28s, train loss: 10.4233]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.03it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.97it/s]
13 Oct 03:23    INFO  epoch 37 evaluating [time: 0.12s, valid_score: 0.860400]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8707    recall@10 : 0.8839    mrr@5 : 0.8587    mrr@10 : 0.8604    ndcg@5 : 0.8617    ndcg@10 : 0.8659    hit@5 : 0.8707    hit@10 : 0.8839    precision@5 : 0.1741    precision@10 : 0.0884

Train    38:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    38:   9%|████▋                                              | 1/11 [00:00<00:01,  8.76it/s]
Train    38:  18%|█████████▎                                         | 2/11 [00:00<00:01,  9.00it/s]
Train    38:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.85it/s]
Train    38:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  5.96it/s]
Train    38:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.84it/s]
Train    38:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.50it/s]
Train    38:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.99it/s]
Train    38:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.30it/s]
Train    38:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.45it/s]
Train    38:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.56it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.71it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.07it/s]
13 Oct 03:23    INFO  epoch 38 training [time: 1.36s, train loss: 10.5093]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.56it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.78it/s]
13 Oct 03:23    INFO  epoch 38 evaluating [time: 0.12s, valid_score: 0.860600]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8721    recall@10 : 0.8853    mrr@5 : 0.8589    mrr@10 : 0.8606    ndcg@5 : 0.8622    ndcg@10 : 0.8663    hit@5 : 0.8721    hit@10 : 0.8853    precision@5 : 0.1744    precision@10 : 0.0885

Train    39:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    39:   9%|████▋                                              | 1/11 [00:00<00:01,  8.30it/s]
Train    39:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.78it/s]
Train    39:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.98it/s]
Train    39:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.08it/s]
Train    39:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.14it/s]
Train    39:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.20it/s]
Train    39:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.25it/s]
Train    39:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.22it/s]
Train    39:  82%|█████████████████████████████████████████▋         | 9/11 [00:00<00:00,  9.23it/s]
Train    39:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.20it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.30it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.16it/s]
13 Oct 03:23    INFO  epoch 39 training [time: 1.20s, train loss: 10.0208]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.51it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.45it/s]
13 Oct 03:23    INFO  epoch 39 evaluating [time: 0.12s, valid_score: 0.860900]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8712    recall@10 : 0.8848    mrr@5 : 0.8592    mrr@10 : 0.8609    ndcg@5 : 0.8622    ndcg@10 : 0.8665    hit@5 : 0.8712    hit@10 : 0.8848    precision@5 : 0.1742    precision@10 : 0.0885

Train    40:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    40:   9%|████▋                                              | 1/11 [00:00<00:01,  8.99it/s]
Train    40:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.02it/s]
Train    40:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.01it/s]
Train    40:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.06it/s]
Train    40:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.07it/s]
Train    40:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.01it/s]
Train    40:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.05it/s]
Train    40:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.01it/s]
Train    40:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.88it/s]
Train    40:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.83it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.95it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.97it/s]
13 Oct 03:23    INFO  epoch 40 training [time: 1.23s, train loss: 10.4824]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.70it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.27it/s]
13 Oct 03:23    INFO  epoch 40 evaluating [time: 0.13s, valid_score: 0.861300]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8726    recall@10 : 0.8848    mrr@5 : 0.8597    mrr@10 : 0.8613    ndcg@5 : 0.8629    ndcg@10 : 0.8669    hit@5 : 0.8726    hit@10 : 0.8848    precision@5 : 0.1745    precision@10 : 0.0885

Train    41:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    41:   9%|████▋                                              | 1/11 [00:00<00:01,  7.91it/s]
Train    41:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.92it/s]
Train    41:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.39it/s]
Train    41:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.61it/s]
Train    41:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.80it/s]
Train    41:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.92it/s]
Train    41:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.95it/s]
Train    41:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.98it/s]
Train    41:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  9.03it/s]
Train    41:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.91it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.90it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.78it/s]
13 Oct 03:23    INFO  epoch 41 training [time: 1.25s, train loss: 9.7959]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.15it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.76it/s]
13 Oct 03:23    INFO  epoch 41 evaluating [time: 0.14s, valid_score: 0.860000]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8744    recall@10 : 0.8857    mrr@5 : 0.8585    mrr@10 : 0.86    ndcg@5 : 0.8625    ndcg@10 : 0.8661    hit@5 : 0.8744    hit@10 : 0.8857    precision@5 : 0.1749    precision@10 : 0.0886

Train    42:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    42:   9%|████▋                                              | 1/11 [00:00<00:01,  8.91it/s]
Train    42:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.45it/s]
Train    42:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.69it/s]
Train    42:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.40it/s]
Train    42:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.74it/s]
Train    42:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.79it/s]
Train    42:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.98it/s]
Train    42:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.00it/s]
Train    42:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.00it/s]
Train    42:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.14it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.38it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.34it/s]
13 Oct 03:23    INFO  epoch 42 training [time: 1.50s, train loss: 11.1963]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 10.88it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 15.46it/s]
13 Oct 03:23    INFO  epoch 42 evaluating [time: 0.20s, valid_score: 0.859600]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8721    recall@10 : 0.883    mrr@5 : 0.8581    mrr@10 : 0.8596    ndcg@5 : 0.8616    ndcg@10 : 0.8651    hit@5 : 0.8721    hit@10 : 0.883    precision@5 : 0.1744    precision@10 : 0.0883

Train    43:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    43:   9%|████▋                                              | 1/11 [00:00<00:01,  8.34it/s]
Train    43:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.54it/s]
Train    43:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.47it/s]
Train    43:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.49it/s]
Train    43:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.99it/s]
Train    43:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.34it/s]
Train    43:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.75it/s]
Train    43:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.11it/s]
Train    43:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.38it/s]
Train    43:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.55it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.78it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.32it/s]
13 Oct 03:23    INFO  epoch 43 training [time: 1.32s, train loss: 10.2560]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.71it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.77it/s]
13 Oct 03:23    INFO  epoch 43 evaluating [time: 0.15s, valid_score: 0.860700]
13 Oct 03:23    INFO  valid result: 
recall@5 : 0.8717    recall@10 : 0.8848    mrr@5 : 0.859    mrr@10 : 0.8607    ndcg@5 : 0.8622    ndcg@10 : 0.8664    hit@5 : 0.8717    hit@10 : 0.8848    precision@5 : 0.1743    precision@10 : 0.0885

Train    44:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    44:   9%|████▋                                              | 1/11 [00:00<00:01,  7.21it/s]
Train    44:  18%|█████████▎                                         | 2/11 [00:00<00:01,  6.89it/s]
Train    44:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.57it/s]
Train    44:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.98it/s]
Train    44:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.22it/s]
Train    44:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.37it/s]
Train    44:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.53it/s]
Train    44:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.31it/s]
Train    44:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.07it/s]
Train    44:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.75it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.96it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.97it/s]
13 Oct 03:24    INFO  epoch 44 training [time: 1.38s, train loss: 9.9727]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.03it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.55it/s]
13 Oct 03:24    INFO  epoch 44 evaluating [time: 0.15s, valid_score: 0.861100]
13 Oct 03:24    INFO  valid result: 
recall@5 : 0.8739    recall@10 : 0.8857    mrr@5 : 0.8596    mrr@10 : 0.8611    ndcg@5 : 0.8632    ndcg@10 : 0.8669    hit@5 : 0.8739    hit@10 : 0.8857    precision@5 : 0.1748    precision@10 : 0.0886

Train    45:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    45:   9%|████▋                                              | 1/11 [00:00<00:01,  7.92it/s]
Train    45:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.29it/s]
Train    45:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.52it/s]
Train    45:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.63it/s]
Train    45:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.57it/s]
Train    45:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.38it/s]
Train    45:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.35it/s]
Train    45:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.28it/s]
Train    45:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.38it/s]
Train    45:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.47it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.73it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.50it/s]
13 Oct 03:24    INFO  epoch 45 training [time: 1.30s, train loss: 9.9274]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.32it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.53it/s]
13 Oct 03:24    INFO  epoch 45 evaluating [time: 0.14s, valid_score: 0.861700]
13 Oct 03:24    INFO  valid result: 
recall@5 : 0.8726    recall@10 : 0.8862    mrr@5 : 0.86    mrr@10 : 0.8617    ndcg@5 : 0.8632    ndcg@10 : 0.8675    hit@5 : 0.8726    hit@10 : 0.8862    precision@5 : 0.1745    precision@10 : 0.0886
13 Oct 03:24    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Train    46:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    46:   9%|████▋                                              | 1/11 [00:00<00:01,  8.76it/s]
Train    46:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.84it/s]
Train    46:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.64it/s]
Train    46:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.66it/s]
Train    46:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.46it/s]
Train    46:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.13it/s]
Train    46:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.49it/s]
Train    46:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.75it/s]
Train    46:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.86it/s]
Train    46:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.02it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.32it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.92it/s]
13 Oct 03:24    INFO  epoch 46 training [time: 1.39s, train loss: 9.9006]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.11it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.55it/s]
13 Oct 03:24    INFO  epoch 46 evaluating [time: 0.14s, valid_score: 0.861600]
13 Oct 03:24    INFO  valid result: 
recall@5 : 0.8707    recall@10 : 0.883    mrr@5 : 0.86    mrr@10 : 0.8616    ndcg@5 : 0.8627    ndcg@10 : 0.8667    hit@5 : 0.8707    hit@10 : 0.883    precision@5 : 0.1741    precision@10 : 0.0883

Train    47:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    47:   9%|████▋                                              | 1/11 [00:00<00:01,  8.35it/s]
Train    47:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.40it/s]
Train    47:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.50it/s]
Train    47:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.72it/s]
Train    47:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.79it/s]
Train    47:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.86it/s]
Train    47:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.83it/s]
Train    47:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.74it/s]
Train    47:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.76it/s]
Train    47:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.70it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.82it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.74it/s]
13 Oct 03:24    INFO  epoch 47 training [time: 1.26s, train loss: 9.8737]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.20it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.10it/s]
13 Oct 03:24    INFO  epoch 47 evaluating [time: 0.15s, valid_score: 0.860100]
13 Oct 03:24    INFO  valid result: 
recall@5 : 0.8739    recall@10 : 0.8853    mrr@5 : 0.8586    mrr@10 : 0.8601    ndcg@5 : 0.8625    ndcg@10 : 0.8661    hit@5 : 0.8739    hit@10 : 0.8853    precision@5 : 0.1748    precision@10 : 0.0885

Train    48:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    48:   9%|████▋                                              | 1/11 [00:00<00:01,  8.82it/s]
Train    48:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.50it/s]
Train    48:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.58it/s]
Train    48:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.49it/s]
Train    48:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.69it/s]
Train    48:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.84it/s]
Train    48:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.78it/s]
Train    48:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.52it/s]
Train    48:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.42it/s]
Train    48:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.34it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.42it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.53it/s]
13 Oct 03:24    INFO  epoch 48 training [time: 1.29s, train loss: 9.8130]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.72it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.22it/s]
13 Oct 03:24    INFO  epoch 48 evaluating [time: 0.14s, valid_score: 0.859800]
13 Oct 03:24    INFO  valid result: 
recall@5 : 0.8748    recall@10 : 0.8862    mrr@5 : 0.8583    mrr@10 : 0.8598    ndcg@5 : 0.8624    ndcg@10 : 0.8661    hit@5 : 0.8748    hit@10 : 0.8862    precision@5 : 0.175    precision@10 : 0.0886

Train    49:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    49:   9%|████▋                                              | 1/11 [00:00<00:01,  8.31it/s]
Train    49:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.26it/s]
Train    49:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.31it/s]
Train    49:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.39it/s]
Train    49:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.49it/s]
Train    49:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.54it/s]
Train    49:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.64it/s]
Train    49:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.73it/s]
Train    49:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.66it/s]
Train    49:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.64it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.60it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.55it/s]
13 Oct 03:24    INFO  epoch 49 training [time: 1.29s, train loss: 10.0372]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.43it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.57it/s]
13 Oct 03:24    INFO  epoch 49 evaluating [time: 0.14s, valid_score: 0.859400]
13 Oct 03:24    INFO  valid result: 
recall@5 : 0.8739    recall@10 : 0.8821    mrr@5 : 0.8583    mrr@10 : 0.8594    ndcg@5 : 0.8622    ndcg@10 : 0.8648    hit@5 : 0.8739    hit@10 : 0.8821    precision@5 : 0.1748    precision@10 : 0.0882
13 Oct 03:24    INFO  Loading model structure and parameters from saved/BERT4Rec-Oct-13-2025_03-22-54.pth

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  5.91it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 12.26it/s]
13 Oct 03:24    INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |    12.60 %     |
+-------------+----------------+
| GPU         |   0.0 / 0.0    |
+-------------+----------------+
| Memory      | 1.22 G/15.33 G |
+-------------+----------------+
13 Oct 03:24    INFO  best valid : OrderedDict({'recall@5': 0.8726, 'recall@10': 0.8862, 'mrr@5': 0.86, 'mrr@10': 0.8617, 'ndcg@5': 0.8632, 'ndcg@10': 0.8675, 'hit@5': 0.8726, 'hit@10': 0.8862, 'precision@5': 0.1745, 'precision@10': 0.0886})
13 Oct 03:24    INFO  test result: OrderedDict({'recall@5': 0.9761, 'recall@10': 0.9809, 'mrr@5': 0.9552, 'mrr@10': 0.9558, 'ndcg@5': 0.9605, 'ndcg@10': 0.962, 'hit@5': 0.9761, 'hit@10': 0.9809, 'precision@5': 0.1952, 'precision@10': 0.0981})
2025-10-13 03:24:11,737 | INFO | Published checkpoint /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/saved/BERT4Rec-Oct-13-2025_03-22-54.pth → /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/versions/BERT4Rec-Oct-13-2025_03-22-54.pth
2025-10-13 03:24:11,738 | INFO | Retraining completed in 0:01:29.754371 | dataset=20251012-202243 | model=Oct-13-2025_03-22-54
2025-10-13 03:24:41,741 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:24:42,560 | INFO | 🔄 Đang trích xuất data từ Postgres...
🐘 Đã trích xuất bằng psycopg.
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 53
Số user: 1
Số sản phẩm: 10
Các loại event: {'add_to_cart': 0.453, 'view': 0.358, 'purchase': 0.189}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[10 rows x 5 columns]
2025-10-13 03:24:42,560 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:24:43,124 | INFO | 🗂  Đã cập nhật /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/interactions.csv (tổng 18331 bản ghi).
✅ Đã tạo snapshot 20251012-202443 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-202443/ecommerce.inter) với 18331 dòng
👥  User: 2607 | 🛒  Sản phẩm: 105
🏷️   Nhãn mua hàng (label=1): 2986
      user_id item_id   timestamp  label
4952        3      25  1704067200      0
4953        3      25  1704068520      0
18222       3      89  1707264000      0
18223       3      89  1707264300      0
18224       3      89  1707265440      0
18225       3      89  1707266820      1
1123        3      12  1708041600      0
1124        3      12  1708044480      0
10396       4       4  1707436800      0
10397       4       4  1707437100      0
2025-10-13 03:24:43,124 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-193417
2025-10-13 03:24:43,124 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 03:26:04,645 | INFO | 13 Oct 03:24    INFO  ['train_bert4rec.py']
13 Oct 03:24    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = False
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
device = cuda
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 03:24    INFO  ecommerce
The number of users: 2607
Average actions of users: 7.034151957022257
The number of items: 96
Average actions of items: 192.9578947368421
The number of inters: 18331
The sparsity of the dataset: 92.67556898094873%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 03:24    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 03:24    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 03:24    INFO  BERT4Rec(
  (item_embedding): Embedding(97, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 113888
13 Oct 03:24    INFO  FLOPs: 5194664.0
🔧 Sử dụng topk=[5, 10], valid_metric=MRR@10, device=cpu

Train     0:   0%|                                                           | 0/11 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   9%|████▋                                              | 1/11 [00:00<00:02,  3.51it/s]
Train     0:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.41it/s]
Train     0:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.64it/s]
Train     0:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.96it/s]
Train     0:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.46it/s]
Train     0:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.21it/s]
Train     0:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  6.97it/s]
Train     0:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.00it/s]
Train     0:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.45it/s]
Train     0:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.27it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.79it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.01it/s]
13 Oct 03:24    INFO  epoch 0 training [time: 1.57s, train loss: 49.8531]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.41it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.37it/s]
13 Oct 03:24    INFO  epoch 0 evaluating [time: 0.17s, valid_score: 0.064000]
13 Oct 03:24    INFO  valid result: 
recall@5 : 0.1024    recall@10 : 0.1944    mrr@5 : 0.0521    mrr@10 : 0.064    ndcg@5 : 0.0646    ndcg@10 : 0.0939    hit@5 : 0.1024    hit@10 : 0.1944    precision@5 : 0.0205    precision@10 : 0.0194
13 Oct 03:24    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train     1:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     1:   9%|████▋                                              | 1/11 [00:00<00:01,  8.85it/s]
Train     1:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.96it/s]
Train     1:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.93it/s]
Train     1:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.85it/s]
Train     1:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.53it/s]
Train     1:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.70it/s]
Train     1:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.87it/s]
Train     1:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.80it/s]
Train     1:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.71it/s]
Train     1:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.78it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.94it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.83it/s]
13 Oct 03:24    INFO  epoch 1 training [time: 1.25s, train loss: 48.9040]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 27.63it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 27.56it/s]
13 Oct 03:24    INFO  epoch 1 evaluating [time: 0.12s, valid_score: 0.098300]
13 Oct 03:24    INFO  valid result: 
recall@5 : 0.1776    recall@10 : 0.2923    mrr@5 : 0.0833    mrr@10 : 0.0983    ndcg@5 : 0.1062    ndcg@10 : 0.143    hit@5 : 0.1776    hit@10 : 0.2923    precision@5 : 0.0355    precision@10 : 0.0292
13 Oct 03:24    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train     2:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     2:   9%|████▋                                              | 1/11 [00:00<00:01,  8.81it/s]
Train     2:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.78it/s]
Train     2:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.78it/s]
Train     2:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.89it/s]
Train     2:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.06it/s]
Train     2:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.97it/s]
Train     2:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.96it/s]
Train     2:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.91it/s]
Train     2:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.76it/s]
Train     2:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.34it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.86it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.20it/s]
13 Oct 03:24    INFO  epoch 2 training [time: 1.34s, train loss: 46.6735]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.36it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.24it/s]
13 Oct 03:24    INFO  epoch 2 evaluating [time: 0.14s, valid_score: 0.298100]
13 Oct 03:24    INFO  valid result: 
recall@5 : 0.4703    recall@10 : 0.5773    mrr@5 : 0.284    mrr@10 : 0.2981    ndcg@5 : 0.3305    ndcg@10 : 0.3649    hit@5 : 0.4703    hit@10 : 0.5773    precision@5 : 0.0941    precision@10 : 0.0577
13 Oct 03:24    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train     3:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     3:   9%|████▋                                              | 1/11 [00:00<00:01,  8.73it/s]
Train     3:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.83it/s]
Train     3:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.88it/s]
Train     3:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.97it/s]
Train     3:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.94it/s]
Train     3:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.06it/s]
Train     3:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.07it/s]
Train     3:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.09it/s]
Train     3:  82%|█████████████████████████████████████████▋         | 9/11 [00:00<00:00,  9.16it/s]
Train     3:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.13it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.20it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.07it/s]
13 Oct 03:24    INFO  epoch 3 training [time: 1.21s, train loss: 42.5607]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.27it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.33it/s]
13 Oct 03:24    INFO  epoch 3 evaluating [time: 0.12s, valid_score: 0.487900]
13 Oct 03:24    INFO  valid result: 
recall@5 : 0.6248    recall@10 : 0.6923    mrr@5 : 0.4788    mrr@10 : 0.4879    ndcg@5 : 0.5155    ndcg@10 : 0.5375    hit@5 : 0.6248    hit@10 : 0.6923    precision@5 : 0.125    precision@10 : 0.0692
13 Oct 03:24    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train     4:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     4:   9%|████▋                                              | 1/11 [00:00<00:01,  8.99it/s]
Train     4:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.13it/s]
Train     4:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.16it/s]
Train     4:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.22it/s]
Train     4:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.06it/s]
Train     4:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.14it/s]
Train     4:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.19it/s]
Train     4:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.23it/s]
Train     4:  82%|█████████████████████████████████████████▋         | 9/11 [00:00<00:00,  9.14it/s]
Train     4:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.15it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.29it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.19it/s]
13 Oct 03:24    INFO  epoch 4 training [time: 1.20s, train loss: 38.4274]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 27.33it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 27.24it/s]
13 Oct 03:24    INFO  epoch 4 evaluating [time: 0.12s, valid_score: 0.602900]
13 Oct 03:24    INFO  valid result: 
recall@5 : 0.7091    recall@10 : 0.758    mrr@5 : 0.5963    mrr@10 : 0.6029    ndcg@5 : 0.6247    ndcg@10 : 0.6406    hit@5 : 0.7091    hit@10 : 0.758    precision@5 : 0.1418    precision@10 : 0.0758
13 Oct 03:24    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train     5:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     5:   9%|████▋                                              | 1/11 [00:00<00:01,  8.73it/s]
Train     5:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.86it/s]
Train     5:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.93it/s]
Train     5:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.06it/s]
Train     5:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.13it/s]
Train     5:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.17it/s]
Train     5:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.19it/s]
Train     5:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.24it/s]
Train     5:  82%|█████████████████████████████████████████▋         | 9/11 [00:00<00:00,  9.09it/s]
Train     5:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.02it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.08it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.08it/s]
13 Oct 03:24    INFO  epoch 5 training [time: 1.21s, train loss: 34.9556]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.05it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.98it/s]
13 Oct 03:24    INFO  epoch 5 evaluating [time: 0.13s, valid_score: 0.659300]
13 Oct 03:24    INFO  valid result: 
recall@5 : 0.7367    recall@10 : 0.7848    mrr@5 : 0.6529    mrr@10 : 0.6593    ndcg@5 : 0.674    ndcg@10 : 0.6895    hit@5 : 0.7367    hit@10 : 0.7848    precision@5 : 0.1473    precision@10 : 0.0785
13 Oct 03:24    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train     6:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     6:   9%|████▋                                              | 1/11 [00:00<00:01,  8.85it/s]
Train     6:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.05it/s]
Train     6:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.10it/s]
Train     6:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.00it/s]
Train     6:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.95it/s]
Train     6:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.99it/s]
Train     6:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.02it/s]
Train     6:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.08it/s]
Train     6:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.03it/s]
Train     6:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.59it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.98it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.34it/s]
13 Oct 03:24    INFO  epoch 6 training [time: 1.32s, train loss: 31.7279]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.05it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.63it/s]
13 Oct 03:24    INFO  epoch 6 evaluating [time: 0.18s, valid_score: 0.690400]
13 Oct 03:24    INFO  valid result: 
recall@5 : 0.7621    recall@10 : 0.8056    mrr@5 : 0.6847    mrr@10 : 0.6904    ndcg@5 : 0.7041    ndcg@10 : 0.7181    hit@5 : 0.7621    hit@10 : 0.8056    precision@5 : 0.1524    precision@10 : 0.0806
13 Oct 03:24    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train     7:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     7:   9%|████▋                                              | 1/11 [00:00<00:01,  7.94it/s]
Train     7:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.60it/s]
Train     7:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.03it/s]
Train     7:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.40it/s]
Train     7:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.55it/s]
Train     7:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.41it/s]
Train     7:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.50it/s]
Train     7:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.29it/s]
Train     7:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.38it/s]
Train     7:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.52it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.68it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.47it/s]
13 Oct 03:25    INFO  epoch 7 training [time: 1.30s, train loss: 28.7148]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.05it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.62it/s]
13 Oct 03:25    INFO  epoch 7 evaluating [time: 0.15s, valid_score: 0.728700]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.7875    recall@10 : 0.8215    mrr@5 : 0.7241    mrr@10 : 0.7287    ndcg@5 : 0.74    ndcg@10 : 0.7511    hit@5 : 0.7875    hit@10 : 0.8215    precision@5 : 0.1575    precision@10 : 0.0821
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train     8:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     8:   9%|████▋                                              | 1/11 [00:00<00:01,  8.86it/s]
Train     8:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.83it/s]
Train     8:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.28it/s]
Train     8:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.45it/s]
Train     8:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.52it/s]
Train     8:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.30it/s]
Train     8:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.09it/s]
Train     8:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.40it/s]
Train     8:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.42it/s]
Train     8:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.53it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.84it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.49it/s]
13 Oct 03:25    INFO  epoch 8 training [time: 1.30s, train loss: 25.7991]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.24it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.28it/s]
13 Oct 03:25    INFO  epoch 8 evaluating [time: 0.13s, valid_score: 0.763500]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8133    recall@10 : 0.8469    mrr@5 : 0.7588    mrr@10 : 0.7635    ndcg@5 : 0.7725    ndcg@10 : 0.7835    hit@5 : 0.8133    hit@10 : 0.8469    precision@5 : 0.1627    precision@10 : 0.0847
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train     9:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     9:   9%|████▋                                              | 1/11 [00:00<00:01,  8.62it/s]
Train     9:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.78it/s]
Train     9:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.83it/s]
Train     9:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.45it/s]
Train     9:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.24it/s]
Train     9:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.24it/s]
Train     9:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.33it/s]
Train     9:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.43it/s]
Train     9:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.51it/s]
Train     9:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.57it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.74it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.54it/s]
13 Oct 03:25    INFO  epoch 9 training [time: 1.29s, train loss: 23.1023]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.57it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.16it/s]
13 Oct 03:25    INFO  epoch 9 evaluating [time: 0.16s, valid_score: 0.782000]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8233    recall@10 : 0.8527    mrr@5 : 0.7781    mrr@10 : 0.782    ndcg@5 : 0.7895    ndcg@10 : 0.799    hit@5 : 0.8233    hit@10 : 0.8527    precision@5 : 0.1647    precision@10 : 0.0853
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    10:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    10:   9%|████▋                                              | 1/11 [00:00<00:01,  8.94it/s]
Train    10:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.92it/s]
Train    10:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.41it/s]
Train    10:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.28it/s]
Train    10:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.89it/s]
Train    10:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.23it/s]
Train    10:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.47it/s]
Train    10:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.63it/s]
Train    10:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.65it/s]
Train    10:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.78it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.96it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.37it/s]
13 Oct 03:25    INFO  epoch 10 training [time: 1.32s, train loss: 21.0377]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.01it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.59it/s]
13 Oct 03:25    INFO  epoch 10 evaluating [time: 0.13s, valid_score: 0.800000]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8351    recall@10 : 0.8591    mrr@5 : 0.7969    mrr@10 : 0.8    ndcg@5 : 0.8065    ndcg@10 : 0.8142    hit@5 : 0.8351    hit@10 : 0.8591    precision@5 : 0.167    precision@10 : 0.0859
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    11:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    11:   9%|████▋                                              | 1/11 [00:00<00:01,  9.14it/s]
Train    11:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.20it/s]
Train    11:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.96it/s]
Train    11:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.91it/s]
Train    11:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.86it/s]
Train    11:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.83it/s]
Train    11:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.94it/s]
Train    11:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.03it/s]
Train    11:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  9.01it/s]
Train    11:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.08it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.21it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.04it/s]
13 Oct 03:25    INFO  epoch 11 training [time: 1.22s, train loss: 19.1399]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 28.47it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 28.40it/s]
13 Oct 03:25    INFO  epoch 11 evaluating [time: 0.11s, valid_score: 0.823000]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8459    recall@10 : 0.8677    mrr@5 : 0.8201    mrr@10 : 0.823    ndcg@5 : 0.8266    ndcg@10 : 0.8337    hit@5 : 0.8459    hit@10 : 0.8677    precision@5 : 0.1692    precision@10 : 0.0868
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    12:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    12:   9%|████▋                                              | 1/11 [00:00<00:01,  8.48it/s]
Train    12:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.52it/s]
Train    12:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.59it/s]
Train    12:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.67it/s]
Train    12:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.83it/s]
Train    12:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.94it/s]
Train    12:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.98it/s]
Train    12:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.07it/s]
Train    12:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  9.07it/s]
Train    12:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.07it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.01it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.91it/s]
13 Oct 03:25    INFO  epoch 12 training [time: 1.23s, train loss: 16.8492]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 27.99it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 27.89it/s]
13 Oct 03:25    INFO  epoch 12 evaluating [time: 0.11s, valid_score: 0.828400]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8505    recall@10 : 0.8686    mrr@5 : 0.8261    mrr@10 : 0.8284    ndcg@5 : 0.8323    ndcg@10 : 0.8379    hit@5 : 0.8505    hit@10 : 0.8686    precision@5 : 0.1701    precision@10 : 0.0869
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    13:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    13:   9%|████▋                                              | 1/11 [00:00<00:01,  8.97it/s]
Train    13:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.04it/s]
Train    13:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.09it/s]
Train    13:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.11it/s]
Train    13:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.80it/s]
Train    13:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.82it/s]
Train    13:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.78it/s]
Train    13:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.83it/s]
Train    13:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.84it/s]
Train    13:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.91it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.04it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.94it/s]
13 Oct 03:25    INFO  epoch 13 training [time: 1.23s, train loss: 15.7909]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  6.66it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 13.45it/s]
13 Oct 03:25    INFO  epoch 13 evaluating [time: 0.23s, valid_score: 0.838400]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8564    recall@10 : 0.8727    mrr@5 : 0.8364    mrr@10 : 0.8384    ndcg@5 : 0.8414    ndcg@10 : 0.8466    hit@5 : 0.8564    hit@10 : 0.8727    precision@5 : 0.1713    precision@10 : 0.0873
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    14:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    14:   9%|████▋                                              | 1/11 [00:00<00:01,  8.50it/s]
Train    14:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.65it/s]
Train    14:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.77it/s]
Train    14:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.75it/s]
Train    14:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.82it/s]
Train    14:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.81it/s]
Train    14:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.78it/s]
Train    14:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.79it/s]
Train    14:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.79it/s]
Train    14:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.82it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.03it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.85it/s]
13 Oct 03:25    INFO  epoch 14 training [time: 1.24s, train loss: 15.1716]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.61it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.31it/s]
13 Oct 03:25    INFO  epoch 14 evaluating [time: 0.13s, valid_score: 0.844900]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8632    recall@10 : 0.879    mrr@5 : 0.8428    mrr@10 : 0.8449    ndcg@5 : 0.8479    ndcg@10 : 0.853    hit@5 : 0.8632    hit@10 : 0.879    precision@5 : 0.1726    precision@10 : 0.0879
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    15:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    15:   9%|████▋                                              | 1/11 [00:00<00:01,  8.78it/s]
Train    15:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.99it/s]
Train    15:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.11it/s]
Train    15:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.83it/s]
Train    15:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.76it/s]
Train    15:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.70it/s]
Train    15:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.79it/s]
Train    15:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.73it/s]
Train    15:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.64it/s]
Train    15:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.50it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.50it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.68it/s]
13 Oct 03:25    INFO  epoch 15 training [time: 1.27s, train loss: 13.7629]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.10it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.58it/s]
13 Oct 03:25    INFO  epoch 15 evaluating [time: 0.14s, valid_score: 0.844000]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8614    recall@10 : 0.8749    mrr@5 : 0.8423    mrr@10 : 0.844    ndcg@5 : 0.8471    ndcg@10 : 0.8514    hit@5 : 0.8614    hit@10 : 0.8749    precision@5 : 0.1723    precision@10 : 0.0875

Train    16:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    16:   9%|████▋                                              | 1/11 [00:00<00:01,  8.40it/s]
Train    16:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.54it/s]
Train    16:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.70it/s]
Train    16:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.84it/s]
Train    16:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.91it/s]
Train    16:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.81it/s]
Train    16:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.77it/s]
Train    16:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.84it/s]
Train    16:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.85it/s]
Train    16:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.89it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.97it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.84it/s]
13 Oct 03:25    INFO  epoch 16 training [time: 1.25s, train loss: 13.3826]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.38it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.27it/s]
13 Oct 03:25    INFO  epoch 16 evaluating [time: 0.13s, valid_score: 0.848100]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8645    recall@10 : 0.8781    mrr@5 : 0.8463    mrr@10 : 0.8481    ndcg@5 : 0.8509    ndcg@10 : 0.8552    hit@5 : 0.8645    hit@10 : 0.8781    precision@5 : 0.1729    precision@10 : 0.0878
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    17:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    17:   9%|████▋                                              | 1/11 [00:00<00:01,  8.95it/s]
Train    17:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.07it/s]
Train    17:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.14it/s]
Train    17:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.05it/s]
Train    17:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.05it/s]
Train    17:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.93it/s]
Train    17:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.95it/s]
Train    17:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.95it/s]
Train    17:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.91it/s]
Train    17:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.84it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.93it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.96it/s]
13 Oct 03:25    INFO  epoch 17 training [time: 1.23s, train loss: 13.2139]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.55it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.45it/s]
13 Oct 03:25    INFO  epoch 17 evaluating [time: 0.13s, valid_score: 0.848300]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8623    recall@10 : 0.8781    mrr@5 : 0.8462    mrr@10 : 0.8483    ndcg@5 : 0.8502    ndcg@10 : 0.8554    hit@5 : 0.8623    hit@10 : 0.8781    precision@5 : 0.1725    precision@10 : 0.0878
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    18:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    18:   9%|████▋                                              | 1/11 [00:00<00:01,  9.17it/s]
Train    18:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.18it/s]
Train    18:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.14it/s]
Train    18:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.06it/s]
Train    18:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.58it/s]
Train    18:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.20it/s]
Train    18:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.63it/s]
Train    18:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.94it/s]
Train    18:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.23it/s]
Train    18:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.43it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.75it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.22it/s]
13 Oct 03:25    INFO  epoch 18 training [time: 1.34s, train loss: 12.1474]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.24it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.42it/s]
13 Oct 03:25    INFO  epoch 18 evaluating [time: 0.13s, valid_score: 0.849200]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8636    recall@10 : 0.8758    mrr@5 : 0.8476    mrr@10 : 0.8492    ndcg@5 : 0.8516    ndcg@10 : 0.8555    hit@5 : 0.8636    hit@10 : 0.8758    precision@5 : 0.1727    precision@10 : 0.0876
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    19:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    19:   9%|████▋                                              | 1/11 [00:00<00:01,  8.57it/s]
Train    19:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.67it/s]
Train    19:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.03it/s]
Train    19:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.19it/s]
Train    19:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.16it/s]
Train    19:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.33it/s]
Train    19:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.52it/s]
Train    19:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.60it/s]
Train    19:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.70it/s]
Train    19:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.79it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.88it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.58it/s]
13 Oct 03:25    INFO  epoch 19 training [time: 1.28s, train loss: 12.1218]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.39it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.40it/s]
13 Oct 03:25    INFO  epoch 19 evaluating [time: 0.12s, valid_score: 0.847400]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8663    recall@10 : 0.8799    mrr@5 : 0.8456    mrr@10 : 0.8474    ndcg@5 : 0.8508    ndcg@10 : 0.8552    hit@5 : 0.8663    hit@10 : 0.8799    precision@5 : 0.1733    precision@10 : 0.088

Train    20:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    20:   9%|████▋                                              | 1/11 [00:00<00:01,  8.89it/s]
Train    20:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.96it/s]
Train    20:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.08it/s]
Train    20:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.09it/s]
Train    20:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.93it/s]
Train    20:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.86it/s]
Train    20:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.81it/s]
Train    20:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.88it/s]
Train    20:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.94it/s]
Train    20:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.90it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.01it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.95it/s]
13 Oct 03:25    INFO  epoch 20 training [time: 1.23s, train loss: 12.1857]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.94it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.06it/s]
13 Oct 03:25    INFO  epoch 20 evaluating [time: 0.12s, valid_score: 0.850400]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8677    recall@10 : 0.8777    mrr@5 : 0.8491    mrr@10 : 0.8504    ndcg@5 : 0.8537    ndcg@10 : 0.8569    hit@5 : 0.8677    hit@10 : 0.8777    precision@5 : 0.1735    precision@10 : 0.0878
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    21:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    21:   9%|████▋                                              | 1/11 [00:00<00:01,  9.08it/s]
Train    21:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.01it/s]
Train    21:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.98it/s]
Train    21:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.90it/s]
Train    21:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.81it/s]
Train    21:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.81it/s]
Train    21:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.87it/s]
Train    21:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.86it/s]
Train    21:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.89it/s]
Train    21:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.91it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.98it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.92it/s]
13 Oct 03:25    INFO  epoch 21 training [time: 1.23s, train loss: 12.8360]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.18it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.65it/s]
13 Oct 03:25    INFO  epoch 21 evaluating [time: 0.13s, valid_score: 0.853100]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8691    recall@10 : 0.8804    mrr@5 : 0.8516    mrr@10 : 0.8531    ndcg@5 : 0.856    ndcg@10 : 0.8596    hit@5 : 0.8691    hit@10 : 0.8804    precision@5 : 0.1738    precision@10 : 0.088
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    22:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    22:   9%|████▋                                              | 1/11 [00:00<00:01,  8.71it/s]
Train    22:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.60it/s]
Train    22:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.80it/s]
Train    22:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.77it/s]
Train    22:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.82it/s]
Train    22:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.89it/s]
Train    22:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.44it/s]
Train    22:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  7.90it/s]
Train    22:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.11it/s]
Train    22:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.18it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.51it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.20it/s]
13 Oct 03:25    INFO  epoch 22 training [time: 1.34s, train loss: 12.4734]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.21it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.02it/s]
13 Oct 03:25    INFO  epoch 22 evaluating [time: 0.13s, valid_score: 0.857300]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.87    recall@10 : 0.8826    mrr@5 : 0.8556    mrr@10 : 0.8573    ndcg@5 : 0.8592    ndcg@10 : 0.8633    hit@5 : 0.87    hit@10 : 0.8826    precision@5 : 0.174    precision@10 : 0.0883
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    23:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    23:   9%|████▋                                              | 1/11 [00:00<00:01,  8.93it/s]
Train    23:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.04it/s]
Train    23:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.93it/s]
Train    23:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.78it/s]
Train    23:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.64it/s]
Train    23:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.55it/s]
Train    23:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.53it/s]
Train    23:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.63it/s]
Train    23:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.70it/s]
Train    23:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.65it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.86it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.74it/s]
13 Oct 03:25    INFO  epoch 23 training [time: 1.26s, train loss: 12.1877]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.93it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.27it/s]
13 Oct 03:25    INFO  epoch 23 evaluating [time: 0.13s, valid_score: 0.855300]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8686    recall@10 : 0.8836    mrr@5 : 0.8532    mrr@10 : 0.8553    ndcg@5 : 0.8571    ndcg@10 : 0.862    hit@5 : 0.8686    hit@10 : 0.8836    precision@5 : 0.1737    precision@10 : 0.0884

Train    24:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    24:   9%|████▋                                              | 1/11 [00:00<00:01,  8.73it/s]
Train    24:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.72it/s]
Train    24:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.92it/s]
Train    24:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.97it/s]
Train    24:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.04it/s]
Train    24:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.91it/s]
Train    24:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.76it/s]
Train    24:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.75it/s]
Train    24:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.69it/s]
Train    24:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.69it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.83it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.82it/s]
13 Oct 03:25    INFO  epoch 24 training [time: 1.25s, train loss: 11.1161]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.07it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.89it/s]
13 Oct 03:25    INFO  epoch 24 evaluating [time: 0.13s, valid_score: 0.854600]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8659    recall@10 : 0.8813    mrr@5 : 0.8525    mrr@10 : 0.8546    ndcg@5 : 0.8559    ndcg@10 : 0.8609    hit@5 : 0.8659    hit@10 : 0.8813    precision@5 : 0.1732    precision@10 : 0.0881

Train    25:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    25:   9%|████▋                                              | 1/11 [00:00<00:01,  8.70it/s]
Train    25:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.74it/s]
Train    25:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.58it/s]
Train    25:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.64it/s]
Train    25:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.76it/s]
Train    25:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.76it/s]
Train    25:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.83it/s]
Train    25:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.71it/s]
Train    25:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.73it/s]
Train    25:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.71it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.82it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.75it/s]
13 Oct 03:25    INFO  epoch 25 training [time: 1.26s, train loss: 11.9758]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.70it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.17it/s]
13 Oct 03:25    INFO  epoch 25 evaluating [time: 0.13s, valid_score: 0.856200]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8686    recall@10 : 0.8836    mrr@5 : 0.8544    mrr@10 : 0.8562    ndcg@5 : 0.8579    ndcg@10 : 0.8626    hit@5 : 0.8686    hit@10 : 0.8836    precision@5 : 0.1737    precision@10 : 0.0884

Train    26:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    26:   9%|████▋                                              | 1/11 [00:00<00:01,  8.63it/s]
Train    26:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.61it/s]
Train    26:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.59it/s]
Train    26:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.19it/s]
Train    26:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.94it/s]
Train    26:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.35it/s]
Train    26:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.73it/s]
Train    26:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.96it/s]
Train    26:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.07it/s]
Train    26:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.24it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.51it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.91it/s]
13 Oct 03:25    INFO  epoch 26 training [time: 1.39s, train loss: 11.3825]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.58it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.73it/s]
13 Oct 03:25    INFO  epoch 26 evaluating [time: 0.12s, valid_score: 0.855900]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8672    recall@10 : 0.8817    mrr@5 : 0.8539    mrr@10 : 0.8559    ndcg@5 : 0.8573    ndcg@10 : 0.862    hit@5 : 0.8672    hit@10 : 0.8817    precision@5 : 0.1734    precision@10 : 0.0882

Train    27:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    27:   9%|████▋                                              | 1/11 [00:00<00:01,  8.71it/s]
Train    27:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.68it/s]
Train    27:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.85it/s]
Train    27:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.93it/s]
Train    27:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.98it/s]
Train    27:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.98it/s]
Train    27:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.90it/s]
Train    27:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.93it/s]
Train    27:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.95it/s]
Train    27:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.78it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.83it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.87it/s]
13 Oct 03:25    INFO  epoch 27 training [time: 1.24s, train loss: 11.5649]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.03it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.95it/s]
13 Oct 03:25    INFO  epoch 27 evaluating [time: 0.12s, valid_score: 0.856600]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8681    recall@10 : 0.884    mrr@5 : 0.8546    mrr@10 : 0.8566    ndcg@5 : 0.858    ndcg@10 : 0.8631    hit@5 : 0.8681    hit@10 : 0.884    precision@5 : 0.1736    precision@10 : 0.0884

Train    28:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    28:   9%|████▋                                              | 1/11 [00:00<00:01,  8.97it/s]
Train    28:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.03it/s]
Train    28:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.74it/s]
Train    28:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.73it/s]
Train    28:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.61it/s]
Train    28:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.53it/s]
Train    28:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.64it/s]
Train    28:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.69it/s]
Train    28:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.68it/s]
Train    28:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.78it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.91it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.76it/s]
13 Oct 03:25    INFO  epoch 28 training [time: 1.26s, train loss: 10.6363]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.48it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.73it/s]
13 Oct 03:25    INFO  epoch 28 evaluating [time: 0.15s, valid_score: 0.854800]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8672    recall@10 : 0.8813    mrr@5 : 0.853    mrr@10 : 0.8548    ndcg@5 : 0.8566    ndcg@10 : 0.8611    hit@5 : 0.8672    hit@10 : 0.8813    precision@5 : 0.1734    precision@10 : 0.0881

Train    29:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    29:   9%|████▋                                              | 1/11 [00:00<00:01,  8.42it/s]
Train    29:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.45it/s]
Train    29:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.42it/s]
Train    29:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.53it/s]
Train    29:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.55it/s]
Train    29:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.56it/s]
Train    29:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.57it/s]
Train    29:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.58it/s]
Train    29:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.67it/s]
Train    29:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.67it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.70it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.60it/s]
13 Oct 03:25    INFO  epoch 29 training [time: 1.28s, train loss: 10.7093]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.78it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.10it/s]
13 Oct 03:25    INFO  epoch 29 evaluating [time: 0.13s, valid_score: 0.856000]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8686    recall@10 : 0.8822    mrr@5 : 0.8541    mrr@10 : 0.856    ndcg@5 : 0.8578    ndcg@10 : 0.8622    hit@5 : 0.8686    hit@10 : 0.8822    precision@5 : 0.1737    precision@10 : 0.0882

Train    30:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    30:   9%|████▋                                              | 1/11 [00:00<00:01,  8.15it/s]
Train    30:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.52it/s]
Train    30:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.62it/s]
Train    30:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.61it/s]
Train    30:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.65it/s]
Train    30:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.73it/s]
Train    30:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.34it/s]
Train    30:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.72it/s]
Train    30:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.01it/s]
Train    30:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.22it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.49it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.10it/s]
13 Oct 03:25    INFO  epoch 30 training [time: 1.36s, train loss: 10.3000]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.85it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.76it/s]
13 Oct 03:25    INFO  epoch 30 evaluating [time: 0.13s, valid_score: 0.856800]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8691    recall@10 : 0.8836    mrr@5 : 0.8548    mrr@10 : 0.8568    ndcg@5 : 0.8584    ndcg@10 : 0.8631    hit@5 : 0.8691    hit@10 : 0.8836    precision@5 : 0.1738    precision@10 : 0.0884

Train    31:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    31:   9%|████▋                                              | 1/11 [00:00<00:01,  8.73it/s]
Train    31:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.79it/s]
Train    31:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.92it/s]
Train    31:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.73it/s]
Train    31:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.52it/s]
Train    31:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.40it/s]
Train    31:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.43it/s]
Train    31:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.48it/s]
Train    31:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.57it/s]
Train    31:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.54it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.71it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.61it/s]
13 Oct 03:25    INFO  epoch 31 training [time: 1.28s, train loss: 10.5946]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.27it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.78it/s]
13 Oct 03:25    INFO  epoch 31 evaluating [time: 0.14s, valid_score: 0.858000]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8709    recall@10 : 0.8872    mrr@5 : 0.856    mrr@10 : 0.858    ndcg@5 : 0.8596    ndcg@10 : 0.8648    hit@5 : 0.8709    hit@10 : 0.8872    precision@5 : 0.1742    precision@10 : 0.0887
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    32:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    32:   9%|████▋                                              | 1/11 [00:00<00:01,  8.73it/s]
Train    32:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.72it/s]
Train    32:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.76it/s]
Train    32:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.73it/s]
Train    32:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.60it/s]
Train    32:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.46it/s]
Train    32:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.46it/s]
Train    32:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.43it/s]
Train    32:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.42it/s]
Train    32:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.40it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.51it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.53it/s]
13 Oct 03:25    INFO  epoch 32 training [time: 1.29s, train loss: 11.4256]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.96it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.59it/s]
13 Oct 03:25    INFO  epoch 32 evaluating [time: 0.13s, valid_score: 0.858000]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8691    recall@10 : 0.8804    mrr@5 : 0.8564    mrr@10 : 0.858    ndcg@5 : 0.8596    ndcg@10 : 0.8633    hit@5 : 0.8691    hit@10 : 0.8804    precision@5 : 0.1738    precision@10 : 0.088
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    33:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    33:   9%|████▋                                              | 1/11 [00:00<00:01,  8.67it/s]
Train    33:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.60it/s]
Train    33:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.27it/s]
Train    33:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.34it/s]
Train    33:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.29it/s]
Train    33:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.35it/s]
Train    33:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.37it/s]
Train    33:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.38it/s]
Train    33:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.38it/s]
Train    33:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.36it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.48it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.40it/s]
13 Oct 03:25    INFO  epoch 33 training [time: 1.31s, train loss: 11.0519]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.99it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.58it/s]
13 Oct 03:25    INFO  epoch 33 evaluating [time: 0.13s, valid_score: 0.859400]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8704    recall@10 : 0.8826    mrr@5 : 0.8577    mrr@10 : 0.8594    ndcg@5 : 0.8609    ndcg@10 : 0.8649    hit@5 : 0.8704    hit@10 : 0.8826    precision@5 : 0.1741    precision@10 : 0.0883
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    34:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    34:   9%|████▋                                              | 1/11 [00:00<00:01,  8.80it/s]
Train    34:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.83it/s]
Train    34:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.79it/s]
Train    34:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.78it/s]
Train    34:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.83it/s]
Train    34:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.75it/s]
Train    34:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.82it/s]
Train    34:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.69it/s]
Train    34:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.50it/s]
Train    34:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.61it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.12it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.97it/s]
13 Oct 03:25    INFO  epoch 34 training [time: 1.38s, train loss: 10.0696]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.28it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.73it/s]
13 Oct 03:25    INFO  epoch 34 evaluating [time: 0.13s, valid_score: 0.858700]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8686    recall@10 : 0.8845    mrr@5 : 0.8566    mrr@10 : 0.8587    ndcg@5 : 0.8596    ndcg@10 : 0.8648    hit@5 : 0.8686    hit@10 : 0.8845    precision@5 : 0.1737    precision@10 : 0.0884

Train    35:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    35:   9%|████▋                                              | 1/11 [00:00<00:01,  8.41it/s]
Train    35:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.45it/s]
Train    35:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.44it/s]
Train    35:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.53it/s]
Train    35:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.61it/s]
Train    35:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.67it/s]
Train    35:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.72it/s]
Train    35:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.81it/s]
Train    35:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.85it/s]
Train    35:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.87it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.81it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.71it/s]
13 Oct 03:25    INFO  epoch 35 training [time: 1.26s, train loss: 11.1738]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.45it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.35it/s]
13 Oct 03:25    INFO  epoch 35 evaluating [time: 0.13s, valid_score: 0.859000]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8709    recall@10 : 0.8845    mrr@5 : 0.857    mrr@10 : 0.859    ndcg@5 : 0.8605    ndcg@10 : 0.865    hit@5 : 0.8709    hit@10 : 0.8845    precision@5 : 0.1742    precision@10 : 0.0884

Train    36:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    36:   9%|████▋                                              | 1/11 [00:00<00:01,  8.29it/s]
Train    36:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.54it/s]
Train    36:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.67it/s]
Train    36:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.74it/s]
Train    36:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.80it/s]
Train    36:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.77it/s]
Train    36:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.78it/s]
Train    36:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.78it/s]
Train    36:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.74it/s]
Train    36:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.63it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.67it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.69it/s]
13 Oct 03:25    INFO  epoch 36 training [time: 1.27s, train loss: 9.8063]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.36it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.47it/s]
13 Oct 03:25    INFO  epoch 36 evaluating [time: 0.14s, valid_score: 0.859600]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8736    recall@10 : 0.8817    mrr@5 : 0.8585    mrr@10 : 0.8596    ndcg@5 : 0.8622    ndcg@10 : 0.8649    hit@5 : 0.8736    hit@10 : 0.8817    precision@5 : 0.1747    precision@10 : 0.0882
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    37:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    37:   9%|████▋                                              | 1/11 [00:00<00:01,  8.64it/s]
Train    37:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.43it/s]
Train    37:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.48it/s]
Train    37:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.38it/s]
Train    37:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.42it/s]
Train    37:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.41it/s]
Train    37:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.47it/s]
Train    37:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.57it/s]
Train    37:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.58it/s]
Train    37:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.55it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.72it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.55it/s]
13 Oct 03:25    INFO  epoch 37 training [time: 1.29s, train loss: 9.8396]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.08it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.88it/s]
13 Oct 03:25    INFO  epoch 37 evaluating [time: 0.14s, valid_score: 0.859100]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8691    recall@10 : 0.8822    mrr@5 : 0.8573    mrr@10 : 0.8591    ndcg@5 : 0.8603    ndcg@10 : 0.8645    hit@5 : 0.8691    hit@10 : 0.8822    precision@5 : 0.1738    precision@10 : 0.0882

Train    38:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    38:   9%|████▋                                              | 1/11 [00:00<00:01,  8.57it/s]
Train    38:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.77it/s]
Train    38:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.84it/s]
Train    38:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.81it/s]
Train    38:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.74it/s]
Train    38:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.48it/s]
Train    38:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.81it/s]
Train    38:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.99it/s]
Train    38:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.82it/s]
Train    38:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.26it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.48it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.31it/s]
13 Oct 03:25    INFO  epoch 38 training [time: 1.51s, train loss: 10.0973]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.51it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.60it/s]
13 Oct 03:25    INFO  epoch 38 evaluating [time: 0.17s, valid_score: 0.859700]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8713    recall@10 : 0.8863    mrr@5 : 0.8576    mrr@10 : 0.8597    ndcg@5 : 0.861    ndcg@10 : 0.8659    hit@5 : 0.8713    hit@10 : 0.8863    precision@5 : 0.1743    precision@10 : 0.0886
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    39:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    39:   9%|████▋                                              | 1/11 [00:00<00:01,  8.69it/s]
Train    39:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.51it/s]
Train    39:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  5.80it/s]
Train    39:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.67it/s]
Train    39:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.96it/s]
Train    39:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.97it/s]
Train    39:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  6.29it/s]
Train    39:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.20it/s]
Train    39:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.64it/s]
Train    39:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.00it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.40it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.91it/s]
13 Oct 03:25    INFO  epoch 39 training [time: 1.59s, train loss: 10.1514]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.74it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.33it/s]
13 Oct 03:25    INFO  epoch 39 evaluating [time: 0.13s, valid_score: 0.858500]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.87    recall@10 : 0.8849    mrr@5 : 0.8565    mrr@10 : 0.8585    ndcg@5 : 0.8599    ndcg@10 : 0.8647    hit@5 : 0.87    hit@10 : 0.8849    precision@5 : 0.174    precision@10 : 0.0885

Train    40:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    40:   9%|████▋                                              | 1/11 [00:00<00:01,  8.39it/s]
Train    40:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.44it/s]
Train    40:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.89it/s]
Train    40:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.35it/s]
Train    40:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.02it/s]
Train    40:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  5.31it/s]
Train    40:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  5.86it/s]
Train    40:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.32it/s]
Train    40:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.82it/s]
Train    40:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.21it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.53it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.79it/s]
13 Oct 03:25    INFO  epoch 40 training [time: 1.62s, train loss: 9.2426]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.55it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.74it/s]
13 Oct 03:25    INFO  epoch 40 evaluating [time: 0.14s, valid_score: 0.858000]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.87    recall@10 : 0.8836    mrr@5 : 0.8562    mrr@10 : 0.858    ndcg@5 : 0.8597    ndcg@10 : 0.864    hit@5 : 0.87    hit@10 : 0.8836    precision@5 : 0.174    precision@10 : 0.0884

Train    41:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    41:   9%|████▋                                              | 1/11 [00:00<00:01,  7.89it/s]
Train    41:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.06it/s]
Train    41:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.12it/s]
Train    41:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.91it/s]
Train    41:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.97it/s]
Train    41:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.04it/s]
Train    41:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.08it/s]
Train    41:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.23it/s]
Train    41:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.00it/s]
Train    41:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.13it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.29it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.12it/s]
13 Oct 03:25    INFO  epoch 41 training [time: 1.36s, train loss: 11.0270]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.53it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.59it/s]
13 Oct 03:25    INFO  epoch 41 evaluating [time: 0.18s, valid_score: 0.860200]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8718    recall@10 : 0.8872    mrr@5 : 0.8583    mrr@10 : 0.8602    ndcg@5 : 0.8616    ndcg@10 : 0.8665    hit@5 : 0.8718    hit@10 : 0.8872    precision@5 : 0.1744    precision@10 : 0.0887
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    42:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    42:   9%|████▋                                              | 1/11 [00:00<00:01,  8.64it/s]
Train    42:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.34it/s]
Train    42:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.33it/s]
Train    42:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.35it/s]
Train    42:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.54it/s]
Train    42:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.44it/s]
Train    42:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.34it/s]
Train    42:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.21it/s]
Train    42:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.13it/s]
Train    42:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.08it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.25it/s]
13 Oct 03:25    INFO  epoch 42 training [time: 1.33s, train loss: 9.1078]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00,  8.67it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 12.03it/s]
13 Oct 03:25    INFO  epoch 42 evaluating [time: 0.27s, valid_score: 0.860500]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8736    recall@10 : 0.8894    mrr@5 : 0.8584    mrr@10 : 0.8605    ndcg@5 : 0.8622    ndcg@10 : 0.8673    hit@5 : 0.8736    hit@10 : 0.8894    precision@5 : 0.1747    precision@10 : 0.0889
13 Oct 03:25    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Train    43:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    43:   9%|████▋                                              | 1/11 [00:00<00:01,  7.72it/s]
Train    43:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.82it/s]
Train    43:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.78it/s]
Train    43:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.99it/s]
Train    43:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.12it/s]
Train    43:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.12it/s]
Train    43:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.05it/s]
Train    43:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.11it/s]
Train    43:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.16it/s]
Train    43:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.14it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.26it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.10it/s]
13 Oct 03:25    INFO  epoch 43 training [time: 1.36s, train loss: 10.0145]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.11it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.76it/s]
13 Oct 03:25    INFO  epoch 43 evaluating [time: 0.14s, valid_score: 0.859500]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8695    recall@10 : 0.8845    mrr@5 : 0.8575    mrr@10 : 0.8595    ndcg@5 : 0.8605    ndcg@10 : 0.8654    hit@5 : 0.8695    hit@10 : 0.8845    precision@5 : 0.1739    precision@10 : 0.0884

Train    44:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    44:   9%|████▋                                              | 1/11 [00:00<00:01,  8.20it/s]
Train    44:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.16it/s]
Train    44:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.28it/s]
Train    44:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.31it/s]
Train    44:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.29it/s]
Train    44:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.28it/s]
Train    44:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.24it/s]
Train    44:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.24it/s]
Train    44:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.29it/s]
Train    44:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.17it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.26it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.25it/s]
13 Oct 03:25    INFO  epoch 44 training [time: 1.33s, train loss: 10.2594]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.60it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.07it/s]
13 Oct 03:25    INFO  epoch 44 evaluating [time: 0.14s, valid_score: 0.857500]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.87    recall@10 : 0.884    mrr@5 : 0.8556    mrr@10 : 0.8575    ndcg@5 : 0.8592    ndcg@10 : 0.8638    hit@5 : 0.87    hit@10 : 0.884    precision@5 : 0.174    precision@10 : 0.0884

Train    45:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    45:   9%|████▋                                              | 1/11 [00:00<00:01,  8.10it/s]
Train    45:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.20it/s]
Train    45:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.26it/s]
Train    45:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.27it/s]
Train    45:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.30it/s]
Train    45:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.21it/s]
Train    45:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.13it/s]
Train    45:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.07it/s]
Train    45:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.13it/s]
Train    45:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.12it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.26it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.20it/s]
13 Oct 03:25    INFO  epoch 45 training [time: 1.34s, train loss: 9.9563]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.07it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.88it/s]
13 Oct 03:25    INFO  epoch 45 evaluating [time: 0.13s, valid_score: 0.860300]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8745    recall@10 : 0.8854    mrr@5 : 0.8589    mrr@10 : 0.8603    ndcg@5 : 0.8627    ndcg@10 : 0.8662    hit@5 : 0.8745    hit@10 : 0.8854    precision@5 : 0.1749    precision@10 : 0.0885

Train    46:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    46:   9%|████▋                                              | 1/11 [00:00<00:01,  8.37it/s]
Train    46:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.48it/s]
Train    46:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.55it/s]
Train    46:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.52it/s]
Train    46:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.53it/s]
Train    46:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.57it/s]
Train    46:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.50it/s]
Train    46:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.41it/s]
Train    46:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.46it/s]
Train    46:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.47it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.46it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.48it/s]
13 Oct 03:25    INFO  epoch 46 training [time: 1.30s, train loss: 9.0545]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.54it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.84it/s]
13 Oct 03:25    INFO  epoch 46 evaluating [time: 0.16s, valid_score: 0.859300]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.87    recall@10 : 0.8858    mrr@5 : 0.8573    mrr@10 : 0.8593    ndcg@5 : 0.8605    ndcg@10 : 0.8655    hit@5 : 0.87    hit@10 : 0.8858    precision@5 : 0.174    precision@10 : 0.0886

Train    47:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    47:   9%|████▋                                              | 1/11 [00:00<00:01,  8.09it/s]
Train    47:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.40it/s]
Train    47:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.39it/s]
Train    47:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.95it/s]
Train    47:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.17it/s]
Train    47:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.38it/s]
Train    47:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.53it/s]
Train    47:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.56it/s]
Train    47:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.54it/s]
Train    47:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.48it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.84it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.04it/s]
13 Oct 03:25    INFO  epoch 47 training [time: 1.56s, train loss: 9.6408]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  6.35it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00,  7.06it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00,  9.00it/s]
13 Oct 03:25    INFO  epoch 47 evaluating [time: 0.35s, valid_score: 0.860300]
13 Oct 03:25    INFO  valid result: 
recall@5 : 0.8722    recall@10 : 0.8863    mrr@5 : 0.8584    mrr@10 : 0.8603    ndcg@5 : 0.8618    ndcg@10 : 0.8664    hit@5 : 0.8722    hit@10 : 0.8863    precision@5 : 0.1744    precision@10 : 0.0886

Train    48:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    48:   9%|████▋                                              | 1/11 [00:00<00:01,  6.44it/s]
Train    48:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.57it/s]
Train    48:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.09it/s]
Train    48:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.16it/s]
Train    48:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.14it/s]
Train    48:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.03it/s]
Train    48:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.93it/s]
Train    48:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.99it/s]
Train    48:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.06it/s]
Train    48:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.12it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.23it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.03it/s]
13 Oct 03:26    INFO  epoch 48 training [time: 1.37s, train loss: 10.9588]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.63it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.07it/s]
13 Oct 03:26    INFO  epoch 48 evaluating [time: 0.13s, valid_score: 0.859600]
13 Oct 03:26    INFO  valid result: 
recall@5 : 0.8727    recall@10 : 0.8867    mrr@5 : 0.8578    mrr@10 : 0.8596    ndcg@5 : 0.8615    ndcg@10 : 0.8659    hit@5 : 0.8727    hit@10 : 0.8867    precision@5 : 0.1745    precision@10 : 0.0887

Train    49:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    49:   9%|████▋                                              | 1/11 [00:00<00:01,  8.15it/s]
Train    49:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.02it/s]
Train    49:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.17it/s]
Train    49:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.17it/s]
Train    49:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.96it/s]
Train    49:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.12it/s]
Train    49:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.30it/s]
Train    49:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.26it/s]
Train    49:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.14it/s]
Train    49:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.15it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.23it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.17it/s]
13 Oct 03:26    INFO  epoch 49 training [time: 1.35s, train loss: 10.1219]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.75it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.34it/s]
13 Oct 03:26    INFO  epoch 49 evaluating [time: 0.15s, valid_score: 0.860200]
13 Oct 03:26    INFO  valid result: 
recall@5 : 0.8736    recall@10 : 0.889    mrr@5 : 0.8583    mrr@10 : 0.8602    ndcg@5 : 0.8621    ndcg@10 : 0.867    hit@5 : 0.8736    hit@10 : 0.889    precision@5 : 0.1747    precision@10 : 0.0889
13 Oct 03:26    INFO  Loading model structure and parameters from saved/BERT4Rec-Oct-13-2025_03-24-47.pth

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.64it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.58it/s]
13 Oct 03:26    INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |     4.70 %     |
+-------------+----------------+
| GPU         |   0.0 / 0.0    |
+-------------+----------------+
| Memory      | 1.39 G/15.33 G |
+-------------+----------------+
13 Oct 03:26    INFO  best valid : OrderedDict({'recall@5': 0.8736, 'recall@10': 0.8894, 'mrr@5': 0.8584, 'mrr@10': 0.8605, 'ndcg@5': 0.8622, 'ndcg@10': 0.8673, 'hit@5': 0.8736, 'hit@10': 0.8894, 'precision@5': 0.1747, 'precision@10': 0.0889})
13 Oct 03:26    INFO  test result: OrderedDict({'recall@5': 0.9748, 'recall@10': 0.9835, 'mrr@5': 0.957, 'mrr@10': 0.9583, 'ndcg@5': 0.9615, 'ndcg@10': 0.9645, 'hit@5': 0.9748, 'hit@10': 0.9835, 'precision@5': 0.195, 'precision@10': 0.0983})
2025-10-13 03:26:04,654 | INFO | Published checkpoint /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/saved/BERT4Rec-Oct-13-2025_03-24-47.pth → /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/versions/BERT4Rec-Oct-13-2025_03-24-47.pth
2025-10-13 03:26:04,654 | INFO | Retraining completed in 0:01:22.914913 | dataset=20251012-202443 | model=Oct-13-2025_03-24-47
2025-10-13 03:26:34,658 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:26:35,450 | INFO | 🔄 Đang trích xuất data từ Postgres...
🐘 Đã trích xuất bằng psycopg.
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 57
Số user: 1
Số sản phẩm: 11
Các loại event: {'add_to_cart': 0.439, 'view': 0.368, 'purchase': 0.193}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[10 rows x 5 columns]
2025-10-13 03:26:35,450 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:26:36,324 | INFO | 🗂  Đã cập nhật /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/interactions.csv (tổng 18340 bản ghi).
✅ Đã tạo snapshot 20251012-202636 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-202636/ecommerce.inter) với 18340 dòng
👥  User: 2607 | 🛒  Sản phẩm: 106
🏷️   Nhãn mua hàng (label=1): 2988
      user_id item_id   timestamp  label
4952        3      25  1704067200      0
4953        3      25  1704068520      0
18235       3      89  1707264000      0
18236       3      89  1707264300      0
18237       3      89  1707265440      0
18238       3      89  1707266820      1
1123        3      12  1708041600      0
1124        3      12  1708044480      0
10396       4       4  1707436800      0
10397       4       4  1707437100      0
2025-10-13 03:26:36,326 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-193539
2025-10-13 03:26:36,326 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 03:28:02,128 | INFO | 13 Oct 03:26    INFO  ['train_bert4rec.py']
13 Oct 03:26    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = False
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
device = cuda
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 03:26    INFO  ecommerce
The number of users: 2607
Average actions of users: 7.037605525709901
The number of items: 96
Average actions of items: 193.05263157894737
The number of inters: 18340
The sparsity of the dataset: 92.67197289349188%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 03:26    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 03:26    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 03:26    INFO  BERT4Rec(
  (item_embedding): Embedding(97, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 113888
13 Oct 03:26    INFO  FLOPs: 5194664.0
🔧 Sử dụng topk=[5, 10], valid_metric=MRR@10, device=cpu

Train     0:   0%|                                                           | 0/11 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   9%|████▋                                              | 1/11 [00:00<00:03,  3.08it/s]
Train     0:  18%|█████████▎                                         | 2/11 [00:00<00:01,  4.91it/s]
Train     0:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.03it/s]
Train     0:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.91it/s]
Train     0:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.50it/s]
Train     0:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.90it/s]
Train     0:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  8.24it/s]
Train     0:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.40it/s]
Train     0:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.61it/s]
Train     0:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.23it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.44it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.42it/s]
13 Oct 03:26    INFO  epoch 0 training [time: 1.49s, train loss: 49.8466]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.11it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.83it/s]
13 Oct 03:26    INFO  epoch 0 evaluating [time: 0.16s, valid_score: 0.056800]
13 Oct 03:26    INFO  valid result: 
recall@5 : 0.0911    recall@10 : 0.1731    mrr@5 : 0.046    mrr@10 : 0.0568    ndcg@5 : 0.0571    ndcg@10 : 0.0835    hit@5 : 0.0911    hit@10 : 0.1731    precision@5 : 0.0182    precision@10 : 0.0173
13 Oct 03:26    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train     1:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     1:   9%|████▋                                              | 1/11 [00:00<00:01,  8.97it/s]
Train     1:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.96it/s]
Train     1:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.06it/s]
Train     1:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.09it/s]
Train     1:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.12it/s]
Train     1:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.15it/s]
Train     1:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.10it/s]
Train     1:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.18it/s]
Train     1:  82%|█████████████████████████████████████████▋         | 9/11 [00:00<00:00,  9.20it/s]
Train     1:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.21it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.23it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.15it/s]
13 Oct 03:26    INFO  epoch 1 training [time: 1.20s, train loss: 48.8748]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.08it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.04it/s]
13 Oct 03:26    INFO  epoch 1 evaluating [time: 0.12s, valid_score: 0.093100]
13 Oct 03:26    INFO  valid result: 
recall@5 : 0.1595    recall@10 : 0.2642    mrr@5 : 0.0792    mrr@10 : 0.0931    ndcg@5 : 0.099    ndcg@10 : 0.1328    hit@5 : 0.1595    hit@10 : 0.2642    precision@5 : 0.0319    precision@10 : 0.0264
13 Oct 03:26    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train     2:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     2:   9%|████▋                                              | 1/11 [00:00<00:01,  8.58it/s]
Train     2:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.87it/s]
Train     2:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.03it/s]
Train     2:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.54it/s]
Train     2:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.26it/s]
Train     2:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.72it/s]
Train     2:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.99it/s]
Train     2:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.30it/s]
Train     2:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.54it/s]
Train     2:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.65it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.82it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.24it/s]
13 Oct 03:26    INFO  epoch 2 training [time: 1.34s, train loss: 46.4818]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.02it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.70it/s]
13 Oct 03:26    INFO  epoch 2 evaluating [time: 0.13s, valid_score: 0.316400]
13 Oct 03:26    INFO  valid result: 
recall@5 : 0.4798    recall@10 : 0.5723    mrr@5 : 0.3042    mrr@10 : 0.3164    ndcg@5 : 0.3478    ndcg@10 : 0.3776    hit@5 : 0.4798    hit@10 : 0.5723    precision@5 : 0.096    precision@10 : 0.0572
13 Oct 03:26    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train     3:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     3:   9%|████▋                                              | 1/11 [00:00<00:01,  8.81it/s]
Train     3:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.78it/s]
Train     3:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.88it/s]
Train     3:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.98it/s]
Train     3:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.99it/s]
Train     3:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.09it/s]
Train     3:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  9.06it/s]
Train     3:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  9.02it/s]
Train     3:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  9.01it/s]
Train     3:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.09it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.21it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.06it/s]
13 Oct 03:26    INFO  epoch 3 training [time: 1.22s, train loss: 42.3517]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.18it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.10it/s]
13 Oct 03:26    INFO  epoch 3 evaluating [time: 0.12s, valid_score: 0.504600]
13 Oct 03:26    INFO  valid result: 
recall@5 : 0.6434    recall@10 : 0.7145    mrr@5 : 0.4951    mrr@10 : 0.5046    ndcg@5 : 0.5324    ndcg@10 : 0.5555    hit@5 : 0.6434    hit@10 : 0.7145    precision@5 : 0.1287    precision@10 : 0.0715
13 Oct 03:26    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train     4:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     4:   9%|████▋                                              | 1/11 [00:00<00:01,  8.76it/s]
Train     4:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.93it/s]
Train     4:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.88it/s]
Train     4:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.89it/s]
Train     4:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.95it/s]
Train     4:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.99it/s]
Train     4:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.94it/s]
Train     4:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.85it/s]
Train     4:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.73it/s]
Train     4:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.76it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.94it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.89it/s]
13 Oct 03:26    INFO  epoch 4 training [time: 1.24s, train loss: 38.4622]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.21it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.40it/s]
13 Oct 03:26    INFO  epoch 4 evaluating [time: 0.13s, valid_score: 0.618300]
13 Oct 03:26    INFO  valid result: 
recall@5 : 0.7105    recall@10 : 0.7644    mrr@5 : 0.6107    mrr@10 : 0.6183    ndcg@5 : 0.6358    ndcg@10 : 0.6536    hit@5 : 0.7105    hit@10 : 0.7644    precision@5 : 0.1421    precision@10 : 0.0764
13 Oct 03:26    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train     5:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     5:   9%|████▋                                              | 1/11 [00:00<00:01,  8.67it/s]
Train     5:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.49it/s]
Train     5:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.57it/s]
Train     5:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.59it/s]
Train     5:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.74it/s]
Train     5:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.78it/s]
Train     5:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.60it/s]
Train     5:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.61it/s]
Train     5:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.52it/s]
Train     5:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.43it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.05it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.42it/s]
13 Oct 03:26    INFO  epoch 5 training [time: 1.31s, train loss: 34.8372]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.94it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.65it/s]
13 Oct 03:26    INFO  epoch 5 evaluating [time: 0.18s, valid_score: 0.696300]
13 Oct 03:26    INFO  valid result: 
recall@5 : 0.7725    recall@10 : 0.8074    mrr@5 : 0.6916    mrr@10 : 0.6963    ndcg@5 : 0.7119    ndcg@10 : 0.7232    hit@5 : 0.7725    hit@10 : 0.8074    precision@5 : 0.1545    precision@10 : 0.0807
13 Oct 03:26    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train     6:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     6:   9%|████▋                                              | 1/11 [00:00<00:02,  3.47it/s]
Train     6:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.43it/s]
Train     6:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.63it/s]
Train     6:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.38it/s]
Train     6:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.90it/s]
Train     6:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.88it/s]
Train     6:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.17it/s]
Train     6:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.37it/s]
Train     6:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.46it/s]
Train     6:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.54it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.68it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.70it/s]
13 Oct 03:26    INFO  epoch 6 training [time: 1.43s, train loss: 31.3025]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.74it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.53it/s]
13 Oct 03:26    INFO  epoch 6 evaluating [time: 0.16s, valid_score: 0.747500]
13 Oct 03:26    INFO  valid result: 
recall@5 : 0.8038    recall@10 : 0.8319    mrr@5 : 0.7438    mrr@10 : 0.7475    ndcg@5 : 0.7589    ndcg@10 : 0.7679    hit@5 : 0.8038    hit@10 : 0.8319    precision@5 : 0.1608    precision@10 : 0.0832
13 Oct 03:26    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train     7:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     7:   9%|████▋                                              | 1/11 [00:00<00:01,  8.90it/s]
Train     7:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.91it/s]
Train     7:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.86it/s]
Train     7:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.58it/s]
Train     7:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.54it/s]
Train     7:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.60it/s]
Train     7:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.70it/s]
Train     7:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.76it/s]
Train     7:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.89it/s]
Train     7:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.87it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.90it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.79it/s]
13 Oct 03:26    INFO  epoch 7 training [time: 1.25s, train loss: 29.0385]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.67it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.05it/s]
13 Oct 03:26    INFO  epoch 7 evaluating [time: 0.16s, valid_score: 0.745900]
13 Oct 03:26    INFO  valid result: 
recall@5 : 0.8024    recall@10 : 0.8373    mrr@5 : 0.7411    mrr@10 : 0.7459    ndcg@5 : 0.7565    ndcg@10 : 0.7679    hit@5 : 0.8024    hit@10 : 0.8373    precision@5 : 0.1605    precision@10 : 0.0837

Train     8:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     8:   9%|████▋                                              | 1/11 [00:00<00:01,  8.53it/s]
Train     8:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.56it/s]
Train     8:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.27it/s]
Train     8:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.69it/s]
Train     8:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.30it/s]
Train     8:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.19it/s]
Train     8:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.49it/s]
Train     8:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.84it/s]
Train     8:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.75it/s]
Train     8:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.82it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.58it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.68it/s]
13 Oct 03:26    INFO  epoch 8 training [time: 1.43s, train loss: 26.3371]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.17it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.87it/s]
13 Oct 03:26    INFO  epoch 8 evaluating [time: 0.18s, valid_score: 0.744700]
13 Oct 03:26    INFO  valid result: 
recall@5 : 0.8006    recall@10 : 0.8355    mrr@5 : 0.7401    mrr@10 : 0.7447    ndcg@5 : 0.7553    ndcg@10 : 0.7666    hit@5 : 0.8006    hit@10 : 0.8355    precision@5 : 0.1601    precision@10 : 0.0836

Train     9:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     9:   9%|████▋                                              | 1/11 [00:00<00:01,  7.02it/s]
Train     9:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.87it/s]
Train     9:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.35it/s]
Train     9:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.26it/s]
Train     9:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.70it/s]
Train     9:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.43it/s]
Train     9:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.72it/s]
Train     9:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.84it/s]
Train     9:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.97it/s]
Train     9:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.09it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.03it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.90it/s]
13 Oct 03:26    INFO  epoch 9 training [time: 1.39s, train loss: 23.8598]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.02it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.84it/s]
13 Oct 03:26    INFO  epoch 9 evaluating [time: 0.19s, valid_score: 0.769000]
13 Oct 03:26    INFO  valid result: 
recall@5 : 0.8165    recall@10 : 0.8396    mrr@5 : 0.7659    mrr@10 : 0.769    ndcg@5 : 0.7786    ndcg@10 : 0.7861    hit@5 : 0.8165    hit@10 : 0.8396    precision@5 : 0.1633    precision@10 : 0.084
13 Oct 03:26    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    10:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    10:   9%|████▋                                              | 1/11 [00:00<00:01,  6.38it/s]
Train    10:  18%|█████████▎                                         | 2/11 [00:00<00:02,  3.89it/s]
Train    10:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  5.18it/s]
Train    10:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.17it/s]
Train    10:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.89it/s]
Train    10:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.26it/s]
Train    10:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  7.55it/s]
Train    10:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.74it/s]
Train    10:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.90it/s]
Train    10:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.11it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.38it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.12it/s]
13 Oct 03:26    INFO  epoch 10 training [time: 1.55s, train loss: 22.1504]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.81it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.05it/s]
13 Oct 03:26    INFO  epoch 10 evaluating [time: 0.17s, valid_score: 0.783900]
13 Oct 03:26    INFO  valid result: 
recall@5 : 0.8265    recall@10 : 0.8523    mrr@5 : 0.7805    mrr@10 : 0.7839    ndcg@5 : 0.7921    ndcg@10 : 0.8004    hit@5 : 0.8265    hit@10 : 0.8523    precision@5 : 0.1653    precision@10 : 0.0852
13 Oct 03:26    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    11:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    11:   9%|████▋                                              | 1/11 [00:00<00:01,  8.49it/s]
Train    11:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.51it/s]
Train    11:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.62it/s]
Train    11:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.60it/s]
Train    11:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.62it/s]
Train    11:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.72it/s]
Train    11:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.65it/s]
Train    11:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.43it/s]
Train    11:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.25it/s]
Train    11:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.16it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.22it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.41it/s]
13 Oct 03:27    INFO  epoch 11 training [time: 1.31s, train loss: 19.9200]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.07it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.11it/s]
13 Oct 03:27    INFO  epoch 11 evaluating [time: 0.14s, valid_score: 0.802300]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8369    recall@10 : 0.86    mrr@5 : 0.7992    mrr@10 : 0.8023    ndcg@5 : 0.8087    ndcg@10 : 0.8162    hit@5 : 0.8369    hit@10 : 0.86    precision@5 : 0.1674    precision@10 : 0.086
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    12:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    12:   9%|████▋                                              | 1/11 [00:00<00:01,  8.38it/s]
Train    12:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.36it/s]
Train    12:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.39it/s]
Train    12:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.52it/s]
Train    12:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.57it/s]
Train    12:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.57it/s]
Train    12:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.31it/s]
Train    12:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.30it/s]
Train    12:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.34it/s]
Train    12:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.28it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.47it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.42it/s]
13 Oct 03:27    INFO  epoch 12 training [time: 1.31s, train loss: 18.3223]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.28it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.36it/s]
13 Oct 03:27    INFO  epoch 12 evaluating [time: 0.12s, valid_score: 0.814500]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8432    recall@10 : 0.8641    mrr@5 : 0.8116    mrr@10 : 0.8145    ndcg@5 : 0.8196    ndcg@10 : 0.8264    hit@5 : 0.8432    hit@10 : 0.8641    precision@5 : 0.1686    precision@10 : 0.0864
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    13:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    13:   9%|████▋                                              | 1/11 [00:00<00:01,  8.55it/s]
Train    13:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.53it/s]
Train    13:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.63it/s]
Train    13:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.68it/s]
Train    13:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.68it/s]
Train    13:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.65it/s]
Train    13:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.56it/s]
Train    13:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.50it/s]
Train    13:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.30it/s]
Train    13:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.40it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.56it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.54it/s]
13 Oct 03:27    INFO  epoch 13 training [time: 1.29s, train loss: 16.4642]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.48it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.76it/s]
13 Oct 03:27    INFO  epoch 13 evaluating [time: 0.16s, valid_score: 0.823200]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8536    recall@10 : 0.865    mrr@5 : 0.8217    mrr@10 : 0.8232    ndcg@5 : 0.8298    ndcg@10 : 0.8334    hit@5 : 0.8536    hit@10 : 0.865    precision@5 : 0.1707    precision@10 : 0.0865
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    14:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    14:   9%|████▋                                              | 1/11 [00:00<00:01,  5.93it/s]
Train    14:  18%|█████████▎                                         | 2/11 [00:00<00:01,  6.22it/s]
Train    14:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.09it/s]
Train    14:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.31it/s]
Train    14:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.16it/s]
Train    14:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.68it/s]
Train    14:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  7.18it/s]
Train    14:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  5.96it/s]
Train    14:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.57it/s]
Train    14:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.07it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.54it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.74it/s]
13 Oct 03:27    INFO  epoch 14 training [time: 1.63s, train loss: 15.5183]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.63it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.52it/s]
13 Oct 03:27    INFO  epoch 14 evaluating [time: 0.13s, valid_score: 0.827000]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8518    recall@10 : 0.8677    mrr@5 : 0.8249    mrr@10 : 0.827    ndcg@5 : 0.8317    ndcg@10 : 0.8368    hit@5 : 0.8518    hit@10 : 0.8677    precision@5 : 0.1704    precision@10 : 0.0868
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    15:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    15:   9%|████▋                                              | 1/11 [00:00<00:01,  7.86it/s]
Train    15:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.63it/s]
Train    15:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.94it/s]
Train    15:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.09it/s]
Train    15:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.25it/s]
Train    15:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.35it/s]
Train    15:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.43it/s]
Train    15:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.47it/s]
Train    15:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.52it/s]
Train    15:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.12it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.30it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.24it/s]
13 Oct 03:27    INFO  epoch 15 training [time: 1.34s, train loss: 14.4729]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.30it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.36it/s]
13 Oct 03:27    INFO  epoch 15 evaluating [time: 0.12s, valid_score: 0.833000]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8568    recall@10 : 0.8713    mrr@5 : 0.8311    mrr@10 : 0.833    ndcg@5 : 0.8376    ndcg@10 : 0.8423    hit@5 : 0.8568    hit@10 : 0.8713    precision@5 : 0.1714    precision@10 : 0.0871
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    16:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    16:   9%|████▋                                              | 1/11 [00:00<00:01,  8.73it/s]
Train    16:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.73it/s]
Train    16:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.78it/s]
Train    16:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.74it/s]
Train    16:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.71it/s]
Train    16:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.67it/s]
Train    16:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.69it/s]
Train    16:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.54it/s]
Train    16:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.51it/s]
Train    16:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.43it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.57it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.61it/s]
13 Oct 03:27    INFO  epoch 16 training [time: 1.28s, train loss: 13.7910]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.77it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 27.02it/s]
13 Oct 03:27    INFO  epoch 16 evaluating [time: 0.12s, valid_score: 0.839900]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8595    recall@10 : 0.8768    mrr@5 : 0.8377    mrr@10 : 0.8399    ndcg@5 : 0.8433    ndcg@10 : 0.8488    hit@5 : 0.8595    hit@10 : 0.8768    precision@5 : 0.1719    precision@10 : 0.0877
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    17:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    17:   9%|████▋                                              | 1/11 [00:00<00:01,  8.83it/s]
Train    17:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.57it/s]
Train    17:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.83it/s]
Train    17:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.44it/s]
Train    17:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.69it/s]
Train    17:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.89it/s]
Train    17:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.12it/s]
Train    17:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.25it/s]
Train    17:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.43it/s]
Train    17:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.49it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.37it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.13it/s]
13 Oct 03:27    INFO  epoch 17 training [time: 1.35s, train loss: 13.8125]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.86it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.59it/s]
13 Oct 03:27    INFO  epoch 17 evaluating [time: 0.18s, valid_score: 0.847100]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8618    recall@10 : 0.8763    mrr@5 : 0.8453    mrr@10 : 0.8471    ndcg@5 : 0.8495    ndcg@10 : 0.854    hit@5 : 0.8618    hit@10 : 0.8763    precision@5 : 0.1724    precision@10 : 0.0876
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    18:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    18:   9%|████▋                                              | 1/11 [00:00<00:01,  8.18it/s]
Train    18:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.76it/s]
Train    18:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.80it/s]
Train    18:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.99it/s]
Train    18:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.05it/s]
Train    18:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.73it/s]
Train    18:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.18it/s]
Train    18:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.52it/s]
Train    18:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.75it/s]
Train    18:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.94it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.02it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.55it/s]
13 Oct 03:27    INFO  epoch 18 training [time: 1.46s, train loss: 12.5664]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.69it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.07it/s]
13 Oct 03:27    INFO  epoch 18 evaluating [time: 0.16s, valid_score: 0.846500]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8614    recall@10 : 0.874    mrr@5 : 0.8449    mrr@10 : 0.8465    ndcg@5 : 0.849    ndcg@10 : 0.8531    hit@5 : 0.8614    hit@10 : 0.874    precision@5 : 0.1723    precision@10 : 0.0874

Train    19:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    19:   9%|████▋                                              | 1/11 [00:00<00:01,  8.10it/s]
Train    19:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.12it/s]
Train    19:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.38it/s]
Train    19:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.26it/s]
Train    19:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.43it/s]
Train    19:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.42it/s]
Train    19:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.37it/s]
Train    19:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.30it/s]
Train    19:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.37it/s]
Train    19:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.30it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.38it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.34it/s]
13 Oct 03:27    INFO  epoch 19 training [time: 1.32s, train loss: 12.8478]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.20it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.67it/s]
13 Oct 03:27    INFO  epoch 19 evaluating [time: 0.13s, valid_score: 0.846200]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8632    recall@10 : 0.8768    mrr@5 : 0.8445    mrr@10 : 0.8462    ndcg@5 : 0.8492    ndcg@10 : 0.8535    hit@5 : 0.8632    hit@10 : 0.8768    precision@5 : 0.1726    precision@10 : 0.0877

Train    20:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    20:   9%|████▋                                              | 1/11 [00:00<00:01,  8.72it/s]
Train    20:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.53it/s]
Train    20:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.68it/s]
Train    20:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.68it/s]
Train    20:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.69it/s]
Train    20:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.62it/s]
Train    20:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.59it/s]
Train    20:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.59it/s]
Train    20:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.60it/s]
Train    20:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.57it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.67it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.63it/s]
13 Oct 03:27    INFO  epoch 20 training [time: 1.27s, train loss: 13.0224]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.28it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.94it/s]
13 Oct 03:27    INFO  epoch 20 evaluating [time: 0.14s, valid_score: 0.848100]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8636    recall@10 : 0.8745    mrr@5 : 0.8466    mrr@10 : 0.8481    ndcg@5 : 0.8509    ndcg@10 : 0.8544    hit@5 : 0.8636    hit@10 : 0.8745    precision@5 : 0.1727    precision@10 : 0.0874
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    21:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    21:   9%|████▋                                              | 1/11 [00:00<00:01,  7.89it/s]
Train    21:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.91it/s]
Train    21:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.96it/s]
Train    21:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.05it/s]
Train    21:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.13it/s]
Train    21:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.18it/s]
Train    21:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.22it/s]
Train    21:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.22it/s]
Train    21:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.16it/s]
Train    21:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.09it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.15it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.12it/s]
13 Oct 03:27    INFO  epoch 21 training [time: 1.36s, train loss: 12.4144]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.74it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.20it/s]
13 Oct 03:27    INFO  epoch 21 evaluating [time: 0.17s, valid_score: 0.851200]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8632    recall@10 : 0.879    mrr@5 : 0.849    mrr@10 : 0.8512    ndcg@5 : 0.8526    ndcg@10 : 0.8578    hit@5 : 0.8632    hit@10 : 0.879    precision@5 : 0.1726    precision@10 : 0.0879
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    22:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    22:   9%|████▋                                              | 1/11 [00:00<00:01,  7.83it/s]
Train    22:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.08it/s]
Train    22:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.14it/s]
Train    22:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.15it/s]
Train    22:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.13it/s]
Train    22:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.14it/s]
Train    22:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.18it/s]
Train    22:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.46it/s]
Train    22:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.07it/s]
Train    22:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.55it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.93it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.74it/s]
13 Oct 03:27    INFO  epoch 22 training [time: 1.42s, train loss: 11.8914]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.94it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.66it/s]
13 Oct 03:27    INFO  epoch 22 evaluating [time: 0.13s, valid_score: 0.851100]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8654    recall@10 : 0.8781    mrr@5 : 0.8495    mrr@10 : 0.8511    ndcg@5 : 0.8535    ndcg@10 : 0.8575    hit@5 : 0.8654    hit@10 : 0.8781    precision@5 : 0.1731    precision@10 : 0.0878

Train    23:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    23:   9%|████▋                                              | 1/11 [00:00<00:01,  8.31it/s]
Train    23:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.28it/s]
Train    23:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.23it/s]
Train    23:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.17it/s]
Train    23:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.15it/s]
Train    23:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.16it/s]
Train    23:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.07it/s]
Train    23:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.03it/s]
Train    23:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.12it/s]
Train    23:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.18it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.15it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.15it/s]
13 Oct 03:27    INFO  epoch 23 training [time: 1.35s, train loss: 12.1349]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.58it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.41it/s]
13 Oct 03:27    INFO  epoch 23 evaluating [time: 0.14s, valid_score: 0.852000]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8663    recall@10 : 0.8795    mrr@5 : 0.8503    mrr@10 : 0.852    ndcg@5 : 0.8544    ndcg@10 : 0.8586    hit@5 : 0.8663    hit@10 : 0.8795    precision@5 : 0.1733    precision@10 : 0.0879
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    24:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    24:   9%|████▋                                              | 1/11 [00:00<00:01,  8.31it/s]
Train    24:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.46it/s]
Train    24:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.44it/s]
Train    24:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.45it/s]
Train    24:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.46it/s]
Train    24:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.64it/s]
Train    24:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.57it/s]
Train    24:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.58it/s]
Train    24:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.50it/s]
Train    24:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.39it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.41it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.47it/s]
13 Oct 03:27    INFO  epoch 24 training [time: 1.30s, train loss: 11.8702]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.10it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.40it/s]
13 Oct 03:27    INFO  epoch 24 evaluating [time: 0.14s, valid_score: 0.852800]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.865    recall@10 : 0.8799    mrr@5 : 0.8509    mrr@10 : 0.8528    ndcg@5 : 0.8544    ndcg@10 : 0.8592    hit@5 : 0.865    hit@10 : 0.8799    precision@5 : 0.173    precision@10 : 0.088
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    25:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    25:   9%|████▋                                              | 1/11 [00:00<00:01,  8.09it/s]
Train    25:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.11it/s]
Train    25:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.14it/s]
Train    25:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.17it/s]
Train    25:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.24it/s]
Train    25:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.30it/s]
Train    25:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.35it/s]
Train    25:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.26it/s]
Train    25:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.15it/s]
Train    25:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.18it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.31it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.24it/s]
13 Oct 03:27    INFO  epoch 25 training [time: 1.34s, train loss: 11.1678]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.87it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.14it/s]
13 Oct 03:27    INFO  epoch 25 evaluating [time: 0.16s, valid_score: 0.851000]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.865    recall@10 : 0.8799    mrr@5 : 0.8491    mrr@10 : 0.851    ndcg@5 : 0.8531    ndcg@10 : 0.8579    hit@5 : 0.865    hit@10 : 0.8799    precision@5 : 0.173    precision@10 : 0.088

Train    26:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    26:   9%|████▋                                              | 1/11 [00:00<00:01,  8.40it/s]
Train    26:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.30it/s]
Train    26:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.32it/s]
Train    26:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.42it/s]
Train    26:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.46it/s]
Train    26:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.21it/s]
Train    26:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.68it/s]
Train    26:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.98it/s]
Train    26:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.96it/s]
Train    26:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.22it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.51it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.40it/s]
13 Oct 03:27    INFO  epoch 26 training [time: 1.49s, train loss: 11.3607]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.86it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.90it/s]
13 Oct 03:27    INFO  epoch 26 evaluating [time: 0.17s, valid_score: 0.853200]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8632    recall@10 : 0.8799    mrr@5 : 0.8511    mrr@10 : 0.8532    ndcg@5 : 0.8541    ndcg@10 : 0.8595    hit@5 : 0.8632    hit@10 : 0.8799    precision@5 : 0.1726    precision@10 : 0.088
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    27:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    27:   9%|████▋                                              | 1/11 [00:00<00:01,  8.67it/s]
Train    27:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.53it/s]
Train    27:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.46it/s]
Train    27:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.43it/s]
Train    27:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.36it/s]
Train    27:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.30it/s]
Train    27:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.29it/s]
Train    27:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.24it/s]
Train    27:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.27it/s]
Train    27:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.31it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.41it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.36it/s]
13 Oct 03:27    INFO  epoch 27 training [time: 1.32s, train loss: 10.8968]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.88it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.11it/s]
13 Oct 03:27    INFO  epoch 27 evaluating [time: 0.14s, valid_score: 0.853800]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.865    recall@10 : 0.8777    mrr@5 : 0.8521    mrr@10 : 0.8538    ndcg@5 : 0.8553    ndcg@10 : 0.8594    hit@5 : 0.865    hit@10 : 0.8777    precision@5 : 0.173    precision@10 : 0.0878
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    28:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    28:   9%|████▋                                              | 1/11 [00:00<00:01,  8.10it/s]
Train    28:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.36it/s]
Train    28:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.40it/s]
Train    28:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.41it/s]
Train    28:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.35it/s]
Train    28:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.39it/s]
Train    28:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.32it/s]
Train    28:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.13it/s]
Train    28:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.13it/s]
Train    28:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.29it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.43it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.33it/s]
13 Oct 03:27    INFO  epoch 28 training [time: 1.32s, train loss: 10.6064]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.46it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.91it/s]
13 Oct 03:27    INFO  epoch 28 evaluating [time: 0.14s, valid_score: 0.853400]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8632    recall@10 : 0.8817    mrr@5 : 0.8511    mrr@10 : 0.8534    ndcg@5 : 0.8541    ndcg@10 : 0.86    hit@5 : 0.8632    hit@10 : 0.8817    precision@5 : 0.1726    precision@10 : 0.0882

Train    29:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    29:   9%|████▋                                              | 1/11 [00:00<00:01,  8.27it/s]
Train    29:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.29it/s]
Train    29:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.40it/s]
Train    29:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.42it/s]
Train    29:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.44it/s]
Train    29:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.44it/s]
Train    29:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.50it/s]
Train    29:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.47it/s]
Train    29:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.48it/s]
Train    29:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.48it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.53it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.46it/s]
13 Oct 03:27    INFO  epoch 29 training [time: 1.30s, train loss: 11.5707]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.64it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.59it/s]
13 Oct 03:27    INFO  epoch 29 evaluating [time: 0.13s, valid_score: 0.856100]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8659    recall@10 : 0.8831    mrr@5 : 0.8539    mrr@10 : 0.8561    ndcg@5 : 0.8569    ndcg@10 : 0.8624    hit@5 : 0.8659    hit@10 : 0.8831    precision@5 : 0.1732    precision@10 : 0.0883
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    30:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    30:   9%|████▋                                              | 1/11 [00:00<00:01,  8.68it/s]
Train    30:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.46it/s]
Train    30:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.65it/s]
Train    30:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.51it/s]
Train    30:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.27it/s]
Train    30:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.14it/s]
Train    30:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.04it/s]
Train    30:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  7.86it/s]
Train    30:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.36it/s]
Train    30:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  4.88it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  5.53it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.77it/s]
13 Oct 03:27    INFO  epoch 30 training [time: 1.62s, train loss: 11.1870]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.49it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.47it/s]
13 Oct 03:27    INFO  epoch 30 evaluating [time: 0.17s, valid_score: 0.856500]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8668    recall@10 : 0.8781    mrr@5 : 0.855    mrr@10 : 0.8565    ndcg@5 : 0.858    ndcg@10 : 0.8616    hit@5 : 0.8668    hit@10 : 0.8781    precision@5 : 0.1734    precision@10 : 0.0878
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    31:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    31:   9%|████▋                                              | 1/11 [00:00<00:01,  7.50it/s]
Train    31:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.99it/s]
Train    31:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.77it/s]
Train    31:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.81it/s]
Train    31:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.76it/s]
Train    31:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.87it/s]
Train    31:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.88it/s]
Train    31:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.81it/s]
Train    31:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.42it/s]
Train    31:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.35it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.18it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.54it/s]
13 Oct 03:27    INFO  epoch 31 training [time: 1.46s, train loss: 11.6632]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.46it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.04it/s]
13 Oct 03:27    INFO  epoch 31 evaluating [time: 0.16s, valid_score: 0.857800]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8691    recall@10 : 0.8826    mrr@5 : 0.8561    mrr@10 : 0.8578    ndcg@5 : 0.8593    ndcg@10 : 0.8636    hit@5 : 0.8691    hit@10 : 0.8826    precision@5 : 0.1738    precision@10 : 0.0883
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    32:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    32:   9%|████▋                                              | 1/11 [00:00<00:01,  7.62it/s]
Train    32:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.90it/s]
Train    32:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.52it/s]
Train    32:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.83it/s]
Train    32:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.84it/s]
Train    32:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.09it/s]
Train    32:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.03it/s]
Train    32:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.36it/s]
Train    32:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.68it/s]
Train    32:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.82it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.93it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.49it/s]
13 Oct 03:27    INFO  epoch 32 training [time: 1.47s, train loss: 10.8215]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.27it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.58it/s]
13 Oct 03:27    INFO  epoch 32 evaluating [time: 0.14s, valid_score: 0.857100]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8695    recall@10 : 0.8799    mrr@5 : 0.8557    mrr@10 : 0.8571    ndcg@5 : 0.8591    ndcg@10 : 0.8625    hit@5 : 0.8695    hit@10 : 0.8799    precision@5 : 0.1739    precision@10 : 0.088

Train    33:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    33:   9%|████▋                                              | 1/11 [00:00<00:01,  8.29it/s]
Train    33:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.42it/s]
Train    33:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.39it/s]
Train    33:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.10it/s]
Train    33:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.91it/s]
Train    33:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.99it/s]
Train    33:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.95it/s]
Train    33:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.83it/s]
Train    33:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.75it/s]
Train    33:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.82it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.87it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.95it/s]
13 Oct 03:27    INFO  epoch 33 training [time: 1.38s, train loss: 10.5476]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.73it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.40it/s]
13 Oct 03:27    INFO  epoch 33 evaluating [time: 0.16s, valid_score: 0.856500]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8663    recall@10 : 0.8813    mrr@5 : 0.8545    mrr@10 : 0.8565    ndcg@5 : 0.8575    ndcg@10 : 0.8623    hit@5 : 0.8663    hit@10 : 0.8813    precision@5 : 0.1733    precision@10 : 0.0881

Train    34:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    34:   9%|████▋                                              | 1/11 [00:00<00:01,  7.88it/s]
Train    34:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.13it/s]
Train    34:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.21it/s]
Train    34:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.20it/s]
Train    34:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.25it/s]
Train    34:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.26it/s]
Train    34:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.36it/s]
Train    34:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.87it/s]
Train    34:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.23it/s]
Train    34:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.53it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.80it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.62it/s]
13 Oct 03:27    INFO  epoch 34 training [time: 1.44s, train loss: 10.8687]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.68it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.96it/s]
13 Oct 03:27    INFO  epoch 34 evaluating [time: 0.14s, valid_score: 0.858100]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8663    recall@10 : 0.8808    mrr@5 : 0.8561    mrr@10 : 0.8581    ndcg@5 : 0.8587    ndcg@10 : 0.8634    hit@5 : 0.8663    hit@10 : 0.8808    precision@5 : 0.1733    precision@10 : 0.0881
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    35:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    35:   9%|████▋                                              | 1/11 [00:00<00:01,  8.46it/s]
Train    35:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.45it/s]
Train    35:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.44it/s]
Train    35:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.38it/s]
Train    35:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.28it/s]
Train    35:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.23it/s]
Train    35:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.17it/s]
Train    35:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.14it/s]
Train    35:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.10it/s]
Train    35:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.08it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.10it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.19it/s]
13 Oct 03:27    INFO  epoch 35 training [time: 1.34s, train loss: 10.3804]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.54it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.48it/s]
13 Oct 03:27    INFO  epoch 35 evaluating [time: 0.14s, valid_score: 0.858700]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8718    recall@10 : 0.8836    mrr@5 : 0.8572    mrr@10 : 0.8587    ndcg@5 : 0.8608    ndcg@10 : 0.8646    hit@5 : 0.8718    hit@10 : 0.8836    precision@5 : 0.1744    precision@10 : 0.0884
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    36:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    36:   9%|████▋                                              | 1/11 [00:00<00:01,  8.15it/s]
Train    36:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.02it/s]
Train    36:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.09it/s]
Train    36:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.12it/s]
Train    36:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.19it/s]
Train    36:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.17it/s]
Train    36:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.17it/s]
Train    36:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.17it/s]
Train    36:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.18it/s]
Train    36:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.00it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.13it/s]
13 Oct 03:27    INFO  epoch 36 training [time: 1.35s, train loss: 9.6793]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.48it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.48it/s]
13 Oct 03:27    INFO  epoch 36 evaluating [time: 0.16s, valid_score: 0.857000]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8691    recall@10 : 0.8836    mrr@5 : 0.855    mrr@10 : 0.857    ndcg@5 : 0.8585    ndcg@10 : 0.8633    hit@5 : 0.8691    hit@10 : 0.8836    precision@5 : 0.1738    precision@10 : 0.0884

Train    37:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    37:   9%|████▋                                              | 1/11 [00:00<00:01,  8.29it/s]
Train    37:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.10it/s]
Train    37:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.99it/s]
Train    37:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.10it/s]
Train    37:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.06it/s]
Train    37:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.12it/s]
Train    37:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.21it/s]
Train    37:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.20it/s]
Train    37:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.18it/s]
Train    37:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.21it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.33it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.20it/s]
13 Oct 03:27    INFO  epoch 37 training [time: 1.34s, train loss: 9.9846]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.74it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.68it/s]
13 Oct 03:27    INFO  epoch 37 evaluating [time: 0.15s, valid_score: 0.856700]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.87    recall@10 : 0.8808    mrr@5 : 0.8552    mrr@10 : 0.8567    ndcg@5 : 0.8589    ndcg@10 : 0.8625    hit@5 : 0.87    hit@10 : 0.8808    precision@5 : 0.174    precision@10 : 0.0881

Train    38:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    38:   9%|████▋                                              | 1/11 [00:00<00:01,  7.85it/s]
Train    38:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.34it/s]
Train    38:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.15it/s]
Train    38:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.39it/s]
Train    38:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.46it/s]
Train    38:  55%|███████████████████████████▊                       | 6/11 [00:01<00:01,  4.91it/s]
Train    38:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  5.63it/s]
Train    38:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.16it/s]
Train    38:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  5.89it/s]
Train    38:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.25it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.74it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.42it/s]
13 Oct 03:27    INFO  epoch 38 training [time: 1.71s, train loss: 10.5779]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.94it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.24it/s]
13 Oct 03:27    INFO  epoch 38 evaluating [time: 0.14s, valid_score: 0.858800]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8722    recall@10 : 0.8822    mrr@5 : 0.8574    mrr@10 : 0.8588    ndcg@5 : 0.8612    ndcg@10 : 0.8644    hit@5 : 0.8722    hit@10 : 0.8822    precision@5 : 0.1744    precision@10 : 0.0882
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    39:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    39:   9%|████▋                                              | 1/11 [00:00<00:01,  8.35it/s]
Train    39:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.29it/s]
Train    39:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.16it/s]
Train    39:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.14it/s]
Train    39:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.03it/s]
Train    39:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.98it/s]
Train    39:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.98it/s]
Train    39:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.02it/s]
Train    39:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.95it/s]
Train    39:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.90it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.08it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.05it/s]
13 Oct 03:27    INFO  epoch 39 training [time: 1.37s, train loss: 10.6653]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.21it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.98it/s]
13 Oct 03:27    INFO  epoch 39 evaluating [time: 0.13s, valid_score: 0.858100]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8672    recall@10 : 0.8799    mrr@5 : 0.8565    mrr@10 : 0.8581    ndcg@5 : 0.8592    ndcg@10 : 0.8633    hit@5 : 0.8672    hit@10 : 0.8799    precision@5 : 0.1734    precision@10 : 0.088

Train    40:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    40:   9%|████▋                                              | 1/11 [00:00<00:01,  7.95it/s]
Train    40:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.05it/s]
Train    40:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.98it/s]
Train    40:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.14it/s]
Train    40:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.15it/s]
Train    40:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.15it/s]
Train    40:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.16it/s]
Train    40:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.18it/s]
Train    40:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.12it/s]
Train    40:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.17it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.27it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.16it/s]
13 Oct 03:27    INFO  epoch 40 training [time: 1.35s, train loss: 10.5997]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.02it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.54it/s]
13 Oct 03:27    INFO  epoch 40 evaluating [time: 0.13s, valid_score: 0.857800]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8681    recall@10 : 0.8808    mrr@5 : 0.8561    mrr@10 : 0.8578    ndcg@5 : 0.8592    ndcg@10 : 0.8632    hit@5 : 0.8681    hit@10 : 0.8808    precision@5 : 0.1736    precision@10 : 0.0881

Train    41:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    41:   9%|████▋                                              | 1/11 [00:00<00:01,  8.31it/s]
Train    41:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.26it/s]
Train    41:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.13it/s]
Train    41:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.13it/s]
Train    41:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.23it/s]
Train    41:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.17it/s]
Train    41:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.17it/s]
Train    41:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.22it/s]
Train    41:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.28it/s]
Train    41:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.36it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.44it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.28it/s]
13 Oct 03:27    INFO  epoch 41 training [time: 1.33s, train loss: 10.7493]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.81it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.70it/s]
13 Oct 03:27    INFO  epoch 41 evaluating [time: 0.12s, valid_score: 0.858500]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.87    recall@10 : 0.8813    mrr@5 : 0.857    mrr@10 : 0.8585    ndcg@5 : 0.8603    ndcg@10 : 0.8639    hit@5 : 0.87    hit@10 : 0.8813    precision@5 : 0.174    precision@10 : 0.0881

Train    42:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    42:   9%|████▋                                              | 1/11 [00:00<00:01,  8.50it/s]
Train    42:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.46it/s]
Train    42:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.48it/s]
Train    42:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.50it/s]
Train    42:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.46it/s]
Train    42:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.58it/s]
Train    42:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.17it/s]
Train    42:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.63it/s]
Train    42:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.87it/s]
Train    42:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.01it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.91it/s]
13 Oct 03:27    INFO  epoch 42 training [time: 1.39s, train loss: 9.9017]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.46it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.36it/s]
13 Oct 03:27    INFO  epoch 42 evaluating [time: 0.13s, valid_score: 0.857900]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8691    recall@10 : 0.8813    mrr@5 : 0.8563    mrr@10 : 0.8579    ndcg@5 : 0.8595    ndcg@10 : 0.8634    hit@5 : 0.8691    hit@10 : 0.8813    precision@5 : 0.1738    precision@10 : 0.0881

Train    43:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    43:   9%|████▋                                              | 1/11 [00:00<00:01,  8.25it/s]
Train    43:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.24it/s]
Train    43:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.13it/s]
Train    43:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.13it/s]
Train    43:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.15it/s]
Train    43:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.17it/s]
Train    43:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.18it/s]
Train    43:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.24it/s]
Train    43:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.24it/s]
Train    43:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.27it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.34it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.24it/s]
13 Oct 03:27    INFO  epoch 43 training [time: 1.34s, train loss: 9.9610]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.37it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.97it/s]
13 Oct 03:27    INFO  epoch 43 evaluating [time: 0.13s, valid_score: 0.857500]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8695    recall@10 : 0.8831    mrr@5 : 0.8558    mrr@10 : 0.8575    ndcg@5 : 0.8592    ndcg@10 : 0.8635    hit@5 : 0.8695    hit@10 : 0.8831    precision@5 : 0.1739    precision@10 : 0.0883

Train    44:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    44:   9%|████▋                                              | 1/11 [00:00<00:01,  8.48it/s]
Train    44:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.34it/s]
Train    44:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.40it/s]
Train    44:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.42it/s]
Train    44:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.41it/s]
Train    44:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.35it/s]
Train    44:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.36it/s]
Train    44:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.34it/s]
Train    44:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.28it/s]
Train    44:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.27it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.33it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.35it/s]
13 Oct 03:27    INFO  epoch 44 training [time: 1.32s, train loss: 10.8407]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.84it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.14it/s]
13 Oct 03:27    INFO  epoch 44 evaluating [time: 0.13s, valid_score: 0.859200]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8709    recall@10 : 0.8822    mrr@5 : 0.8577    mrr@10 : 0.8592    ndcg@5 : 0.861    ndcg@10 : 0.8647    hit@5 : 0.8709    hit@10 : 0.8822    precision@5 : 0.1742    precision@10 : 0.0882
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Train    45:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    45:   9%|████▋                                              | 1/11 [00:00<00:01,  8.07it/s]
Train    45:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.21it/s]
Train    45:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.22it/s]
Train    45:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.19it/s]
Train    45:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.11it/s]
Train    45:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.08it/s]
Train    45:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.11it/s]
Train    45:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.16it/s]
Train    45:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.19it/s]
Train    45:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.17it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.24it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.18it/s]
13 Oct 03:27    INFO  epoch 45 training [time: 1.35s, train loss: 10.1505]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.12it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.90it/s]
13 Oct 03:27    INFO  epoch 45 evaluating [time: 0.13s, valid_score: 0.857400]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8681    recall@10 : 0.8817    mrr@5 : 0.8556    mrr@10 : 0.8574    ndcg@5 : 0.8588    ndcg@10 : 0.8632    hit@5 : 0.8681    hit@10 : 0.8817    precision@5 : 0.1736    precision@10 : 0.0882

Train    46:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    46:   9%|████▋                                              | 1/11 [00:00<00:01,  8.17it/s]
Train    46:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.13it/s]
Train    46:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.19it/s]
Train    46:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.20it/s]
Train    46:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.25it/s]
Train    46:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.22it/s]
Train    46:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.19it/s]
Train    46:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.15it/s]
Train    46:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.14it/s]
Train    46:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.49it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.98it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.62it/s]
13 Oct 03:27    INFO  epoch 46 training [time: 1.45s, train loss: 9.9342]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.14it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.36it/s]
13 Oct 03:27    INFO  epoch 46 evaluating [time: 0.15s, valid_score: 0.855800]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8686    recall@10 : 0.8808    mrr@5 : 0.8543    mrr@10 : 0.8558    ndcg@5 : 0.8579    ndcg@10 : 0.8617    hit@5 : 0.8686    hit@10 : 0.8808    precision@5 : 0.1737    precision@10 : 0.0881

Train    47:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    47:   9%|████▋                                              | 1/11 [00:00<00:01,  8.46it/s]
Train    47:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.32it/s]
Train    47:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.44it/s]
Train    47:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.30it/s]
Train    47:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.34it/s]
Train    47:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.38it/s]
Train    47:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.16it/s]
Train    47:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.07it/s]
Train    47:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.06it/s]
Train    47:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.96it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.71it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.05it/s]
13 Oct 03:27    INFO  epoch 47 training [time: 1.37s, train loss: 10.1212]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 11.24it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 15.26it/s]
13 Oct 03:27    INFO  epoch 47 evaluating [time: 0.22s, valid_score: 0.856100]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8663    recall@10 : 0.8822    mrr@5 : 0.8541    mrr@10 : 0.8561    ndcg@5 : 0.8572    ndcg@10 : 0.8623    hit@5 : 0.8663    hit@10 : 0.8822    precision@5 : 0.1733    precision@10 : 0.0882

Train    48:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    48:   9%|████▋                                              | 1/11 [00:00<00:01,  7.69it/s]
Train    48:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.93it/s]
Train    48:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.09it/s]
Train    48:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.11it/s]
Train    48:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.64it/s]
Train    48:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.84it/s]
Train    48:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.61it/s]
Train    48:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.83it/s]
Train    48:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.62it/s]
Train    48:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.42it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.59it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.70it/s]
13 Oct 03:27    INFO  epoch 48 training [time: 1.43s, train loss: 9.6544]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.98it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.79it/s]
13 Oct 03:27    INFO  epoch 48 evaluating [time: 0.13s, valid_score: 0.858000]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8695    recall@10 : 0.8822    mrr@5 : 0.8564    mrr@10 : 0.858    ndcg@5 : 0.8597    ndcg@10 : 0.8637    hit@5 : 0.8695    hit@10 : 0.8822    precision@5 : 0.1739    precision@10 : 0.0882

Train    49:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    49:   9%|████▋                                              | 1/11 [00:00<00:01,  8.09it/s]
Train    49:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.09it/s]
Train    49:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.10it/s]
Train    49:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.13it/s]
Train    49:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.14it/s]
Train    49:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.18it/s]
Train    49:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.16it/s]
Train    49:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.14it/s]
Train    49:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.15it/s]
Train    49:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.06it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.13it/s]
13 Oct 03:27    INFO  epoch 49 training [time: 1.35s, train loss: 9.3699]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.81it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.15it/s]
13 Oct 03:27    INFO  epoch 49 evaluating [time: 0.16s, valid_score: 0.859600]
13 Oct 03:27    INFO  valid result: 
recall@5 : 0.8709    recall@10 : 0.8804    mrr@5 : 0.8583    mrr@10 : 0.8596    ndcg@5 : 0.8615    ndcg@10 : 0.8645    hit@5 : 0.8709    hit@10 : 0.8804    precision@5 : 0.1742    precision@10 : 0.088
13 Oct 03:27    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-26-41.pth
13 Oct 03:27    INFO  Loading model structure and parameters from saved/BERT4Rec-Oct-13-2025_03-26-41.pth

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.74it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.13it/s]
13 Oct 03:28    INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |     5.80 %     |
+-------------+----------------+
| GPU         |   0.0 / 0.0    |
+-------------+----------------+
| Memory      | 1.20 G/15.33 G |
+-------------+----------------+
13 Oct 03:28    INFO  best valid : OrderedDict({'recall@5': 0.8709, 'recall@10': 0.8804, 'mrr@5': 0.8583, 'mrr@10': 0.8596, 'ndcg@5': 0.8615, 'ndcg@10': 0.8645, 'hit@5': 0.8709, 'hit@10': 0.8804, 'precision@5': 0.1742, 'precision@10': 0.088})
13 Oct 03:28    INFO  test result: OrderedDict({'recall@5': 0.9726, 'recall@10': 0.9787, 'mrr@5': 0.9521, 'mrr@10': 0.953, 'ndcg@5': 0.9573, 'ndcg@10': 0.9593, 'hit@5': 0.9726, 'hit@10': 0.9787, 'precision@5': 0.1945, 'precision@10': 0.0979})
2025-10-13 03:28:02,138 | INFO | Published checkpoint /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/saved/BERT4Rec-Oct-13-2025_03-26-41.pth → /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/versions/BERT4Rec-Oct-13-2025_03-26-41.pth
2025-10-13 03:28:02,139 | INFO | Retraining completed in 0:01:27.482624 | dataset=20251012-202636 | model=Oct-13-2025_03-26-41
2025-10-13 03:28:32,142 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:28:32,969 | INFO | 🔄 Đang trích xuất data từ Postgres...
🐘 Đã trích xuất bằng psycopg.
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 69
Số user: 2
Số sản phẩm: 11
Các loại event: {'add_to_cart': 0.42, 'view': 0.377, 'purchase': 0.203}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[10 rows x 5 columns]
2025-10-13 03:28:32,969 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:28:33,459 | INFO | 🗂  Đã cập nhật /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/interactions.csv (tổng 18356 bản ghi).
✅ Đã tạo snapshot 20251012-202833 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-202833/ecommerce.inter) với 18356 dòng
👥  User: 2608 | 🛒  Sản phẩm: 106
🏷️   Nhãn mua hàng (label=1): 2992
      user_id item_id   timestamp  label
4952        3      25  1704067200      0
4953        3      25  1704068520      0
18244       3      89  1707264000      0
18245       3      89  1707264300      0
18246       3      89  1707265440      0
18247       3      89  1707266820      1
1123        3      12  1708041600      0
1124        3      12  1708044480      0
10396       4       4  1707436800      0
10397       4       4  1707437100      0
2025-10-13 03:28:33,459 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-193709
2025-10-13 03:28:33,460 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 03:29:57,961 | INFO | 13 Oct 03:28    INFO  ['train_bert4rec.py']
13 Oct 03:28    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = False
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
device = cuda
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 03:28    INFO  ecommerce
The number of users: 2608
Average actions of users: 7.041043344840813
The number of items: 96
Average actions of items: 193.22105263157894
The number of inters: 18356
The sparsity of the dataset: 92.66839212678937%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 03:28    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 03:28    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 03:28    INFO  BERT4Rec(
  (item_embedding): Embedding(97, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 113888
13 Oct 03:28    INFO  FLOPs: 5194664.0
🔧 Sử dụng topk=[5, 10], valid_metric=MRR@10, device=cpu

Train     0:   0%|                                                           | 0/11 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   9%|████▋                                              | 1/11 [00:00<00:03,  3.29it/s]
Train     0:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.09it/s]
Train     0:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.29it/s]
Train     0:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.18it/s]
Train     0:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.70it/s]
Train     0:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.06it/s]
Train     0:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.27it/s]
Train     0:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.43it/s]
Train     0:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.60it/s]
Train     0:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.65it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.84it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.66it/s]
13 Oct 03:28    INFO  epoch 0 training [time: 1.44s, train loss: 49.8349]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.10it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.47it/s]
13 Oct 03:28    INFO  epoch 0 evaluating [time: 0.14s, valid_score: 0.058600]
13 Oct 03:28    INFO  valid result: 
recall@5 : 0.0973    recall@10 : 0.1738    mrr@5 : 0.0488    mrr@10 : 0.0586    ndcg@5 : 0.0608    ndcg@10 : 0.0851    hit@5 : 0.0973    hit@10 : 0.1738    precision@5 : 0.0195    precision@10 : 0.0174
13 Oct 03:28    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train     1:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     1:   9%|████▋                                              | 1/11 [00:00<00:01,  9.13it/s]
Train     1:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.22it/s]
Train     1:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.25it/s]
Train     1:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.29it/s]
Train     1:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.81it/s]
Train     1:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.72it/s]
Train     1:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.74it/s]
Train     1:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.78it/s]
Train     1:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.69it/s]
Train     1:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.73it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.77it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.85it/s]
13 Oct 03:28    INFO  epoch 1 training [time: 1.24s, train loss: 49.0051]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.24it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.00it/s]
13 Oct 03:28    INFO  epoch 1 evaluating [time: 0.13s, valid_score: 0.081300]
13 Oct 03:28    INFO  valid result: 
recall@5 : 0.1521    recall@10 : 0.2558    mrr@5 : 0.0679    mrr@10 : 0.0813    ndcg@5 : 0.0885    ndcg@10 : 0.1215    hit@5 : 0.1521    hit@10 : 0.2558    precision@5 : 0.0304    precision@10 : 0.0256
13 Oct 03:28    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train     2:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     2:   9%|████▋                                              | 1/11 [00:00<00:01,  8.80it/s]
Train     2:  18%|█████████▎                                         | 2/11 [00:00<00:01,  9.00it/s]
Train     2:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.04it/s]
Train     2:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.07it/s]
Train     2:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.48it/s]
Train     2:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.15it/s]
Train     2:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.71it/s]
Train     2:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.02it/s]
Train     2:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.29it/s]
Train     2:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.49it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.57it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.16it/s]
13 Oct 03:28    INFO  epoch 2 training [time: 1.35s, train loss: 46.7460]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.77it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.92it/s]
13 Oct 03:28    INFO  epoch 2 evaluating [time: 0.12s, valid_score: 0.280700]
13 Oct 03:28    INFO  valid result: 
recall@5 : 0.4178    recall@10 : 0.5514    mrr@5 : 0.2634    mrr@10 : 0.2807    ndcg@5 : 0.3017    ndcg@10 : 0.3444    hit@5 : 0.4178    hit@10 : 0.5514    precision@5 : 0.0836    precision@10 : 0.0551
13 Oct 03:28    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train     3:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     3:   9%|████▋                                              | 1/11 [00:00<00:01,  8.75it/s]
Train     3:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.86it/s]
Train     3:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.75it/s]
Train     3:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.76it/s]
Train     3:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.89it/s]
Train     3:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.72it/s]
Train     3:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.61it/s]
Train     3:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.66it/s]
Train     3:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.59it/s]
Train     3:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.63it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.75it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.72it/s]
13 Oct 03:28    INFO  epoch 3 training [time: 1.26s, train loss: 42.6567]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.73it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.94it/s]
13 Oct 03:28    INFO  epoch 3 evaluating [time: 0.12s, valid_score: 0.492600]
13 Oct 03:28    INFO  valid result: 
recall@5 : 0.6378    recall@10 : 0.6967    mrr@5 : 0.4847    mrr@10 : 0.4926    ndcg@5 : 0.5233    ndcg@10 : 0.5424    hit@5 : 0.6378    hit@10 : 0.6967    precision@5 : 0.1276    precision@10 : 0.0697
13 Oct 03:28    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train     4:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     4:   9%|████▋                                              | 1/11 [00:00<00:01,  8.59it/s]
Train     4:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.74it/s]
Train     4:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.73it/s]
Train     4:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.74it/s]
Train     4:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.79it/s]
Train     4:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.78it/s]
Train     4:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.85it/s]
Train     4:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.70it/s]
Train     4:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.20it/s]
Train     4:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.24it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.40it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.55it/s]
13 Oct 03:28    INFO  epoch 4 training [time: 1.29s, train loss: 38.6486]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.57it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.41it/s]
13 Oct 03:28    INFO  epoch 4 evaluating [time: 0.13s, valid_score: 0.615600]
13 Oct 03:28    INFO  valid result: 
recall@5 : 0.7003    recall@10 : 0.7601    mrr@5 : 0.608    mrr@10 : 0.6156    ndcg@5 : 0.6313    ndcg@10 : 0.6502    hit@5 : 0.7003    hit@10 : 0.7601    precision@5 : 0.1401    precision@10 : 0.076
13 Oct 03:28    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train     5:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     5:   9%|████▋                                              | 1/11 [00:00<00:01,  8.70it/s]
Train     5:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.89it/s]
Train     5:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.72it/s]
Train     5:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.66it/s]
Train     5:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.70it/s]
Train     5:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.79it/s]
Train     5:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.85it/s]
Train     5:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.85it/s]
Train     5:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.70it/s]
Train     5:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.54it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.44it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.64it/s]
13 Oct 03:28    INFO  epoch 5 training [time: 1.27s, train loss: 34.9015]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.24it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.17it/s]
13 Oct 03:28    INFO  epoch 5 evaluating [time: 0.14s, valid_score: 0.645200]
13 Oct 03:28    INFO  valid result: 
recall@5 : 0.7284    recall@10 : 0.7768    mrr@5 : 0.6386    mrr@10 : 0.6452    ndcg@5 : 0.6612    ndcg@10 : 0.6769    hit@5 : 0.7284    hit@10 : 0.7768    precision@5 : 0.1457    precision@10 : 0.0777
13 Oct 03:28    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train     6:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     6:   9%|████▋                                              | 1/11 [00:00<00:01,  8.78it/s]
Train     6:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.67it/s]
Train     6:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.61it/s]
Train     6:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.42it/s]
Train     6:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.29it/s]
Train     6:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.52it/s]
Train     6:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.64it/s]
Train     6:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.32it/s]
Train     6:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.96it/s]
Train     6:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.45it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.88it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.84it/s]
13 Oct 03:28    INFO  epoch 6 training [time: 1.40s, train loss: 31.7765]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.43it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.04it/s]
13 Oct 03:28    INFO  epoch 6 evaluating [time: 0.14s, valid_score: 0.691000]
13 Oct 03:28    INFO  valid result: 
recall@5 : 0.7741    recall@10 : 0.8158    mrr@5 : 0.6854    mrr@10 : 0.691    ndcg@5 : 0.7077    ndcg@10 : 0.7211    hit@5 : 0.7741    hit@10 : 0.8158    precision@5 : 0.1548    precision@10 : 0.0816
13 Oct 03:28    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train     7:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     7:   9%|████▋                                              | 1/11 [00:00<00:01,  8.60it/s]
Train     7:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.60it/s]
Train     7:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.47it/s]
Train     7:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.59it/s]
Train     7:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.67it/s]
Train     7:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.68it/s]
Train     7:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.79it/s]
Train     7:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.81it/s]
Train     7:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.85it/s]
Train     7:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.74it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.78it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.72it/s]
13 Oct 03:28    INFO  epoch 7 training [time: 1.26s, train loss: 28.4992]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 11.59it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 16.17it/s]
13 Oct 03:28    INFO  epoch 7 evaluating [time: 0.21s, valid_score: 0.744100]
13 Oct 03:28    INFO  valid result: 
recall@5 : 0.8013    recall@10 : 0.833    mrr@5 : 0.7399    mrr@10 : 0.7441    ndcg@5 : 0.7554    ndcg@10 : 0.7656    hit@5 : 0.8013    hit@10 : 0.833    precision@5 : 0.1603    precision@10 : 0.0833
13 Oct 03:28    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train     8:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     8:   9%|████▋                                              | 1/11 [00:00<00:01,  8.29it/s]
Train     8:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.32it/s]
Train     8:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.53it/s]
Train     8:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.65it/s]
Train     8:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.64it/s]
Train     8:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.68it/s]
Train     8:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.62it/s]
Train     8:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.51it/s]
Train     8:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.40it/s]
Train     8:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.36it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.42it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.48it/s]
13 Oct 03:28    INFO  epoch 8 training [time: 1.30s, train loss: 26.0906]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.29it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.25it/s]
13 Oct 03:28    INFO  epoch 8 evaluating [time: 0.15s, valid_score: 0.749200]
13 Oct 03:28    INFO  valid result: 
recall@5 : 0.8067    recall@10 : 0.8411    mrr@5 : 0.7446    mrr@10 : 0.7492    ndcg@5 : 0.7602    ndcg@10 : 0.7714    hit@5 : 0.8067    hit@10 : 0.8411    precision@5 : 0.1613    precision@10 : 0.0841
13 Oct 03:28    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train     9:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     9:   9%|████▋                                              | 1/11 [00:00<00:01,  9.08it/s]
Train     9:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.90it/s]
Train     9:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.98it/s]
Train     9:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.97it/s]
Train     9:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.90it/s]
Train     9:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.84it/s]
Train     9:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.69it/s]
Train     9:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.67it/s]
Train     9:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.72it/s]
Train     9:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.70it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.58it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.74it/s]
13 Oct 03:28    INFO  epoch 9 training [time: 1.26s, train loss: 23.4732]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.30it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.20it/s]
13 Oct 03:28    INFO  epoch 9 evaluating [time: 0.15s, valid_score: 0.772400]
13 Oct 03:28    INFO  valid result: 
recall@5 : 0.8244    recall@10 : 0.8529    mrr@5 : 0.7686    mrr@10 : 0.7724    ndcg@5 : 0.7826    ndcg@10 : 0.7919    hit@5 : 0.8244    hit@10 : 0.8529    precision@5 : 0.1649    precision@10 : 0.0853
13 Oct 03:28    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    10:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    10:   9%|████▋                                              | 1/11 [00:00<00:01,  8.53it/s]
Train    10:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.69it/s]
Train    10:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.69it/s]
Train    10:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.74it/s]
Train    10:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.72it/s]
Train    10:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.72it/s]
Train    10:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.54it/s]
Train    10:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.49it/s]
Train    10:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.40it/s]
Train    10:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.98it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.48it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.87it/s]
13 Oct 03:28    INFO  epoch 10 training [time: 1.40s, train loss: 21.4298]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.78it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.44it/s]
13 Oct 03:28    INFO  epoch 10 evaluating [time: 0.13s, valid_score: 0.797500]
13 Oct 03:28    INFO  valid result: 
recall@5 : 0.8348    recall@10 : 0.8547    mrr@5 : 0.7948    mrr@10 : 0.7975    ndcg@5 : 0.8048    ndcg@10 : 0.8114    hit@5 : 0.8348    hit@10 : 0.8547    precision@5 : 0.167    precision@10 : 0.0855
13 Oct 03:28    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    11:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    11:   9%|████▋                                              | 1/11 [00:00<00:01,  8.80it/s]
Train    11:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.94it/s]
Train    11:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.00it/s]
Train    11:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.88it/s]
Train    11:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.96it/s]
Train    11:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.60it/s]
Train    11:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.41it/s]
Train    11:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.32it/s]
Train    11:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.22it/s]
Train    11:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.23it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.19it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.45it/s]
13 Oct 03:28    INFO  epoch 11 training [time: 1.30s, train loss: 19.1633]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.35it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.03it/s]
13 Oct 03:28    INFO  epoch 11 evaluating [time: 0.15s, valid_score: 0.814300]
13 Oct 03:28    INFO  valid result: 
recall@5 : 0.8429    recall@10 : 0.8574    mrr@5 : 0.8123    mrr@10 : 0.8143    ndcg@5 : 0.8201    ndcg@10 : 0.8248    hit@5 : 0.8429    hit@10 : 0.8574    precision@5 : 0.1686    precision@10 : 0.0857
13 Oct 03:28    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    12:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    12:   9%|████▋                                              | 1/11 [00:00<00:01,  8.46it/s]
Train    12:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.53it/s]
Train    12:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.73it/s]
Train    12:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.84it/s]
Train    12:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.88it/s]
Train    12:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.75it/s]
Train    12:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.58it/s]
Train    12:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.52it/s]
Train    12:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.54it/s]
Train    12:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.51it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.59it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.62it/s]
13 Oct 03:28    INFO  epoch 12 training [time: 1.28s, train loss: 18.3293]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.23it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.51it/s]
13 Oct 03:28    INFO  epoch 12 evaluating [time: 0.16s, valid_score: 0.823000]
13 Oct 03:28    INFO  valid result: 
recall@5 : 0.8506    recall@10 : 0.8665    mrr@5 : 0.821    mrr@10 : 0.823    ndcg@5 : 0.8284    ndcg@10 : 0.8335    hit@5 : 0.8506    hit@10 : 0.8665    precision@5 : 0.1701    precision@10 : 0.0866
13 Oct 03:28    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    13:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    13:   9%|████▋                                              | 1/11 [00:00<00:01,  8.99it/s]
Train    13:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.80it/s]
Train    13:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.66it/s]
Train    13:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.32it/s]
Train    13:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.14it/s]
Train    13:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.31it/s]
Train    13:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.32it/s]
Train    13:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.18it/s]
Train    13:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.32it/s]
Train    13:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.40it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.55it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.42it/s]
13 Oct 03:28    INFO  epoch 13 training [time: 1.31s, train loss: 16.2517]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.33it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.55it/s]
13 Oct 03:28    INFO  epoch 13 evaluating [time: 0.14s, valid_score: 0.822800]
13 Oct 03:28    INFO  valid result: 
recall@5 : 0.8483    recall@10 : 0.8646    mrr@5 : 0.8206    mrr@10 : 0.8228    ndcg@5 : 0.8276    ndcg@10 : 0.8329    hit@5 : 0.8483    hit@10 : 0.8646    precision@5 : 0.1697    precision@10 : 0.0865

Train    14:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    14:   9%|████▋                                              | 1/11 [00:00<00:01,  8.26it/s]
Train    14:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.27it/s]
Train    14:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.36it/s]
Train    14:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.32it/s]
Train    14:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.38it/s]
Train    14:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.34it/s]
Train    14:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.44it/s]
Train    14:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.45it/s]
Train    14:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.47it/s]
Train    14:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.49it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.58it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.45it/s]
13 Oct 03:29    INFO  epoch 14 training [time: 1.30s, train loss: 15.1803]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.29it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.81it/s]
13 Oct 03:29    INFO  epoch 14 evaluating [time: 0.15s, valid_score: 0.826600]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8524    recall@10 : 0.8646    mrr@5 : 0.8249    mrr@10 : 0.8266    ndcg@5 : 0.8318    ndcg@10 : 0.8358    hit@5 : 0.8524    hit@10 : 0.8646    precision@5 : 0.1705    precision@10 : 0.0865
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    15:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    15:   9%|████▋                                              | 1/11 [00:00<00:01,  6.59it/s]
Train    15:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.31it/s]
Train    15:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.65it/s]
Train    15:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  5.88it/s]
Train    15:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.67it/s]
Train    15:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.80it/s]
Train    15:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  7.01it/s]
Train    15:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.17it/s]
Train    15:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.45it/s]
Train    15:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.70it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.93it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.26it/s]
13 Oct 03:29    INFO  epoch 15 training [time: 1.52s, train loss: 14.0270]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.65it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.59it/s]
13 Oct 03:29    INFO  epoch 15 evaluating [time: 0.12s, valid_score: 0.831100]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8538    recall@10 : 0.8696    mrr@5 : 0.8289    mrr@10 : 0.8311    ndcg@5 : 0.8352    ndcg@10 : 0.8403    hit@5 : 0.8538    hit@10 : 0.8696    precision@5 : 0.1708    precision@10 : 0.087
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    16:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    16:   9%|████▋                                              | 1/11 [00:00<00:01,  8.35it/s]
Train    16:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.53it/s]
Train    16:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.63it/s]
Train    16:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.83it/s]
Train    16:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.86it/s]
Train    16:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.89it/s]
Train    16:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.52it/s]
Train    16:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.30it/s]
Train    16:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.17it/s]
Train    16:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.09it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.16it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.39it/s]
13 Oct 03:29    INFO  epoch 16 training [time: 1.31s, train loss: 13.9780]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.08it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.90it/s]
13 Oct 03:29    INFO  epoch 16 evaluating [time: 0.15s, valid_score: 0.840700]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8542    recall@10 : 0.8742    mrr@5 : 0.838    mrr@10 : 0.8407    ndcg@5 : 0.8421    ndcg@10 : 0.8486    hit@5 : 0.8542    hit@10 : 0.8742    precision@5 : 0.1708    precision@10 : 0.0874
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    17:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    17:   9%|████▋                                              | 1/11 [00:00<00:01,  7.94it/s]
Train    17:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.07it/s]
Train    17:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.92it/s]
Train    17:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.74it/s]
Train    17:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.79it/s]
Train    17:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.71it/s]
Train    17:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.89it/s]
Train    17:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.98it/s]
Train    17:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.03it/s]
Train    17:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.94it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.80it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.86it/s]
13 Oct 03:29    INFO  epoch 17 training [time: 1.40s, train loss: 13.4821]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.51it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.86it/s]
13 Oct 03:29    INFO  epoch 17 evaluating [time: 0.16s, valid_score: 0.841900]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8547    recall@10 : 0.8728    mrr@5 : 0.8394    mrr@10 : 0.8419    ndcg@5 : 0.8433    ndcg@10 : 0.8492    hit@5 : 0.8547    hit@10 : 0.8728    precision@5 : 0.1709    precision@10 : 0.0873
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    18:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    18:   9%|████▋                                              | 1/11 [00:00<00:01,  8.23it/s]
Train    18:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.17it/s]
Train    18:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.22it/s]
Train    18:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.22it/s]
Train    18:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.17it/s]
Train    18:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.21it/s]
Train    18:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.14it/s]
Train    18:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.20it/s]
Train    18:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.27it/s]
Train    18:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.27it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.29it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.23it/s]
13 Oct 03:29    INFO  epoch 18 training [time: 1.34s, train loss: 12.8328]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.60it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.98it/s]
13 Oct 03:29    INFO  epoch 18 evaluating [time: 0.13s, valid_score: 0.839200]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8592    recall@10 : 0.8778    mrr@5 : 0.8367    mrr@10 : 0.8392    ndcg@5 : 0.8424    ndcg@10 : 0.8484    hit@5 : 0.8592    hit@10 : 0.8778    precision@5 : 0.1718    precision@10 : 0.0878

Train    19:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    19:   9%|████▋                                              | 1/11 [00:00<00:01,  8.08it/s]
Train    19:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.12it/s]
Train    19:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.15it/s]
Train    19:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.21it/s]
Train    19:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.22it/s]
Train    19:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.22it/s]
Train    19:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.15it/s]
Train    19:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.23it/s]
Train    19:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.75it/s]
Train    19:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.19it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.50it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.54it/s]
13 Oct 03:29    INFO  epoch 19 training [time: 1.46s, train loss: 12.6652]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.68it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.34it/s]
13 Oct 03:29    INFO  epoch 19 evaluating [time: 0.12s, valid_score: 0.847900]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8624    recall@10 : 0.8782    mrr@5 : 0.8458    mrr@10 : 0.8479    ndcg@5 : 0.8499    ndcg@10 : 0.8551    hit@5 : 0.8624    hit@10 : 0.8782    precision@5 : 0.1725    precision@10 : 0.0878
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    20:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    20:   9%|████▋                                              | 1/11 [00:00<00:01,  8.30it/s]
Train    20:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.30it/s]
Train    20:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.19it/s]
Train    20:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.05it/s]
Train    20:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.93it/s]
Train    20:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.08it/s]
Train    20:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.18it/s]
Train    20:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.27it/s]
Train    20:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.20it/s]
Train    20:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.18it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.29it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.19it/s]
13 Oct 03:29    INFO  epoch 20 training [time: 1.34s, train loss: 11.6583]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.42it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.04it/s]
13 Oct 03:29    INFO  epoch 20 evaluating [time: 0.14s, valid_score: 0.846100]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8624    recall@10 : 0.8769    mrr@5 : 0.8443    mrr@10 : 0.8461    ndcg@5 : 0.8488    ndcg@10 : 0.8534    hit@5 : 0.8624    hit@10 : 0.8769    precision@5 : 0.1725    precision@10 : 0.0877

Train    21:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    21:   9%|████▋                                              | 1/11 [00:00<00:01,  8.44it/s]
Train    21:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.21it/s]
Train    21:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.33it/s]
Train    21:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.34it/s]
Train    21:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.29it/s]
Train    21:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.20it/s]
Train    21:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.15it/s]
Train    21:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.01it/s]
Train    21:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.91it/s]
Train    21:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.08it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.19it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.17it/s]
13 Oct 03:29    INFO  epoch 21 training [time: 1.35s, train loss: 12.4649]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.52it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.15it/s]
13 Oct 03:29    INFO  epoch 21 evaluating [time: 0.13s, valid_score: 0.848800]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8624    recall@10 : 0.8791    mrr@5 : 0.8465    mrr@10 : 0.8488    ndcg@5 : 0.8505    ndcg@10 : 0.856    hit@5 : 0.8624    hit@10 : 0.8791    precision@5 : 0.1725    precision@10 : 0.0879
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    22:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    22:   9%|████▋                                              | 1/11 [00:00<00:01,  7.88it/s]
Train    22:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.36it/s]
Train    22:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.34it/s]
Train    22:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.31it/s]
Train    22:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.23it/s]
Train    22:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.20it/s]
Train    22:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.15it/s]
Train    22:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.13it/s]
Train    22:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.13it/s]
Train    22:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.19it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.34it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.24it/s]
13 Oct 03:29    INFO  epoch 22 training [time: 1.34s, train loss: 12.1504]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.36it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.12it/s]
13 Oct 03:29    INFO  epoch 22 evaluating [time: 0.13s, valid_score: 0.852100]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8674    recall@10 : 0.8805    mrr@5 : 0.8504    mrr@10 : 0.8521    ndcg@5 : 0.8546    ndcg@10 : 0.8588    hit@5 : 0.8674    hit@10 : 0.8805    precision@5 : 0.1735    precision@10 : 0.088
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    23:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    23:   9%|████▋                                              | 1/11 [00:00<00:01,  8.61it/s]
Train    23:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.54it/s]
Train    23:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.35it/s]
Train    23:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.21it/s]
Train    23:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.07it/s]
Train    23:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.04it/s]
Train    23:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.16it/s]
Train    23:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.71it/s]
Train    23:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.11it/s]
Train    23:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.45it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.72it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.55it/s]
13 Oct 03:29    INFO  epoch 23 training [time: 1.46s, train loss: 12.2324]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.36it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.10it/s]
13 Oct 03:29    INFO  epoch 23 evaluating [time: 0.15s, valid_score: 0.851500]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8665    recall@10 : 0.8791    mrr@5 : 0.8498    mrr@10 : 0.8515    ndcg@5 : 0.854    ndcg@10 : 0.8582    hit@5 : 0.8665    hit@10 : 0.8791    precision@5 : 0.1733    precision@10 : 0.0879

Train    24:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    24:   9%|████▋                                              | 1/11 [00:00<00:01,  8.30it/s]
Train    24:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.28it/s]
Train    24:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.24it/s]
Train    24:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.24it/s]
Train    24:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.24it/s]
Train    24:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.27it/s]
Train    24:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.31it/s]
Train    24:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.22it/s]
Train    24:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.18it/s]
Train    24:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.12it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.07it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.18it/s]
13 Oct 03:29    INFO  epoch 24 training [time: 1.35s, train loss: 12.0957]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.51it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.95it/s]
13 Oct 03:29    INFO  epoch 24 evaluating [time: 0.17s, valid_score: 0.855800]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8678    recall@10 : 0.88    mrr@5 : 0.8542    mrr@10 : 0.8558    ndcg@5 : 0.8576    ndcg@10 : 0.8616    hit@5 : 0.8678    hit@10 : 0.88    precision@5 : 0.1736    precision@10 : 0.088
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    25:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    25:   9%|████▋                                              | 1/11 [00:00<00:01,  8.14it/s]
Train    25:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.96it/s]
Train    25:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.86it/s]
Train    25:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.84it/s]
Train    25:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.89it/s]
Train    25:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.02it/s]
Train    25:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.08it/s]
Train    25:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.12it/s]
Train    25:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.14it/s]
Train    25:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.18it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.34it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.12it/s]
13 Oct 03:29    INFO  epoch 25 training [time: 1.36s, train loss: 12.1327]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.48it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.26it/s]
13 Oct 03:29    INFO  epoch 25 evaluating [time: 0.13s, valid_score: 0.857400]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8665    recall@10 : 0.8814    mrr@5 : 0.8554    mrr@10 : 0.8574    ndcg@5 : 0.8582    ndcg@10 : 0.863    hit@5 : 0.8665    hit@10 : 0.8814    precision@5 : 0.1733    precision@10 : 0.0881
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    26:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    26:   9%|████▋                                              | 1/11 [00:00<00:01,  8.16it/s]
Train    26:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.36it/s]
Train    26:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.40it/s]
Train    26:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.45it/s]
Train    26:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.36it/s]
Train    26:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.33it/s]
Train    26:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.24it/s]
Train    26:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.13it/s]
Train    26:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.14it/s]
Train    26:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.14it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.25it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.26it/s]
13 Oct 03:29    INFO  epoch 26 training [time: 1.33s, train loss: 11.5253]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.83it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.13it/s]
13 Oct 03:29    INFO  epoch 26 evaluating [time: 0.13s, valid_score: 0.856200]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8678    recall@10 : 0.8809    mrr@5 : 0.8545    mrr@10 : 0.8562    ndcg@5 : 0.8579    ndcg@10 : 0.862    hit@5 : 0.8678    hit@10 : 0.8809    precision@5 : 0.1736    precision@10 : 0.0881

Train    27:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    27:   9%|████▋                                              | 1/11 [00:00<00:01,  8.23it/s]
Train    27:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.38it/s]
Train    27:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.35it/s]
Train    27:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.34it/s]
Train    27:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.29it/s]
Train    27:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.03it/s]
Train    27:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.02it/s]
Train    27:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  7.96it/s]
Train    27:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.96it/s]
Train    27:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.15it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.68it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.44it/s]
13 Oct 03:29    INFO  epoch 27 training [time: 1.48s, train loss: 11.3834]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.07it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.46it/s]
13 Oct 03:29    INFO  epoch 27 evaluating [time: 0.14s, valid_score: 0.857700]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8678    recall@10 : 0.8828    mrr@5 : 0.8557    mrr@10 : 0.8577    ndcg@5 : 0.8588    ndcg@10 : 0.8635    hit@5 : 0.8678    hit@10 : 0.8828    precision@5 : 0.1736    precision@10 : 0.0883
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    28:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    28:   9%|████▋                                              | 1/11 [00:00<00:01,  8.00it/s]
Train    28:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.08it/s]
Train    28:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.91it/s]
Train    28:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.06it/s]
Train    28:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.09it/s]
Train    28:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.08it/s]
Train    28:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.08it/s]
Train    28:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.09it/s]
Train    28:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.08it/s]
Train    28:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.04it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.17it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.09it/s]
13 Oct 03:29    INFO  epoch 28 training [time: 1.36s, train loss: 11.8742]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.34it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.46it/s]
13 Oct 03:29    INFO  epoch 28 evaluating [time: 0.16s, valid_score: 0.857200]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8696    recall@10 : 0.8814    mrr@5 : 0.8556    mrr@10 : 0.8572    ndcg@5 : 0.8591    ndcg@10 : 0.863    hit@5 : 0.8696    hit@10 : 0.8814    precision@5 : 0.1739    precision@10 : 0.0881

Train    29:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    29:   9%|████▋                                              | 1/11 [00:00<00:01,  8.36it/s]
Train    29:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.63it/s]
Train    29:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.76it/s]
Train    29:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.66it/s]
Train    29:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.45it/s]
Train    29:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.37it/s]
Train    29:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.31it/s]
Train    29:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.24it/s]
Train    29:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.21it/s]
Train    29:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.17it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.22it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.33it/s]
13 Oct 03:29    INFO  epoch 29 training [time: 1.32s, train loss: 10.5379]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.76it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.32it/s]
13 Oct 03:29    INFO  epoch 29 evaluating [time: 0.14s, valid_score: 0.856700]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.866    recall@10 : 0.8782    mrr@5 : 0.8551    mrr@10 : 0.8567    ndcg@5 : 0.8578    ndcg@10 : 0.8617    hit@5 : 0.866    hit@10 : 0.8782    precision@5 : 0.1732    precision@10 : 0.0878

Train    30:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    30:   9%|████▋                                              | 1/11 [00:00<00:01,  8.37it/s]
Train    30:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.14it/s]
Train    30:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.02it/s]
Train    30:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.00it/s]
Train    30:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.93it/s]
Train    30:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.02it/s]
Train    30:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.11it/s]
Train    30:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.12it/s]
Train    30:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.18it/s]
Train    30:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.16it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.21it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.12it/s]
13 Oct 03:29    INFO  epoch 30 training [time: 1.36s, train loss: 10.5852]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.79it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.01it/s]
13 Oct 03:29    INFO  epoch 30 evaluating [time: 0.13s, valid_score: 0.858200]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8855    mrr@5 : 0.8562    mrr@10 : 0.8582    ndcg@5 : 0.8597    ndcg@10 : 0.8646    hit@5 : 0.8701    hit@10 : 0.8855    precision@5 : 0.174    precision@10 : 0.0885
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    31:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    31:   9%|████▋                                              | 1/11 [00:00<00:01,  8.15it/s]
Train    31:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.14it/s]
Train    31:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.16it/s]
Train    31:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.07it/s]
Train    31:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.82it/s]
Train    31:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.95it/s]
Train    31:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.06it/s]
Train    31:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.10it/s]
Train    31:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.17it/s]
Train    31:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.13it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.10it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.07it/s]
13 Oct 03:29    INFO  epoch 31 training [time: 1.36s, train loss: 11.2706]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  5.94it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 12.73it/s]
13 Oct 03:29    INFO  epoch 31 evaluating [time: 0.24s, valid_score: 0.856900]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8696    recall@10 : 0.8796    mrr@5 : 0.8557    mrr@10 : 0.8569    ndcg@5 : 0.8592    ndcg@10 : 0.8623    hit@5 : 0.8696    hit@10 : 0.8796    precision@5 : 0.1739    precision@10 : 0.088

Train    32:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    32:   9%|████▋                                              | 1/11 [00:00<00:01,  8.32it/s]
Train    32:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.20it/s]
Train    32:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.22it/s]
Train    32:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.19it/s]
Train    32:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.23it/s]
Train    32:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.21it/s]
Train    32:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.17it/s]
Train    32:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.12it/s]
Train    32:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.04it/s]
Train    32:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.02it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.07it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.13it/s]
13 Oct 03:29    INFO  epoch 32 training [time: 1.35s, train loss: 11.0654]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.07it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.78it/s]
13 Oct 03:29    INFO  epoch 32 evaluating [time: 0.15s, valid_score: 0.858700]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8692    recall@10 : 0.8837    mrr@5 : 0.8568    mrr@10 : 0.8587    ndcg@5 : 0.8599    ndcg@10 : 0.8645    hit@5 : 0.8692    hit@10 : 0.8837    precision@5 : 0.1738    precision@10 : 0.0884
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    33:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    33:   9%|████▋                                              | 1/11 [00:00<00:01,  8.07it/s]
Train    33:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.21it/s]
Train    33:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.27it/s]
Train    33:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.23it/s]
Train    33:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.13it/s]
Train    33:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.09it/s]
Train    33:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.08it/s]
Train    33:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.04it/s]
Train    33:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.06it/s]
Train    33:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.98it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.98it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.07it/s]
13 Oct 03:29    INFO  epoch 33 training [time: 1.36s, train loss: 10.1648]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.32it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.45it/s]
13 Oct 03:29    INFO  epoch 33 evaluating [time: 0.16s, valid_score: 0.858700]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8732    recall@10 : 0.8868    mrr@5 : 0.8571    mrr@10 : 0.8587    ndcg@5 : 0.8611    ndcg@10 : 0.8653    hit@5 : 0.8732    hit@10 : 0.8868    precision@5 : 0.1746    precision@10 : 0.0887
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    34:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    34:   9%|████▋                                              | 1/11 [00:00<00:01,  7.71it/s]
Train    34:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.80it/s]
Train    34:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.79it/s]
Train    34:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.80it/s]
Train    34:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.73it/s]
Train    34:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.72it/s]
Train    34:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.78it/s]
Train    34:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.78it/s]
Train    34:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.71it/s]
Train    34:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.76it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.83it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.78it/s]
13 Oct 03:29    INFO  epoch 34 training [time: 1.41s, train loss: 10.1223]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.61it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.64it/s]
13 Oct 03:29    INFO  epoch 34 evaluating [time: 0.15s, valid_score: 0.860900]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8714    recall@10 : 0.8846    mrr@5 : 0.8592    mrr@10 : 0.8609    ndcg@5 : 0.8623    ndcg@10 : 0.8664    hit@5 : 0.8714    hit@10 : 0.8846    precision@5 : 0.1743    precision@10 : 0.0885
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    35:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    35:   9%|████▋                                              | 1/11 [00:00<00:01,  8.25it/s]
Train    35:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.16it/s]
Train    35:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.16it/s]
Train    35:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.11it/s]
Train    35:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.14it/s]
Train    35:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.14it/s]
Train    35:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.17it/s]
Train    35:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.14it/s]
Train    35:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.21it/s]
Train    35:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.24it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.31it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.21it/s]
13 Oct 03:29    INFO  epoch 35 training [time: 1.34s, train loss: 10.3528]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00,  9.38it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 13.46it/s]
13 Oct 03:29    INFO  epoch 35 evaluating [time: 0.23s, valid_score: 0.859700]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8714    recall@10 : 0.8859    mrr@5 : 0.8578    mrr@10 : 0.8597    ndcg@5 : 0.8612    ndcg@10 : 0.8658    hit@5 : 0.8714    hit@10 : 0.8859    precision@5 : 0.1743    precision@10 : 0.0886

Train    36:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    36:   9%|████▋                                              | 1/11 [00:00<00:01,  8.27it/s]
Train    36:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.17it/s]
Train    36:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.17it/s]
Train    36:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.10it/s]
Train    36:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.98it/s]
Train    36:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.95it/s]
Train    36:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.99it/s]
Train    36:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.02it/s]
Train    36:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.99it/s]
Train    36:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.98it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.03it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.03it/s]
13 Oct 03:29    INFO  epoch 36 training [time: 1.37s, train loss: 11.0719]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.34it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.62it/s]
13 Oct 03:29    INFO  epoch 36 evaluating [time: 0.16s, valid_score: 0.860100]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.8837    mrr@5 : 0.8585    mrr@10 : 0.8601    ndcg@5 : 0.8616    ndcg@10 : 0.8656    hit@5 : 0.871    hit@10 : 0.8837    precision@5 : 0.1742    precision@10 : 0.0884

Train    37:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    37:   9%|████▋                                              | 1/11 [00:00<00:01,  8.02it/s]
Train    37:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.94it/s]
Train    37:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.95it/s]
Train    37:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.99it/s]
Train    37:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.05it/s]
Train    37:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.06it/s]
Train    37:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.09it/s]
Train    37:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.11it/s]
Train    37:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.17it/s]
Train    37:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.21it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.29it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
13 Oct 03:29    INFO  epoch 37 training [time: 1.35s, train loss: 10.4781]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.01it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.56it/s]
13 Oct 03:29    INFO  epoch 37 evaluating [time: 0.13s, valid_score: 0.859500]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8814    mrr@5 : 0.8578    mrr@10 : 0.8595    ndcg@5 : 0.8609    ndcg@10 : 0.8647    hit@5 : 0.8701    hit@10 : 0.8814    precision@5 : 0.174    precision@10 : 0.0881

Train    38:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    38:   9%|████▋                                              | 1/11 [00:00<00:01,  8.25it/s]
Train    38:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.28it/s]
Train    38:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.20it/s]
Train    38:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.20it/s]
Train    38:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.16it/s]
Train    38:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.11it/s]
Train    38:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.12it/s]
Train    38:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.07it/s]
Train    38:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.05it/s]
Train    38:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.10it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.17it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
13 Oct 03:29    INFO  epoch 38 training [time: 1.35s, train loss: 10.1048]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.91it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.91it/s]
13 Oct 03:29    INFO  epoch 38 evaluating [time: 0.15s, valid_score: 0.858700]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8837    mrr@5 : 0.857    mrr@10 : 0.8587    ndcg@5 : 0.8603    ndcg@10 : 0.8646    hit@5 : 0.8701    hit@10 : 0.8837    precision@5 : 0.174    precision@10 : 0.0884

Train    39:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    39:   9%|████▋                                              | 1/11 [00:00<00:01,  7.97it/s]
Train    39:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.11it/s]
Train    39:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.12it/s]
Train    39:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.13it/s]
Train    39:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.06it/s]
Train    39:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.01it/s]
Train    39:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.95it/s]
Train    39:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.84it/s]
Train    39:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.86it/s]
Train    39:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.91it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.35it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.41it/s]
13 Oct 03:29    INFO  epoch 39 training [time: 1.48s, train loss: 11.4887]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.42it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.24it/s]
13 Oct 03:29    INFO  epoch 39 evaluating [time: 0.15s, valid_score: 0.859400]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.8805    mrr@5 : 0.8581    mrr@10 : 0.8594    ndcg@5 : 0.8613    ndcg@10 : 0.8644    hit@5 : 0.871    hit@10 : 0.8805    precision@5 : 0.1742    precision@10 : 0.088

Train    40:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    40:   9%|████▋                                              | 1/11 [00:00<00:01,  7.49it/s]
Train    40:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.77it/s]
Train    40:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.85it/s]
Train    40:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.90it/s]
Train    40:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.98it/s]
Train    40:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.00it/s]
Train    40:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.01it/s]
Train    40:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.95it/s]
Train    40:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.06it/s]
Train    40:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.11it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.18it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.02it/s]
13 Oct 03:29    INFO  epoch 40 training [time: 1.37s, train loss: 11.3051]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.08it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.55it/s]
13 Oct 03:29    INFO  epoch 40 evaluating [time: 0.17s, valid_score: 0.859900]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8705    recall@10 : 0.8818    mrr@5 : 0.8585    mrr@10 : 0.8599    ndcg@5 : 0.8615    ndcg@10 : 0.8651    hit@5 : 0.8705    hit@10 : 0.8818    precision@5 : 0.1741    precision@10 : 0.0882

Train    41:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    41:   9%|████▋                                              | 1/11 [00:00<00:01,  8.09it/s]
Train    41:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.98it/s]
Train    41:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.64it/s]
Train    41:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.69it/s]
Train    41:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.83it/s]
Train    41:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.92it/s]
Train    41:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.97it/s]
Train    41:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.08it/s]
Train    41:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.11it/s]
Train    41:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.15it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.10it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.99it/s]
13 Oct 03:29    INFO  epoch 41 training [time: 1.38s, train loss: 9.9387]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.11it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.37it/s]
13 Oct 03:29    INFO  epoch 41 evaluating [time: 0.17s, valid_score: 0.861400]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8732    recall@10 : 0.8841    mrr@5 : 0.86    mrr@10 : 0.8614    ndcg@5 : 0.8633    ndcg@10 : 0.8668    hit@5 : 0.8732    hit@10 : 0.8841    precision@5 : 0.1746    precision@10 : 0.0884
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    42:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    42:   9%|████▋                                              | 1/11 [00:00<00:01,  8.01it/s]
Train    42:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.15it/s]
Train    42:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.07it/s]
Train    42:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.04it/s]
Train    42:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.01it/s]
Train    42:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.06it/s]
Train    42:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.99it/s]
Train    42:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  7.99it/s]
Train    42:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.07it/s]
Train    42:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.00it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.13it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.06it/s]
13 Oct 03:29    INFO  epoch 42 training [time: 1.37s, train loss: 10.8537]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.08it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.42it/s]
13 Oct 03:29    INFO  epoch 42 evaluating [time: 0.14s, valid_score: 0.861800]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8728    recall@10 : 0.8837    mrr@5 : 0.8605    mrr@10 : 0.8618    ndcg@5 : 0.8636    ndcg@10 : 0.867    hit@5 : 0.8728    hit@10 : 0.8837    precision@5 : 0.1746    precision@10 : 0.0884
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    43:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    43:   9%|████▋                                              | 1/11 [00:00<00:01,  8.11it/s]
Train    43:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.96it/s]
Train    43:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.96it/s]
Train    43:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.86it/s]
Train    43:  45%|███████████████████████▏                           | 5/11 [00:00<00:01,  5.81it/s]
Train    43:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.36it/s]
Train    43:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  6.77it/s]
Train    43:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.01it/s]
Train    43:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.27it/s]
Train    43:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.55it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.80it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.28it/s]
13 Oct 03:29    INFO  epoch 43 training [time: 1.51s, train loss: 10.6564]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.49it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.84it/s]
13 Oct 03:29    INFO  epoch 43 evaluating [time: 0.13s, valid_score: 0.859000]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8796    mrr@5 : 0.8575    mrr@10 : 0.859    ndcg@5 : 0.8602    ndcg@10 : 0.8638    hit@5 : 0.8683    hit@10 : 0.8796    precision@5 : 0.1737    precision@10 : 0.088

Train    44:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    44:   9%|████▋                                              | 1/11 [00:00<00:01,  8.00it/s]
Train    44:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.08it/s]
Train    44:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.12it/s]
Train    44:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.18it/s]
Train    44:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.19it/s]
Train    44:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.13it/s]
Train    44:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.13it/s]
Train    44:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.15it/s]
Train    44:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.01it/s]
Train    44:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.93it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.94it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.04it/s]
13 Oct 03:29    INFO  epoch 44 training [time: 1.37s, train loss: 9.7946]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.63it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.94it/s]
13 Oct 03:29    INFO  epoch 44 evaluating [time: 0.13s, valid_score: 0.860100]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8805    mrr@5 : 0.8585    mrr@10 : 0.8601    ndcg@5 : 0.861    ndcg@10 : 0.8648    hit@5 : 0.8683    hit@10 : 0.8805    precision@5 : 0.1737    precision@10 : 0.088

Train    45:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    45:   9%|████▋                                              | 1/11 [00:00<00:01,  8.15it/s]
Train    45:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.12it/s]
Train    45:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.05it/s]
Train    45:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.06it/s]
Train    45:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.03it/s]
Train    45:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.08it/s]
Train    45:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.07it/s]
Train    45:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.11it/s]
Train    45:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.17it/s]
Train    45:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.15it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.15it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.11it/s]
13 Oct 03:29    INFO  epoch 45 training [time: 1.36s, train loss: 10.0786]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 11.57it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 15.64it/s]
13 Oct 03:29    INFO  epoch 45 evaluating [time: 0.21s, valid_score: 0.861600]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8692    recall@10 : 0.8818    mrr@5 : 0.8599    mrr@10 : 0.8616    ndcg@5 : 0.8622    ndcg@10 : 0.8663    hit@5 : 0.8692    hit@10 : 0.8818    precision@5 : 0.1738    precision@10 : 0.0882

Train    46:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    46:   9%|████▋                                              | 1/11 [00:00<00:01,  7.03it/s]
Train    46:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.63it/s]
Train    46:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.78it/s]
Train    46:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.88it/s]
Train    46:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.86it/s]
Train    46:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.80it/s]
Train    46:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.82it/s]
Train    46:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.91it/s]
Train    46:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.92it/s]
Train    46:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.89it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.90it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.83it/s]
13 Oct 03:29    INFO  epoch 46 training [time: 1.40s, train loss: 9.9877]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.16it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.30it/s]
13 Oct 03:29    INFO  epoch 46 evaluating [time: 0.14s, valid_score: 0.862100]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8714    recall@10 : 0.8846    mrr@5 : 0.8605    mrr@10 : 0.8621    ndcg@5 : 0.8632    ndcg@10 : 0.8673    hit@5 : 0.8714    hit@10 : 0.8846    precision@5 : 0.1743    precision@10 : 0.0885
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    47:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    47:   9%|████▋                                              | 1/11 [00:00<00:01,  8.36it/s]
Train    47:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.25it/s]
Train    47:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.30it/s]
Train    47:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.90it/s]
Train    47:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.29it/s]
Train    47:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.51it/s]
Train    47:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.67it/s]
Train    47:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.68it/s]
Train    47:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.71it/s]
Train    47:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.71it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.76it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.36it/s]
13 Oct 03:29    INFO  epoch 47 training [time: 1.49s, train loss: 10.6057]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.00it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.79it/s]
13 Oct 03:29    INFO  epoch 47 evaluating [time: 0.15s, valid_score: 0.861600]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8728    recall@10 : 0.8832    mrr@5 : 0.8603    mrr@10 : 0.8616    ndcg@5 : 0.8634    ndcg@10 : 0.8668    hit@5 : 0.8728    hit@10 : 0.8832    precision@5 : 0.1746    precision@10 : 0.0883

Train    48:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    48:   9%|████▋                                              | 1/11 [00:00<00:01,  7.63it/s]
Train    48:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.36it/s]
Train    48:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.63it/s]
Train    48:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.71it/s]
Train    48:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.73it/s]
Train    48:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.87it/s]
Train    48:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.95it/s]
Train    48:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.98it/s]
Train    48:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.99it/s]
Train    48:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.58it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.72it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.76it/s]
13 Oct 03:29    INFO  epoch 48 training [time: 1.42s, train loss: 10.2149]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.72it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.14it/s]
13 Oct 03:29    INFO  epoch 48 evaluating [time: 0.17s, valid_score: 0.862800]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8719    recall@10 : 0.8864    mrr@5 : 0.8609    mrr@10 : 0.8628    ndcg@5 : 0.8637    ndcg@10 : 0.8684    hit@5 : 0.8719    hit@10 : 0.8864    precision@5 : 0.1744    precision@10 : 0.0886
13 Oct 03:29    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Train    49:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    49:   9%|████▋                                              | 1/11 [00:00<00:01,  7.97it/s]
Train    49:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.92it/s]
Train    49:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.00it/s]
Train    49:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.94it/s]
Train    49:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.95it/s]
Train    49:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.02it/s]
Train    49:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.96it/s]
Train    49:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.92it/s]
Train    49:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.97it/s]
Train    49:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.06it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.02it/s]
13 Oct 03:29    INFO  epoch 49 training [time: 1.37s, train loss: 9.4892]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.09it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.37it/s]
13 Oct 03:29    INFO  epoch 49 evaluating [time: 0.14s, valid_score: 0.861900]
13 Oct 03:29    INFO  valid result: 
recall@5 : 0.8719    recall@10 : 0.8868    mrr@5 : 0.8599    mrr@10 : 0.8619    ndcg@5 : 0.8629    ndcg@10 : 0.8677    hit@5 : 0.8719    hit@10 : 0.8868    precision@5 : 0.1744    precision@10 : 0.0887
13 Oct 03:29    INFO  Loading model structure and parameters from saved/BERT4Rec-Oct-13-2025_03-28-38.pth

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.82it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.08it/s]
13 Oct 03:29    INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |     7.50 %     |
+-------------+----------------+
| GPU         |   0.0 / 0.0    |
+-------------+----------------+
| Memory      | 1.52 G/15.33 G |
+-------------+----------------+
13 Oct 03:29    INFO  best valid : OrderedDict({'recall@5': 0.8719, 'recall@10': 0.8864, 'mrr@5': 0.8609, 'mrr@10': 0.8628, 'ndcg@5': 0.8637, 'ndcg@10': 0.8684, 'hit@5': 0.8719, 'hit@10': 0.8864, 'precision@5': 0.1744, 'precision@10': 0.0886})
13 Oct 03:29    INFO  test result: OrderedDict({'recall@5': 0.9774, 'recall@10': 0.9857, 'mrr@5': 0.9612, 'mrr@10': 0.9622, 'ndcg@5': 0.9653, 'ndcg@10': 0.9679, 'hit@5': 0.9774, 'hit@10': 0.9857, 'precision@5': 0.1955, 'precision@10': 0.0986})
2025-10-13 03:29:57,965 | INFO | Published checkpoint /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/saved/BERT4Rec-Oct-13-2025_03-28-38.pth → /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/versions/BERT4Rec-Oct-13-2025_03-28-38.pth
2025-10-13 03:29:57,965 | INFO | Retraining completed in 0:01:25.825849 | dataset=20251012-202833 | model=Oct-13-2025_03-28-38
2025-10-13 03:30:27,969 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:30:28,735 | INFO | 🔄 Đang trích xuất data từ Postgres...
🐘 Đã trích xuất bằng psycopg.
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 69
Số user: 2
Số sản phẩm: 11
Các loại event: {'add_to_cart': 0.42, 'view': 0.377, 'purchase': 0.203}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[10 rows x 5 columns]
2025-10-13 03:30:28,735 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:30:29,261 | INFO | 🗂  Đã cập nhật /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/interactions.csv (tổng 18368 bản ghi).
✅ Đã tạo snapshot 20251012-203029 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-203029/ecommerce.inter) với 18368 dòng
👥  User: 2609 | 🛒  Sản phẩm: 106
🏷️   Nhãn mua hàng (label=1): 2995
      user_id item_id   timestamp  label
4952        3      25  1704067200      0
4953        3      25  1704068520      0
18260       3      89  1707264000      0
18261       3      89  1707264300      0
18262       3      89  1707265440      0
18263       3      89  1707266820      1
1123        3      12  1708041600      0
1124        3      12  1708044480      0
10396       4       4  1707436800      0
10397       4       4  1707437100      0
2025-10-13 03:30:29,261 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-193730
2025-10-13 03:30:29,262 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 03:31:55,629 | INFO | 13 Oct 03:30    INFO  ['train_bert4rec.py']
13 Oct 03:30    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = False
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
device = cuda
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 03:30    INFO  ecommerce
The number of users: 2608
Average actions of users: 7.045646336785578
The number of items: 96
Average actions of items: 193.34736842105264
The number of inters: 18368
The sparsity of the dataset: 92.66359918200409%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 03:30    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 03:30    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 03:30    INFO  BERT4Rec(
  (item_embedding): Embedding(97, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 113888
13 Oct 03:30    INFO  FLOPs: 5194664.0
🔧 Sử dụng topk=[5, 10], valid_metric=MRR@10, device=cpu

Train     0:   0%|                                                           | 0/11 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   9%|████▋                                              | 1/11 [00:00<00:03,  3.30it/s]
Train     0:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.14it/s]
Train     0:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.30it/s]
Train     0:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.03it/s]
Train     0:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.63it/s]
Train     0:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.74it/s]
Train     0:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  7.86it/s]
Train     0:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.26it/s]
Train     0:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.62it/s]
Train     0:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.83it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.23it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.24it/s]
13 Oct 03:30    INFO  epoch 0 training [time: 1.52s, train loss: 49.7594]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.27it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.19it/s]
13 Oct 03:30    INFO  epoch 0 evaluating [time: 0.16s, valid_score: 0.057500]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.0937    recall@10 : 0.1765    mrr@5 : 0.0466    mrr@10 : 0.0575    ndcg@5 : 0.0582    ndcg@10 : 0.0847    hit@5 : 0.0937    hit@10 : 0.1765    precision@5 : 0.0187    precision@10 : 0.0176
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train     1:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     1:   9%|████▋                                              | 1/11 [00:00<00:01,  8.94it/s]
Train     1:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.09it/s]
Train     1:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.69it/s]
Train     1:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.18it/s]
Train     1:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.30it/s]
Train     1:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.20it/s]
Train     1:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.29it/s]
Train     1:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.30it/s]
Train     1:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.47it/s]
Train     1:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.54it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.50it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.45it/s]
13 Oct 03:30    INFO  epoch 1 training [time: 1.30s, train loss: 48.9054]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.87it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.30it/s]
13 Oct 03:30    INFO  epoch 1 evaluating [time: 0.13s, valid_score: 0.078800]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.1348    recall@10 : 0.2118    mrr@5 : 0.0691    mrr@10 : 0.0788    ndcg@5 : 0.0853    ndcg@10 : 0.1096    hit@5 : 0.1348    hit@10 : 0.2118    precision@5 : 0.027    precision@10 : 0.0212
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train     2:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     2:   9%|████▋                                              | 1/11 [00:00<00:01,  8.79it/s]
Train     2:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.94it/s]
Train     2:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.00it/s]
Train     2:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.00it/s]
Train     2:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.65it/s]
Train     2:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.34it/s]
Train     2:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.86it/s]
Train     2:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.17it/s]
Train     2:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.28it/s]
Train     2:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.44it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.45it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.18it/s]
13 Oct 03:30    INFO  epoch 2 training [time: 1.34s, train loss: 46.8474]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.54it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.25it/s]
13 Oct 03:30    INFO  epoch 2 evaluating [time: 0.13s, valid_score: 0.351100]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.5244    recall@10 : 0.6136    mrr@5 : 0.3392    mrr@10 : 0.3511    ndcg@5 : 0.3855    ndcg@10 : 0.4144    hit@5 : 0.5244    hit@10 : 0.6136    precision@5 : 0.1049    precision@10 : 0.0614
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train     3:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     3:   9%|████▋                                              | 1/11 [00:00<00:01,  8.98it/s]
Train     3:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.20it/s]
Train     3:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.02it/s]
Train     3:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.82it/s]
Train     3:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.86it/s]
Train     3:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.83it/s]
Train     3:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.90it/s]
Train     3:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.93it/s]
Train     3:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.98it/s]
Train     3:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.03it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.09it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.98it/s]
13 Oct 03:30    INFO  epoch 3 training [time: 1.23s, train loss: 42.5084]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.94it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.69it/s]
13 Oct 03:30    INFO  epoch 3 evaluating [time: 0.12s, valid_score: 0.538900]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.6611    recall@10 : 0.7217    mrr@5 : 0.5306    mrr@10 : 0.5389    ndcg@5 : 0.5636    ndcg@10 : 0.5834    hit@5 : 0.6611    hit@10 : 0.7217    precision@5 : 0.1322    precision@10 : 0.0722
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train     4:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     4:   9%|████▋                                              | 1/11 [00:00<00:01,  8.94it/s]
Train     4:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.86it/s]
Train     4:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.86it/s]
Train     4:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.84it/s]
Train     4:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.86it/s]
Train     4:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.83it/s]
Train     4:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.83it/s]
Train     4:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.74it/s]
Train     4:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.66it/s]
Train     4:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.30it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.10it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.54it/s]
13 Oct 03:30    INFO  epoch 4 training [time: 1.29s, train loss: 38.5157]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.23it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.09it/s]
13 Oct 03:30    INFO  epoch 4 evaluating [time: 0.13s, valid_score: 0.577400]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.6937    recall@10 : 0.7443    mrr@5 : 0.5704    mrr@10 : 0.5774    ndcg@5 : 0.6016    ndcg@10 : 0.6183    hit@5 : 0.6937    hit@10 : 0.7443    precision@5 : 0.1387    precision@10 : 0.0744
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train     5:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     5:   9%|████▋                                              | 1/11 [00:00<00:01,  8.64it/s]
Train     5:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.16it/s]
Train     5:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.21it/s]
Train     5:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.32it/s]
Train     5:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.64it/s]
Train     5:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.72it/s]
Train     5:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.23it/s]
Train     5:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.20it/s]
Train     5:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.38it/s]
Train     5:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.65it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.93it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.63it/s]
13 Oct 03:30    INFO  epoch 5 training [time: 1.44s, train loss: 35.0609]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.71it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.14it/s]
13 Oct 03:30    INFO  epoch 5 evaluating [time: 0.15s, valid_score: 0.636100]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.7303    recall@10 : 0.7765    mrr@5 : 0.6301    mrr@10 : 0.6361    ndcg@5 : 0.6553    ndcg@10 : 0.6701    hit@5 : 0.7303    hit@10 : 0.7765    precision@5 : 0.1461    precision@10 : 0.0776
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train     6:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     6:   9%|████▋                                              | 1/11 [00:00<00:01,  8.85it/s]
Train     6:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.68it/s]
Train     6:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.72it/s]
Train     6:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.65it/s]
Train     6:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.66it/s]
Train     6:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.41it/s]
Train     6:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.05it/s]
Train     6:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.56it/s]
Train     6:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.97it/s]
Train     6:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.23it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.49it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.04it/s]
13 Oct 03:30    INFO  epoch 6 training [time: 1.37s, train loss: 31.5342]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.22it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.18it/s]
13 Oct 03:30    INFO  epoch 6 evaluating [time: 0.12s, valid_score: 0.688700]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.7548    recall@10 : 0.8023    mrr@5 : 0.6823    mrr@10 : 0.6887    ndcg@5 : 0.7006    ndcg@10 : 0.716    hit@5 : 0.7548    hit@10 : 0.8023    precision@5 : 0.151    precision@10 : 0.0802
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train     7:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     7:   9%|████▋                                              | 1/11 [00:00<00:01,  8.79it/s]
Train     7:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.74it/s]
Train     7:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.75it/s]
Train     7:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.63it/s]
Train     7:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.51it/s]
Train     7:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.29it/s]
Train     7:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.62it/s]
Train     7:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  7.79it/s]
Train     7:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.82it/s]
Train     7:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.86it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.95it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.09it/s]
13 Oct 03:30    INFO  epoch 7 training [time: 1.36s, train loss: 28.7599]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.39it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.14it/s]
13 Oct 03:30    INFO  epoch 7 evaluating [time: 0.16s, valid_score: 0.720300]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.7842    recall@10 : 0.8213    mrr@5 : 0.7153    mrr@10 : 0.7203    ndcg@5 : 0.7326    ndcg@10 : 0.7446    hit@5 : 0.7842    hit@10 : 0.8213    precision@5 : 0.1568    precision@10 : 0.0821
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train     8:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     8:   9%|████▋                                              | 1/11 [00:00<00:01,  8.59it/s]
Train     8:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.63it/s]
Train     8:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.64it/s]
Train     8:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.67it/s]
Train     8:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.59it/s]
Train     8:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.65it/s]
Train     8:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.67it/s]
Train     8:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.75it/s]
Train     8:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.59it/s]
Train     8:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.52it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.52it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.60it/s]
13 Oct 03:30    INFO  epoch 8 training [time: 1.28s, train loss: 25.9326]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.96it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.45it/s]
13 Oct 03:30    INFO  epoch 8 evaluating [time: 0.15s, valid_score: 0.747400]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.8041    recall@10 : 0.8339    mrr@5 : 0.7434    mrr@10 : 0.7474    ndcg@5 : 0.7586    ndcg@10 : 0.7683    hit@5 : 0.8041    hit@10 : 0.8339    precision@5 : 0.1608    precision@10 : 0.0834
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train     9:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     9:   9%|████▋                                              | 1/11 [00:00<00:01,  8.87it/s]
Train     9:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.73it/s]
Train     9:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.57it/s]
Train     9:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.49it/s]
Train     9:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.32it/s]
Train     9:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.51it/s]
Train     9:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.58it/s]
Train     9:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.47it/s]
Train     9:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.25it/s]
Train     9:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.31it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.45it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.46it/s]
13 Oct 03:30    INFO  epoch 9 training [time: 1.30s, train loss: 23.2385]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.29it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.18it/s]
13 Oct 03:30    INFO  epoch 9 evaluating [time: 0.12s, valid_score: 0.783100]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.829    recall@10 : 0.8529    mrr@5 : 0.7799    mrr@10 : 0.7831    ndcg@5 : 0.7923    ndcg@10 : 0.8    hit@5 : 0.829    hit@10 : 0.8529    precision@5 : 0.1658    precision@10 : 0.0853
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    10:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    10:   9%|████▋                                              | 1/11 [00:00<00:01,  8.79it/s]
Train    10:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.90it/s]
Train    10:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.77it/s]
Train    10:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.69it/s]
Train    10:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.57it/s]
Train    10:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.56it/s]
Train    10:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.53it/s]
Train    10:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.54it/s]
Train    10:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.58it/s]
Train    10:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.73it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.32it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.00it/s]
13 Oct 03:30    INFO  epoch 10 training [time: 1.38s, train loss: 20.9736]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.25it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.28it/s]
13 Oct 03:30    INFO  epoch 10 evaluating [time: 0.12s, valid_score: 0.809200]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.8385    recall@10 : 0.8579    mrr@5 : 0.8065    mrr@10 : 0.8092    ndcg@5 : 0.8145    ndcg@10 : 0.8209    hit@5 : 0.8385    hit@10 : 0.8579    precision@5 : 0.1677    precision@10 : 0.0858
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    11:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    11:   9%|████▋                                              | 1/11 [00:00<00:01,  8.59it/s]
Train    11:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.49it/s]
Train    11:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.58it/s]
Train    11:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.61it/s]
Train    11:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.64it/s]
Train    11:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.79it/s]
Train    11:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.73it/s]
Train    11:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.57it/s]
Train    11:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.48it/s]
Train    11:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.48it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.54it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.58it/s]
13 Oct 03:30    INFO  epoch 11 training [time: 1.28s, train loss: 19.1671]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.72it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.37it/s]
13 Oct 03:30    INFO  epoch 11 evaluating [time: 0.13s, valid_score: 0.820000]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.8448    recall@10 : 0.8665    mrr@5 : 0.8171    mrr@10 : 0.82    ndcg@5 : 0.8241    ndcg@10 : 0.8311    hit@5 : 0.8448    hit@10 : 0.8665    precision@5 : 0.169    precision@10 : 0.0867
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    12:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    12:   9%|████▋                                              | 1/11 [00:00<00:01,  8.66it/s]
Train    12:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.65it/s]
Train    12:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.54it/s]
Train    12:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.40it/s]
Train    12:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.32it/s]
Train    12:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.36it/s]
Train    12:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.37it/s]
Train    12:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.41it/s]
Train    12:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.45it/s]
Train    12:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.48it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.61it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.49it/s]
13 Oct 03:30    INFO  epoch 12 training [time: 1.30s, train loss: 17.4560]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.37it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.85it/s]
13 Oct 03:30    INFO  epoch 12 evaluating [time: 0.15s, valid_score: 0.829300]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.8475    recall@10 : 0.8679    mrr@5 : 0.8265    mrr@10 : 0.8293    ndcg@5 : 0.8318    ndcg@10 : 0.8384    hit@5 : 0.8475    hit@10 : 0.8679    precision@5 : 0.1695    precision@10 : 0.0868
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    13:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    13:   9%|████▋                                              | 1/11 [00:00<00:01,  8.73it/s]
Train    13:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.47it/s]
Train    13:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.71it/s]
Train    13:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.72it/s]
Train    13:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.54it/s]
Train    13:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.33it/s]
Train    13:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.22it/s]
Train    13:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.18it/s]
Train    13:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.24it/s]
Train    13:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.26it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.46it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.41it/s]
13 Oct 03:30    INFO  epoch 13 training [time: 1.31s, train loss: 16.1932]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.44it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.88it/s]
13 Oct 03:30    INFO  epoch 13 evaluating [time: 0.13s, valid_score: 0.835100]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.8534    recall@10 : 0.8719    mrr@5 : 0.8326    mrr@10 : 0.8351    ndcg@5 : 0.8378    ndcg@10 : 0.8438    hit@5 : 0.8534    hit@10 : 0.8719    precision@5 : 0.1707    precision@10 : 0.0872
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    14:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    14:   9%|████▋                                              | 1/11 [00:00<00:01,  8.57it/s]
Train    14:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.62it/s]
Train    14:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.59it/s]
Train    14:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.63it/s]
Train    14:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.57it/s]
Train    14:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.58it/s]
Train    14:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.44it/s]
Train    14:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.15it/s]
Train    14:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.29it/s]
Train    14:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.30it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.35it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.41it/s]
13 Oct 03:30    INFO  epoch 14 training [time: 1.31s, train loss: 15.6198]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  5.34it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 11.10it/s]
13 Oct 03:30    INFO  epoch 14 evaluating [time: 0.29s, valid_score: 0.841300]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.857    recall@10 : 0.8742    mrr@5 : 0.8391    mrr@10 : 0.8413    ndcg@5 : 0.8436    ndcg@10 : 0.8491    hit@5 : 0.857    hit@10 : 0.8742    precision@5 : 0.1714    precision@10 : 0.0874
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    15:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    15:   9%|████▋                                              | 1/11 [00:00<00:01,  8.58it/s]
Train    15:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.51it/s]
Train    15:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.40it/s]
Train    15:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.30it/s]
Train    15:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.26it/s]
Train    15:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.27it/s]
Train    15:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.36it/s]
Train    15:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.29it/s]
Train    15:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.75it/s]
Train    15:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.85it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.57it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.54it/s]
13 Oct 03:30    INFO  epoch 15 training [time: 1.46s, train loss: 13.9309]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 10.66it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 14.84it/s]
13 Oct 03:30    INFO  epoch 15 evaluating [time: 0.21s, valid_score: 0.845200]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.8588    recall@10 : 0.8742    mrr@5 : 0.8432    mrr@10 : 0.8452    ndcg@5 : 0.8471    ndcg@10 : 0.852    hit@5 : 0.8588    hit@10 : 0.8742    precision@5 : 0.1718    precision@10 : 0.0874
13 Oct 03:30    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    16:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    16:   9%|████▋                                              | 1/11 [00:00<00:01,  7.76it/s]
Train    16:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.80it/s]
Train    16:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.05it/s]
Train    16:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.15it/s]
Train    16:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.63it/s]
Train    16:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.00it/s]
Train    16:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.19it/s]
Train    16:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.18it/s]
Train    16:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.06it/s]
Train    16:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.11it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.19it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.99it/s]
13 Oct 03:30    INFO  epoch 16 training [time: 1.38s, train loss: 13.4300]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.50it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.32it/s]
13 Oct 03:30    INFO  epoch 16 evaluating [time: 0.14s, valid_score: 0.844100]
13 Oct 03:30    INFO  valid result: 
recall@5 : 0.8575    recall@10 : 0.8765    mrr@5 : 0.8416    mrr@10 : 0.8441    ndcg@5 : 0.8456    ndcg@10 : 0.8517    hit@5 : 0.8575    hit@10 : 0.8765    precision@5 : 0.1715    precision@10 : 0.0876

Train    17:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    17:   9%|████▋                                              | 1/11 [00:00<00:01,  8.19it/s]
Train    17:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.47it/s]
Train    17:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.52it/s]
Train    17:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.57it/s]
Train    17:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.59it/s]
Train    17:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.60it/s]
Train    17:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.55it/s]
Train    17:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.45it/s]
Train    17:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.46it/s]
Train    17:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.55it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.57it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.53it/s]
13 Oct 03:31    INFO  epoch 17 training [time: 1.29s, train loss: 13.0804]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.74it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.92it/s]
13 Oct 03:31    INFO  epoch 17 evaluating [time: 0.14s, valid_score: 0.846200]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8597    recall@10 : 0.8751    mrr@5 : 0.8443    mrr@10 : 0.8462    ndcg@5 : 0.8481    ndcg@10 : 0.853    hit@5 : 0.8597    hit@10 : 0.8751    precision@5 : 0.1719    precision@10 : 0.0875
13 Oct 03:31    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    18:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    18:   9%|████▋                                              | 1/11 [00:00<00:01,  7.67it/s]
Train    18:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.08it/s]
Train    18:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.16it/s]
Train    18:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.09it/s]
Train    18:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.98it/s]
Train    18:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.95it/s]
Train    18:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.16it/s]
Train    18:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.70it/s]
Train    18:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.14it/s]
Train    18:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.50it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.83it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.52it/s]
13 Oct 03:31    INFO  epoch 18 training [time: 1.46s, train loss: 13.4371]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.98it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.51it/s]
13 Oct 03:31    INFO  epoch 18 evaluating [time: 0.13s, valid_score: 0.852200]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8647    recall@10 : 0.8769    mrr@5 : 0.8507    mrr@10 : 0.8522    ndcg@5 : 0.8542    ndcg@10 : 0.8581    hit@5 : 0.8647    hit@10 : 0.8769    precision@5 : 0.1729    precision@10 : 0.0877
13 Oct 03:31    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    19:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    19:   9%|████▋                                              | 1/11 [00:00<00:01,  8.38it/s]
Train    19:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.09it/s]
Train    19:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.09it/s]
Train    19:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.17it/s]
Train    19:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.03it/s]
Train    19:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.03it/s]
Train    19:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.09it/s]
Train    19:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.15it/s]
Train    19:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.22it/s]
Train    19:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.29it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.33it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.20it/s]
13 Oct 03:31    INFO  epoch 19 training [time: 1.34s, train loss: 13.0179]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.54it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.93it/s]
13 Oct 03:31    INFO  epoch 19 evaluating [time: 0.17s, valid_score: 0.851000]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8638    recall@10 : 0.8778    mrr@5 : 0.8492    mrr@10 : 0.851    ndcg@5 : 0.8529    ndcg@10 : 0.8574    hit@5 : 0.8638    hit@10 : 0.8778    precision@5 : 0.1728    precision@10 : 0.0878

Train    20:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    20:   9%|████▋                                              | 1/11 [00:00<00:01,  7.99it/s]
Train    20:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.87it/s]
Train    20:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.74it/s]
Train    20:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.07it/s]
Train    20:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.22it/s]
Train    20:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.54it/s]
Train    20:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.59it/s]
Train    20:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.45it/s]
Train    20:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.52it/s]
Train    20:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.77it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.88it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.63it/s]
13 Oct 03:31    INFO  epoch 20 training [time: 1.44s, train loss: 12.5615]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.41it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.93it/s]
13 Oct 03:31    INFO  epoch 20 evaluating [time: 0.13s, valid_score: 0.852700]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.867    recall@10 : 0.8778    mrr@5 : 0.8513    mrr@10 : 0.8527    ndcg@5 : 0.8552    ndcg@10 : 0.8587    hit@5 : 0.867    hit@10 : 0.8778    precision@5 : 0.1734    precision@10 : 0.0878
13 Oct 03:31    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    21:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    21:   9%|████▋                                              | 1/11 [00:00<00:01,  8.30it/s]
Train    21:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.04it/s]
Train    21:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.96it/s]
Train    21:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.00it/s]
Train    21:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.76it/s]
Train    21:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.27it/s]
Train    21:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.40it/s]
Train    21:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.52it/s]
Train    21:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.93it/s]
Train    21:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.28it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.37it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.29it/s]
13 Oct 03:31    INFO  epoch 21 training [time: 1.51s, train loss: 11.9438]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.96it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.25it/s]
13 Oct 03:31    INFO  epoch 21 evaluating [time: 0.15s, valid_score: 0.853200]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8661    recall@10 : 0.8796    mrr@5 : 0.8515    mrr@10 : 0.8532    ndcg@5 : 0.8552    ndcg@10 : 0.8595    hit@5 : 0.8661    hit@10 : 0.8796    precision@5 : 0.1732    precision@10 : 0.088
13 Oct 03:31    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    22:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    22:   9%|████▋                                              | 1/11 [00:00<00:01,  8.03it/s]
Train    22:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.90it/s]
Train    22:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.88it/s]
Train    22:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.87it/s]
Train    22:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.84it/s]
Train    22:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  5.52it/s]
Train    22:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  6.08it/s]
Train    22:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.47it/s]
Train    22:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.91it/s]
Train    22:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.24it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.55it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.09it/s]
13 Oct 03:31    INFO  epoch 22 training [time: 1.55s, train loss: 11.5617]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 12.57it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 17.19it/s]
13 Oct 03:31    INFO  epoch 22 evaluating [time: 0.18s, valid_score: 0.852400]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8652    recall@10 : 0.8783    mrr@5 : 0.8506    mrr@10 : 0.8524    ndcg@5 : 0.8543    ndcg@10 : 0.8586    hit@5 : 0.8652    hit@10 : 0.8783    precision@5 : 0.173    precision@10 : 0.0878

Train    23:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    23:   9%|████▋                                              | 1/11 [00:00<00:01,  7.21it/s]
Train    23:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.39it/s]
Train    23:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.56it/s]
Train    23:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.75it/s]
Train    23:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.88it/s]
Train    23:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.94it/s]
Train    23:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.10it/s]
Train    23:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.20it/s]
Train    23:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.36it/s]
Train    23:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.49it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.65it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.53it/s]
13 Oct 03:31    INFO  epoch 23 training [time: 1.46s, train loss: 11.4483]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.14it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.37it/s]
13 Oct 03:31    INFO  epoch 23 evaluating [time: 0.16s, valid_score: 0.850200]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8652    recall@10 : 0.8792    mrr@5 : 0.8483    mrr@10 : 0.8502    ndcg@5 : 0.8525    ndcg@10 : 0.857    hit@5 : 0.8652    hit@10 : 0.8792    precision@5 : 0.173    precision@10 : 0.0879

Train    24:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    24:   9%|████▋                                              | 1/11 [00:00<00:01,  7.22it/s]
Train    24:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.19it/s]
Train    24:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.24it/s]
Train    24:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.67it/s]
Train    24:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.84it/s]
Train    24:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.80it/s]
Train    24:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.83it/s]
Train    24:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.82it/s]
Train    24:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.87it/s]
Train    24:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.84it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.89it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.75it/s]
13 Oct 03:31    INFO  epoch 24 training [time: 1.42s, train loss: 11.3786]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 12.69it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 16.63it/s]
13 Oct 03:31    INFO  epoch 24 evaluating [time: 0.20s, valid_score: 0.852300]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8792    mrr@5 : 0.8508    mrr@10 : 0.8523    ndcg@5 : 0.8552    ndcg@10 : 0.8587    hit@5 : 0.8683    hit@10 : 0.8792    precision@5 : 0.1737    precision@10 : 0.0879

Train    25:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    25:   9%|████▋                                              | 1/11 [00:00<00:01,  6.83it/s]
Train    25:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.46it/s]
Train    25:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.61it/s]
Train    25:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.39it/s]
Train    25:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.59it/s]
Train    25:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.87it/s]
Train    25:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.96it/s]
Train    25:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.01it/s]
Train    25:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.53it/s]
Train    25:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.85it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.00it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.77it/s]
13 Oct 03:31    INFO  epoch 25 training [time: 1.42s, train loss: 11.9237]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.27it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.82it/s]
13 Oct 03:31    INFO  epoch 25 evaluating [time: 0.13s, valid_score: 0.852800]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8674    recall@10 : 0.8778    mrr@5 : 0.8513    mrr@10 : 0.8528    ndcg@5 : 0.8553    ndcg@10 : 0.8588    hit@5 : 0.8674    hit@10 : 0.8778    precision@5 : 0.1735    precision@10 : 0.0878

Train    26:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    26:   9%|████▋                                              | 1/11 [00:00<00:01,  8.15it/s]
Train    26:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.96it/s]
Train    26:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.88it/s]
Train    26:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.94it/s]
Train    26:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.06it/s]
Train    26:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.11it/s]
Train    26:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.08it/s]
Train    26:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  7.97it/s]
Train    26:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.93it/s]
Train    26:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  5.59it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.19it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.11it/s]
13 Oct 03:31    INFO  epoch 26 training [time: 1.55s, train loss: 11.2112]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.63it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.73it/s]
13 Oct 03:31    INFO  epoch 26 evaluating [time: 0.13s, valid_score: 0.854300]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8729    recall@10 : 0.8801    mrr@5 : 0.8534    mrr@10 : 0.8543    ndcg@5 : 0.8583    ndcg@10 : 0.8606    hit@5 : 0.8729    hit@10 : 0.8801    precision@5 : 0.1746    precision@10 : 0.088
13 Oct 03:31    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    27:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    27:   9%|████▋                                              | 1/11 [00:00<00:01,  8.11it/s]
Train    27:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.13it/s]
Train    27:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.29it/s]
Train    27:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.28it/s]
Train    27:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.26it/s]
Train    27:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.21it/s]
Train    27:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.15it/s]
Train    27:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.02it/s]
Train    27:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.99it/s]
Train    27:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.88it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.96it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.07it/s]
13 Oct 03:31    INFO  epoch 27 training [time: 1.36s, train loss: 11.0132]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.22it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.11it/s]
13 Oct 03:31    INFO  epoch 27 evaluating [time: 0.15s, valid_score: 0.854500]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8792    mrr@5 : 0.853    mrr@10 : 0.8545    ndcg@5 : 0.8569    ndcg@10 : 0.8604    hit@5 : 0.8683    hit@10 : 0.8792    precision@5 : 0.1737    precision@10 : 0.0879
13 Oct 03:31    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    28:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    28:   9%|████▋                                              | 1/11 [00:00<00:01,  7.40it/s]
Train    28:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.68it/s]
Train    28:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.95it/s]
Train    28:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.03it/s]
Train    28:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.11it/s]
Train    28:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.10it/s]
Train    28:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.99it/s]
Train    28:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.00it/s]
Train    28:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.01it/s]
Train    28:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.01it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.63it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.87it/s]
13 Oct 03:31    INFO  epoch 28 training [time: 1.40s, train loss: 11.1068]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.23it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.30it/s]
13 Oct 03:31    INFO  epoch 28 evaluating [time: 0.17s, valid_score: 0.854200]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.8805    mrr@5 : 0.8528    mrr@10 : 0.8542    ndcg@5 : 0.8571    ndcg@10 : 0.8605    hit@5 : 0.8697    hit@10 : 0.8805    precision@5 : 0.1739    precision@10 : 0.0881

Train    29:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    29:   9%|████▋                                              | 1/11 [00:00<00:01,  7.84it/s]
Train    29:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.90it/s]
Train    29:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.93it/s]
Train    29:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.98it/s]
Train    29:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.98it/s]
Train    29:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.05it/s]
Train    29:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.08it/s]
Train    29:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.07it/s]
Train    29:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.03it/s]
Train    29:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.04it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.11it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.04it/s]
13 Oct 03:31    INFO  epoch 29 training [time: 1.37s, train loss: 11.8484]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.63it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.85it/s]
13 Oct 03:31    INFO  epoch 29 evaluating [time: 0.16s, valid_score: 0.855100]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8692    recall@10 : 0.8783    mrr@5 : 0.8539    mrr@10 : 0.8551    ndcg@5 : 0.8578    ndcg@10 : 0.8607    hit@5 : 0.8692    hit@10 : 0.8783    precision@5 : 0.1738    precision@10 : 0.0878
13 Oct 03:31    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    30:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    30:   9%|████▋                                              | 1/11 [00:00<00:01,  7.63it/s]
Train    30:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.81it/s]
Train    30:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.98it/s]
Train    30:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.05it/s]
Train    30:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.13it/s]
Train    30:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.07it/s]
Train    30:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.58it/s]
Train    30:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.08it/s]
Train    30:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.58it/s]
Train    30:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.07it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.45it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.37it/s]
13 Oct 03:31    INFO  epoch 30 training [time: 1.49s, train loss: 10.8367]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.27it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.18it/s]
13 Oct 03:31    INFO  epoch 30 evaluating [time: 0.17s, valid_score: 0.856100]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8706    recall@10 : 0.8787    mrr@5 : 0.855    mrr@10 : 0.8561    ndcg@5 : 0.8589    ndcg@10 : 0.8616    hit@5 : 0.8706    hit@10 : 0.8787    precision@5 : 0.1741    precision@10 : 0.0879
13 Oct 03:31    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    31:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    31:   9%|████▋                                              | 1/11 [00:00<00:01,  8.12it/s]
Train    31:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.89it/s]
Train    31:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.86it/s]
Train    31:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.82it/s]
Train    31:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.83it/s]
Train    31:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.88it/s]
Train    31:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.89it/s]
Train    31:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.92it/s]
Train    31:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.97it/s]
Train    31:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.90it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.91it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.90it/s]
13 Oct 03:31    INFO  epoch 31 training [time: 1.39s, train loss: 11.6070]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.45it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.07it/s]
13 Oct 03:31    INFO  epoch 31 evaluating [time: 0.18s, valid_score: 0.856900]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.881    mrr@5 : 0.8553    mrr@10 : 0.8569    ndcg@5 : 0.859    ndcg@10 : 0.8626    hit@5 : 0.8697    hit@10 : 0.881    precision@5 : 0.1739    precision@10 : 0.0881
13 Oct 03:31    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    32:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    32:   9%|████▋                                              | 1/11 [00:00<00:01,  7.96it/s]
Train    32:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.95it/s]
Train    32:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.98it/s]
Train    32:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.01it/s]
Train    32:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.09it/s]
Train    32:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.14it/s]
Train    32:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.14it/s]
Train    32:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.13it/s]
Train    32:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.15it/s]
Train    32:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.16it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.20it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.12it/s]
13 Oct 03:31    INFO  epoch 32 training [time: 1.36s, train loss: 11.3697]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.64it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.89it/s]
13 Oct 03:31    INFO  epoch 32 evaluating [time: 0.13s, valid_score: 0.858500]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.881    mrr@5 : 0.8572    mrr@10 : 0.8585    ndcg@5 : 0.8606    ndcg@10 : 0.8638    hit@5 : 0.871    hit@10 : 0.881    precision@5 : 0.1742    precision@10 : 0.0881
13 Oct 03:31    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    33:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    33:   9%|████▋                                              | 1/11 [00:00<00:01,  8.16it/s]
Train    33:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.15it/s]
Train    33:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.21it/s]
Train    33:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.19it/s]
Train    33:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.26it/s]
Train    33:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.28it/s]
Train    33:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.29it/s]
Train    33:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.28it/s]
Train    33:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.24it/s]
Train    33:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.19it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.19it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.22it/s]
13 Oct 03:31    INFO  epoch 33 training [time: 1.34s, train loss: 11.1416]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.56it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.08it/s]
13 Oct 03:31    INFO  epoch 33 evaluating [time: 0.13s, valid_score: 0.860300]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8719    recall@10 : 0.8778    mrr@5 : 0.8595    mrr@10 : 0.8603    ndcg@5 : 0.8626    ndcg@10 : 0.8646    hit@5 : 0.8719    hit@10 : 0.8778    precision@5 : 0.1744    precision@10 : 0.0878
13 Oct 03:31    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    34:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    34:   9%|████▋                                              | 1/11 [00:00<00:01,  8.11it/s]
Train    34:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.69it/s]
Train    34:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.86it/s]
Train    34:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.87it/s]
Train    34:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.80it/s]
Train    34:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.85it/s]
Train    34:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.90it/s]
Train    34:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.88it/s]
Train    34:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.76it/s]
Train    34:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  5.72it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.29it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.09it/s]
13 Oct 03:31    INFO  epoch 34 training [time: 1.55s, train loss: 9.8315]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.85it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.91it/s]
13 Oct 03:31    INFO  epoch 34 evaluating [time: 0.14s, valid_score: 0.858700]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8828    mrr@5 : 0.857    mrr@10 : 0.8587    ndcg@5 : 0.8604    ndcg@10 : 0.8644    hit@5 : 0.8701    hit@10 : 0.8828    precision@5 : 0.174    precision@10 : 0.0883

Train    35:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    35:   9%|████▋                                              | 1/11 [00:00<00:01,  8.12it/s]
Train    35:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.14it/s]
Train    35:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.02it/s]
Train    35:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.06it/s]
Train    35:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.09it/s]
Train    35:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.12it/s]
Train    35:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.10it/s]
Train    35:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.09it/s]
Train    35:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.05it/s]
Train    35:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.05it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.09it/s]
13 Oct 03:31    INFO  epoch 35 training [time: 1.36s, train loss: 10.2343]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.61it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.07it/s]
13 Oct 03:31    INFO  epoch 35 evaluating [time: 0.13s, valid_score: 0.856900]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.881    mrr@5 : 0.8552    mrr@10 : 0.8569    ndcg@5 : 0.8585    ndcg@10 : 0.8626    hit@5 : 0.8683    hit@10 : 0.881    precision@5 : 0.1737    precision@10 : 0.0881

Train    36:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    36:   9%|████▋                                              | 1/11 [00:00<00:01,  8.32it/s]
Train    36:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.32it/s]
Train    36:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.28it/s]
Train    36:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.30it/s]
Train    36:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.29it/s]
Train    36:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.25it/s]
Train    36:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.21it/s]
Train    36:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.23it/s]
Train    36:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.20it/s]
Train    36:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.13it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.07it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.19it/s]
13 Oct 03:31    INFO  epoch 36 training [time: 1.34s, train loss: 9.8023]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.08it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.36it/s]
13 Oct 03:31    INFO  epoch 36 evaluating [time: 0.14s, valid_score: 0.855700]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.881    mrr@5 : 0.8544    mrr@10 : 0.8557    ndcg@5 : 0.8586    ndcg@10 : 0.8618    hit@5 : 0.871    hit@10 : 0.881    precision@5 : 0.1742    precision@10 : 0.0881

Train    37:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    37:   9%|████▋                                              | 1/11 [00:00<00:01,  8.32it/s]
Train    37:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.29it/s]
Train    37:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.29it/s]
Train    37:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.19it/s]
Train    37:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.20it/s]
Train    37:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.20it/s]
Train    37:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.11it/s]
Train    37:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.12it/s]
Train    37:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.07it/s]
Train    37:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.03it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.03it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.12it/s]
13 Oct 03:31    INFO  epoch 37 training [time: 1.36s, train loss: 10.7128]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 11.53it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 14.78it/s]
13 Oct 03:31    INFO  epoch 37 evaluating [time: 0.22s, valid_score: 0.855300]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8674    recall@10 : 0.8796    mrr@5 : 0.8538    mrr@10 : 0.8553    ndcg@5 : 0.8572    ndcg@10 : 0.8611    hit@5 : 0.8674    hit@10 : 0.8796    precision@5 : 0.1735    precision@10 : 0.088

Train    38:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    38:   9%|████▋                                              | 1/11 [00:00<00:01,  7.70it/s]
Train    38:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.19it/s]
Train    38:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.46it/s]
Train    38:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.44it/s]
Train    38:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.52it/s]
Train    38:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.58it/s]
Train    38:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.42it/s]
Train    38:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  5.53it/s]
Train    38:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.10it/s]
Train    38:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.56it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.84it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.85it/s]
13 Oct 03:31    INFO  epoch 38 training [time: 1.61s, train loss: 10.7494]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 12.17it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 16.18it/s]
13 Oct 03:31    INFO  epoch 38 evaluating [time: 0.20s, valid_score: 0.859300]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8719    recall@10 : 0.8837    mrr@5 : 0.8576    mrr@10 : 0.8593    ndcg@5 : 0.8612    ndcg@10 : 0.8651    hit@5 : 0.8719    hit@10 : 0.8837    precision@5 : 0.1744    precision@10 : 0.0884

Train    39:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    39:   9%|████▋                                              | 1/11 [00:00<00:01,  5.54it/s]
Train    39:  18%|█████████▎                                         | 2/11 [00:00<00:01,  6.20it/s]
Train    39:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.46it/s]
Train    39:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.95it/s]
Train    39:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.22it/s]
Train    39:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.29it/s]
Train    39:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  6.83it/s]
Train    39:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.10it/s]
Train    39:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.29it/s]
Train    39:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.40it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.49it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.10it/s]
13 Oct 03:31    INFO  epoch 39 training [time: 1.55s, train loss: 11.0422]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 12.75it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 17.73it/s]
13 Oct 03:31    INFO  epoch 39 evaluating [time: 0.19s, valid_score: 0.859600]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.8837    mrr@5 : 0.8578    mrr@10 : 0.8596    ndcg@5 : 0.8608    ndcg@10 : 0.8653    hit@5 : 0.8697    hit@10 : 0.8837    precision@5 : 0.1739    precision@10 : 0.0884

Train    40:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    40:   9%|████▋                                              | 1/11 [00:00<00:01,  7.76it/s]
Train    40:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.36it/s]
Train    40:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.62it/s]
Train    40:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.87it/s]
Train    40:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.91it/s]
Train    40:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.37it/s]
Train    40:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.49it/s]
Train    40:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.44it/s]
Train    40:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.29it/s]
Train    40:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.77it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.17it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.16it/s]
13 Oct 03:31    INFO  epoch 40 training [time: 1.54s, train loss: 10.1116]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.68it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.69it/s]
13 Oct 03:31    INFO  epoch 40 evaluating [time: 0.14s, valid_score: 0.860800]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8706    recall@10 : 0.8842    mrr@5 : 0.859    mrr@10 : 0.8608    ndcg@5 : 0.8619    ndcg@10 : 0.8663    hit@5 : 0.8706    hit@10 : 0.8842    precision@5 : 0.1741    precision@10 : 0.0884
13 Oct 03:31    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    41:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    41:   9%|████▋                                              | 1/11 [00:00<00:01,  8.05it/s]
Train    41:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.68it/s]
Train    41:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.75it/s]
Train    41:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.27it/s]
Train    41:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.41it/s]
Train    41:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.55it/s]
Train    41:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.66it/s]
Train    41:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.86it/s]
Train    41:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.92it/s]
Train    41:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.81it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.81it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.71it/s]
13 Oct 03:31    INFO  epoch 41 training [time: 1.43s, train loss: 9.5977]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.99it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.15it/s]
13 Oct 03:31    INFO  epoch 41 evaluating [time: 0.14s, valid_score: 0.857700]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8805    mrr@5 : 0.8562    mrr@10 : 0.8577    ndcg@5 : 0.8597    ndcg@10 : 0.8631    hit@5 : 0.8701    hit@10 : 0.8805    precision@5 : 0.174    precision@10 : 0.0881

Train    42:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    42:   9%|████▋                                              | 1/11 [00:00<00:01,  8.10it/s]
Train    42:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.00it/s]
Train    42:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.08it/s]
Train    42:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.09it/s]
Train    42:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.02it/s]
Train    42:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.99it/s]
Train    42:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.07it/s]
Train    42:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  7.95it/s]
Train    42:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.96it/s]
Train    42:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.88it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.85it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.95it/s]
13 Oct 03:31    INFO  epoch 42 training [time: 1.38s, train loss: 10.2352]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.27it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.20it/s]
13 Oct 03:31    INFO  epoch 42 evaluating [time: 0.18s, valid_score: 0.856100]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8828    mrr@5 : 0.8541    mrr@10 : 0.8561    ndcg@5 : 0.8577    ndcg@10 : 0.8624    hit@5 : 0.8683    hit@10 : 0.8828    precision@5 : 0.1737    precision@10 : 0.0883

Train    43:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    43:   9%|████▋                                              | 1/11 [00:00<00:01,  7.23it/s]
Train    43:  18%|█████████▎                                         | 2/11 [00:00<00:01,  4.80it/s]
Train    43:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  5.48it/s]
Train    43:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.29it/s]
Train    43:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.90it/s]
Train    43:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.29it/s]
Train    43:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  7.49it/s]
Train    43:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.69it/s]
Train    43:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.77it/s]
Train    43:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.84it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.89it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.15it/s]
13 Oct 03:31    INFO  epoch 43 training [time: 1.54s, train loss: 10.5877]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.39it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.06it/s]
13 Oct 03:31    INFO  epoch 43 evaluating [time: 0.14s, valid_score: 0.858500]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8846    mrr@5 : 0.8565    mrr@10 : 0.8585    ndcg@5 : 0.8599    ndcg@10 : 0.8647    hit@5 : 0.8701    hit@10 : 0.8846    precision@5 : 0.174    precision@10 : 0.0885

Train    44:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    44:   9%|████▋                                              | 1/11 [00:00<00:01,  7.67it/s]
Train    44:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.89it/s]
Train    44:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.61it/s]
Train    44:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.71it/s]
Train    44:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.81it/s]
Train    44:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.92it/s]
Train    44:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.90it/s]
Train    44:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.92it/s]
Train    44:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.73it/s]
Train    44:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.82it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.91it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.84it/s]
13 Oct 03:31    INFO  epoch 44 training [time: 1.40s, train loss: 10.1106]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.15it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.05it/s]
13 Oct 03:31    INFO  epoch 44 evaluating [time: 0.14s, valid_score: 0.860300]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8747    recall@10 : 0.8882    mrr@5 : 0.8586    mrr@10 : 0.8603    ndcg@5 : 0.8625    ndcg@10 : 0.8668    hit@5 : 0.8747    hit@10 : 0.8882    precision@5 : 0.1749    precision@10 : 0.0888

Train    45:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    45:   9%|████▋                                              | 1/11 [00:00<00:01,  7.97it/s]
Train    45:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.99it/s]
Train    45:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.90it/s]
Train    45:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.94it/s]
Train    45:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.92it/s]
Train    45:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.96it/s]
Train    45:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.89it/s]
Train    45:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.82it/s]
Train    45:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.77it/s]
Train    45:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.75it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.70it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.82it/s]
13 Oct 03:31    INFO  epoch 45 training [time: 1.41s, train loss: 9.8360]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.03it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.72it/s]
13 Oct 03:31    INFO  epoch 45 evaluating [time: 0.15s, valid_score: 0.860300]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8715    recall@10 : 0.8837    mrr@5 : 0.8587    mrr@10 : 0.8603    ndcg@5 : 0.8619    ndcg@10 : 0.8658    hit@5 : 0.8715    hit@10 : 0.8837    precision@5 : 0.1743    precision@10 : 0.0884

Train    46:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    46:   9%|████▋                                              | 1/11 [00:00<00:01,  7.99it/s]
Train    46:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.09it/s]
Train    46:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.16it/s]
Train    46:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.92it/s]
Train    46:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.99it/s]
Train    46:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.97it/s]
Train    46:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.59it/s]
Train    46:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.55it/s]
Train    46:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.62it/s]
Train    46:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.61it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.74it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.78it/s]
13 Oct 03:31    INFO  epoch 46 training [time: 1.41s, train loss: 10.3990]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.81it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.61it/s]
13 Oct 03:31    INFO  epoch 46 evaluating [time: 0.15s, valid_score: 0.862000]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8724    recall@10 : 0.8828    mrr@5 : 0.8607    mrr@10 : 0.862    ndcg@5 : 0.8636    ndcg@10 : 0.8669    hit@5 : 0.8724    hit@10 : 0.8828    precision@5 : 0.1745    precision@10 : 0.0883
13 Oct 03:31    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Train    47:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    47:   9%|████▋                                              | 1/11 [00:00<00:01,  7.92it/s]
Train    47:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.00it/s]
Train    47:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.01it/s]
Train    47:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.06it/s]
Train    47:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.10it/s]
Train    47:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.12it/s]
Train    47:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.62it/s]
Train    47:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.87it/s]
Train    47:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.20it/s]
Train    47:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.48it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.64it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.37it/s]
13 Oct 03:31    INFO  epoch 47 training [time: 1.49s, train loss: 10.2382]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.48it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.01it/s]
13 Oct 03:31    INFO  epoch 47 evaluating [time: 0.15s, valid_score: 0.860400]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.8846    mrr@5 : 0.8586    mrr@10 : 0.8604    ndcg@5 : 0.8617    ndcg@10 : 0.8661    hit@5 : 0.871    hit@10 : 0.8846    precision@5 : 0.1742    precision@10 : 0.0885

Train    48:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    48:   9%|████▋                                              | 1/11 [00:00<00:01,  7.83it/s]
Train    48:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.89it/s]
Train    48:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.84it/s]
Train    48:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.92it/s]
Train    48:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.00it/s]
Train    48:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.04it/s]
Train    48:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.01it/s]
Train    48:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.09it/s]
Train    48:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.11it/s]
Train    48:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.10it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.04it/s]
13 Oct 03:31    INFO  epoch 48 training [time: 1.37s, train loss: 9.4924]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.11it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.92it/s]
13 Oct 03:31    INFO  epoch 48 evaluating [time: 0.17s, valid_score: 0.861200]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.8738    recall@10 : 0.8873    mrr@5 : 0.8594    mrr@10 : 0.8612    ndcg@5 : 0.863    ndcg@10 : 0.8674    hit@5 : 0.8738    hit@10 : 0.8873    precision@5 : 0.1748    precision@10 : 0.0887

Train    49:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    49:   9%|████▋                                              | 1/11 [00:00<00:01,  8.07it/s]
Train    49:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.03it/s]
Train    49:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.93it/s]
Train    49:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.89it/s]
Train    49:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.96it/s]
Train    49:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.01it/s]
Train    49:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.01it/s]
Train    49:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.07it/s]
Train    49:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.07it/s]
Train    49:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.05it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.04it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.02it/s]
13 Oct 03:31    INFO  epoch 49 training [time: 1.37s, train loss: 9.9048]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.31it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.22it/s]
13 Oct 03:31    INFO  epoch 49 evaluating [time: 0.17s, valid_score: 0.861300]
13 Oct 03:31    INFO  valid result: 
recall@5 : 0.876    recall@10 : 0.886    mrr@5 : 0.8599    mrr@10 : 0.8613    ndcg@5 : 0.8639    ndcg@10 : 0.8671    hit@5 : 0.876    hit@10 : 0.886    precision@5 : 0.1752    precision@10 : 0.0886
13 Oct 03:31    INFO  Loading model structure and parameters from saved/BERT4Rec-Oct-13-2025_03-30-33.pth

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.72it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.38it/s]
13 Oct 03:31    INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |     7.40 %     |
+-------------+----------------+
| GPU         |   0.0 / 0.0    |
+-------------+----------------+
| Memory      | 1.19 G/15.33 G |
+-------------+----------------+
13 Oct 03:31    INFO  best valid : OrderedDict({'recall@5': 0.8724, 'recall@10': 0.8828, 'mrr@5': 0.8607, 'mrr@10': 0.862, 'ndcg@5': 0.8636, 'ndcg@10': 0.8669, 'hit@5': 0.8724, 'hit@10': 0.8828, 'precision@5': 0.1745, 'precision@10': 0.0883})
13 Oct 03:31    INFO  test result: OrderedDict({'recall@5': 0.9787, 'recall@10': 0.9835, 'mrr@5': 0.9596, 'mrr@10': 0.9602, 'ndcg@5': 0.9645, 'ndcg@10': 0.966, 'hit@5': 0.9787, 'hit@10': 0.9835, 'precision@5': 0.1957, 'precision@10': 0.0983})
2025-10-13 03:31:55,637 | INFO | Published checkpoint /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/saved/BERT4Rec-Oct-13-2025_03-30-33.pth → /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/versions/BERT4Rec-Oct-13-2025_03-30-33.pth
2025-10-13 03:31:55,638 | INFO | Retraining completed in 0:01:27.670311 | dataset=20251012-203029 | model=Oct-13-2025_03-30-33
2025-10-13 03:32:25,639 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:32:26,434 | INFO | 🔄 Đang trích xuất data từ Postgres...
🐘 Đã trích xuất bằng psycopg.
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 69
Số user: 2
Số sản phẩm: 11
Các loại event: {'add_to_cart': 0.42, 'view': 0.377, 'purchase': 0.203}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[10 rows x 5 columns]
2025-10-13 03:32:26,435 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:32:26,952 | INFO | 🗂  Đã cập nhật /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/interactions.csv (tổng 18368 bản ghi).
✅ Đã tạo snapshot 20251012-203226 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-203226/ecommerce.inter) với 18368 dòng
👥  User: 2609 | 🛒  Sản phẩm: 106
🏷️   Nhãn mua hàng (label=1): 2995
      user_id item_id   timestamp  label
4952        3      25  1704067200      0
4953        3      25  1704068520      0
18272       3      89  1707264000      0
18273       3      89  1707264300      0
18274       3      89  1707265440      0
18275       3      89  1707266820      1
1123        3      12  1708041600      0
1124        3      12  1708044480      0
10396       4       4  1707436800      0
10397       4       4  1707437100      0
2025-10-13 03:32:26,954 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-195714
2025-10-13 03:32:26,954 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 03:33:51,764 | INFO | 13 Oct 03:32    INFO  ['train_bert4rec.py']
13 Oct 03:32    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = False
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
device = cuda
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 03:32    INFO  ecommerce
The number of users: 2608
Average actions of users: 7.045646336785578
The number of items: 96
Average actions of items: 193.34736842105264
The number of inters: 18368
The sparsity of the dataset: 92.66359918200409%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 03:32    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 03:32    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 03:32    INFO  BERT4Rec(
  (item_embedding): Embedding(97, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 113888
13 Oct 03:32    INFO  FLOPs: 5194664.0
🔧 Sử dụng topk=[5, 10], valid_metric=MRR@10, device=cpu

Train     0:   0%|                                                           | 0/11 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   9%|████▋                                              | 1/11 [00:00<00:03,  3.08it/s]
Train     0:  18%|█████████▎                                         | 2/11 [00:00<00:01,  4.91it/s]
Train     0:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.22it/s]
Train     0:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.09it/s]
Train     0:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.72it/s]
Train     0:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.21it/s]
Train     0:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.51it/s]
Train     0:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.69it/s]
Train     0:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.87it/s]
Train     0:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.00it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.16it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.75it/s]
13 Oct 03:32    INFO  epoch 0 training [time: 1.42s, train loss: 49.7594]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.99it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.18it/s]
13 Oct 03:32    INFO  epoch 0 evaluating [time: 0.15s, valid_score: 0.057500]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.0937    recall@10 : 0.1765    mrr@5 : 0.0466    mrr@10 : 0.0575    ndcg@5 : 0.0582    ndcg@10 : 0.0847    hit@5 : 0.0937    hit@10 : 0.1765    precision@5 : 0.0187    precision@10 : 0.0176
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train     1:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     1:   9%|████▋                                              | 1/11 [00:00<00:01,  9.06it/s]
Train     1:  18%|█████████▎                                         | 2/11 [00:00<00:01,  9.00it/s]
Train     1:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.05it/s]
Train     1:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.97it/s]
Train     1:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.87it/s]
Train     1:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.82it/s]
Train     1:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.89it/s]
Train     1:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.88it/s]
Train     1:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.96it/s]
Train     1:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  9.04it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.93it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.94it/s]
13 Oct 03:32    INFO  epoch 1 training [time: 1.23s, train loss: 48.9054]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.27it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.36it/s]
13 Oct 03:32    INFO  epoch 1 evaluating [time: 0.12s, valid_score: 0.078800]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.1348    recall@10 : 0.2118    mrr@5 : 0.0691    mrr@10 : 0.0788    ndcg@5 : 0.0853    ndcg@10 : 0.1096    hit@5 : 0.1348    hit@10 : 0.2118    precision@5 : 0.027    precision@10 : 0.0212
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train     2:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     2:   9%|████▋                                              | 1/11 [00:00<00:01,  9.02it/s]
Train     2:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.13it/s]
Train     2:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.12it/s]
Train     2:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  9.19it/s]
Train     2:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.70it/s]
Train     2:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.42it/s]
Train     2:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.90it/s]
Train     2:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.25it/s]
Train     2:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.51it/s]
Train     2:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.59it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.60it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.31it/s]
13 Oct 03:32    INFO  epoch 2 training [time: 1.32s, train loss: 46.8474]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.65it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.61it/s]
13 Oct 03:32    INFO  epoch 2 evaluating [time: 0.12s, valid_score: 0.351100]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.5244    recall@10 : 0.6136    mrr@5 : 0.3392    mrr@10 : 0.3511    ndcg@5 : 0.3855    ndcg@10 : 0.4144    hit@5 : 0.5244    hit@10 : 0.6136    precision@5 : 0.1049    precision@10 : 0.0614
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train     3:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     3:   9%|████▋                                              | 1/11 [00:00<00:01,  8.95it/s]
Train     3:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.46it/s]
Train     3:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.33it/s]
Train     3:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.45it/s]
Train     3:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.63it/s]
Train     3:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.75it/s]
Train     3:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.81it/s]
Train     3:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.82it/s]
Train     3:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.81it/s]
Train     3:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.74it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.83it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.72it/s]
13 Oct 03:32    INFO  epoch 3 training [time: 1.26s, train loss: 42.5084]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.39it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.30it/s]
13 Oct 03:32    INFO  epoch 3 evaluating [time: 0.12s, valid_score: 0.538900]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.6611    recall@10 : 0.7217    mrr@5 : 0.5306    mrr@10 : 0.5389    ndcg@5 : 0.5636    ndcg@10 : 0.5834    hit@5 : 0.6611    hit@10 : 0.7217    precision@5 : 0.1322    precision@10 : 0.0722
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train     4:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     4:   9%|████▋                                              | 1/11 [00:00<00:01,  8.95it/s]
Train     4:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.99it/s]
Train     4:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  9.09it/s]
Train     4:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.95it/s]
Train     4:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.96it/s]
Train     4:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.73it/s]
Train     4:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.45it/s]
Train     4:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.33it/s]
Train     4:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.35it/s]
Train     4:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.34it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.43it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.58it/s]
13 Oct 03:32    INFO  epoch 4 training [time: 1.28s, train loss: 38.5157]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.47it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.07it/s]
13 Oct 03:32    INFO  epoch 4 evaluating [time: 0.13s, valid_score: 0.577400]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.6937    recall@10 : 0.7443    mrr@5 : 0.5704    mrr@10 : 0.5774    ndcg@5 : 0.6016    ndcg@10 : 0.6183    hit@5 : 0.6937    hit@10 : 0.7443    precision@5 : 0.1387    precision@10 : 0.0744
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train     5:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     5:   9%|████▋                                              | 1/11 [00:00<00:01,  8.57it/s]
Train     5:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.59it/s]
Train     5:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.67it/s]
Train     5:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.83it/s]
Train     5:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.94it/s]
Train     5:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.84it/s]
Train     5:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.65it/s]
Train     5:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.61it/s]
Train     5:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.49it/s]
Train     5:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.52it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.63it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.66it/s]
13 Oct 03:32    INFO  epoch 5 training [time: 1.27s, train loss: 35.0609]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.50it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.05it/s]
13 Oct 03:32    INFO  epoch 5 evaluating [time: 0.13s, valid_score: 0.636100]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.7303    recall@10 : 0.7765    mrr@5 : 0.6301    mrr@10 : 0.6361    ndcg@5 : 0.6553    ndcg@10 : 0.6701    hit@5 : 0.7303    hit@10 : 0.7765    precision@5 : 0.1461    precision@10 : 0.0776
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train     6:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     6:   9%|████▋                                              | 1/11 [00:00<00:01,  8.63it/s]
Train     6:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.88it/s]
Train     6:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.10it/s]
Train     6:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.30it/s]
Train     6:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.43it/s]
Train     6:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.41it/s]
Train     6:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.01it/s]
Train     6:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.44it/s]
Train     6:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.81it/s]
Train     6:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.94it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.19it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.80it/s]
13 Oct 03:32    INFO  epoch 6 training [time: 1.41s, train loss: 31.5342]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.32it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.72it/s]
13 Oct 03:32    INFO  epoch 6 evaluating [time: 0.13s, valid_score: 0.688700]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.7548    recall@10 : 0.8023    mrr@5 : 0.6823    mrr@10 : 0.6887    ndcg@5 : 0.7006    ndcg@10 : 0.716    hit@5 : 0.7548    hit@10 : 0.8023    precision@5 : 0.151    precision@10 : 0.0802
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train     7:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     7:   9%|████▋                                              | 1/11 [00:00<00:01,  8.70it/s]
Train     7:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.72it/s]
Train     7:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.61it/s]
Train     7:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.78it/s]
Train     7:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.81it/s]
Train     7:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.76it/s]
Train     7:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.76it/s]
Train     7:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.72it/s]
Train     7:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.56it/s]
Train     7:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.61it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.68it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.69it/s]
13 Oct 03:32    INFO  epoch 7 training [time: 1.27s, train loss: 28.7599]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.27it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.36it/s]
13 Oct 03:32    INFO  epoch 7 evaluating [time: 0.14s, valid_score: 0.720300]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.7842    recall@10 : 0.8213    mrr@5 : 0.7153    mrr@10 : 0.7203    ndcg@5 : 0.7326    ndcg@10 : 0.7446    hit@5 : 0.7842    hit@10 : 0.8213    precision@5 : 0.1568    precision@10 : 0.0821
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train     8:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     8:   9%|████▋                                              | 1/11 [00:00<00:01,  8.51it/s]
Train     8:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.52it/s]
Train     8:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.61it/s]
Train     8:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.64it/s]
Train     8:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.64it/s]
Train     8:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.70it/s]
Train     8:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.53it/s]
Train     8:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.42it/s]
Train     8:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.34it/s]
Train     8:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.25it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.28it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.43it/s]
13 Oct 03:32    INFO  epoch 8 training [time: 1.30s, train loss: 25.9326]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.95it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.53it/s]
13 Oct 03:32    INFO  epoch 8 evaluating [time: 0.13s, valid_score: 0.747400]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.8041    recall@10 : 0.8339    mrr@5 : 0.7434    mrr@10 : 0.7474    ndcg@5 : 0.7586    ndcg@10 : 0.7683    hit@5 : 0.8041    hit@10 : 0.8339    precision@5 : 0.1608    precision@10 : 0.0834
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train     9:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     9:   9%|████▋                                              | 1/11 [00:00<00:01,  8.49it/s]
Train     9:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.56it/s]
Train     9:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.59it/s]
Train     9:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.61it/s]
Train     9:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.75it/s]
Train     9:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.74it/s]
Train     9:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.82it/s]
Train     9:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.86it/s]
Train     9:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.72it/s]
Train     9:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.52it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.46it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.62it/s]
13 Oct 03:32    INFO  epoch 9 training [time: 1.28s, train loss: 23.2385]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.58it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.27it/s]
13 Oct 03:32    INFO  epoch 9 evaluating [time: 0.13s, valid_score: 0.783100]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.829    recall@10 : 0.8529    mrr@5 : 0.7799    mrr@10 : 0.7831    ndcg@5 : 0.7923    ndcg@10 : 0.8    hit@5 : 0.829    hit@10 : 0.8529    precision@5 : 0.1658    precision@10 : 0.0853
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    10:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    10:   9%|████▋                                              | 1/11 [00:00<00:01,  8.51it/s]
Train    10:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.43it/s]
Train    10:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.63it/s]
Train    10:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.62it/s]
Train    10:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.65it/s]
Train    10:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.69it/s]
Train    10:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.71it/s]
Train    10:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.69it/s]
Train    10:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.71it/s]
Train    10:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.49it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.12it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.91it/s]
13 Oct 03:32    INFO  epoch 10 training [time: 1.39s, train loss: 20.9736]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.28it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 26.49it/s]
13 Oct 03:32    INFO  epoch 10 evaluating [time: 0.12s, valid_score: 0.809200]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.8385    recall@10 : 0.8579    mrr@5 : 0.8065    mrr@10 : 0.8092    ndcg@5 : 0.8145    ndcg@10 : 0.8209    hit@5 : 0.8385    hit@10 : 0.8579    precision@5 : 0.1677    precision@10 : 0.0858
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    11:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    11:   9%|████▋                                              | 1/11 [00:00<00:01,  8.45it/s]
Train    11:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.05it/s]
Train    11:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.04it/s]
Train    11:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.94it/s]
Train    11:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.04it/s]
Train    11:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.15it/s]
Train    11:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.25it/s]
Train    11:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.40it/s]
Train    11:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.52it/s]
Train    11:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.49it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.41it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.29it/s]
13 Oct 03:32    INFO  epoch 11 training [time: 1.33s, train loss: 19.1671]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.80it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.24it/s]
13 Oct 03:32    INFO  epoch 11 evaluating [time: 0.19s, valid_score: 0.820000]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.8448    recall@10 : 0.8665    mrr@5 : 0.8171    mrr@10 : 0.82    ndcg@5 : 0.8241    ndcg@10 : 0.8311    hit@5 : 0.8448    hit@10 : 0.8665    precision@5 : 0.169    precision@10 : 0.0867
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    12:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    12:   9%|████▋                                              | 1/11 [00:00<00:01,  8.57it/s]
Train    12:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.68it/s]
Train    12:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.68it/s]
Train    12:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.70it/s]
Train    12:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.70it/s]
Train    12:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.69it/s]
Train    12:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.69it/s]
Train    12:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.69it/s]
Train    12:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.68it/s]
Train    12:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.57it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.40it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.59it/s]
13 Oct 03:32    INFO  epoch 12 training [time: 1.28s, train loss: 17.4560]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.13it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.94it/s]
13 Oct 03:32    INFO  epoch 12 evaluating [time: 0.17s, valid_score: 0.829300]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.8475    recall@10 : 0.8679    mrr@5 : 0.8265    mrr@10 : 0.8293    ndcg@5 : 0.8318    ndcg@10 : 0.8384    hit@5 : 0.8475    hit@10 : 0.8679    precision@5 : 0.1695    precision@10 : 0.0868
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    13:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    13:   9%|████▋                                              | 1/11 [00:00<00:01,  8.28it/s]
Train    13:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.88it/s]
Train    13:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.74it/s]
Train    13:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.89it/s]
Train    13:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.53it/s]
Train    13:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.89it/s]
Train    13:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.10it/s]
Train    13:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.20it/s]
Train    13:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.27it/s]
Train    13:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.27it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.33it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.10it/s]
13 Oct 03:32    INFO  epoch 13 training [time: 1.36s, train loss: 16.1932]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.25it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.75it/s]
13 Oct 03:32    INFO  epoch 13 evaluating [time: 0.16s, valid_score: 0.835100]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.8534    recall@10 : 0.8719    mrr@5 : 0.8326    mrr@10 : 0.8351    ndcg@5 : 0.8378    ndcg@10 : 0.8438    hit@5 : 0.8534    hit@10 : 0.8719    precision@5 : 0.1707    precision@10 : 0.0872
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    14:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    14:   9%|████▋                                              | 1/11 [00:00<00:01,  8.24it/s]
Train    14:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.25it/s]
Train    14:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.70it/s]
Train    14:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.79it/s]
Train    14:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.84it/s]
Train    14:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.83it/s]
Train    14:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.01it/s]
Train    14:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.14it/s]
Train    14:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.75it/s]
Train    14:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.93it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.95it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.93it/s]
13 Oct 03:32    INFO  epoch 14 training [time: 1.39s, train loss: 15.6198]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  5.94it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 11.98it/s]
13 Oct 03:32    INFO  epoch 14 evaluating [time: 0.27s, valid_score: 0.841300]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.857    recall@10 : 0.8742    mrr@5 : 0.8391    mrr@10 : 0.8413    ndcg@5 : 0.8436    ndcg@10 : 0.8491    hit@5 : 0.857    hit@10 : 0.8742    precision@5 : 0.1714    precision@10 : 0.0874
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    15:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    15:   9%|████▋                                              | 1/11 [00:00<00:01,  8.43it/s]
Train    15:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.29it/s]
Train    15:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.34it/s]
Train    15:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.45it/s]
Train    15:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.50it/s]
Train    15:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.24it/s]
Train    15:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.25it/s]
Train    15:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.12it/s]
Train    15:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.97it/s]
Train    15:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.93it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.00it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.15it/s]
13 Oct 03:32    INFO  epoch 15 training [time: 1.35s, train loss: 13.9309]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.22it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.65it/s]
13 Oct 03:32    INFO  epoch 15 evaluating [time: 0.13s, valid_score: 0.845200]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.8588    recall@10 : 0.8742    mrr@5 : 0.8432    mrr@10 : 0.8452    ndcg@5 : 0.8471    ndcg@10 : 0.852    hit@5 : 0.8588    hit@10 : 0.8742    precision@5 : 0.1718    precision@10 : 0.0874
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    16:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    16:   9%|████▋                                              | 1/11 [00:00<00:01,  8.33it/s]
Train    16:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.27it/s]
Train    16:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.35it/s]
Train    16:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.41it/s]
Train    16:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.43it/s]
Train    16:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.58it/s]
Train    16:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.56it/s]
Train    16:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.51it/s]
Train    16:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.44it/s]
Train    16:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.44it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.40it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.43it/s]
13 Oct 03:32    INFO  epoch 16 training [time: 1.31s, train loss: 13.4300]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.33it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.93it/s]
13 Oct 03:32    INFO  epoch 16 evaluating [time: 0.13s, valid_score: 0.844100]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.8575    recall@10 : 0.8765    mrr@5 : 0.8416    mrr@10 : 0.8441    ndcg@5 : 0.8456    ndcg@10 : 0.8517    hit@5 : 0.8575    hit@10 : 0.8765    precision@5 : 0.1715    precision@10 : 0.0876

Train    17:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    17:   9%|████▋                                              | 1/11 [00:00<00:01,  8.54it/s]
Train    17:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.48it/s]
Train    17:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.44it/s]
Train    17:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.34it/s]
Train    17:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.19it/s]
Train    17:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.15it/s]
Train    17:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.11it/s]
Train    17:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.11it/s]
Train    17:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.10it/s]
Train    17:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.16it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.26it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.23it/s]
13 Oct 03:32    INFO  epoch 17 training [time: 1.34s, train loss: 13.0804]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.13it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.12it/s]
13 Oct 03:32    INFO  epoch 17 evaluating [time: 0.15s, valid_score: 0.846200]
13 Oct 03:32    INFO  valid result: 
recall@5 : 0.8597    recall@10 : 0.8751    mrr@5 : 0.8443    mrr@10 : 0.8462    ndcg@5 : 0.8481    ndcg@10 : 0.853    hit@5 : 0.8597    hit@10 : 0.8751    precision@5 : 0.1719    precision@10 : 0.0875
13 Oct 03:32    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    18:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    18:   9%|████▋                                              | 1/11 [00:00<00:01,  8.23it/s]
Train    18:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.34it/s]
Train    18:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.23it/s]
Train    18:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.29it/s]
Train    18:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.24it/s]
Train    18:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.20it/s]
Train    18:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.31it/s]
Train    18:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.84it/s]
Train    18:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.04it/s]
Train    18:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.29it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.29it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.44it/s]
13 Oct 03:33    INFO  epoch 18 training [time: 1.48s, train loss: 13.4371]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.52it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.30it/s]
13 Oct 03:33    INFO  epoch 18 evaluating [time: 0.15s, valid_score: 0.852200]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8647    recall@10 : 0.8769    mrr@5 : 0.8507    mrr@10 : 0.8522    ndcg@5 : 0.8542    ndcg@10 : 0.8581    hit@5 : 0.8647    hit@10 : 0.8769    precision@5 : 0.1729    precision@10 : 0.0877
13 Oct 03:33    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    19:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    19:   9%|████▋                                              | 1/11 [00:00<00:01,  8.03it/s]
Train    19:  18%|█████████▎                                         | 2/11 [00:00<00:01,  6.97it/s]
Train    19:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.12it/s]
Train    19:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.49it/s]
Train    19:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.60it/s]
Train    19:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.77it/s]
Train    19:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.84it/s]
Train    19:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.61it/s]
Train    19:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.68it/s]
Train    19:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.73it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.91it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.68it/s]
13 Oct 03:33    INFO  epoch 19 training [time: 1.43s, train loss: 13.0179]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.59it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.20it/s]
13 Oct 03:33    INFO  epoch 19 evaluating [time: 0.13s, valid_score: 0.851000]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8638    recall@10 : 0.8778    mrr@5 : 0.8492    mrr@10 : 0.851    ndcg@5 : 0.8529    ndcg@10 : 0.8574    hit@5 : 0.8638    hit@10 : 0.8778    precision@5 : 0.1728    precision@10 : 0.0878

Train    20:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    20:   9%|████▋                                              | 1/11 [00:00<00:01,  8.51it/s]
Train    20:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.33it/s]
Train    20:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.21it/s]
Train    20:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.18it/s]
Train    20:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.25it/s]
Train    20:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.36it/s]
Train    20:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.30it/s]
Train    20:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.26it/s]
Train    20:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.20it/s]
Train    20:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.13it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.12it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.21it/s]
13 Oct 03:33    INFO  epoch 20 training [time: 1.34s, train loss: 12.5615]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.39it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.85it/s]
13 Oct 03:33    INFO  epoch 20 evaluating [time: 0.15s, valid_score: 0.852700]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.867    recall@10 : 0.8778    mrr@5 : 0.8513    mrr@10 : 0.8527    ndcg@5 : 0.8552    ndcg@10 : 0.8587    hit@5 : 0.867    hit@10 : 0.8778    precision@5 : 0.1734    precision@10 : 0.0878
13 Oct 03:33    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    21:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    21:   9%|████▋                                              | 1/11 [00:00<00:01,  7.97it/s]
Train    21:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.06it/s]
Train    21:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.14it/s]
Train    21:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.74it/s]
Train    21:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.97it/s]
Train    21:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.07it/s]
Train    21:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.21it/s]
Train    21:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.71it/s]
Train    21:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.55it/s]
Train    21:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.69it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.74it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.84it/s]
13 Oct 03:33    INFO  epoch 21 training [time: 1.40s, train loss: 11.9438]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.57it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.53it/s]
13 Oct 03:33    INFO  epoch 21 evaluating [time: 0.15s, valid_score: 0.853200]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8661    recall@10 : 0.8796    mrr@5 : 0.8515    mrr@10 : 0.8532    ndcg@5 : 0.8552    ndcg@10 : 0.8595    hit@5 : 0.8661    hit@10 : 0.8796    precision@5 : 0.1732    precision@10 : 0.088
13 Oct 03:33    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    22:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    22:   9%|████▋                                              | 1/11 [00:00<00:01,  7.78it/s]
Train    22:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.99it/s]
Train    22:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.05it/s]
Train    22:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.96it/s]
Train    22:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.08it/s]
Train    22:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  5.85it/s]
Train    22:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  6.45it/s]
Train    22:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.90it/s]
Train    22:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.16it/s]
Train    22:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.23it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.81it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.05it/s]
13 Oct 03:33    INFO  epoch 22 training [time: 1.56s, train loss: 11.5617]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.38it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.56it/s]
13 Oct 03:33    INFO  epoch 22 evaluating [time: 0.18s, valid_score: 0.852400]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8652    recall@10 : 0.8783    mrr@5 : 0.8506    mrr@10 : 0.8524    ndcg@5 : 0.8543    ndcg@10 : 0.8586    hit@5 : 0.8652    hit@10 : 0.8783    precision@5 : 0.173    precision@10 : 0.0878

Train    23:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    23:   9%|████▋                                              | 1/11 [00:00<00:01,  8.17it/s]
Train    23:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.20it/s]
Train    23:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.06it/s]
Train    23:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.05it/s]
Train    23:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.68it/s]
Train    23:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.49it/s]
Train    23:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.69it/s]
Train    23:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.62it/s]
Train    23:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.62it/s]
Train    23:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.69it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.94it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.81it/s]
13 Oct 03:33    INFO  epoch 23 training [time: 1.41s, train loss: 11.4483]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.87it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.89it/s]
13 Oct 03:33    INFO  epoch 23 evaluating [time: 0.14s, valid_score: 0.850200]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8652    recall@10 : 0.8792    mrr@5 : 0.8483    mrr@10 : 0.8502    ndcg@5 : 0.8525    ndcg@10 : 0.857    hit@5 : 0.8652    hit@10 : 0.8792    precision@5 : 0.173    precision@10 : 0.0879

Train    24:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    24:   9%|████▋                                              | 1/11 [00:00<00:01,  6.55it/s]
Train    24:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.33it/s]
Train    24:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.71it/s]
Train    24:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.93it/s]
Train    24:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.06it/s]
Train    24:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.15it/s]
Train    24:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.14it/s]
Train    24:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.22it/s]
Train    24:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.16it/s]
Train    24:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.11it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.00it/s]
13 Oct 03:33    INFO  epoch 24 training [time: 1.38s, train loss: 11.3786]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.13it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.14it/s]
13 Oct 03:33    INFO  epoch 24 evaluating [time: 0.14s, valid_score: 0.852300]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8792    mrr@5 : 0.8508    mrr@10 : 0.8523    ndcg@5 : 0.8552    ndcg@10 : 0.8587    hit@5 : 0.8683    hit@10 : 0.8792    precision@5 : 0.1737    precision@10 : 0.0879

Train    25:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    25:   9%|████▋                                              | 1/11 [00:00<00:01,  8.39it/s]
Train    25:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.28it/s]
Train    25:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.26it/s]
Train    25:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.24it/s]
Train    25:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.26it/s]
Train    25:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.26it/s]
Train    25:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.28it/s]
Train    25:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.18it/s]
Train    25:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.08it/s]
Train    25:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.77it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.90it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.09it/s]
13 Oct 03:33    INFO  epoch 25 training [time: 1.36s, train loss: 11.9237]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.67it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.61it/s]
13 Oct 03:33    INFO  epoch 25 evaluating [time: 0.15s, valid_score: 0.852800]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8674    recall@10 : 0.8778    mrr@5 : 0.8513    mrr@10 : 0.8528    ndcg@5 : 0.8553    ndcg@10 : 0.8588    hit@5 : 0.8674    hit@10 : 0.8778    precision@5 : 0.1735    precision@10 : 0.0878

Train    26:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    26:   9%|████▋                                              | 1/11 [00:00<00:01,  8.09it/s]
Train    26:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.07it/s]
Train    26:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.14it/s]
Train    26:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.17it/s]
Train    26:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.25it/s]
Train    26:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.27it/s]
Train    26:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.29it/s]
Train    26:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.33it/s]
Train    26:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.32it/s]
Train    26:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.38it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.95it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.62it/s]
13 Oct 03:33    INFO  epoch 26 training [time: 1.44s, train loss: 11.2112]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.64it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.28it/s]
13 Oct 03:33    INFO  epoch 26 evaluating [time: 0.13s, valid_score: 0.854300]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8729    recall@10 : 0.8801    mrr@5 : 0.8534    mrr@10 : 0.8543    ndcg@5 : 0.8583    ndcg@10 : 0.8606    hit@5 : 0.8729    hit@10 : 0.8801    precision@5 : 0.1746    precision@10 : 0.088
13 Oct 03:33    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    27:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    27:   9%|████▋                                              | 1/11 [00:00<00:01,  8.53it/s]
Train    27:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.24it/s]
Train    27:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.19it/s]
Train    27:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.10it/s]
Train    27:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.09it/s]
Train    27:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.19it/s]
Train    27:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.19it/s]
Train    27:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.12it/s]
Train    27:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.01it/s]
Train    27:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.85it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.82it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.02it/s]
13 Oct 03:33    INFO  epoch 27 training [time: 1.37s, train loss: 11.0132]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.12it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 17.80it/s]
13 Oct 03:33    INFO  epoch 27 evaluating [time: 0.18s, valid_score: 0.854500]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8792    mrr@5 : 0.853    mrr@10 : 0.8545    ndcg@5 : 0.8569    ndcg@10 : 0.8604    hit@5 : 0.8683    hit@10 : 0.8792    precision@5 : 0.1737    precision@10 : 0.0879
13 Oct 03:33    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    28:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    28:   9%|████▋                                              | 1/11 [00:00<00:01,  8.10it/s]
Train    28:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.59it/s]
Train    28:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.59it/s]
Train    28:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.72it/s]
Train    28:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.83it/s]
Train    28:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.98it/s]
Train    28:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.03it/s]
Train    28:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.00it/s]
Train    28:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.02it/s]
Train    28:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.10it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.16it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.98it/s]
13 Oct 03:33    INFO  epoch 28 training [time: 1.38s, train loss: 11.1068]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.67it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.11it/s]
13 Oct 03:33    INFO  epoch 28 evaluating [time: 0.13s, valid_score: 0.854200]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.8805    mrr@5 : 0.8528    mrr@10 : 0.8542    ndcg@5 : 0.8571    ndcg@10 : 0.8605    hit@5 : 0.8697    hit@10 : 0.8805    precision@5 : 0.1739    precision@10 : 0.0881

Train    29:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    29:   9%|████▋                                              | 1/11 [00:00<00:01,  7.93it/s]
Train    29:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.17it/s]
Train    29:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.18it/s]
Train    29:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.21it/s]
Train    29:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.21it/s]
Train    29:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.08it/s]
Train    29:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.99it/s]
Train    29:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.00it/s]
Train    29:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.09it/s]
Train    29:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.04it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.06it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.08it/s]
13 Oct 03:33    INFO  epoch 29 training [time: 1.36s, train loss: 11.8484]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.93it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.56it/s]
13 Oct 03:33    INFO  epoch 29 evaluating [time: 0.13s, valid_score: 0.855100]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8692    recall@10 : 0.8783    mrr@5 : 0.8539    mrr@10 : 0.8551    ndcg@5 : 0.8578    ndcg@10 : 0.8607    hit@5 : 0.8692    hit@10 : 0.8783    precision@5 : 0.1738    precision@10 : 0.0878
13 Oct 03:33    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    30:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    30:   9%|████▋                                              | 1/11 [00:00<00:01,  8.37it/s]
Train    30:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.28it/s]
Train    30:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.25it/s]
Train    30:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.22it/s]
Train    30:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.20it/s]
Train    30:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.23it/s]
Train    30:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.10it/s]
Train    30:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.32it/s]
Train    30:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.85it/s]
Train    30:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.24it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.54it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.60it/s]
13 Oct 03:33    INFO  epoch 30 training [time: 1.45s, train loss: 10.8367]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.88it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.31it/s]
13 Oct 03:33    INFO  epoch 30 evaluating [time: 0.16s, valid_score: 0.856100]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8706    recall@10 : 0.8787    mrr@5 : 0.855    mrr@10 : 0.8561    ndcg@5 : 0.8589    ndcg@10 : 0.8616    hit@5 : 0.8706    hit@10 : 0.8787    precision@5 : 0.1741    precision@10 : 0.0879
13 Oct 03:33    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    31:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    31:   9%|████▋                                              | 1/11 [00:00<00:01,  8.06it/s]
Train    31:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.06it/s]
Train    31:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.11it/s]
Train    31:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.08it/s]
Train    31:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.10it/s]
Train    31:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.01it/s]
Train    31:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.93it/s]
Train    31:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  7.93it/s]
Train    31:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.98it/s]
Train    31:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.94it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.05it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.02it/s]
13 Oct 03:33    INFO  epoch 31 training [time: 1.37s, train loss: 11.6070]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.75it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.26it/s]
13 Oct 03:33    INFO  epoch 31 evaluating [time: 0.13s, valid_score: 0.856900]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.881    mrr@5 : 0.8553    mrr@10 : 0.8569    ndcg@5 : 0.859    ndcg@10 : 0.8626    hit@5 : 0.8697    hit@10 : 0.881    precision@5 : 0.1739    precision@10 : 0.0881
13 Oct 03:33    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    32:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    32:   9%|████▋                                              | 1/11 [00:00<00:01,  8.09it/s]
Train    32:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.11it/s]
Train    32:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.10it/s]
Train    32:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.12it/s]
Train    32:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.10it/s]
Train    32:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.09it/s]
Train    32:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.11it/s]
Train    32:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.11it/s]
Train    32:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.05it/s]
Train    32:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.96it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.03it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.06it/s]
13 Oct 03:33    INFO  epoch 32 training [time: 1.36s, train loss: 11.3697]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.96it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.95it/s]
13 Oct 03:33    INFO  epoch 32 evaluating [time: 0.14s, valid_score: 0.858500]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.881    mrr@5 : 0.8572    mrr@10 : 0.8585    ndcg@5 : 0.8606    ndcg@10 : 0.8638    hit@5 : 0.871    hit@10 : 0.881    precision@5 : 0.1742    precision@10 : 0.0881
13 Oct 03:33    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    33:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    33:   9%|████▋                                              | 1/11 [00:00<00:01,  7.93it/s]
Train    33:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.96it/s]
Train    33:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.10it/s]
Train    33:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.16it/s]
Train    33:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.24it/s]
Train    33:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.32it/s]
Train    33:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.32it/s]
Train    33:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.28it/s]
Train    33:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.24it/s]
Train    33:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.23it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.20it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.21it/s]
13 Oct 03:33    INFO  epoch 33 training [time: 1.34s, train loss: 11.1416]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.86it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.10it/s]
13 Oct 03:33    INFO  epoch 33 evaluating [time: 0.15s, valid_score: 0.860300]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8719    recall@10 : 0.8778    mrr@5 : 0.8595    mrr@10 : 0.8603    ndcg@5 : 0.8626    ndcg@10 : 0.8646    hit@5 : 0.8719    hit@10 : 0.8778    precision@5 : 0.1744    precision@10 : 0.0878
13 Oct 03:33    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    34:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    34:   9%|████▋                                              | 1/11 [00:00<00:01,  8.23it/s]
Train    34:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.16it/s]
Train    34:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.16it/s]
Train    34:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.09it/s]
Train    34:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.04it/s]
Train    34:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.10it/s]
Train    34:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.08it/s]
Train    34:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.13it/s]
Train    34:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.16it/s]
Train    34:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  5.89it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.44it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.31it/s]
13 Oct 03:33    INFO  epoch 34 training [time: 1.51s, train loss: 9.8315]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 12.55it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 17.09it/s]
13 Oct 03:33    INFO  epoch 34 evaluating [time: 0.19s, valid_score: 0.858700]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8828    mrr@5 : 0.857    mrr@10 : 0.8587    ndcg@5 : 0.8604    ndcg@10 : 0.8644    hit@5 : 0.8701    hit@10 : 0.8828    precision@5 : 0.174    precision@10 : 0.0883

Train    35:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    35:   9%|████▋                                              | 1/11 [00:00<00:01,  7.93it/s]
Train    35:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.06it/s]
Train    35:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.09it/s]
Train    35:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.05it/s]
Train    35:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.09it/s]
Train    35:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.13it/s]
Train    35:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.13it/s]
Train    35:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.09it/s]
Train    35:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.09it/s]
Train    35:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.12it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.20it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.12it/s]
13 Oct 03:33    INFO  epoch 35 training [time: 1.36s, train loss: 10.2343]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.40it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.30it/s]
13 Oct 03:33    INFO  epoch 35 evaluating [time: 0.17s, valid_score: 0.856900]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.881    mrr@5 : 0.8552    mrr@10 : 0.8569    ndcg@5 : 0.8585    ndcg@10 : 0.8626    hit@5 : 0.8683    hit@10 : 0.881    precision@5 : 0.1737    precision@10 : 0.0881

Train    36:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    36:   9%|████▋                                              | 1/11 [00:00<00:01,  7.59it/s]
Train    36:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.88it/s]
Train    36:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.97it/s]
Train    36:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.04it/s]
Train    36:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.03it/s]
Train    36:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.08it/s]
Train    36:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.12it/s]
Train    36:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.13it/s]
Train    36:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.06it/s]
Train    36:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.01it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.04it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.03it/s]
13 Oct 03:33    INFO  epoch 36 training [time: 1.37s, train loss: 9.8023]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.87it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.90it/s]
13 Oct 03:33    INFO  epoch 36 evaluating [time: 0.17s, valid_score: 0.855700]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.881    mrr@5 : 0.8544    mrr@10 : 0.8557    ndcg@5 : 0.8586    ndcg@10 : 0.8618    hit@5 : 0.871    hit@10 : 0.881    precision@5 : 0.1742    precision@10 : 0.0881

Train    37:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    37:   9%|████▋                                              | 1/11 [00:00<00:01,  8.08it/s]
Train    37:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.04it/s]
Train    37:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.11it/s]
Train    37:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.09it/s]
Train    37:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.09it/s]
Train    37:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.06it/s]
Train    37:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.08it/s]
Train    37:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.06it/s]
Train    37:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.13it/s]
Train    37:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.09it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.13it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.10it/s]
13 Oct 03:33    INFO  epoch 37 training [time: 1.36s, train loss: 10.7128]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.96it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.59it/s]
13 Oct 03:33    INFO  epoch 37 evaluating [time: 0.13s, valid_score: 0.855300]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8674    recall@10 : 0.8796    mrr@5 : 0.8538    mrr@10 : 0.8553    ndcg@5 : 0.8572    ndcg@10 : 0.8611    hit@5 : 0.8674    hit@10 : 0.8796    precision@5 : 0.1735    precision@10 : 0.088

Train    38:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    38:   9%|████▋                                              | 1/11 [00:00<00:01,  8.24it/s]
Train    38:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.05it/s]
Train    38:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.16it/s]
Train    38:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.11it/s]
Train    38:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.08it/s]
Train    38:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.10it/s]
Train    38:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.15it/s]
Train    38:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  5.91it/s]
Train    38:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.45it/s]
Train    38:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.85it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.23it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.33it/s]
13 Oct 03:33    INFO  epoch 38 training [time: 1.50s, train loss: 10.7494]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.00it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.19it/s]
13 Oct 03:33    INFO  epoch 38 evaluating [time: 0.15s, valid_score: 0.859300]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8719    recall@10 : 0.8837    mrr@5 : 0.8576    mrr@10 : 0.8593    ndcg@5 : 0.8612    ndcg@10 : 0.8651    hit@5 : 0.8719    hit@10 : 0.8837    precision@5 : 0.1744    precision@10 : 0.0884

Train    39:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    39:   9%|████▋                                              | 1/11 [00:00<00:01,  7.88it/s]
Train    39:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.89it/s]
Train    39:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.85it/s]
Train    39:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.94it/s]
Train    39:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.93it/s]
Train    39:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.93it/s]
Train    39:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.02it/s]
Train    39:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.07it/s]
Train    39:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.07it/s]
Train    39:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.07it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.07it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.01it/s]
13 Oct 03:33    INFO  epoch 39 training [time: 1.37s, train loss: 11.0422]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.42it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.91it/s]
13 Oct 03:33    INFO  epoch 39 evaluating [time: 0.13s, valid_score: 0.859600]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.8837    mrr@5 : 0.8578    mrr@10 : 0.8596    ndcg@5 : 0.8608    ndcg@10 : 0.8653    hit@5 : 0.8697    hit@10 : 0.8837    precision@5 : 0.1739    precision@10 : 0.0884

Train    40:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    40:   9%|████▋                                              | 1/11 [00:00<00:01,  8.03it/s]
Train    40:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.18it/s]
Train    40:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.01it/s]
Train    40:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.00it/s]
Train    40:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.00it/s]
Train    40:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.01it/s]
Train    40:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.02it/s]
Train    40:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.01it/s]
Train    40:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.02it/s]
Train    40:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.97it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.02it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.02it/s]
13 Oct 03:33    INFO  epoch 40 training [time: 1.37s, train loss: 10.1116]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.33it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.84it/s]
13 Oct 03:33    INFO  epoch 40 evaluating [time: 0.13s, valid_score: 0.860800]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8706    recall@10 : 0.8842    mrr@5 : 0.859    mrr@10 : 0.8608    ndcg@5 : 0.8619    ndcg@10 : 0.8663    hit@5 : 0.8706    hit@10 : 0.8842    precision@5 : 0.1741    precision@10 : 0.0884
13 Oct 03:33    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    41:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    41:   9%|████▋                                              | 1/11 [00:00<00:01,  8.14it/s]
Train    41:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.22it/s]
Train    41:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.14it/s]
Train    41:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.09it/s]
Train    41:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.08it/s]
Train    41:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.06it/s]
Train    41:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.03it/s]
Train    41:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.86it/s]
Train    41:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.84it/s]
Train    41:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.77it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.81it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.93it/s]
13 Oct 03:33    INFO  epoch 41 training [time: 1.39s, train loss: 9.5977]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.14it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.31it/s]
13 Oct 03:33    INFO  epoch 41 evaluating [time: 0.16s, valid_score: 0.857700]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8805    mrr@5 : 0.8562    mrr@10 : 0.8577    ndcg@5 : 0.8597    ndcg@10 : 0.8631    hit@5 : 0.8701    hit@10 : 0.8805    precision@5 : 0.174    precision@10 : 0.0881

Train    42:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    42:   9%|████▋                                              | 1/11 [00:00<00:01,  7.99it/s]
Train    42:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.98it/s]
Train    42:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.94it/s]
Train    42:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.02it/s]
Train    42:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.13it/s]
Train    42:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.17it/s]
Train    42:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.17it/s]
Train    42:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.16it/s]
Train    42:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.18it/s]
Train    42:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.19it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.26it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.15it/s]
13 Oct 03:33    INFO  epoch 42 training [time: 1.35s, train loss: 10.2352]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.58it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.48it/s]
13 Oct 03:33    INFO  epoch 42 evaluating [time: 0.14s, valid_score: 0.856100]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8828    mrr@5 : 0.8541    mrr@10 : 0.8561    ndcg@5 : 0.8577    ndcg@10 : 0.8624    hit@5 : 0.8683    hit@10 : 0.8828    precision@5 : 0.1737    precision@10 : 0.0883

Train    43:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    43:   9%|████▋                                              | 1/11 [00:00<00:01,  8.03it/s]
Train    43:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.27it/s]
Train    43:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.38it/s]
Train    43:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.91it/s]
Train    43:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.20it/s]
Train    43:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.51it/s]
Train    43:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.65it/s]
Train    43:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.73it/s]
Train    43:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.87it/s]
Train    43:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.98it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.09it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.48it/s]
13 Oct 03:33    INFO  epoch 43 training [time: 1.47s, train loss: 10.5877]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.56it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.37it/s]
13 Oct 03:33    INFO  epoch 43 evaluating [time: 0.12s, valid_score: 0.858500]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8846    mrr@5 : 0.8565    mrr@10 : 0.8585    ndcg@5 : 0.8599    ndcg@10 : 0.8647    hit@5 : 0.8701    hit@10 : 0.8846    precision@5 : 0.174    precision@10 : 0.0885

Train    44:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    44:   9%|████▋                                              | 1/11 [00:00<00:01,  8.19it/s]
Train    44:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.23it/s]
Train    44:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.25it/s]
Train    44:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.26it/s]
Train    44:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.29it/s]
Train    44:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.27it/s]
Train    44:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.26it/s]
Train    44:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.26it/s]
Train    44:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.00it/s]
Train    44:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.98it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.02it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
13 Oct 03:33    INFO  epoch 44 training [time: 1.35s, train loss: 10.1106]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.23it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.36it/s]
13 Oct 03:33    INFO  epoch 44 evaluating [time: 0.17s, valid_score: 0.860300]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8747    recall@10 : 0.8882    mrr@5 : 0.8586    mrr@10 : 0.8603    ndcg@5 : 0.8625    ndcg@10 : 0.8668    hit@5 : 0.8747    hit@10 : 0.8882    precision@5 : 0.1749    precision@10 : 0.0888

Train    45:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    45:   9%|████▋                                              | 1/11 [00:00<00:01,  7.50it/s]
Train    45:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.86it/s]
Train    45:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.96it/s]
Train    45:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.00it/s]
Train    45:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.92it/s]
Train    45:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.93it/s]
Train    45:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.94it/s]
Train    45:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.95it/s]
Train    45:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.90it/s]
Train    45:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.80it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.85it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.88it/s]
13 Oct 03:33    INFO  epoch 45 training [time: 1.40s, train loss: 9.8360]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.12it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.88it/s]
13 Oct 03:33    INFO  epoch 45 evaluating [time: 0.15s, valid_score: 0.860300]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8715    recall@10 : 0.8837    mrr@5 : 0.8587    mrr@10 : 0.8603    ndcg@5 : 0.8619    ndcg@10 : 0.8658    hit@5 : 0.8715    hit@10 : 0.8837    precision@5 : 0.1743    precision@10 : 0.0884

Train    46:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    46:   9%|████▋                                              | 1/11 [00:00<00:01,  7.88it/s]
Train    46:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.87it/s]
Train    46:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.90it/s]
Train    46:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.85it/s]
Train    46:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.89it/s]
Train    46:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.84it/s]
Train    46:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.90it/s]
Train    46:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.90it/s]
Train    46:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.90it/s]
Train    46:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.93it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.00it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.92it/s]
13 Oct 03:33    INFO  epoch 46 training [time: 1.39s, train loss: 10.3990]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.71it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.75it/s]
13 Oct 03:33    INFO  epoch 46 evaluating [time: 0.14s, valid_score: 0.862000]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8724    recall@10 : 0.8828    mrr@5 : 0.8607    mrr@10 : 0.862    ndcg@5 : 0.8636    ndcg@10 : 0.8669    hit@5 : 0.8724    hit@10 : 0.8828    precision@5 : 0.1745    precision@10 : 0.0883
13 Oct 03:33    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Train    47:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    47:   9%|████▋                                              | 1/11 [00:00<00:01,  7.90it/s]
Train    47:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.96it/s]
Train    47:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.95it/s]
Train    47:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.04it/s]
Train    47:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.09it/s]
Train    47:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.10it/s]
Train    47:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.59it/s]
Train    47:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.01it/s]
Train    47:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.31it/s]
Train    47:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.51it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.71it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.41it/s]
13 Oct 03:33    INFO  epoch 47 training [time: 1.49s, train loss: 10.2382]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.31it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.75it/s]
13 Oct 03:33    INFO  epoch 47 evaluating [time: 0.14s, valid_score: 0.860400]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.8846    mrr@5 : 0.8586    mrr@10 : 0.8604    ndcg@5 : 0.8617    ndcg@10 : 0.8661    hit@5 : 0.871    hit@10 : 0.8846    precision@5 : 0.1742    precision@10 : 0.0885

Train    48:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    48:   9%|████▋                                              | 1/11 [00:00<00:01,  8.05it/s]
Train    48:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.02it/s]
Train    48:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.10it/s]
Train    48:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.14it/s]
Train    48:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.08it/s]
Train    48:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.06it/s]
Train    48:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.01it/s]
Train    48:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  7.95it/s]
Train    48:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.92it/s]
Train    48:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.81it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.91it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.97it/s]
13 Oct 03:33    INFO  epoch 48 training [time: 1.38s, train loss: 9.4924]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.69it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.81it/s]
13 Oct 03:33    INFO  epoch 48 evaluating [time: 0.14s, valid_score: 0.861200]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.8738    recall@10 : 0.8873    mrr@5 : 0.8594    mrr@10 : 0.8612    ndcg@5 : 0.863    ndcg@10 : 0.8674    hit@5 : 0.8738    hit@10 : 0.8873    precision@5 : 0.1748    precision@10 : 0.0887

Train    49:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    49:   9%|████▋                                              | 1/11 [00:00<00:01,  7.87it/s]
Train    49:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.93it/s]
Train    49:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.73it/s]
Train    49:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.75it/s]
Train    49:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.86it/s]
Train    49:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.98it/s]
Train    49:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.04it/s]
Train    49:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.12it/s]
Train    49:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.13it/s]
Train    49:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.10it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.06it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.00it/s]
13 Oct 03:33    INFO  epoch 49 training [time: 1.38s, train loss: 9.9048]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.08it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.37it/s]
13 Oct 03:33    INFO  epoch 49 evaluating [time: 0.14s, valid_score: 0.861300]
13 Oct 03:33    INFO  valid result: 
recall@5 : 0.876    recall@10 : 0.886    mrr@5 : 0.8599    mrr@10 : 0.8613    ndcg@5 : 0.8639    ndcg@10 : 0.8671    hit@5 : 0.876    hit@10 : 0.886    precision@5 : 0.1752    precision@10 : 0.0886
13 Oct 03:33    INFO  Loading model structure and parameters from saved/BERT4Rec-Oct-13-2025_03-32-31.pth

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.55it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.59it/s]
13 Oct 03:33    INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |     6.60 %     |
+-------------+----------------+
| GPU         |   0.0 / 0.0    |
+-------------+----------------+
| Memory      | 1.32 G/15.33 G |
+-------------+----------------+
13 Oct 03:33    INFO  best valid : OrderedDict({'recall@5': 0.8724, 'recall@10': 0.8828, 'mrr@5': 0.8607, 'mrr@10': 0.862, 'ndcg@5': 0.8636, 'ndcg@10': 0.8669, 'hit@5': 0.8724, 'hit@10': 0.8828, 'precision@5': 0.1745, 'precision@10': 0.0883})
13 Oct 03:33    INFO  test result: OrderedDict({'recall@5': 0.9787, 'recall@10': 0.9835, 'mrr@5': 0.9596, 'mrr@10': 0.9602, 'ndcg@5': 0.9645, 'ndcg@10': 0.966, 'hit@5': 0.9787, 'hit@10': 0.9835, 'precision@5': 0.1957, 'precision@10': 0.0983})
2025-10-13 03:33:51,768 | INFO | Published checkpoint /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/saved/BERT4Rec-Oct-13-2025_03-32-31.pth → /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/versions/BERT4Rec-Oct-13-2025_03-32-31.pth
2025-10-13 03:33:51,768 | INFO | Retraining completed in 0:01:26.129125 | dataset=20251012-203226 | model=Oct-13-2025_03-32-31
2025-10-13 03:34:21,771 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:34:22,645 | INFO | 🔄 Đang trích xuất data từ Postgres...
🐘 Đã trích xuất bằng psycopg.
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 69
Số user: 2
Số sản phẩm: 11
Các loại event: {'add_to_cart': 0.42, 'view': 0.377, 'purchase': 0.203}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[10 rows x 5 columns]
2025-10-13 03:34:22,645 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:34:23,201 | INFO | 🗂  Đã cập nhật /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/interactions.csv (tổng 18368 bản ghi).
✅ Đã tạo snapshot 20251012-203423 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-203423/ecommerce.inter) với 18368 dòng
👥  User: 2609 | 🛒  Sản phẩm: 106
🏷️   Nhãn mua hàng (label=1): 2995
      user_id item_id   timestamp  label
4952        3      25  1704067200      0
4953        3      25  1704068520      0
18272       3      89  1707264000      0
18273       3      89  1707264300      0
18274       3      89  1707265440      0
18275       3      89  1707266820      1
1123        3      12  1708041600      0
1124        3      12  1708044480      0
10396       4       4  1707436800      0
10397       4       4  1707437100      0
2025-10-13 03:34:23,202 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-202243
2025-10-13 03:34:23,202 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 03:35:47,339 | INFO | 13 Oct 03:34    INFO  ['train_bert4rec.py']
13 Oct 03:34    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = False
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
device = cuda
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 03:34    INFO  ecommerce
The number of users: 2608
Average actions of users: 7.045646336785578
The number of items: 96
Average actions of items: 193.34736842105264
The number of inters: 18368
The sparsity of the dataset: 92.66359918200409%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 03:34    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 03:34    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 03:34    INFO  BERT4Rec(
  (item_embedding): Embedding(97, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 113888
13 Oct 03:34    INFO  FLOPs: 5194664.0
🔧 Sử dụng topk=[5, 10], valid_metric=MRR@10, device=cpu

Train     0:   0%|                                                           | 0/11 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   9%|████▋                                              | 1/11 [00:00<00:02,  3.50it/s]
Train     0:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.23it/s]
Train     0:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.45it/s]
Train     0:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.28it/s]
Train     0:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.55it/s]
Train     0:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.83it/s]
Train     0:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.03it/s]
Train     0:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.21it/s]
Train     0:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.39it/s]
Train     0:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.57it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.72it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.62it/s]
13 Oct 03:34    INFO  epoch 0 training [time: 1.45s, train loss: 49.7594]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.55it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.07it/s]
13 Oct 03:34    INFO  epoch 0 evaluating [time: 0.17s, valid_score: 0.057500]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.0937    recall@10 : 0.1765    mrr@5 : 0.0466    mrr@10 : 0.0575    ndcg@5 : 0.0582    ndcg@10 : 0.0847    hit@5 : 0.0937    hit@10 : 0.1765    precision@5 : 0.0187    precision@10 : 0.0176
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train     1:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     1:   9%|████▋                                              | 1/11 [00:00<00:01,  9.04it/s]
Train     1:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.90it/s]
Train     1:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.49it/s]
Train     1:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.63it/s]
Train     1:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.68it/s]
Train     1:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.74it/s]
Train     1:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.71it/s]
Train     1:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.72it/s]
Train     1:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.78it/s]
Train     1:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.73it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.32it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.59it/s]
13 Oct 03:34    INFO  epoch 1 training [time: 1.28s, train loss: 48.9054]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.83it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.42it/s]
13 Oct 03:34    INFO  epoch 1 evaluating [time: 0.13s, valid_score: 0.078800]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.1348    recall@10 : 0.2118    mrr@5 : 0.0691    mrr@10 : 0.0788    ndcg@5 : 0.0853    ndcg@10 : 0.1096    hit@5 : 0.1348    hit@10 : 0.2118    precision@5 : 0.027    precision@10 : 0.0212
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train     2:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     2:   9%|████▋                                              | 1/11 [00:00<00:01,  8.77it/s]
Train     2:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.71it/s]
Train     2:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.81it/s]
Train     2:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.95it/s]
Train     2:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.52it/s]
Train     2:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.21it/s]
Train     2:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.75it/s]
Train     2:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.17it/s]
Train     2:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.33it/s]
Train     2:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.47it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.60it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.17it/s]
13 Oct 03:34    INFO  epoch 2 training [time: 1.35s, train loss: 46.8474]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.84it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.83it/s]
13 Oct 03:34    INFO  epoch 2 evaluating [time: 0.12s, valid_score: 0.351100]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.5244    recall@10 : 0.6136    mrr@5 : 0.3392    mrr@10 : 0.3511    ndcg@5 : 0.3855    ndcg@10 : 0.4144    hit@5 : 0.5244    hit@10 : 0.6136    precision@5 : 0.1049    precision@10 : 0.0614
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train     3:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     3:   9%|████▋                                              | 1/11 [00:00<00:01,  8.87it/s]
Train     3:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.90it/s]
Train     3:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.80it/s]
Train     3:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.74it/s]
Train     3:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.72it/s]
Train     3:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.79it/s]
Train     3:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.82it/s]
Train     3:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.76it/s]
Train     3:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.86it/s]
Train     3:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.93it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.94it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.85it/s]
13 Oct 03:34    INFO  epoch 3 training [time: 1.24s, train loss: 42.5084]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.10it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.65it/s]
13 Oct 03:34    INFO  epoch 3 evaluating [time: 0.14s, valid_score: 0.538900]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.6611    recall@10 : 0.7217    mrr@5 : 0.5306    mrr@10 : 0.5389    ndcg@5 : 0.5636    ndcg@10 : 0.5834    hit@5 : 0.6611    hit@10 : 0.7217    precision@5 : 0.1322    precision@10 : 0.0722
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train     4:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     4:   9%|████▋                                              | 1/11 [00:00<00:01,  8.50it/s]
Train     4:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.60it/s]
Train     4:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.26it/s]
Train     4:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.45it/s]
Train     4:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.48it/s]
Train     4:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.57it/s]
Train     4:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.59it/s]
Train     4:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.63it/s]
Train     4:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.63it/s]
Train     4:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.61it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.57it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.55it/s]
13 Oct 03:34    INFO  epoch 4 training [time: 1.29s, train loss: 38.5157]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.78it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.25it/s]
13 Oct 03:34    INFO  epoch 4 evaluating [time: 0.15s, valid_score: 0.577400]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.6937    recall@10 : 0.7443    mrr@5 : 0.5704    mrr@10 : 0.5774    ndcg@5 : 0.6016    ndcg@10 : 0.6183    hit@5 : 0.6937    hit@10 : 0.7443    precision@5 : 0.1387    precision@10 : 0.0744
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train     5:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     5:   9%|████▋                                              | 1/11 [00:00<00:01,  8.63it/s]
Train     5:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.71it/s]
Train     5:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.68it/s]
Train     5:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.65it/s]
Train     5:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.61it/s]
Train     5:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.63it/s]
Train     5:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.61it/s]
Train     5:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.56it/s]
Train     5:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.55it/s]
Train     5:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.54it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.58it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.60it/s]
13 Oct 03:34    INFO  epoch 5 training [time: 1.28s, train loss: 35.0609]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.92it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.74it/s]
13 Oct 03:34    INFO  epoch 5 evaluating [time: 0.13s, valid_score: 0.636100]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.7303    recall@10 : 0.7765    mrr@5 : 0.6301    mrr@10 : 0.6361    ndcg@5 : 0.6553    ndcg@10 : 0.6701    hit@5 : 0.7303    hit@10 : 0.7765    precision@5 : 0.1461    precision@10 : 0.0776
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train     6:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     6:   9%|████▋                                              | 1/11 [00:00<00:01,  8.91it/s]
Train     6:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.66it/s]
Train     6:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.69it/s]
Train     6:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.84it/s]
Train     6:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.87it/s]
Train     6:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.55it/s]
Train     6:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.07it/s]
Train     6:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.39it/s]
Train     6:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.77it/s]
Train     6:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.96it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.08it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.91it/s]
13 Oct 03:34    INFO  epoch 6 training [time: 1.39s, train loss: 31.5342]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.49it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.88it/s]
13 Oct 03:34    INFO  epoch 6 evaluating [time: 0.13s, valid_score: 0.688700]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.7548    recall@10 : 0.8023    mrr@5 : 0.6823    mrr@10 : 0.6887    ndcg@5 : 0.7006    ndcg@10 : 0.716    hit@5 : 0.7548    hit@10 : 0.8023    precision@5 : 0.151    precision@10 : 0.0802
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train     7:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     7:   9%|████▋                                              | 1/11 [00:00<00:01,  8.40it/s]
Train     7:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.68it/s]
Train     7:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.82it/s]
Train     7:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.95it/s]
Train     7:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.93it/s]
Train     7:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.99it/s]
Train     7:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.80it/s]
Train     7:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.61it/s]
Train     7:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.30it/s]
Train     7:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.15it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.18it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.50it/s]
13 Oct 03:34    INFO  epoch 7 training [time: 1.29s, train loss: 28.7599]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.70it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.31it/s]
13 Oct 03:34    INFO  epoch 7 evaluating [time: 0.16s, valid_score: 0.720300]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.7842    recall@10 : 0.8213    mrr@5 : 0.7153    mrr@10 : 0.7203    ndcg@5 : 0.7326    ndcg@10 : 0.7446    hit@5 : 0.7842    hit@10 : 0.8213    precision@5 : 0.1568    precision@10 : 0.0821
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train     8:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     8:   9%|████▋                                              | 1/11 [00:00<00:01,  8.42it/s]
Train     8:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.50it/s]
Train     8:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.74it/s]
Train     8:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.63it/s]
Train     8:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.59it/s]
Train     8:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.59it/s]
Train     8:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.47it/s]
Train     8:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.42it/s]
Train     8:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.46it/s]
Train     8:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.47it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.49it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.51it/s]
13 Oct 03:34    INFO  epoch 8 training [time: 1.29s, train loss: 25.9326]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.99it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.36it/s]
13 Oct 03:34    INFO  epoch 8 evaluating [time: 0.14s, valid_score: 0.747400]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.8041    recall@10 : 0.8339    mrr@5 : 0.7434    mrr@10 : 0.7474    ndcg@5 : 0.7586    ndcg@10 : 0.7683    hit@5 : 0.8041    hit@10 : 0.8339    precision@5 : 0.1608    precision@10 : 0.0834
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train     9:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     9:   9%|████▋                                              | 1/11 [00:00<00:01,  8.39it/s]
Train     9:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.71it/s]
Train     9:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.74it/s]
Train     9:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.81it/s]
Train     9:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.81it/s]
Train     9:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.81it/s]
Train     9:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.81it/s]
Train     9:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.72it/s]
Train     9:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.72it/s]
Train     9:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.63it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.63it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.70it/s]
13 Oct 03:34    INFO  epoch 9 training [time: 1.26s, train loss: 23.2385]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.60it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.34it/s]
13 Oct 03:34    INFO  epoch 9 evaluating [time: 0.16s, valid_score: 0.783100]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.829    recall@10 : 0.8529    mrr@5 : 0.7799    mrr@10 : 0.7831    ndcg@5 : 0.7923    ndcg@10 : 0.8    hit@5 : 0.829    hit@10 : 0.8529    precision@5 : 0.1658    precision@10 : 0.0853
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    10:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    10:   9%|████▋                                              | 1/11 [00:00<00:01,  8.58it/s]
Train    10:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.40it/s]
Train    10:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.44it/s]
Train    10:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.46it/s]
Train    10:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.54it/s]
Train    10:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.55it/s]
Train    10:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.49it/s]
Train    10:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.37it/s]
Train    10:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.41it/s]
Train    10:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.45it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.01it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.77it/s]
13 Oct 03:34    INFO  epoch 10 training [time: 1.42s, train loss: 20.9736]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.53it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.89it/s]
13 Oct 03:34    INFO  epoch 10 evaluating [time: 0.13s, valid_score: 0.809200]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.8385    recall@10 : 0.8579    mrr@5 : 0.8065    mrr@10 : 0.8092    ndcg@5 : 0.8145    ndcg@10 : 0.8209    hit@5 : 0.8385    hit@10 : 0.8579    precision@5 : 0.1677    precision@10 : 0.0858
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    11:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    11:   9%|████▋                                              | 1/11 [00:00<00:01,  8.48it/s]
Train    11:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.56it/s]
Train    11:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.60it/s]
Train    11:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.58it/s]
Train    11:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.58it/s]
Train    11:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.62it/s]
Train    11:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.63it/s]
Train    11:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.65it/s]
Train    11:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.64it/s]
Train    11:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.61it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.57it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.59it/s]
13 Oct 03:34    INFO  epoch 11 training [time: 1.28s, train loss: 19.1671]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.88it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.29it/s]
13 Oct 03:34    INFO  epoch 11 evaluating [time: 0.13s, valid_score: 0.820000]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.8448    recall@10 : 0.8665    mrr@5 : 0.8171    mrr@10 : 0.82    ndcg@5 : 0.8241    ndcg@10 : 0.8311    hit@5 : 0.8448    hit@10 : 0.8665    precision@5 : 0.169    precision@10 : 0.0867
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    12:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    12:   9%|████▋                                              | 1/11 [00:00<00:01,  8.55it/s]
Train    12:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.77it/s]
Train    12:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.85it/s]
Train    12:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.91it/s]
Train    12:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.98it/s]
Train    12:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  9.04it/s]
Train    12:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.96it/s]
Train    12:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.69it/s]
Train    12:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.58it/s]
Train    12:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.44it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.43it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.67it/s]
13 Oct 03:34    INFO  epoch 12 training [time: 1.27s, train loss: 17.4560]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.03it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.38it/s]
13 Oct 03:34    INFO  epoch 12 evaluating [time: 0.15s, valid_score: 0.829300]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.8475    recall@10 : 0.8679    mrr@5 : 0.8265    mrr@10 : 0.8293    ndcg@5 : 0.8318    ndcg@10 : 0.8384    hit@5 : 0.8475    hit@10 : 0.8679    precision@5 : 0.1695    precision@10 : 0.0868
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    13:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    13:   9%|████▋                                              | 1/11 [00:00<00:01,  8.58it/s]
Train    13:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.58it/s]
Train    13:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.65it/s]
Train    13:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.75it/s]
Train    13:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.70it/s]
Train    13:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.66it/s]
Train    13:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.47it/s]
Train    13:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.38it/s]
Train    13:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.27it/s]
Train    13:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.15it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.32it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.44it/s]
13 Oct 03:34    INFO  epoch 13 training [time: 1.30s, train loss: 16.1932]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.56it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.13it/s]
13 Oct 03:34    INFO  epoch 13 evaluating [time: 0.16s, valid_score: 0.835100]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.8534    recall@10 : 0.8719    mrr@5 : 0.8326    mrr@10 : 0.8351    ndcg@5 : 0.8378    ndcg@10 : 0.8438    hit@5 : 0.8534    hit@10 : 0.8719    precision@5 : 0.1707    precision@10 : 0.0872
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    14:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    14:   9%|████▋                                              | 1/11 [00:00<00:01,  8.66it/s]
Train    14:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.70it/s]
Train    14:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.57it/s]
Train    14:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.48it/s]
Train    14:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.36it/s]
Train    14:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.25it/s]
Train    14:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.18it/s]
Train    14:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.19it/s]
Train    14:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.20it/s]
Train    14:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.19it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.25it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.30it/s]
13 Oct 03:34    INFO  epoch 14 training [time: 1.33s, train loss: 15.6198]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  5.29it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 11.20it/s]
13 Oct 03:34    INFO  epoch 14 evaluating [time: 0.29s, valid_score: 0.841300]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.857    recall@10 : 0.8742    mrr@5 : 0.8391    mrr@10 : 0.8413    ndcg@5 : 0.8436    ndcg@10 : 0.8491    hit@5 : 0.857    hit@10 : 0.8742    precision@5 : 0.1714    precision@10 : 0.0874
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    15:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    15:   9%|████▋                                              | 1/11 [00:00<00:01,  8.22it/s]
Train    15:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.14it/s]
Train    15:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.16it/s]
Train    15:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.23it/s]
Train    15:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.04it/s]
Train    15:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.00it/s]
Train    15:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.16it/s]
Train    15:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.20it/s]
Train    15:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.28it/s]
Train    15:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.35it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.47it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.26it/s]
13 Oct 03:34    INFO  epoch 15 training [time: 1.33s, train loss: 13.9309]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.95it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.36it/s]
13 Oct 03:34    INFO  epoch 15 evaluating [time: 0.13s, valid_score: 0.845200]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.8588    recall@10 : 0.8742    mrr@5 : 0.8432    mrr@10 : 0.8452    ndcg@5 : 0.8471    ndcg@10 : 0.852    hit@5 : 0.8588    hit@10 : 0.8742    precision@5 : 0.1718    precision@10 : 0.0874
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    16:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    16:   9%|████▋                                              | 1/11 [00:00<00:01,  8.73it/s]
Train    16:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.62it/s]
Train    16:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.69it/s]
Train    16:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.56it/s]
Train    16:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.44it/s]
Train    16:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.39it/s]
Train    16:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.48it/s]
Train    16:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.52it/s]
Train    16:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.54it/s]
Train    16:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.54it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.57it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.54it/s]
13 Oct 03:34    INFO  epoch 16 training [time: 1.29s, train loss: 13.4300]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.76it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.22it/s]
13 Oct 03:34    INFO  epoch 16 evaluating [time: 0.14s, valid_score: 0.844100]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.8575    recall@10 : 0.8765    mrr@5 : 0.8416    mrr@10 : 0.8441    ndcg@5 : 0.8456    ndcg@10 : 0.8517    hit@5 : 0.8575    hit@10 : 0.8765    precision@5 : 0.1715    precision@10 : 0.0876

Train    17:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    17:   9%|████▋                                              | 1/11 [00:00<00:01,  8.27it/s]
Train    17:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.39it/s]
Train    17:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.37it/s]
Train    17:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.46it/s]
Train    17:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.57it/s]
Train    17:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.44it/s]
Train    17:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.28it/s]
Train    17:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.22it/s]
Train    17:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.15it/s]
Train    17:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.20it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.27it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.31it/s]
13 Oct 03:34    INFO  epoch 17 training [time: 1.32s, train loss: 13.0804]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.57it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.19it/s]
13 Oct 03:34    INFO  epoch 17 evaluating [time: 0.18s, valid_score: 0.846200]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.8597    recall@10 : 0.8751    mrr@5 : 0.8443    mrr@10 : 0.8462    ndcg@5 : 0.8481    ndcg@10 : 0.853    hit@5 : 0.8597    hit@10 : 0.8751    precision@5 : 0.1719    precision@10 : 0.0875
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    18:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    18:   9%|████▋                                              | 1/11 [00:00<00:01,  8.18it/s]
Train    18:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.30it/s]
Train    18:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.38it/s]
Train    18:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.38it/s]
Train    18:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.45it/s]
Train    18:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.58it/s]
Train    18:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.35it/s]
Train    18:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.81it/s]
Train    18:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.16it/s]
Train    18:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.44it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.67it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.63it/s]
13 Oct 03:34    INFO  epoch 18 training [time: 1.44s, train loss: 13.4371]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.17it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.44it/s]
13 Oct 03:34    INFO  epoch 18 evaluating [time: 0.14s, valid_score: 0.852200]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.8647    recall@10 : 0.8769    mrr@5 : 0.8507    mrr@10 : 0.8522    ndcg@5 : 0.8542    ndcg@10 : 0.8581    hit@5 : 0.8647    hit@10 : 0.8769    precision@5 : 0.1729    precision@10 : 0.0877
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    19:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    19:   9%|████▋                                              | 1/11 [00:00<00:01,  8.36it/s]
Train    19:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.29it/s]
Train    19:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.35it/s]
Train    19:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.31it/s]
Train    19:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.34it/s]
Train    19:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.21it/s]
Train    19:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.27it/s]
Train    19:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.27it/s]
Train    19:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.30it/s]
Train    19:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.36it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.29it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.30it/s]
13 Oct 03:34    INFO  epoch 19 training [time: 1.33s, train loss: 13.0179]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.50it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.98it/s]
13 Oct 03:34    INFO  epoch 19 evaluating [time: 0.13s, valid_score: 0.851000]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.8638    recall@10 : 0.8778    mrr@5 : 0.8492    mrr@10 : 0.851    ndcg@5 : 0.8529    ndcg@10 : 0.8574    hit@5 : 0.8638    hit@10 : 0.8778    precision@5 : 0.1728    precision@10 : 0.0878

Train    20:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    20:   9%|████▋                                              | 1/11 [00:00<00:01,  8.31it/s]
Train    20:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.46it/s]
Train    20:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.60it/s]
Train    20:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.47it/s]
Train    20:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.06it/s]
Train    20:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.16it/s]
Train    20:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.23it/s]
Train    20:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.24it/s]
Train    20:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.26it/s]
Train    20:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.26it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.17it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.25it/s]
13 Oct 03:34    INFO  epoch 20 training [time: 1.33s, train loss: 12.5615]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.87it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.91it/s]
13 Oct 03:34    INFO  epoch 20 evaluating [time: 0.14s, valid_score: 0.852700]
13 Oct 03:34    INFO  valid result: 
recall@5 : 0.867    recall@10 : 0.8778    mrr@5 : 0.8513    mrr@10 : 0.8527    ndcg@5 : 0.8552    ndcg@10 : 0.8587    hit@5 : 0.867    hit@10 : 0.8778    precision@5 : 0.1734    precision@10 : 0.0878
13 Oct 03:34    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    21:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    21:   9%|████▋                                              | 1/11 [00:00<00:01,  8.76it/s]
Train    21:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.84it/s]
Train    21:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.66it/s]
Train    21:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.51it/s]
Train    21:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.34it/s]
Train    21:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.20it/s]
Train    21:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.19it/s]
Train    21:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.18it/s]
Train    21:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.18it/s]
Train    21:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.25it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.34it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.34it/s]
13 Oct 03:35    INFO  epoch 21 training [time: 1.32s, train loss: 11.9438]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.70it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.59it/s]
13 Oct 03:35    INFO  epoch 21 evaluating [time: 0.16s, valid_score: 0.853200]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8661    recall@10 : 0.8796    mrr@5 : 0.8515    mrr@10 : 0.8532    ndcg@5 : 0.8552    ndcg@10 : 0.8595    hit@5 : 0.8661    hit@10 : 0.8796    precision@5 : 0.1732    precision@10 : 0.088
13 Oct 03:35    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    22:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    22:   9%|████▋                                              | 1/11 [00:00<00:01,  7.63it/s]
Train    22:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.92it/s]
Train    22:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.04it/s]
Train    22:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.09it/s]
Train    22:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.19it/s]
Train    22:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.24it/s]
Train    22:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.77it/s]
Train    22:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.15it/s]
Train    22:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.44it/s]
Train    22:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.61it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.77it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.50it/s]
13 Oct 03:35    INFO  epoch 22 training [time: 1.47s, train loss: 11.5617]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.83it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.06it/s]
13 Oct 03:35    INFO  epoch 22 evaluating [time: 0.14s, valid_score: 0.852400]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8652    recall@10 : 0.8783    mrr@5 : 0.8506    mrr@10 : 0.8524    ndcg@5 : 0.8543    ndcg@10 : 0.8586    hit@5 : 0.8652    hit@10 : 0.8783    precision@5 : 0.173    precision@10 : 0.0878

Train    23:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    23:   9%|████▋                                              | 1/11 [00:00<00:01,  7.95it/s]
Train    23:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.09it/s]
Train    23:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.27it/s]
Train    23:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.29it/s]
Train    23:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.30it/s]
Train    23:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.30it/s]
Train    23:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.27it/s]
Train    23:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.29it/s]
Train    23:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.22it/s]
Train    23:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.20it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.20it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.23it/s]
13 Oct 03:35    INFO  epoch 23 training [time: 1.34s, train loss: 11.4483]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.64it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.11it/s]
13 Oct 03:35    INFO  epoch 23 evaluating [time: 0.16s, valid_score: 0.850200]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8652    recall@10 : 0.8792    mrr@5 : 0.8483    mrr@10 : 0.8502    ndcg@5 : 0.8525    ndcg@10 : 0.857    hit@5 : 0.8652    hit@10 : 0.8792    precision@5 : 0.173    precision@10 : 0.0879

Train    24:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    24:   9%|████▋                                              | 1/11 [00:00<00:01,  8.08it/s]
Train    24:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.02it/s]
Train    24:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.21it/s]
Train    24:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.33it/s]
Train    24:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.35it/s]
Train    24:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.28it/s]
Train    24:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.22it/s]
Train    24:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.23it/s]
Train    24:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.29it/s]
Train    24:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.27it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.20it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.23it/s]
13 Oct 03:35    INFO  epoch 24 training [time: 1.34s, train loss: 11.3786]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.02it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.03it/s]
13 Oct 03:35    INFO  epoch 24 evaluating [time: 0.17s, valid_score: 0.852300]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8792    mrr@5 : 0.8508    mrr@10 : 0.8523    ndcg@5 : 0.8552    ndcg@10 : 0.8587    hit@5 : 0.8683    hit@10 : 0.8792    precision@5 : 0.1737    precision@10 : 0.0879

Train    25:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    25:   9%|████▋                                              | 1/11 [00:00<00:01,  8.17it/s]
Train    25:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.25it/s]
Train    25:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.26it/s]
Train    25:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.25it/s]
Train    25:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.20it/s]
Train    25:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.16it/s]
Train    25:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.24it/s]
Train    25:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.22it/s]
Train    25:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.22it/s]
Train    25:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.26it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.37it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.27it/s]
13 Oct 03:35    INFO  epoch 25 training [time: 1.33s, train loss: 11.9237]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.29it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.82it/s]
13 Oct 03:35    INFO  epoch 25 evaluating [time: 0.13s, valid_score: 0.852800]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8674    recall@10 : 0.8778    mrr@5 : 0.8513    mrr@10 : 0.8528    ndcg@5 : 0.8553    ndcg@10 : 0.8588    hit@5 : 0.8674    hit@10 : 0.8778    precision@5 : 0.1735    precision@10 : 0.0878

Train    26:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    26:   9%|████▋                                              | 1/11 [00:00<00:01,  8.12it/s]
Train    26:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.20it/s]
Train    26:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.14it/s]
Train    26:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.26it/s]
Train    26:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.32it/s]
Train    26:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.23it/s]
Train    26:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.21it/s]
Train    26:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.13it/s]
Train    26:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.10it/s]
Train    26:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.06it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.54it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.41it/s]
13 Oct 03:35    INFO  epoch 26 training [time: 1.49s, train loss: 11.2112]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.35it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.95it/s]
13 Oct 03:35    INFO  epoch 26 evaluating [time: 0.15s, valid_score: 0.854300]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8729    recall@10 : 0.8801    mrr@5 : 0.8534    mrr@10 : 0.8543    ndcg@5 : 0.8583    ndcg@10 : 0.8606    hit@5 : 0.8729    hit@10 : 0.8801    precision@5 : 0.1746    precision@10 : 0.088
13 Oct 03:35    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    27:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    27:   9%|████▋                                              | 1/11 [00:00<00:01,  7.98it/s]
Train    27:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.15it/s]
Train    27:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.20it/s]
Train    27:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.20it/s]
Train    27:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.22it/s]
Train    27:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.22it/s]
Train    27:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.13it/s]
Train    27:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.15it/s]
Train    27:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.15it/s]
Train    27:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.10it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.17it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.16it/s]
13 Oct 03:35    INFO  epoch 27 training [time: 1.35s, train loss: 11.0132]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.01it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.19it/s]
13 Oct 03:35    INFO  epoch 27 evaluating [time: 0.14s, valid_score: 0.854500]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8792    mrr@5 : 0.853    mrr@10 : 0.8545    ndcg@5 : 0.8569    ndcg@10 : 0.8604    hit@5 : 0.8683    hit@10 : 0.8792    precision@5 : 0.1737    precision@10 : 0.0879
13 Oct 03:35    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    28:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    28:   9%|████▋                                              | 1/11 [00:00<00:01,  8.32it/s]
Train    28:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.25it/s]
Train    28:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.02it/s]
Train    28:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.07it/s]
Train    28:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.04it/s]
Train    28:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.03it/s]
Train    28:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.95it/s]
Train    28:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.00it/s]
Train    28:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.94it/s]
Train    28:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.01it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.97it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.01it/s]
13 Oct 03:35    INFO  epoch 28 training [time: 1.37s, train loss: 11.1068]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.06it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.07it/s]
13 Oct 03:35    INFO  epoch 28 evaluating [time: 0.19s, valid_score: 0.854200]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.8805    mrr@5 : 0.8528    mrr@10 : 0.8542    ndcg@5 : 0.8571    ndcg@10 : 0.8605    hit@5 : 0.8697    hit@10 : 0.8805    precision@5 : 0.1739    precision@10 : 0.0881

Train    29:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    29:   9%|████▋                                              | 1/11 [00:00<00:01,  7.61it/s]
Train    29:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.69it/s]
Train    29:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.44it/s]
Train    29:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.60it/s]
Train    29:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.64it/s]
Train    29:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.71it/s]
Train    29:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.68it/s]
Train    29:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.75it/s]
Train    29:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.77it/s]
Train    29:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.91it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.96it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.77it/s]
13 Oct 03:35    INFO  epoch 29 training [time: 1.42s, train loss: 11.8484]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.91it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.38it/s]
13 Oct 03:35    INFO  epoch 29 evaluating [time: 0.13s, valid_score: 0.855100]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8692    recall@10 : 0.8783    mrr@5 : 0.8539    mrr@10 : 0.8551    ndcg@5 : 0.8578    ndcg@10 : 0.8607    hit@5 : 0.8692    hit@10 : 0.8783    precision@5 : 0.1738    precision@10 : 0.0878
13 Oct 03:35    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    30:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    30:   9%|████▋                                              | 1/11 [00:00<00:01,  8.34it/s]
Train    30:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.15it/s]
Train    30:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.95it/s]
Train    30:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.83it/s]
Train    30:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.92it/s]
Train    30:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.93it/s]
Train    30:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.93it/s]
Train    30:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.07it/s]
Train    30:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.54it/s]
Train    30:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.95it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.32it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.34it/s]
13 Oct 03:35    INFO  epoch 30 training [time: 1.50s, train loss: 10.8367]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.56it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.43it/s]
13 Oct 03:35    INFO  epoch 30 evaluating [time: 0.14s, valid_score: 0.856100]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8706    recall@10 : 0.8787    mrr@5 : 0.855    mrr@10 : 0.8561    ndcg@5 : 0.8589    ndcg@10 : 0.8616    hit@5 : 0.8706    hit@10 : 0.8787    precision@5 : 0.1741    precision@10 : 0.0879
13 Oct 03:35    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    31:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    31:   9%|████▋                                              | 1/11 [00:00<00:01,  7.86it/s]
Train    31:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.29it/s]
Train    31:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.70it/s]
Train    31:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.64it/s]
Train    31:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.68it/s]
Train    31:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.70it/s]
Train    31:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.78it/s]
Train    31:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.85it/s]
Train    31:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.92it/s]
Train    31:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.94it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.98it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.82it/s]
13 Oct 03:35    INFO  epoch 31 training [time: 1.41s, train loss: 11.6070]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.93it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.07it/s]
13 Oct 03:35    INFO  epoch 31 evaluating [time: 0.18s, valid_score: 0.856900]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.881    mrr@5 : 0.8553    mrr@10 : 0.8569    ndcg@5 : 0.859    ndcg@10 : 0.8626    hit@5 : 0.8697    hit@10 : 0.881    precision@5 : 0.1739    precision@10 : 0.0881
13 Oct 03:35    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    32:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    32:   9%|████▋                                              | 1/11 [00:00<00:01,  7.98it/s]
Train    32:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.05it/s]
Train    32:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.98it/s]
Train    32:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.98it/s]
Train    32:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.99it/s]
Train    32:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.02it/s]
Train    32:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.07it/s]
Train    32:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.84it/s]
Train    32:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.87it/s]
Train    32:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.84it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.91it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.94it/s]
13 Oct 03:35    INFO  epoch 32 training [time: 1.39s, train loss: 11.3697]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.23it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.11it/s]
13 Oct 03:35    INFO  epoch 32 evaluating [time: 0.15s, valid_score: 0.858500]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.881    mrr@5 : 0.8572    mrr@10 : 0.8585    ndcg@5 : 0.8606    ndcg@10 : 0.8638    hit@5 : 0.871    hit@10 : 0.881    precision@5 : 0.1742    precision@10 : 0.0881
13 Oct 03:35    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    33:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    33:   9%|████▋                                              | 1/11 [00:00<00:01,  8.38it/s]
Train    33:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.12it/s]
Train    33:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.03it/s]
Train    33:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.92it/s]
Train    33:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.95it/s]
Train    33:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.91it/s]
Train    33:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.84it/s]
Train    33:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.81it/s]
Train    33:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.83it/s]
Train    33:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.86it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.75it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.86it/s]
13 Oct 03:35    INFO  epoch 33 training [time: 1.40s, train loss: 11.1416]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.58it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.91it/s]
13 Oct 03:35    INFO  epoch 33 evaluating [time: 0.14s, valid_score: 0.860300]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8719    recall@10 : 0.8778    mrr@5 : 0.8595    mrr@10 : 0.8603    ndcg@5 : 0.8626    ndcg@10 : 0.8646    hit@5 : 0.8719    hit@10 : 0.8778    precision@5 : 0.1744    precision@10 : 0.0878
13 Oct 03:35    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    34:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    34:   9%|████▋                                              | 1/11 [00:00<00:01,  8.18it/s]
Train    34:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.91it/s]
Train    34:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.78it/s]
Train    34:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.76it/s]
Train    34:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.75it/s]
Train    34:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.79it/s]
Train    34:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.83it/s]
Train    34:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.83it/s]
Train    34:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.95it/s]
Train    34:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  5.96it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.53it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.21it/s]
13 Oct 03:35    INFO  epoch 34 training [time: 1.53s, train loss: 9.8315]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.96it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.46it/s]
13 Oct 03:35    INFO  epoch 34 evaluating [time: 0.13s, valid_score: 0.858700]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8828    mrr@5 : 0.857    mrr@10 : 0.8587    ndcg@5 : 0.8604    ndcg@10 : 0.8644    hit@5 : 0.8701    hit@10 : 0.8828    precision@5 : 0.174    precision@10 : 0.0883

Train    35:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    35:   9%|████▋                                              | 1/11 [00:00<00:01,  8.48it/s]
Train    35:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.44it/s]
Train    35:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.34it/s]
Train    35:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.26it/s]
Train    35:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.21it/s]
Train    35:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.03it/s]
Train    35:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.04it/s]
Train    35:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.06it/s]
Train    35:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.92it/s]
Train    35:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.94it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.97it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.07it/s]
13 Oct 03:35    INFO  epoch 35 training [time: 1.36s, train loss: 10.2343]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.89it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.94it/s]
13 Oct 03:35    INFO  epoch 35 evaluating [time: 0.14s, valid_score: 0.856900]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.881    mrr@5 : 0.8552    mrr@10 : 0.8569    ndcg@5 : 0.8585    ndcg@10 : 0.8626    hit@5 : 0.8683    hit@10 : 0.881    precision@5 : 0.1737    precision@10 : 0.0881

Train    36:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    36:   9%|████▋                                              | 1/11 [00:00<00:01,  8.10it/s]
Train    36:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.10it/s]
Train    36:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.07it/s]
Train    36:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.05it/s]
Train    36:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.12it/s]
Train    36:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.16it/s]
Train    36:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.06it/s]
Train    36:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.03it/s]
Train    36:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.06it/s]
Train    36:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.00it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.98it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.04it/s]
13 Oct 03:35    INFO  epoch 36 training [time: 1.37s, train loss: 9.8023]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.59it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.62it/s]
13 Oct 03:35    INFO  epoch 36 evaluating [time: 0.17s, valid_score: 0.855700]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.881    mrr@5 : 0.8544    mrr@10 : 0.8557    ndcg@5 : 0.8586    ndcg@10 : 0.8618    hit@5 : 0.871    hit@10 : 0.881    precision@5 : 0.1742    precision@10 : 0.0881

Train    37:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    37:   9%|████▋                                              | 1/11 [00:00<00:01,  8.24it/s]
Train    37:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.07it/s]
Train    37:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.05it/s]
Train    37:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.09it/s]
Train    37:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.11it/s]
Train    37:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.15it/s]
Train    37:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.15it/s]
Train    37:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.13it/s]
Train    37:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.13it/s]
Train    37:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.08it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.11it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.11it/s]
13 Oct 03:35    INFO  epoch 37 training [time: 1.36s, train loss: 10.7128]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.39it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.04it/s]
13 Oct 03:35    INFO  epoch 37 evaluating [time: 0.14s, valid_score: 0.855300]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8674    recall@10 : 0.8796    mrr@5 : 0.8538    mrr@10 : 0.8553    ndcg@5 : 0.8572    ndcg@10 : 0.8611    hit@5 : 0.8674    hit@10 : 0.8796    precision@5 : 0.1735    precision@10 : 0.088

Train    38:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    38:   9%|████▋                                              | 1/11 [00:00<00:01,  8.17it/s]
Train    38:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.15it/s]
Train    38:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.16it/s]
Train    38:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.04it/s]
Train    38:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.93it/s]
Train    38:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.88it/s]
Train    38:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.89it/s]
Train    38:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.22it/s]
Train    38:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.69it/s]
Train    38:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.04it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.30it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.39it/s]
13 Oct 03:35    INFO  epoch 38 training [time: 1.49s, train loss: 10.7494]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.27it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.05it/s]
13 Oct 03:35    INFO  epoch 38 evaluating [time: 0.17s, valid_score: 0.859300]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8719    recall@10 : 0.8837    mrr@5 : 0.8576    mrr@10 : 0.8593    ndcg@5 : 0.8612    ndcg@10 : 0.8651    hit@5 : 0.8719    hit@10 : 0.8837    precision@5 : 0.1744    precision@10 : 0.0884

Train    39:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    39:   9%|████▋                                              | 1/11 [00:00<00:01,  8.46it/s]
Train    39:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.30it/s]
Train    39:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.13it/s]
Train    39:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.13it/s]
Train    39:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.16it/s]
Train    39:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.17it/s]
Train    39:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.20it/s]
Train    39:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.12it/s]
Train    39:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.07it/s]
Train    39:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.10it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.10it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
13 Oct 03:35    INFO  epoch 39 training [time: 1.35s, train loss: 11.0422]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.77it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.00it/s]
13 Oct 03:35    INFO  epoch 39 evaluating [time: 0.15s, valid_score: 0.859600]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.8837    mrr@5 : 0.8578    mrr@10 : 0.8596    ndcg@5 : 0.8608    ndcg@10 : 0.8653    hit@5 : 0.8697    hit@10 : 0.8837    precision@5 : 0.1739    precision@10 : 0.0884

Train    40:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    40:   9%|████▋                                              | 1/11 [00:00<00:01,  7.87it/s]
Train    40:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.12it/s]
Train    40:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.18it/s]
Train    40:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.22it/s]
Train    40:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.21it/s]
Train    40:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.19it/s]
Train    40:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.19it/s]
Train    40:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.19it/s]
Train    40:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.21it/s]
Train    40:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.18it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.15it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.17it/s]
13 Oct 03:35    INFO  epoch 40 training [time: 1.35s, train loss: 10.1116]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.33it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.10it/s]
13 Oct 03:35    INFO  epoch 40 evaluating [time: 0.16s, valid_score: 0.860800]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8706    recall@10 : 0.8842    mrr@5 : 0.859    mrr@10 : 0.8608    ndcg@5 : 0.8619    ndcg@10 : 0.8663    hit@5 : 0.8706    hit@10 : 0.8842    precision@5 : 0.1741    precision@10 : 0.0884
13 Oct 03:35    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    41:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    41:   9%|████▋                                              | 1/11 [00:00<00:01,  8.62it/s]
Train    41:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.40it/s]
Train    41:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.38it/s]
Train    41:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.26it/s]
Train    41:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.02it/s]
Train    41:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.01it/s]
Train    41:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.00it/s]
Train    41:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.00it/s]
Train    41:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.00it/s]
Train    41:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.04it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.11it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.11it/s]
13 Oct 03:35    INFO  epoch 41 training [time: 1.36s, train loss: 9.5977]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.63it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.99it/s]
13 Oct 03:35    INFO  epoch 41 evaluating [time: 0.13s, valid_score: 0.857700]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8805    mrr@5 : 0.8562    mrr@10 : 0.8577    ndcg@5 : 0.8597    ndcg@10 : 0.8631    hit@5 : 0.8701    hit@10 : 0.8805    precision@5 : 0.174    precision@10 : 0.0881

Train    42:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    42:   9%|████▋                                              | 1/11 [00:00<00:01,  8.21it/s]
Train    42:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.10it/s]
Train    42:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.01it/s]
Train    42:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.01it/s]
Train    42:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.03it/s]
Train    42:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.03it/s]
Train    42:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.01it/s]
Train    42:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.77it/s]
Train    42:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.74it/s]
Train    42:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.49it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.65it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.82it/s]
13 Oct 03:35    INFO  epoch 42 training [time: 1.41s, train loss: 10.2352]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.95it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.87it/s]
13 Oct 03:35    INFO  epoch 42 evaluating [time: 0.17s, valid_score: 0.856100]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8828    mrr@5 : 0.8541    mrr@10 : 0.8561    ndcg@5 : 0.8577    ndcg@10 : 0.8624    hit@5 : 0.8683    hit@10 : 0.8828    precision@5 : 0.1737    precision@10 : 0.0883

Train    43:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    43:   9%|████▋                                              | 1/11 [00:00<00:01,  7.84it/s]
Train    43:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.08it/s]
Train    43:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.04it/s]
Train    43:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.59it/s]
Train    43:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.96it/s]
Train    43:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.32it/s]
Train    43:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  7.55it/s]
Train    43:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.69it/s]
Train    43:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.77it/s]
Train    43:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.85it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.87it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.28it/s]
13 Oct 03:35    INFO  epoch 43 training [time: 1.51s, train loss: 10.5877]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.27it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.98it/s]
13 Oct 03:35    INFO  epoch 43 evaluating [time: 0.15s, valid_score: 0.858500]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8846    mrr@5 : 0.8565    mrr@10 : 0.8585    ndcg@5 : 0.8599    ndcg@10 : 0.8647    hit@5 : 0.8701    hit@10 : 0.8846    precision@5 : 0.174    precision@10 : 0.0885

Train    44:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    44:   9%|████▋                                              | 1/11 [00:00<00:01,  7.68it/s]
Train    44:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.79it/s]
Train    44:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.79it/s]
Train    44:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.82it/s]
Train    44:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.83it/s]
Train    44:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.92it/s]
Train    44:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.86it/s]
Train    44:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.95it/s]
Train    44:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.90it/s]
Train    44:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.88it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.96it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.89it/s]
13 Oct 03:35    INFO  epoch 44 training [time: 1.40s, train loss: 10.1106]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.94it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.97it/s]
13 Oct 03:35    INFO  epoch 44 evaluating [time: 0.15s, valid_score: 0.860300]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8747    recall@10 : 0.8882    mrr@5 : 0.8586    mrr@10 : 0.8603    ndcg@5 : 0.8625    ndcg@10 : 0.8668    hit@5 : 0.8747    hit@10 : 0.8882    precision@5 : 0.1749    precision@10 : 0.0888

Train    45:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    45:   9%|████▋                                              | 1/11 [00:00<00:01,  8.00it/s]
Train    45:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.04it/s]
Train    45:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.04it/s]
Train    45:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.09it/s]
Train    45:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.11it/s]
Train    45:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.10it/s]
Train    45:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.03it/s]
Train    45:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.06it/s]
Train    45:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.06it/s]
Train    45:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.04it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.03it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.05it/s]
13 Oct 03:35    INFO  epoch 45 training [time: 1.37s, train loss: 9.8360]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.92it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.82it/s]
13 Oct 03:35    INFO  epoch 45 evaluating [time: 0.15s, valid_score: 0.860300]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8715    recall@10 : 0.8837    mrr@5 : 0.8587    mrr@10 : 0.8603    ndcg@5 : 0.8619    ndcg@10 : 0.8658    hit@5 : 0.8715    hit@10 : 0.8837    precision@5 : 0.1743    precision@10 : 0.0884

Train    46:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    46:   9%|████▋                                              | 1/11 [00:00<00:01,  7.62it/s]
Train    46:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.66it/s]
Train    46:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.77it/s]
Train    46:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.88it/s]
Train    46:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.98it/s]
Train    46:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.97it/s]
Train    46:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.88it/s]
Train    46:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.92it/s]
Train    46:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.90it/s]
Train    46:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.81it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.89it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.87it/s]
13 Oct 03:35    INFO  epoch 46 training [time: 1.40s, train loss: 10.3990]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.48it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.96it/s]
13 Oct 03:35    INFO  epoch 46 evaluating [time: 0.13s, valid_score: 0.862000]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8724    recall@10 : 0.8828    mrr@5 : 0.8607    mrr@10 : 0.862    ndcg@5 : 0.8636    ndcg@10 : 0.8669    hit@5 : 0.8724    hit@10 : 0.8828    precision@5 : 0.1745    precision@10 : 0.0883
13 Oct 03:35    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Train    47:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    47:   9%|████▋                                              | 1/11 [00:00<00:01,  8.21it/s]
Train    47:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.25it/s]
Train    47:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.12it/s]
Train    47:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.03it/s]
Train    47:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.91it/s]
Train    47:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.00it/s]
Train    47:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.51it/s]
Train    47:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.84it/s]
Train    47:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.86it/s]
Train    47:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.20it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.42it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.24it/s]
13 Oct 03:35    INFO  epoch 47 training [time: 1.52s, train loss: 10.2382]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.71it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.91it/s]
13 Oct 03:35    INFO  epoch 47 evaluating [time: 0.14s, valid_score: 0.860400]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.8846    mrr@5 : 0.8586    mrr@10 : 0.8604    ndcg@5 : 0.8617    ndcg@10 : 0.8661    hit@5 : 0.871    hit@10 : 0.8846    precision@5 : 0.1742    precision@10 : 0.0885

Train    48:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    48:   9%|████▋                                              | 1/11 [00:00<00:01,  8.02it/s]
Train    48:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.08it/s]
Train    48:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.18it/s]
Train    48:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.10it/s]
Train    48:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.10it/s]
Train    48:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.10it/s]
Train    48:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.12it/s]
Train    48:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.07it/s]
Train    48:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.05it/s]
Train    48:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.01it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.08it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.08it/s]
13 Oct 03:35    INFO  epoch 48 training [time: 1.36s, train loss: 9.4924]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.01it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.26it/s]
13 Oct 03:35    INFO  epoch 48 evaluating [time: 0.14s, valid_score: 0.861200]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.8738    recall@10 : 0.8873    mrr@5 : 0.8594    mrr@10 : 0.8612    ndcg@5 : 0.863    ndcg@10 : 0.8674    hit@5 : 0.8738    hit@10 : 0.8873    precision@5 : 0.1748    precision@10 : 0.0887

Train    49:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    49:   9%|████▋                                              | 1/11 [00:00<00:01,  8.21it/s]
Train    49:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.15it/s]
Train    49:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.11it/s]
Train    49:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.16it/s]
Train    49:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.08it/s]
Train    49:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.97it/s]
Train    49:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.84it/s]
Train    49:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.80it/s]
Train    49:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.82it/s]
Train    49:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.87it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.99it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.97it/s]
13 Oct 03:35    INFO  epoch 49 training [time: 1.38s, train loss: 9.9048]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.17it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.13it/s]
13 Oct 03:35    INFO  epoch 49 evaluating [time: 0.17s, valid_score: 0.861300]
13 Oct 03:35    INFO  valid result: 
recall@5 : 0.876    recall@10 : 0.886    mrr@5 : 0.8599    mrr@10 : 0.8613    ndcg@5 : 0.8639    ndcg@10 : 0.8671    hit@5 : 0.876    hit@10 : 0.886    precision@5 : 0.1752    precision@10 : 0.0886
13 Oct 03:35    INFO  Loading model structure and parameters from saved/BERT4Rec-Oct-13-2025_03-34-27.pth

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.82it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.06it/s]
13 Oct 03:35    INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |    11.90 %     |
+-------------+----------------+
| GPU         |   0.0 / 0.0    |
+-------------+----------------+
| Memory      | 1.54 G/15.33 G |
+-------------+----------------+
13 Oct 03:35    INFO  best valid : OrderedDict({'recall@5': 0.8724, 'recall@10': 0.8828, 'mrr@5': 0.8607, 'mrr@10': 0.862, 'ndcg@5': 0.8636, 'ndcg@10': 0.8669, 'hit@5': 0.8724, 'hit@10': 0.8828, 'precision@5': 0.1745, 'precision@10': 0.0883})
13 Oct 03:35    INFO  test result: OrderedDict({'recall@5': 0.9787, 'recall@10': 0.9835, 'mrr@5': 0.9596, 'mrr@10': 0.9602, 'ndcg@5': 0.9645, 'ndcg@10': 0.966, 'hit@5': 0.9787, 'hit@10': 0.9835, 'precision@5': 0.1957, 'precision@10': 0.0983})
2025-10-13 03:35:47,346 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/versions/BERT4Rec-Oct-13-2025_03-22-54.pth
2025-10-13 03:35:47,347 | INFO | Published checkpoint /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/saved/BERT4Rec-Oct-13-2025_03-34-27.pth → /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/versions/BERT4Rec-Oct-13-2025_03-34-27.pth
2025-10-13 03:35:47,347 | INFO | Retraining completed in 0:01:25.577990 | dataset=20251012-203423 | model=Oct-13-2025_03-34-27
2025-10-13 03:36:17,350 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:36:18,056 | INFO | 🔄 Đang trích xuất data từ Postgres...
🐘 Đã trích xuất bằng psycopg.
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 69
Số user: 2
Số sản phẩm: 11
Các loại event: {'add_to_cart': 0.42, 'view': 0.377, 'purchase': 0.203}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[10 rows x 5 columns]
2025-10-13 03:36:18,056 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:36:18,576 | INFO | 🗂  Đã cập nhật /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/interactions.csv (tổng 18368 bản ghi).
✅ Đã tạo snapshot 20251012-203618 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-203618/ecommerce.inter) với 18368 dòng
👥  User: 2609 | 🛒  Sản phẩm: 106
🏷️   Nhãn mua hàng (label=1): 2995
      user_id item_id   timestamp  label
4952        3      25  1704067200      0
4953        3      25  1704068520      0
18272       3      89  1707264000      0
18273       3      89  1707264300      0
18274       3      89  1707265440      0
18275       3      89  1707266820      1
1123        3      12  1708041600      0
1124        3      12  1708044480      0
10396       4       4  1707436800      0
10397       4       4  1707437100      0
2025-10-13 03:36:18,577 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-202443
2025-10-13 03:36:18,578 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 03:37:44,038 | INFO | 13 Oct 03:36    INFO  ['train_bert4rec.py']
13 Oct 03:36    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = False
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
device = cuda
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 03:36    INFO  ecommerce
The number of users: 2608
Average actions of users: 7.045646336785578
The number of items: 96
Average actions of items: 193.34736842105264
The number of inters: 18368
The sparsity of the dataset: 92.66359918200409%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 03:36    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 03:36    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 03:36    INFO  BERT4Rec(
  (item_embedding): Embedding(97, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 113888
13 Oct 03:36    INFO  FLOPs: 5194664.0
🔧 Sử dụng topk=[5, 10], valid_metric=MRR@10, device=cpu

Train     0:   0%|                                                           | 0/11 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   9%|████▋                                              | 1/11 [00:00<00:02,  4.21it/s]
Train     0:  18%|█████████▎                                         | 2/11 [00:00<00:01,  6.12it/s]
Train     0:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.19it/s]
Train     0:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.79it/s]
Train     0:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.26it/s]
Train     0:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.43it/s]
Train     0:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.68it/s]
Train     0:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.88it/s]
Train     0:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  9.00it/s]
Train     0:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.98it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  9.01it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.22it/s]
13 Oct 03:36    INFO  epoch 0 training [time: 1.34s, train loss: 49.7594]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.56it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.86it/s]
13 Oct 03:36    INFO  epoch 0 evaluating [time: 0.18s, valid_score: 0.057500]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.0937    recall@10 : 0.1765    mrr@5 : 0.0466    mrr@10 : 0.0575    ndcg@5 : 0.0582    ndcg@10 : 0.0847    hit@5 : 0.0937    hit@10 : 0.1765    precision@5 : 0.0187    precision@10 : 0.0176
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train     1:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     1:   9%|████▋                                              | 1/11 [00:00<00:01,  8.62it/s]
Train     1:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.78it/s]
Train     1:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.73it/s]
Train     1:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.89it/s]
Train     1:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.98it/s]
Train     1:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.86it/s]
Train     1:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.80it/s]
Train     1:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.74it/s]
Train     1:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.71it/s]
Train     1:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.73it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.69it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.76it/s]
13 Oct 03:36    INFO  epoch 1 training [time: 1.26s, train loss: 48.9054]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.25it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.59it/s]
13 Oct 03:36    INFO  epoch 1 evaluating [time: 0.13s, valid_score: 0.078800]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.1348    recall@10 : 0.2118    mrr@5 : 0.0691    mrr@10 : 0.0788    ndcg@5 : 0.0853    ndcg@10 : 0.1096    hit@5 : 0.1348    hit@10 : 0.2118    precision@5 : 0.027    precision@10 : 0.0212
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train     2:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     2:   9%|████▋                                              | 1/11 [00:00<00:01,  8.99it/s]
Train     2:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.03it/s]
Train     2:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.66it/s]
Train     2:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.47it/s]
Train     2:  45%|███████████████████████▏                           | 5/11 [00:00<00:01,  5.98it/s]
Train     2:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.73it/s]
Train     2:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.30it/s]
Train     2:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.77it/s]
Train     2:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.08it/s]
Train     2:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.16it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.19it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.80it/s]
13 Oct 03:36    INFO  epoch 2 training [time: 1.41s, train loss: 46.8474]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.78it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.99it/s]
13 Oct 03:36    INFO  epoch 2 evaluating [time: 0.15s, valid_score: 0.351100]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.5244    recall@10 : 0.6136    mrr@5 : 0.3392    mrr@10 : 0.3511    ndcg@5 : 0.3855    ndcg@10 : 0.4144    hit@5 : 0.5244    hit@10 : 0.6136    precision@5 : 0.1049    precision@10 : 0.0614
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train     3:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     3:   9%|████▋                                              | 1/11 [00:00<00:01,  8.69it/s]
Train     3:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.73it/s]
Train     3:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.71it/s]
Train     3:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.73it/s]
Train     3:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.78it/s]
Train     3:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.79it/s]
Train     3:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.71it/s]
Train     3:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.52it/s]
Train     3:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.52it/s]
Train     3:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.41it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.52it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.60it/s]
13 Oct 03:36    INFO  epoch 3 training [time: 1.28s, train loss: 42.5084]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.00it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.78it/s]
13 Oct 03:36    INFO  epoch 3 evaluating [time: 0.13s, valid_score: 0.538900]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.6611    recall@10 : 0.7217    mrr@5 : 0.5306    mrr@10 : 0.5389    ndcg@5 : 0.5636    ndcg@10 : 0.5834    hit@5 : 0.6611    hit@10 : 0.7217    precision@5 : 0.1322    precision@10 : 0.0722
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train     4:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     4:   9%|████▋                                              | 1/11 [00:00<00:01,  8.98it/s]
Train     4:  18%|█████████▎                                         | 2/11 [00:00<00:00,  9.03it/s]
Train     4:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.96it/s]
Train     4:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.97it/s]
Train     4:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  9.01it/s]
Train     4:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.84it/s]
Train     4:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.77it/s]
Train     4:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.85it/s]
Train     4:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.81it/s]
Train     4:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.77it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.72it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.83it/s]
13 Oct 03:36    INFO  epoch 4 training [time: 1.25s, train loss: 38.5157]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.91it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.36it/s]
13 Oct 03:36    INFO  epoch 4 evaluating [time: 0.15s, valid_score: 0.577400]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.6937    recall@10 : 0.7443    mrr@5 : 0.5704    mrr@10 : 0.5774    ndcg@5 : 0.6016    ndcg@10 : 0.6183    hit@5 : 0.6937    hit@10 : 0.7443    precision@5 : 0.1387    precision@10 : 0.0744
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train     5:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     5:   9%|████▋                                              | 1/11 [00:00<00:01,  8.72it/s]
Train     5:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.90it/s]
Train     5:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.89it/s]
Train     5:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.81it/s]
Train     5:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.66it/s]
Train     5:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.63it/s]
Train     5:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.59it/s]
Train     5:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.47it/s]
Train     5:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.53it/s]
Train     5:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.55it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.57it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.62it/s]
13 Oct 03:36    INFO  epoch 5 training [time: 1.28s, train loss: 35.0609]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.98it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.90it/s]
13 Oct 03:36    INFO  epoch 5 evaluating [time: 0.12s, valid_score: 0.636100]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.7303    recall@10 : 0.7765    mrr@5 : 0.6301    mrr@10 : 0.6361    ndcg@5 : 0.6553    ndcg@10 : 0.6701    hit@5 : 0.7303    hit@10 : 0.7765    precision@5 : 0.1461    precision@10 : 0.0776
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train     6:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     6:   9%|████▋                                              | 1/11 [00:00<00:01,  8.84it/s]
Train     6:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.88it/s]
Train     6:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.74it/s]
Train     6:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.71it/s]
Train     6:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.73it/s]
Train     6:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.48it/s]
Train     6:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.10it/s]
Train     6:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.45it/s]
Train     6:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.65it/s]
Train     6:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.74it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.90it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.83it/s]
13 Oct 03:36    INFO  epoch 6 training [time: 1.41s, train loss: 31.5342]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.73it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.29it/s]
13 Oct 03:36    INFO  epoch 6 evaluating [time: 0.15s, valid_score: 0.688700]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.7548    recall@10 : 0.8023    mrr@5 : 0.6823    mrr@10 : 0.6887    ndcg@5 : 0.7006    ndcg@10 : 0.716    hit@5 : 0.7548    hit@10 : 0.8023    precision@5 : 0.151    precision@10 : 0.0802
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train     7:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     7:   9%|████▋                                              | 1/11 [00:00<00:01,  8.70it/s]
Train     7:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.42it/s]
Train     7:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.48it/s]
Train     7:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.63it/s]
Train     7:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.72it/s]
Train     7:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.79it/s]
Train     7:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.78it/s]
Train     7:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.82it/s]
Train     7:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.82it/s]
Train     7:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.84it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.84it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.76it/s]
13 Oct 03:36    INFO  epoch 7 training [time: 1.26s, train loss: 28.7599]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 19.39it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.50it/s]
13 Oct 03:36    INFO  epoch 7 evaluating [time: 0.13s, valid_score: 0.720300]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.7842    recall@10 : 0.8213    mrr@5 : 0.7153    mrr@10 : 0.7203    ndcg@5 : 0.7326    ndcg@10 : 0.7446    hit@5 : 0.7842    hit@10 : 0.8213    precision@5 : 0.1568    precision@10 : 0.0821
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train     8:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     8:   9%|████▋                                              | 1/11 [00:00<00:01,  8.67it/s]
Train     8:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.57it/s]
Train     8:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.49it/s]
Train     8:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.51it/s]
Train     8:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.55it/s]
Train     8:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.60it/s]
Train     8:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.69it/s]
Train     8:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.68it/s]
Train     8:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.54it/s]
Train     8:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.40it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.40it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.51it/s]
13 Oct 03:36    INFO  epoch 8 training [time: 1.29s, train loss: 25.9326]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.56it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.36it/s]
13 Oct 03:36    INFO  epoch 8 evaluating [time: 0.12s, valid_score: 0.747400]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.8041    recall@10 : 0.8339    mrr@5 : 0.7434    mrr@10 : 0.7474    ndcg@5 : 0.7586    ndcg@10 : 0.7683    hit@5 : 0.8041    hit@10 : 0.8339    precision@5 : 0.1608    precision@10 : 0.0834
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train     9:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     9:   9%|████▋                                              | 1/11 [00:00<00:01,  8.65it/s]
Train     9:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.67it/s]
Train     9:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.72it/s]
Train     9:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.68it/s]
Train     9:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.62it/s]
Train     9:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.60it/s]
Train     9:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.53it/s]
Train     9:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.51it/s]
Train     9:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.39it/s]
Train     9:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.22it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.11it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.40it/s]
13 Oct 03:36    INFO  epoch 9 training [time: 1.31s, train loss: 23.2385]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.01it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.06it/s]
13 Oct 03:36    INFO  epoch 9 evaluating [time: 0.15s, valid_score: 0.783100]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.829    recall@10 : 0.8529    mrr@5 : 0.7799    mrr@10 : 0.7831    ndcg@5 : 0.7923    ndcg@10 : 0.8    hit@5 : 0.829    hit@10 : 0.8529    precision@5 : 0.1658    precision@10 : 0.0853
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    10:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    10:   9%|████▋                                              | 1/11 [00:00<00:01,  8.43it/s]
Train    10:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.49it/s]
Train    10:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.64it/s]
Train    10:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.77it/s]
Train    10:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.81it/s]
Train    10:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.76it/s]
Train    10:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.68it/s]
Train    10:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.62it/s]
Train    10:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.42it/s]
Train    10:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.11it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.75it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.72it/s]
13 Oct 03:36    INFO  epoch 10 training [time: 1.43s, train loss: 20.9736]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.79it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.10it/s]
13 Oct 03:36    INFO  epoch 10 evaluating [time: 0.13s, valid_score: 0.809200]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.8385    recall@10 : 0.8579    mrr@5 : 0.8065    mrr@10 : 0.8092    ndcg@5 : 0.8145    ndcg@10 : 0.8209    hit@5 : 0.8385    hit@10 : 0.8579    precision@5 : 0.1677    precision@10 : 0.0858
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    11:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    11:   9%|████▋                                              | 1/11 [00:00<00:01,  8.49it/s]
Train    11:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.55it/s]
Train    11:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.49it/s]
Train    11:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.48it/s]
Train    11:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.30it/s]
Train    11:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.25it/s]
Train    11:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.19it/s]
Train    11:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.18it/s]
Train    11:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.17it/s]
Train    11:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.24it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.28it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.29it/s]
13 Oct 03:36    INFO  epoch 11 training [time: 1.33s, train loss: 19.1671]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.24it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.58it/s]
13 Oct 03:36    INFO  epoch 11 evaluating [time: 0.16s, valid_score: 0.820000]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.8448    recall@10 : 0.8665    mrr@5 : 0.8171    mrr@10 : 0.82    ndcg@5 : 0.8241    ndcg@10 : 0.8311    hit@5 : 0.8448    hit@10 : 0.8665    precision@5 : 0.169    precision@10 : 0.0867
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    12:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    12:   9%|████▋                                              | 1/11 [00:00<00:01,  8.50it/s]
Train    12:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.59it/s]
Train    12:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.61it/s]
Train    12:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.50it/s]
Train    12:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.06it/s]
Train    12:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.61it/s]
Train    12:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.75it/s]
Train    12:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.63it/s]
Train    12:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.74it/s]
Train    12:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.86it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.97it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.97it/s]
13 Oct 03:36    INFO  epoch 12 training [time: 1.38s, train loss: 17.4560]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.41it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.32it/s]
13 Oct 03:36    INFO  epoch 12 evaluating [time: 0.15s, valid_score: 0.829300]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.8475    recall@10 : 0.8679    mrr@5 : 0.8265    mrr@10 : 0.8293    ndcg@5 : 0.8318    ndcg@10 : 0.8384    hit@5 : 0.8475    hit@10 : 0.8679    precision@5 : 0.1695    precision@10 : 0.0868
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    13:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    13:   9%|████▋                                              | 1/11 [00:00<00:01,  8.50it/s]
Train    13:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.58it/s]
Train    13:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.68it/s]
Train    13:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.75it/s]
Train    13:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.85it/s]
Train    13:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.82it/s]
Train    13:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.73it/s]
Train    13:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.30it/s]
Train    13:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.05it/s]
Train    13:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.96it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.94it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.31it/s]
13 Oct 03:36    INFO  epoch 13 training [time: 1.32s, train loss: 16.1932]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.52it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.43it/s]
13 Oct 03:36    INFO  epoch 13 evaluating [time: 0.15s, valid_score: 0.835100]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.8534    recall@10 : 0.8719    mrr@5 : 0.8326    mrr@10 : 0.8351    ndcg@5 : 0.8378    ndcg@10 : 0.8438    hit@5 : 0.8534    hit@10 : 0.8719    precision@5 : 0.1707    precision@10 : 0.0872
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    14:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    14:   9%|████▋                                              | 1/11 [00:00<00:01,  8.53it/s]
Train    14:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.56it/s]
Train    14:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.45it/s]
Train    14:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.43it/s]
Train    14:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.39it/s]
Train    14:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.37it/s]
Train    14:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.34it/s]
Train    14:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.36it/s]
Train    14:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.37it/s]
Train    14:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.36it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.39it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.39it/s]
13 Oct 03:36    INFO  epoch 14 training [time: 1.31s, train loss: 15.6198]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  4.29it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00,  9.42it/s]
13 Oct 03:36    INFO  epoch 14 evaluating [time: 0.33s, valid_score: 0.841300]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.857    recall@10 : 0.8742    mrr@5 : 0.8391    mrr@10 : 0.8413    ndcg@5 : 0.8436    ndcg@10 : 0.8491    hit@5 : 0.857    hit@10 : 0.8742    precision@5 : 0.1714    precision@10 : 0.0874
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    15:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    15:   9%|████▋                                              | 1/11 [00:00<00:01,  8.56it/s]
Train    15:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.26it/s]
Train    15:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.10it/s]
Train    15:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.00it/s]
Train    15:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.05it/s]
Train    15:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.08it/s]
Train    15:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.25it/s]
Train    15:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.22it/s]
Train    15:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.19it/s]
Train    15:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.26it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.24it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.19it/s]
13 Oct 03:36    INFO  epoch 15 training [time: 1.34s, train loss: 13.9309]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.79it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.37it/s]
13 Oct 03:36    INFO  epoch 15 evaluating [time: 0.17s, valid_score: 0.845200]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.8588    recall@10 : 0.8742    mrr@5 : 0.8432    mrr@10 : 0.8452    ndcg@5 : 0.8471    ndcg@10 : 0.852    hit@5 : 0.8588    hit@10 : 0.8742    precision@5 : 0.1718    precision@10 : 0.0874
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    16:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    16:   9%|████▋                                              | 1/11 [00:00<00:01,  8.07it/s]
Train    16:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.27it/s]
Train    16:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.40it/s]
Train    16:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.13it/s]
Train    16:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.15it/s]
Train    16:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.12it/s]
Train    16:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.05it/s]
Train    16:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.74it/s]
Train    16:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.78it/s]
Train    16:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.76it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.84it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.96it/s]
13 Oct 03:36    INFO  epoch 16 training [time: 1.38s, train loss: 13.4300]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.32it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.56it/s]
13 Oct 03:36    INFO  epoch 16 evaluating [time: 0.17s, valid_score: 0.844100]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.8575    recall@10 : 0.8765    mrr@5 : 0.8416    mrr@10 : 0.8441    ndcg@5 : 0.8456    ndcg@10 : 0.8517    hit@5 : 0.8575    hit@10 : 0.8765    precision@5 : 0.1715    precision@10 : 0.0876

Train    17:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    17:   9%|████▋                                              | 1/11 [00:00<00:01,  8.50it/s]
Train    17:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.22it/s]
Train    17:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.31it/s]
Train    17:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.36it/s]
Train    17:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.39it/s]
Train    17:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.28it/s]
Train    17:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.40it/s]
Train    17:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.04it/s]
Train    17:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.00it/s]
Train    17:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.92it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.89it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.11it/s]
13 Oct 03:36    INFO  epoch 17 training [time: 1.36s, train loss: 13.0804]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.11it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.52it/s]
13 Oct 03:36    INFO  epoch 17 evaluating [time: 0.16s, valid_score: 0.846200]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.8597    recall@10 : 0.8751    mrr@5 : 0.8443    mrr@10 : 0.8462    ndcg@5 : 0.8481    ndcg@10 : 0.853    hit@5 : 0.8597    hit@10 : 0.8751    precision@5 : 0.1719    precision@10 : 0.0875
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    18:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    18:   9%|████▋                                              | 1/11 [00:00<00:01,  8.00it/s]
Train    18:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.91it/s]
Train    18:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.64it/s]
Train    18:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.83it/s]
Train    18:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.92it/s]
Train    18:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.82it/s]
Train    18:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  5.89it/s]
Train    18:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.37it/s]
Train    18:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.46it/s]
Train    18:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.67it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.09it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.04it/s]
13 Oct 03:36    INFO  epoch 18 training [time: 1.56s, train loss: 13.4371]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.92it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.94it/s]
13 Oct 03:36    INFO  epoch 18 evaluating [time: 0.14s, valid_score: 0.852200]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.8647    recall@10 : 0.8769    mrr@5 : 0.8507    mrr@10 : 0.8522    ndcg@5 : 0.8542    ndcg@10 : 0.8581    hit@5 : 0.8647    hit@10 : 0.8769    precision@5 : 0.1729    precision@10 : 0.0877
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    19:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    19:   9%|████▋                                              | 1/11 [00:00<00:01,  8.09it/s]
Train    19:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.02it/s]
Train    19:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.08it/s]
Train    19:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.10it/s]
Train    19:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.98it/s]
Train    19:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.24it/s]
Train    19:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.53it/s]
Train    19:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.77it/s]
Train    19:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.94it/s]
Train    19:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.78it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.95it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.45it/s]
13 Oct 03:36    INFO  epoch 19 training [time: 1.48s, train loss: 13.0179]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  9.42it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00,  9.33it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 13.12it/s]
13 Oct 03:36    INFO  epoch 19 evaluating [time: 0.25s, valid_score: 0.851000]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.8638    recall@10 : 0.8778    mrr@5 : 0.8492    mrr@10 : 0.851    ndcg@5 : 0.8529    ndcg@10 : 0.8574    hit@5 : 0.8638    hit@10 : 0.8778    precision@5 : 0.1728    precision@10 : 0.0878

Train    20:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    20:   9%|████▋                                              | 1/11 [00:00<00:01,  8.04it/s]
Train    20:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.01it/s]
Train    20:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.01it/s]
Train    20:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.99it/s]
Train    20:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.97it/s]
Train    20:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.00it/s]
Train    20:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.04it/s]
Train    20:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.99it/s]
Train    20:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.04it/s]
Train    20:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.01it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.04it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.02it/s]
13 Oct 03:36    INFO  epoch 20 training [time: 1.37s, train loss: 12.5615]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.63it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.55it/s]
13 Oct 03:36    INFO  epoch 20 evaluating [time: 0.16s, valid_score: 0.852700]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.867    recall@10 : 0.8778    mrr@5 : 0.8513    mrr@10 : 0.8527    ndcg@5 : 0.8552    ndcg@10 : 0.8587    hit@5 : 0.867    hit@10 : 0.8778    precision@5 : 0.1734    precision@10 : 0.0878
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    21:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    21:   9%|████▋                                              | 1/11 [00:00<00:01,  8.25it/s]
Train    21:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.16it/s]
Train    21:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.12it/s]
Train    21:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.62it/s]
Train    21:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.74it/s]
Train    21:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.91it/s]
Train    21:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.21it/s]
Train    21:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.07it/s]
Train    21:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.99it/s]
Train    21:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.94it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.92it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.96it/s]
13 Oct 03:36    INFO  epoch 21 training [time: 1.38s, train loss: 11.9438]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.21it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.21it/s]
13 Oct 03:36    INFO  epoch 21 evaluating [time: 0.14s, valid_score: 0.853200]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.8661    recall@10 : 0.8796    mrr@5 : 0.8515    mrr@10 : 0.8532    ndcg@5 : 0.8552    ndcg@10 : 0.8595    hit@5 : 0.8661    hit@10 : 0.8796    precision@5 : 0.1732    precision@10 : 0.088
13 Oct 03:36    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    22:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    22:   9%|████▋                                              | 1/11 [00:00<00:01,  8.06it/s]
Train    22:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.09it/s]
Train    22:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.11it/s]
Train    22:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.12it/s]
Train    22:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.10it/s]
Train    22:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.12it/s]
Train    22:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.68it/s]
Train    22:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.09it/s]
Train    22:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.39it/s]
Train    22:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.60it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.72it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.47it/s]
13 Oct 03:36    INFO  epoch 22 training [time: 1.47s, train loss: 11.5617]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.84it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.05it/s]
13 Oct 03:36    INFO  epoch 22 evaluating [time: 0.16s, valid_score: 0.852400]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.8652    recall@10 : 0.8783    mrr@5 : 0.8506    mrr@10 : 0.8524    ndcg@5 : 0.8543    ndcg@10 : 0.8586    hit@5 : 0.8652    hit@10 : 0.8783    precision@5 : 0.173    precision@10 : 0.0878

Train    23:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    23:   9%|████▋                                              | 1/11 [00:00<00:01,  7.95it/s]
Train    23:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.65it/s]
Train    23:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.77it/s]
Train    23:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.33it/s]
Train    23:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.35it/s]
Train    23:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.36it/s]
Train    23:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.56it/s]
Train    23:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.63it/s]
Train    23:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.74it/s]
Train    23:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.80it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.88it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.67it/s]
13 Oct 03:36    INFO  epoch 23 training [time: 1.43s, train loss: 11.4483]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.83it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.13it/s]
13 Oct 03:36    INFO  epoch 23 evaluating [time: 0.17s, valid_score: 0.850200]
13 Oct 03:36    INFO  valid result: 
recall@5 : 0.8652    recall@10 : 0.8792    mrr@5 : 0.8483    mrr@10 : 0.8502    ndcg@5 : 0.8525    ndcg@10 : 0.857    hit@5 : 0.8652    hit@10 : 0.8792    precision@5 : 0.173    precision@10 : 0.0879

Train    24:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    24:   9%|████▋                                              | 1/11 [00:00<00:01,  8.21it/s]
Train    24:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.00it/s]
Train    24:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.93it/s]
Train    24:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.84it/s]
Train    24:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.88it/s]
Train    24:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.78it/s]
Train    24:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.85it/s]
Train    24:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.99it/s]
Train    24:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.93it/s]
Train    24:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.59it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.72it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.82it/s]
13 Oct 03:37    INFO  epoch 24 training [time: 1.41s, train loss: 11.3786]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.16it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.54it/s]
13 Oct 03:37    INFO  epoch 24 evaluating [time: 0.16s, valid_score: 0.852300]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8792    mrr@5 : 0.8508    mrr@10 : 0.8523    ndcg@5 : 0.8552    ndcg@10 : 0.8587    hit@5 : 0.8683    hit@10 : 0.8792    precision@5 : 0.1737    precision@10 : 0.0879

Train    25:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    25:   9%|████▋                                              | 1/11 [00:00<00:01,  7.38it/s]
Train    25:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.32it/s]
Train    25:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.52it/s]
Train    25:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.72it/s]
Train    25:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.88it/s]
Train    25:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.96it/s]
Train    25:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.95it/s]
Train    25:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.98it/s]
Train    25:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.02it/s]
Train    25:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.88it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.94it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.85it/s]
13 Oct 03:37    INFO  epoch 25 training [time: 1.40s, train loss: 11.9237]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.82it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.94it/s]
13 Oct 03:37    INFO  epoch 25 evaluating [time: 0.14s, valid_score: 0.852800]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8674    recall@10 : 0.8778    mrr@5 : 0.8513    mrr@10 : 0.8528    ndcg@5 : 0.8553    ndcg@10 : 0.8588    hit@5 : 0.8674    hit@10 : 0.8778    precision@5 : 0.1735    precision@10 : 0.0878

Train    26:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    26:   9%|████▋                                              | 1/11 [00:00<00:01,  7.78it/s]
Train    26:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.84it/s]
Train    26:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.88it/s]
Train    26:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.90it/s]
Train    26:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.86it/s]
Train    26:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.87it/s]
Train    26:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.93it/s]
Train    26:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.95it/s]
Train    26:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.01it/s]
Train    26:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.16it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.73it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.34it/s]
13 Oct 03:37    INFO  epoch 26 training [time: 1.50s, train loss: 11.2112]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.53it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.08it/s]
13 Oct 03:37    INFO  epoch 26 evaluating [time: 0.14s, valid_score: 0.854300]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8729    recall@10 : 0.8801    mrr@5 : 0.8534    mrr@10 : 0.8543    ndcg@5 : 0.8583    ndcg@10 : 0.8606    hit@5 : 0.8729    hit@10 : 0.8801    precision@5 : 0.1746    precision@10 : 0.088
13 Oct 03:37    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    27:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    27:   9%|████▋                                              | 1/11 [00:00<00:01,  8.37it/s]
Train    27:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.28it/s]
Train    27:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.33it/s]
Train    27:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.17it/s]
Train    27:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.11it/s]
Train    27:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.09it/s]
Train    27:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.05it/s]
Train    27:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.07it/s]
Train    27:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.01it/s]
Train    27:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.97it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.91it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.05it/s]
13 Oct 03:37    INFO  epoch 27 training [time: 1.37s, train loss: 11.0132]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.81it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.05it/s]
13 Oct 03:37    INFO  epoch 27 evaluating [time: 0.15s, valid_score: 0.854500]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8792    mrr@5 : 0.853    mrr@10 : 0.8545    ndcg@5 : 0.8569    ndcg@10 : 0.8604    hit@5 : 0.8683    hit@10 : 0.8792    precision@5 : 0.1737    precision@10 : 0.0879
13 Oct 03:37    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    28:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    28:   9%|████▋                                              | 1/11 [00:00<00:01,  7.74it/s]
Train    28:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.42it/s]
Train    28:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.56it/s]
Train    28:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.78it/s]
Train    28:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.91it/s]
Train    28:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.99it/s]
Train    28:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.01it/s]
Train    28:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.06it/s]
Train    28:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.04it/s]
Train    28:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.95it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.90it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.89it/s]
13 Oct 03:37    INFO  epoch 28 training [time: 1.40s, train loss: 11.1068]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.78it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.92it/s]
13 Oct 03:37    INFO  epoch 28 evaluating [time: 0.14s, valid_score: 0.854200]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.8805    mrr@5 : 0.8528    mrr@10 : 0.8542    ndcg@5 : 0.8571    ndcg@10 : 0.8605    hit@5 : 0.8697    hit@10 : 0.8805    precision@5 : 0.1739    precision@10 : 0.0881

Train    29:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    29:   9%|████▋                                              | 1/11 [00:00<00:01,  8.15it/s]
Train    29:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.16it/s]
Train    29:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.12it/s]
Train    29:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.04it/s]
Train    29:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.04it/s]
Train    29:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.05it/s]
Train    29:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.97it/s]
Train    29:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.89it/s]
Train    29:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.80it/s]
Train    29:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.83it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.93it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.96it/s]
13 Oct 03:37    INFO  epoch 29 training [time: 1.38s, train loss: 11.8484]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.16it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.97it/s]
13 Oct 03:37    INFO  epoch 29 evaluating [time: 0.15s, valid_score: 0.855100]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8692    recall@10 : 0.8783    mrr@5 : 0.8539    mrr@10 : 0.8551    ndcg@5 : 0.8578    ndcg@10 : 0.8607    hit@5 : 0.8692    hit@10 : 0.8783    precision@5 : 0.1738    precision@10 : 0.0878
13 Oct 03:37    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    30:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    30:   9%|████▋                                              | 1/11 [00:00<00:01,  7.96it/s]
Train    30:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.81it/s]
Train    30:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.90it/s]
Train    30:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.82it/s]
Train    30:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.91it/s]
Train    30:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.90it/s]
Train    30:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.91it/s]
Train    30:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.02it/s]
Train    30:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.49it/s]
Train    30:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.90it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.23it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.27it/s]
13 Oct 03:37    INFO  epoch 30 training [time: 1.51s, train loss: 10.8367]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.66it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.22it/s]
13 Oct 03:37    INFO  epoch 30 evaluating [time: 0.15s, valid_score: 0.856100]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8706    recall@10 : 0.8787    mrr@5 : 0.855    mrr@10 : 0.8561    ndcg@5 : 0.8589    ndcg@10 : 0.8616    hit@5 : 0.8706    hit@10 : 0.8787    precision@5 : 0.1741    precision@10 : 0.0879
13 Oct 03:37    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    31:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    31:   9%|████▋                                              | 1/11 [00:00<00:01,  7.70it/s]
Train    31:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.82it/s]
Train    31:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.78it/s]
Train    31:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.89it/s]
Train    31:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.98it/s]
Train    31:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.96it/s]
Train    31:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.96it/s]
Train    31:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.90it/s]
Train    31:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.95it/s]
Train    31:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.66it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.72it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.82it/s]
13 Oct 03:37    INFO  epoch 31 training [time: 1.41s, train loss: 11.6070]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.40it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.44it/s]
13 Oct 03:37    INFO  epoch 31 evaluating [time: 0.14s, valid_score: 0.856900]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.881    mrr@5 : 0.8553    mrr@10 : 0.8569    ndcg@5 : 0.859    ndcg@10 : 0.8626    hit@5 : 0.8697    hit@10 : 0.881    precision@5 : 0.1739    precision@10 : 0.0881
13 Oct 03:37    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    32:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    32:   9%|████▋                                              | 1/11 [00:00<00:01,  7.68it/s]
Train    32:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.92it/s]
Train    32:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.97it/s]
Train    32:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.93it/s]
Train    32:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.96it/s]
Train    32:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.00it/s]
Train    32:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.03it/s]
Train    32:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.04it/s]
Train    32:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.03it/s]
Train    32:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.75it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.67it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.86it/s]
13 Oct 03:37    INFO  epoch 32 training [time: 1.40s, train loss: 11.3697]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.49it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.64it/s]
13 Oct 03:37    INFO  epoch 32 evaluating [time: 0.16s, valid_score: 0.858500]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.881    mrr@5 : 0.8572    mrr@10 : 0.8585    ndcg@5 : 0.8606    ndcg@10 : 0.8638    hit@5 : 0.871    hit@10 : 0.881    precision@5 : 0.1742    precision@10 : 0.0881
13 Oct 03:37    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    33:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    33:   9%|████▋                                              | 1/11 [00:00<00:01,  7.55it/s]
Train    33:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.18it/s]
Train    33:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.38it/s]
Train    33:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.60it/s]
Train    33:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.78it/s]
Train    33:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.85it/s]
Train    33:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.93it/s]
Train    33:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.92it/s]
Train    33:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.97it/s]
Train    33:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.01it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.98it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.83it/s]
13 Oct 03:37    INFO  epoch 33 training [time: 1.41s, train loss: 11.1416]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.03it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.40it/s]
13 Oct 03:37    INFO  epoch 33 evaluating [time: 0.17s, valid_score: 0.860300]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8719    recall@10 : 0.8778    mrr@5 : 0.8595    mrr@10 : 0.8603    ndcg@5 : 0.8626    ndcg@10 : 0.8646    hit@5 : 0.8719    hit@10 : 0.8778    precision@5 : 0.1744    precision@10 : 0.0878
13 Oct 03:37    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    34:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    34:   9%|████▋                                              | 1/11 [00:00<00:01,  7.80it/s]
Train    34:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.79it/s]
Train    34:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.81it/s]
Train    34:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.85it/s]
Train    34:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.87it/s]
Train    34:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.88it/s]
Train    34:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.91it/s]
Train    34:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.92it/s]
Train    34:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.85it/s]
Train    34:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  5.95it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.47it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.20it/s]
13 Oct 03:37    INFO  epoch 34 training [time: 1.53s, train loss: 9.8315]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.72it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.32it/s]
13 Oct 03:37    INFO  epoch 34 evaluating [time: 0.16s, valid_score: 0.858700]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8828    mrr@5 : 0.857    mrr@10 : 0.8587    ndcg@5 : 0.8604    ndcg@10 : 0.8644    hit@5 : 0.8701    hit@10 : 0.8828    precision@5 : 0.174    precision@10 : 0.0883

Train    35:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    35:   9%|████▋                                              | 1/11 [00:00<00:01,  7.97it/s]
Train    35:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.92it/s]
Train    35:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.02it/s]
Train    35:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.88it/s]
Train    35:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.87it/s]
Train    35:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.79it/s]
Train    35:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.67it/s]
Train    35:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.69it/s]
Train    35:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.66it/s]
Train    35:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.66it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.78it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.78it/s]
13 Oct 03:37    INFO  epoch 35 training [time: 1.42s, train loss: 10.2343]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.32it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.56it/s]
13 Oct 03:37    INFO  epoch 35 evaluating [time: 0.17s, valid_score: 0.856900]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.881    mrr@5 : 0.8552    mrr@10 : 0.8569    ndcg@5 : 0.8585    ndcg@10 : 0.8626    hit@5 : 0.8683    hit@10 : 0.881    precision@5 : 0.1737    precision@10 : 0.0881

Train    36:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    36:   9%|████▋                                              | 1/11 [00:00<00:01,  7.82it/s]
Train    36:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.76it/s]
Train    36:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.78it/s]
Train    36:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.80it/s]
Train    36:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.87it/s]
Train    36:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.80it/s]
Train    36:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.79it/s]
Train    36:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.74it/s]
Train    36:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.78it/s]
Train    36:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.51it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.50it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.68it/s]
13 Oct 03:37    INFO  epoch 36 training [time: 1.43s, train loss: 9.8023]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.28it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.45it/s]
13 Oct 03:37    INFO  epoch 36 evaluating [time: 0.16s, valid_score: 0.855700]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.881    mrr@5 : 0.8544    mrr@10 : 0.8557    ndcg@5 : 0.8586    ndcg@10 : 0.8618    hit@5 : 0.871    hit@10 : 0.881    precision@5 : 0.1742    precision@10 : 0.0881

Train    37:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    37:   9%|████▋                                              | 1/11 [00:00<00:01,  7.61it/s]
Train    37:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.78it/s]
Train    37:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.76it/s]
Train    37:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.79it/s]
Train    37:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.80it/s]
Train    37:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.81it/s]
Train    37:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.66it/s]
Train    37:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.65it/s]
Train    37:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.73it/s]
Train    37:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.70it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.73it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.73it/s]
13 Oct 03:37    INFO  epoch 37 training [time: 1.42s, train loss: 10.7128]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.05it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.15it/s]
13 Oct 03:37    INFO  epoch 37 evaluating [time: 0.14s, valid_score: 0.855300]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8674    recall@10 : 0.8796    mrr@5 : 0.8538    mrr@10 : 0.8553    ndcg@5 : 0.8572    ndcg@10 : 0.8611    hit@5 : 0.8674    hit@10 : 0.8796    precision@5 : 0.1735    precision@10 : 0.088

Train    38:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    38:   9%|████▋                                              | 1/11 [00:00<00:01,  7.50it/s]
Train    38:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.61it/s]
Train    38:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.67it/s]
Train    38:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.72it/s]
Train    38:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.75it/s]
Train    38:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.78it/s]
Train    38:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.84it/s]
Train    38:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  5.91it/s]
Train    38:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.40it/s]
Train    38:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.84it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.20it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.17it/s]
13 Oct 03:37    INFO  epoch 38 training [time: 1.54s, train loss: 10.7494]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.88it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.05it/s]
13 Oct 03:37    INFO  epoch 38 evaluating [time: 0.14s, valid_score: 0.859300]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8719    recall@10 : 0.8837    mrr@5 : 0.8576    mrr@10 : 0.8593    ndcg@5 : 0.8612    ndcg@10 : 0.8651    hit@5 : 0.8719    hit@10 : 0.8837    precision@5 : 0.1744    precision@10 : 0.0884

Train    39:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    39:   9%|████▋                                              | 1/11 [00:00<00:01,  7.77it/s]
Train    39:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.75it/s]
Train    39:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.89it/s]
Train    39:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.94it/s]
Train    39:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.92it/s]
Train    39:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.89it/s]
Train    39:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.92it/s]
Train    39:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.98it/s]
Train    39:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.93it/s]
Train    39:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.86it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.80it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.87it/s]
13 Oct 03:37    INFO  epoch 39 training [time: 1.40s, train loss: 11.0422]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.91it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.12it/s]
13 Oct 03:37    INFO  epoch 39 evaluating [time: 0.14s, valid_score: 0.859600]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.8837    mrr@5 : 0.8578    mrr@10 : 0.8596    ndcg@5 : 0.8608    ndcg@10 : 0.8653    hit@5 : 0.8697    hit@10 : 0.8837    precision@5 : 0.1739    precision@10 : 0.0884

Train    40:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    40:   9%|████▋                                              | 1/11 [00:00<00:01,  7.88it/s]
Train    40:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.96it/s]
Train    40:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  8.00it/s]
Train    40:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.02it/s]
Train    40:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.02it/s]
Train    40:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.87it/s]
Train    40:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.89it/s]
Train    40:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.89it/s]
Train    40:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.89it/s]
Train    40:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.93it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.01it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.95it/s]
13 Oct 03:37    INFO  epoch 40 training [time: 1.38s, train loss: 10.1116]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.59it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.22it/s]
13 Oct 03:37    INFO  epoch 40 evaluating [time: 0.15s, valid_score: 0.860800]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8706    recall@10 : 0.8842    mrr@5 : 0.859    mrr@10 : 0.8608    ndcg@5 : 0.8619    ndcg@10 : 0.8663    hit@5 : 0.8706    hit@10 : 0.8842    precision@5 : 0.1741    precision@10 : 0.0884
13 Oct 03:37    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    41:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    41:   9%|████▋                                              | 1/11 [00:00<00:01,  7.88it/s]
Train    41:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.93it/s]
Train    41:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.94it/s]
Train    41:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.92it/s]
Train    41:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.87it/s]
Train    41:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.83it/s]
Train    41:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.82it/s]
Train    41:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.80it/s]
Train    41:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.81it/s]
Train    41:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.81it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.84it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.85it/s]
13 Oct 03:37    INFO  epoch 41 training [time: 1.40s, train loss: 9.5977]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.11it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.41it/s]
13 Oct 03:37    INFO  epoch 41 evaluating [time: 0.17s, valid_score: 0.857700]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8805    mrr@5 : 0.8562    mrr@10 : 0.8577    ndcg@5 : 0.8597    ndcg@10 : 0.8631    hit@5 : 0.8701    hit@10 : 0.8805    precision@5 : 0.174    precision@10 : 0.0881

Train    42:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    42:   9%|████▋                                              | 1/11 [00:00<00:01,  7.53it/s]
Train    42:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.84it/s]
Train    42:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.78it/s]
Train    42:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.76it/s]
Train    42:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.89it/s]
Train    42:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.97it/s]
Train    42:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.98it/s]
Train    42:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.87it/s]
Train    42:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.91it/s]
Train    42:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.92it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.96it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.90it/s]
13 Oct 03:37    INFO  epoch 42 training [time: 1.39s, train loss: 10.2352]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.09it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.58it/s]
13 Oct 03:37    INFO  epoch 42 evaluating [time: 0.16s, valid_score: 0.856100]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8828    mrr@5 : 0.8541    mrr@10 : 0.8561    ndcg@5 : 0.8577    ndcg@10 : 0.8624    hit@5 : 0.8683    hit@10 : 0.8828    precision@5 : 0.1737    precision@10 : 0.0883

Train    43:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    43:   9%|████▋                                              | 1/11 [00:00<00:01,  7.81it/s]
Train    43:  18%|█████████▎                                         | 2/11 [00:00<00:01,  4.87it/s]
Train    43:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  5.93it/s]
Train    43:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.63it/s]
Train    43:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.05it/s]
Train    43:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.23it/s]
Train    43:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  7.39it/s]
Train    43:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.46it/s]
Train    43:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.51it/s]
Train    43:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.52it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.60it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.11it/s]
13 Oct 03:37    INFO  epoch 43 training [time: 1.55s, train loss: 10.5877]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.36it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.24it/s]
13 Oct 03:37    INFO  epoch 43 evaluating [time: 0.15s, valid_score: 0.858500]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8846    mrr@5 : 0.8565    mrr@10 : 0.8585    ndcg@5 : 0.8599    ndcg@10 : 0.8647    hit@5 : 0.8701    hit@10 : 0.8846    precision@5 : 0.174    precision@10 : 0.0885

Train    44:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    44:   9%|████▋                                              | 1/11 [00:00<00:01,  7.56it/s]
Train    44:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.68it/s]
Train    44:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.69it/s]
Train    44:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.77it/s]
Train    44:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.86it/s]
Train    44:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.93it/s]
Train    44:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.89it/s]
Train    44:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.81it/s]
Train    44:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.39it/s]
Train    44:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.91it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.55it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.27it/s]
13 Oct 03:37    INFO  epoch 44 training [time: 1.51s, train loss: 10.1106]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 10.49it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 13.46it/s]
13 Oct 03:37    INFO  epoch 44 evaluating [time: 0.25s, valid_score: 0.860300]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8747    recall@10 : 0.8882    mrr@5 : 0.8586    mrr@10 : 0.8603    ndcg@5 : 0.8625    ndcg@10 : 0.8668    hit@5 : 0.8747    hit@10 : 0.8882    precision@5 : 0.1749    precision@10 : 0.0888

Train    45:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    45:   9%|████▋                                              | 1/11 [00:00<00:01,  6.47it/s]
Train    45:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.41it/s]
Train    45:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.62it/s]
Train    45:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.82it/s]
Train    45:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.83it/s]
Train    45:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.90it/s]
Train    45:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.92it/s]
Train    45:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.98it/s]
Train    45:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.99it/s]
Train    45:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.95it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.45it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.68it/s]
13 Oct 03:37    INFO  epoch 45 training [time: 1.43s, train loss: 9.8360]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.02it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.81it/s]
13 Oct 03:37    INFO  epoch 45 evaluating [time: 0.18s, valid_score: 0.860300]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8715    recall@10 : 0.8837    mrr@5 : 0.8587    mrr@10 : 0.8603    ndcg@5 : 0.8619    ndcg@10 : 0.8658    hit@5 : 0.8715    hit@10 : 0.8837    precision@5 : 0.1743    precision@10 : 0.0884

Train    46:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    46:   9%|████▋                                              | 1/11 [00:00<00:01,  5.87it/s]
Train    46:  18%|█████████▎                                         | 2/11 [00:00<00:01,  6.67it/s]
Train    46:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.11it/s]
Train    46:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.26it/s]
Train    46:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.42it/s]
Train    46:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.62it/s]
Train    46:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.78it/s]
Train    46:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.83it/s]
Train    46:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.82it/s]
Train    46:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.84it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.96it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.60it/s]
13 Oct 03:37    INFO  epoch 46 training [time: 1.45s, train loss: 10.3990]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 12.85it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 17.77it/s]
13 Oct 03:37    INFO  epoch 46 evaluating [time: 0.19s, valid_score: 0.862000]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8724    recall@10 : 0.8828    mrr@5 : 0.8607    mrr@10 : 0.862    ndcg@5 : 0.8636    ndcg@10 : 0.8669    hit@5 : 0.8724    hit@10 : 0.8828    precision@5 : 0.1745    precision@10 : 0.0883
13 Oct 03:37    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Train    47:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    47:   9%|████▋                                              | 1/11 [00:00<00:01,  7.80it/s]
Train    47:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.84it/s]
Train    47:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.95it/s]
Train    47:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.00it/s]
Train    47:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.89it/s]
Train    47:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  5.64it/s]
Train    47:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  6.18it/s]
Train    47:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.60it/s]
Train    47:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.97it/s]
Train    47:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.16it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.20it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.04it/s]
13 Oct 03:37    INFO  epoch 47 training [time: 1.56s, train loss: 10.2382]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.09it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.69it/s]
13 Oct 03:37    INFO  epoch 47 evaluating [time: 0.16s, valid_score: 0.860400]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.8846    mrr@5 : 0.8586    mrr@10 : 0.8604    ndcg@5 : 0.8617    ndcg@10 : 0.8661    hit@5 : 0.871    hit@10 : 0.8846    precision@5 : 0.1742    precision@10 : 0.0885

Train    48:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    48:   9%|████▋                                              | 1/11 [00:00<00:01,  7.76it/s]
Train    48:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.82it/s]
Train    48:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.72it/s]
Train    48:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.18it/s]
Train    48:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.16it/s]
Train    48:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.39it/s]
Train    48:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.57it/s]
Train    48:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.70it/s]
Train    48:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.80it/s]
Train    48:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.87it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.85it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.65it/s]
13 Oct 03:37    INFO  epoch 48 training [time: 1.44s, train loss: 9.4924]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.41it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.30it/s]
13 Oct 03:37    INFO  epoch 48 evaluating [time: 0.15s, valid_score: 0.861200]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.8738    recall@10 : 0.8873    mrr@5 : 0.8594    mrr@10 : 0.8612    ndcg@5 : 0.863    ndcg@10 : 0.8674    hit@5 : 0.8738    hit@10 : 0.8873    precision@5 : 0.1748    precision@10 : 0.0887

Train    49:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    49:   9%|████▋                                              | 1/11 [00:00<00:01,  8.00it/s]
Train    49:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.02it/s]
Train    49:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.86it/s]
Train    49:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.92it/s]
Train    49:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.98it/s]
Train    49:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.02it/s]
Train    49:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.03it/s]
Train    49:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.06it/s]
Train    49:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.03it/s]
Train    49:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.01it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.93it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.97it/s]
13 Oct 03:37    INFO  epoch 49 training [time: 1.38s, train loss: 9.9048]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.21it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.79it/s]
13 Oct 03:37    INFO  epoch 49 evaluating [time: 0.15s, valid_score: 0.861300]
13 Oct 03:37    INFO  valid result: 
recall@5 : 0.876    recall@10 : 0.886    mrr@5 : 0.8599    mrr@10 : 0.8613    ndcg@5 : 0.8639    ndcg@10 : 0.8671    hit@5 : 0.876    hit@10 : 0.886    precision@5 : 0.1752    precision@10 : 0.0886
13 Oct 03:37    INFO  Loading model structure and parameters from saved/BERT4Rec-Oct-13-2025_03-36-22.pth

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.65it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.03it/s]
13 Oct 03:37    INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |    15.80 %     |
+-------------+----------------+
| GPU         |   0.0 / 0.0    |
+-------------+----------------+
| Memory      | 1.53 G/15.33 G |
+-------------+----------------+
13 Oct 03:37    INFO  best valid : OrderedDict({'recall@5': 0.8724, 'recall@10': 0.8828, 'mrr@5': 0.8607, 'mrr@10': 0.862, 'ndcg@5': 0.8636, 'ndcg@10': 0.8669, 'hit@5': 0.8724, 'hit@10': 0.8828, 'precision@5': 0.1745, 'precision@10': 0.0883})
13 Oct 03:37    INFO  test result: OrderedDict({'recall@5': 0.9787, 'recall@10': 0.9835, 'mrr@5': 0.9596, 'mrr@10': 0.9602, 'ndcg@5': 0.9645, 'ndcg@10': 0.966, 'hit@5': 0.9787, 'hit@10': 0.9835, 'precision@5': 0.1957, 'precision@10': 0.0983})
2025-10-13 03:37:44,048 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/versions/BERT4Rec-Oct-13-2025_03-24-47.pth
2025-10-13 03:37:44,049 | INFO | Published checkpoint /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/saved/BERT4Rec-Oct-13-2025_03-36-22.pth → /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/versions/BERT4Rec-Oct-13-2025_03-36-22.pth
2025-10-13 03:37:44,049 | INFO | Retraining completed in 0:01:26.701031 | dataset=20251012-203618 | model=Oct-13-2025_03-36-22
2025-10-13 03:38:14,050 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:38:14,821 | INFO | 🔄 Đang trích xuất data từ Postgres...
🐘 Đã trích xuất bằng psycopg.
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 69
Số user: 2
Số sản phẩm: 11
Các loại event: {'add_to_cart': 0.42, 'view': 0.377, 'purchase': 0.203}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[10 rows x 5 columns]
2025-10-13 03:38:14,821 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:38:15,334 | INFO | 🗂  Đã cập nhật /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/interactions.csv (tổng 18368 bản ghi).
✅ Đã tạo snapshot 20251012-203815 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-203815/ecommerce.inter) với 18368 dòng
👥  User: 2609 | 🛒  Sản phẩm: 106
🏷️   Nhãn mua hàng (label=1): 2995
      user_id item_id   timestamp  label
4952        3      25  1704067200      0
4953        3      25  1704068520      0
18272       3      89  1707264000      0
18273       3      89  1707264300      0
18274       3      89  1707265440      0
18275       3      89  1707266820      1
1123        3      12  1708041600      0
1124        3      12  1708044480      0
10396       4       4  1707436800      0
10397       4       4  1707437100      0
2025-10-13 03:38:15,336 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-202636
2025-10-13 03:38:15,336 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 03:39:41,589 | INFO | 13 Oct 03:38    INFO  ['train_bert4rec.py']
13 Oct 03:38    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = False
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
device = cuda
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 03:38    INFO  ecommerce
The number of users: 2608
Average actions of users: 7.045646336785578
The number of items: 96
Average actions of items: 193.34736842105264
The number of inters: 18368
The sparsity of the dataset: 92.66359918200409%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 03:38    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 03:38    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 03:38    INFO  BERT4Rec(
  (item_embedding): Embedding(97, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 113888
13 Oct 03:38    INFO  FLOPs: 5194664.0
🔧 Sử dụng topk=[5, 10], valid_metric=MRR@10, device=cpu

Train     0:   0%|                                                           | 0/11 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   9%|████▋                                              | 1/11 [00:00<00:02,  3.40it/s]
Train     0:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.18it/s]
Train     0:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.35it/s]
Train     0:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.21it/s]
Train     0:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.77it/s]
Train     0:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.11it/s]
Train     0:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.37it/s]
Train     0:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.45it/s]
Train     0:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.64it/s]
Train     0:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.65it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.74it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.69it/s]
13 Oct 03:38    INFO  epoch 0 training [time: 1.43s, train loss: 49.7594]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.07it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.03it/s]
13 Oct 03:38    INFO  epoch 0 evaluating [time: 0.15s, valid_score: 0.057500]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.0937    recall@10 : 0.1765    mrr@5 : 0.0466    mrr@10 : 0.0575    ndcg@5 : 0.0582    ndcg@10 : 0.0847    hit@5 : 0.0937    hit@10 : 0.1765    precision@5 : 0.0187    precision@10 : 0.0176
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train     1:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     1:   9%|████▋                                              | 1/11 [00:00<00:01,  8.04it/s]
Train     1:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.15it/s]
Train     1:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.19it/s]
Train     1:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.52it/s]
Train     1:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.79it/s]
Train     1:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.73it/s]
Train     1:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.74it/s]
Train     1:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.72it/s]
Train     1:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.83it/s]
Train     1:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.83it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.88it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.69it/s]
13 Oct 03:38    INFO  epoch 1 training [time: 1.27s, train loss: 48.9054]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.23it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.88it/s]
13 Oct 03:38    INFO  epoch 1 evaluating [time: 0.13s, valid_score: 0.078800]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.1348    recall@10 : 0.2118    mrr@5 : 0.0691    mrr@10 : 0.0788    ndcg@5 : 0.0853    ndcg@10 : 0.1096    hit@5 : 0.1348    hit@10 : 0.2118    precision@5 : 0.027    precision@10 : 0.0212
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train     2:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     2:   9%|████▋                                              | 1/11 [00:00<00:01,  9.01it/s]
Train     2:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.81it/s]
Train     2:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.57it/s]
Train     2:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.63it/s]
Train     2:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.04it/s]
Train     2:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.68it/s]
Train     2:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.98it/s]
Train     2:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.38it/s]
Train     2:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.73it/s]
Train     2:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.98it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.19it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.69it/s]
13 Oct 03:38    INFO  epoch 2 training [time: 1.43s, train loss: 46.8474]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.90it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.99it/s]
13 Oct 03:38    INFO  epoch 2 evaluating [time: 0.13s, valid_score: 0.351100]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.5244    recall@10 : 0.6136    mrr@5 : 0.3392    mrr@10 : 0.3511    ndcg@5 : 0.3855    ndcg@10 : 0.4144    hit@5 : 0.5244    hit@10 : 0.6136    precision@5 : 0.1049    precision@10 : 0.0614
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train     3:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     3:   9%|████▋                                              | 1/11 [00:00<00:01,  8.58it/s]
Train     3:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.72it/s]
Train     3:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.75it/s]
Train     3:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.82it/s]
Train     3:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.69it/s]
Train     3:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.34it/s]
Train     3:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.02it/s]
Train     3:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.05it/s]
Train     3:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.27it/s]
Train     3:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.37it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.56it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.45it/s]
13 Oct 03:38    INFO  epoch 3 training [time: 1.30s, train loss: 42.5084]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.73it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.09it/s]
13 Oct 03:38    INFO  epoch 3 evaluating [time: 0.13s, valid_score: 0.538900]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.6611    recall@10 : 0.7217    mrr@5 : 0.5306    mrr@10 : 0.5389    ndcg@5 : 0.5636    ndcg@10 : 0.5834    hit@5 : 0.6611    hit@10 : 0.7217    precision@5 : 0.1322    precision@10 : 0.0722
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train     4:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     4:   9%|████▋                                              | 1/11 [00:00<00:01,  8.62it/s]
Train     4:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.92it/s]
Train     4:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.71it/s]
Train     4:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.50it/s]
Train     4:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.45it/s]
Train     4:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.42it/s]
Train     4:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.44it/s]
Train     4:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.34it/s]
Train     4:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.50it/s]
Train     4:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.58it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.60it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.54it/s]
13 Oct 03:38    INFO  epoch 4 training [time: 1.29s, train loss: 38.5157]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.56it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.58it/s]
13 Oct 03:38    INFO  epoch 4 evaluating [time: 0.15s, valid_score: 0.577400]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.6937    recall@10 : 0.7443    mrr@5 : 0.5704    mrr@10 : 0.5774    ndcg@5 : 0.6016    ndcg@10 : 0.6183    hit@5 : 0.6937    hit@10 : 0.7443    precision@5 : 0.1387    precision@10 : 0.0744
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train     5:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     5:   9%|████▋                                              | 1/11 [00:00<00:01,  8.38it/s]
Train     5:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.44it/s]
Train     5:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.28it/s]
Train     5:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.24it/s]
Train     5:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.29it/s]
Train     5:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.42it/s]
Train     5:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.34it/s]
Train     5:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.06it/s]
Train     5:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.15it/s]
Train     5:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.20it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.30it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.27it/s]
13 Oct 03:38    INFO  epoch 5 training [time: 1.33s, train loss: 35.0609]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.02it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.49it/s]
13 Oct 03:38    INFO  epoch 5 evaluating [time: 0.15s, valid_score: 0.636100]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.7303    recall@10 : 0.7765    mrr@5 : 0.6301    mrr@10 : 0.6361    ndcg@5 : 0.6553    ndcg@10 : 0.6701    hit@5 : 0.7303    hit@10 : 0.7765    precision@5 : 0.1461    precision@10 : 0.0776
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train     6:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     6:   9%|████▋                                              | 1/11 [00:00<00:01,  8.38it/s]
Train     6:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.31it/s]
Train     6:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.32it/s]
Train     6:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.26it/s]
Train     6:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.23it/s]
Train     6:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  5.94it/s]
Train     6:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.62it/s]
Train     6:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.17it/s]
Train     6:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.49it/s]
Train     6:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.78it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.03it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.60it/s]
13 Oct 03:38    INFO  epoch 6 training [time: 1.45s, train loss: 31.5342]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.68it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.03it/s]
13 Oct 03:38    INFO  epoch 6 evaluating [time: 0.13s, valid_score: 0.688700]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.7548    recall@10 : 0.8023    mrr@5 : 0.6823    mrr@10 : 0.6887    ndcg@5 : 0.7006    ndcg@10 : 0.716    hit@5 : 0.7548    hit@10 : 0.8023    precision@5 : 0.151    precision@10 : 0.0802
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train     7:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     7:   9%|████▋                                              | 1/11 [00:00<00:01,  8.38it/s]
Train     7:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.23it/s]
Train     7:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.28it/s]
Train     7:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.28it/s]
Train     7:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.81it/s]
Train     7:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.93it/s]
Train     7:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.94it/s]
Train     7:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  7.97it/s]
Train     7:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.81it/s]
Train     7:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.87it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.98it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.99it/s]
13 Oct 03:38    INFO  epoch 7 training [time: 1.38s, train loss: 28.7599]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.69it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.15it/s]
13 Oct 03:38    INFO  epoch 7 evaluating [time: 0.16s, valid_score: 0.720300]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.7842    recall@10 : 0.8213    mrr@5 : 0.7153    mrr@10 : 0.7203    ndcg@5 : 0.7326    ndcg@10 : 0.7446    hit@5 : 0.7842    hit@10 : 0.8213    precision@5 : 0.1568    precision@10 : 0.0821
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train     8:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     8:   9%|████▋                                              | 1/11 [00:00<00:01,  8.79it/s]
Train     8:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.57it/s]
Train     8:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.62it/s]
Train     8:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.75it/s]
Train     8:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.79it/s]
Train     8:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.90it/s]
Train     8:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.79it/s]
Train     8:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.59it/s]
Train     8:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.41it/s]
Train     8:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.31it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.18it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.49it/s]
13 Oct 03:38    INFO  epoch 8 training [time: 1.30s, train loss: 25.9326]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.30it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.10it/s]
13 Oct 03:38    INFO  epoch 8 evaluating [time: 0.15s, valid_score: 0.747400]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.8041    recall@10 : 0.8339    mrr@5 : 0.7434    mrr@10 : 0.7474    ndcg@5 : 0.7586    ndcg@10 : 0.7683    hit@5 : 0.8041    hit@10 : 0.8339    precision@5 : 0.1608    precision@10 : 0.0834
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train     9:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     9:   9%|████▋                                              | 1/11 [00:00<00:01,  8.05it/s]
Train     9:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.09it/s]
Train     9:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.14it/s]
Train     9:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.27it/s]
Train     9:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.25it/s]
Train     9:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.35it/s]
Train     9:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.32it/s]
Train     9:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.21it/s]
Train     9:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.09it/s]
Train     9:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.97it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.95it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.11it/s]
13 Oct 03:38    INFO  epoch 9 training [time: 1.36s, train loss: 23.2385]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.33it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.90it/s]
13 Oct 03:38    INFO  epoch 9 evaluating [time: 0.16s, valid_score: 0.783100]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.829    recall@10 : 0.8529    mrr@5 : 0.7799    mrr@10 : 0.7831    ndcg@5 : 0.7923    ndcg@10 : 0.8    hit@5 : 0.829    hit@10 : 0.8529    precision@5 : 0.1658    precision@10 : 0.0853
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    10:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    10:   9%|████▋                                              | 1/11 [00:00<00:01,  7.88it/s]
Train    10:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.00it/s]
Train    10:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.17it/s]
Train    10:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.25it/s]
Train    10:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.33it/s]
Train    10:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.25it/s]
Train    10:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.19it/s]
Train    10:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.17it/s]
Train    10:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.19it/s]
Train    10:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.16it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.71it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.48it/s]
13 Oct 03:38    INFO  epoch 10 training [time: 1.47s, train loss: 20.9736]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.38it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.86it/s]
13 Oct 03:38    INFO  epoch 10 evaluating [time: 0.17s, valid_score: 0.809200]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.8385    recall@10 : 0.8579    mrr@5 : 0.8065    mrr@10 : 0.8092    ndcg@5 : 0.8145    ndcg@10 : 0.8209    hit@5 : 0.8385    hit@10 : 0.8579    precision@5 : 0.1677    precision@10 : 0.0858
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    11:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    11:   9%|████▋                                              | 1/11 [00:00<00:01,  8.88it/s]
Train    11:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.55it/s]
Train    11:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.65it/s]
Train    11:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.45it/s]
Train    11:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.13it/s]
Train    11:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.09it/s]
Train    11:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.04it/s]
Train    11:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.02it/s]
Train    11:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.99it/s]
Train    11:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.01it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.02it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
13 Oct 03:38    INFO  epoch 11 training [time: 1.35s, train loss: 19.1671]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.59it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.65it/s]
13 Oct 03:38    INFO  epoch 11 evaluating [time: 0.15s, valid_score: 0.820000]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.8448    recall@10 : 0.8665    mrr@5 : 0.8171    mrr@10 : 0.82    ndcg@5 : 0.8241    ndcg@10 : 0.8311    hit@5 : 0.8448    hit@10 : 0.8665    precision@5 : 0.169    precision@10 : 0.0867
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    12:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    12:   9%|████▋                                              | 1/11 [00:00<00:01,  7.71it/s]
Train    12:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.95it/s]
Train    12:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.86it/s]
Train    12:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.08it/s]
Train    12:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.10it/s]
Train    12:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.22it/s]
Train    12:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.26it/s]
Train    12:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.30it/s]
Train    12:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.27it/s]
Train    12:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.29it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.32it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.20it/s]
13 Oct 03:38    INFO  epoch 12 training [time: 1.34s, train loss: 17.4560]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.32it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.75it/s]
13 Oct 03:38    INFO  epoch 12 evaluating [time: 0.13s, valid_score: 0.829300]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.8475    recall@10 : 0.8679    mrr@5 : 0.8265    mrr@10 : 0.8293    ndcg@5 : 0.8318    ndcg@10 : 0.8384    hit@5 : 0.8475    hit@10 : 0.8679    precision@5 : 0.1695    precision@10 : 0.0868
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    13:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    13:   9%|████▋                                              | 1/11 [00:00<00:01,  8.51it/s]
Train    13:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.64it/s]
Train    13:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.58it/s]
Train    13:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.47it/s]
Train    13:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.16it/s]
Train    13:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.09it/s]
Train    13:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.10it/s]
Train    13:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.02it/s]
Train    13:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.97it/s]
Train    13:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.96it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.96it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.12it/s]
13 Oct 03:38    INFO  epoch 13 training [time: 1.36s, train loss: 16.1932]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.37it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.75it/s]
13 Oct 03:38    INFO  epoch 13 evaluating [time: 0.15s, valid_score: 0.835100]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.8534    recall@10 : 0.8719    mrr@5 : 0.8326    mrr@10 : 0.8351    ndcg@5 : 0.8378    ndcg@10 : 0.8438    hit@5 : 0.8534    hit@10 : 0.8719    precision@5 : 0.1707    precision@10 : 0.0872
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    14:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    14:   9%|████▋                                              | 1/11 [00:00<00:01,  8.30it/s]
Train    14:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.34it/s]
Train    14:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.42it/s]
Train    14:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.26it/s]
Train    14:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.20it/s]
Train    14:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.26it/s]
Train    14:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.12it/s]
Train    14:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  7.88it/s]
Train    14:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.94it/s]
Train    14:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.04it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.15it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
13 Oct 03:38    INFO  epoch 14 training [time: 1.35s, train loss: 15.6198]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  5.35it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 11.51it/s]
13 Oct 03:38    INFO  epoch 14 evaluating [time: 0.27s, valid_score: 0.841300]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.857    recall@10 : 0.8742    mrr@5 : 0.8391    mrr@10 : 0.8413    ndcg@5 : 0.8436    ndcg@10 : 0.8491    hit@5 : 0.857    hit@10 : 0.8742    precision@5 : 0.1714    precision@10 : 0.0874
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    15:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    15:   9%|████▋                                              | 1/11 [00:00<00:01,  8.43it/s]
Train    15:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.43it/s]
Train    15:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.44it/s]
Train    15:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.34it/s]
Train    15:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.36it/s]
Train    15:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.23it/s]
Train    15:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.18it/s]
Train    15:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.04it/s]
Train    15:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.05it/s]
Train    15:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.03it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.07it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.17it/s]
13 Oct 03:38    INFO  epoch 15 training [time: 1.35s, train loss: 13.9309]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.98it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.15it/s]
13 Oct 03:38    INFO  epoch 15 evaluating [time: 0.17s, valid_score: 0.845200]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.8588    recall@10 : 0.8742    mrr@5 : 0.8432    mrr@10 : 0.8452    ndcg@5 : 0.8471    ndcg@10 : 0.852    hit@5 : 0.8588    hit@10 : 0.8742    precision@5 : 0.1718    precision@10 : 0.0874
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    16:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    16:   9%|████▋                                              | 1/11 [00:00<00:01,  8.26it/s]
Train    16:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.12it/s]
Train    16:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.16it/s]
Train    16:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.18it/s]
Train    16:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.11it/s]
Train    16:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.98it/s]
Train    16:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.94it/s]
Train    16:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  7.94it/s]
Train    16:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.87it/s]
Train    16:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.84it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.94it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.99it/s]
13 Oct 03:38    INFO  epoch 16 training [time: 1.38s, train loss: 13.4300]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.86it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.86it/s]
13 Oct 03:38    INFO  epoch 16 evaluating [time: 0.14s, valid_score: 0.844100]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.8575    recall@10 : 0.8765    mrr@5 : 0.8416    mrr@10 : 0.8441    ndcg@5 : 0.8456    ndcg@10 : 0.8517    hit@5 : 0.8575    hit@10 : 0.8765    precision@5 : 0.1715    precision@10 : 0.0876

Train    17:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    17:   9%|████▋                                              | 1/11 [00:00<00:01,  8.26it/s]
Train    17:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.00it/s]
Train    17:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.10it/s]
Train    17:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.14it/s]
Train    17:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.12it/s]
Train    17:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.99it/s]
Train    17:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.03it/s]
Train    17:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.06it/s]
Train    17:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.06it/s]
Train    17:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.02it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.85it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.00it/s]
13 Oct 03:38    INFO  epoch 17 training [time: 1.38s, train loss: 13.0804]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.75it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.72it/s]
13 Oct 03:38    INFO  epoch 17 evaluating [time: 0.14s, valid_score: 0.846200]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.8597    recall@10 : 0.8751    mrr@5 : 0.8443    mrr@10 : 0.8462    ndcg@5 : 0.8481    ndcg@10 : 0.853    hit@5 : 0.8597    hit@10 : 0.8751    precision@5 : 0.1719    precision@10 : 0.0875
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    18:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    18:   9%|████▋                                              | 1/11 [00:00<00:01,  8.19it/s]
Train    18:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.26it/s]
Train    18:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.34it/s]
Train    18:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.30it/s]
Train    18:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.25it/s]
Train    18:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.18it/s]
Train    18:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  5.91it/s]
Train    18:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.55it/s]
Train    18:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.01it/s]
Train    18:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.36it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.65it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.47it/s]
13 Oct 03:38    INFO  epoch 18 training [time: 1.47s, train loss: 13.4371]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.47it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.99it/s]
13 Oct 03:38    INFO  epoch 18 evaluating [time: 0.17s, valid_score: 0.852200]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.8647    recall@10 : 0.8769    mrr@5 : 0.8507    mrr@10 : 0.8522    ndcg@5 : 0.8542    ndcg@10 : 0.8581    hit@5 : 0.8647    hit@10 : 0.8769    precision@5 : 0.1729    precision@10 : 0.0877
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    19:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    19:   9%|████▋                                              | 1/11 [00:00<00:01,  8.31it/s]
Train    19:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.07it/s]
Train    19:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.07it/s]
Train    19:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.07it/s]
Train    19:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.04it/s]
Train    19:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.06it/s]
Train    19:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.11it/s]
Train    19:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.12it/s]
Train    19:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.12it/s]
Train    19:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.69it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.27it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.79it/s]
13 Oct 03:38    INFO  epoch 19 training [time: 1.41s, train loss: 13.0179]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.45it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.66it/s]
13 Oct 03:38    INFO  epoch 19 evaluating [time: 0.14s, valid_score: 0.851000]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.8638    recall@10 : 0.8778    mrr@5 : 0.8492    mrr@10 : 0.851    ndcg@5 : 0.8529    ndcg@10 : 0.8574    hit@5 : 0.8638    hit@10 : 0.8778    precision@5 : 0.1728    precision@10 : 0.0878

Train    20:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    20:   9%|████▋                                              | 1/11 [00:00<00:01,  8.07it/s]
Train    20:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.21it/s]
Train    20:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.94it/s]
Train    20:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.93it/s]
Train    20:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.87it/s]
Train    20:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.90it/s]
Train    20:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.91it/s]
Train    20:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.80it/s]
Train    20:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.89it/s]
Train    20:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.91it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.01it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.94it/s]
13 Oct 03:38    INFO  epoch 20 training [time: 1.39s, train loss: 12.5615]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.75it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.35it/s]
13 Oct 03:38    INFO  epoch 20 evaluating [time: 0.15s, valid_score: 0.852700]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.867    recall@10 : 0.8778    mrr@5 : 0.8513    mrr@10 : 0.8527    ndcg@5 : 0.8552    ndcg@10 : 0.8587    hit@5 : 0.867    hit@10 : 0.8778    precision@5 : 0.1734    precision@10 : 0.0878
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    21:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    21:   9%|████▋                                              | 1/11 [00:00<00:01,  7.39it/s]
Train    21:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.74it/s]
Train    21:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.95it/s]
Train    21:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.09it/s]
Train    21:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.20it/s]
Train    21:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.25it/s]
Train    21:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.30it/s]
Train    21:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.26it/s]
Train    21:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.30it/s]
Train    21:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.25it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.25it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.17it/s]
13 Oct 03:38    INFO  epoch 21 training [time: 1.35s, train loss: 11.9438]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.89it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.24it/s]
13 Oct 03:38    INFO  epoch 21 evaluating [time: 0.16s, valid_score: 0.853200]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.8661    recall@10 : 0.8796    mrr@5 : 0.8515    mrr@10 : 0.8532    ndcg@5 : 0.8552    ndcg@10 : 0.8595    hit@5 : 0.8661    hit@10 : 0.8796    precision@5 : 0.1732    precision@10 : 0.088
13 Oct 03:38    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    22:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    22:   9%|████▋                                              | 1/11 [00:00<00:01,  8.28it/s]
Train    22:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.31it/s]
Train    22:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.27it/s]
Train    22:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.20it/s]
Train    22:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.15it/s]
Train    22:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.01it/s]
Train    22:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.55it/s]
Train    22:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.93it/s]
Train    22:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.24it/s]
Train    22:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.38it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.60it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.39it/s]
13 Oct 03:38    INFO  epoch 22 training [time: 1.49s, train loss: 11.5617]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.93it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.18it/s]
13 Oct 03:38    INFO  epoch 22 evaluating [time: 0.14s, valid_score: 0.852400]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.8652    recall@10 : 0.8783    mrr@5 : 0.8506    mrr@10 : 0.8524    ndcg@5 : 0.8543    ndcg@10 : 0.8586    hit@5 : 0.8652    hit@10 : 0.8783    precision@5 : 0.173    precision@10 : 0.0878

Train    23:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    23:   9%|████▋                                              | 1/11 [00:00<00:01,  8.14it/s]
Train    23:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.94it/s]
Train    23:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.91it/s]
Train    23:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.86it/s]
Train    23:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.70it/s]
Train    23:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.58it/s]
Train    23:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.65it/s]
Train    23:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.68it/s]
Train    23:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.72it/s]
Train    23:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.76it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.83it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.77it/s]
13 Oct 03:38    INFO  epoch 23 training [time: 1.42s, train loss: 11.4483]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.44it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.25it/s]
13 Oct 03:38    INFO  epoch 23 evaluating [time: 0.18s, valid_score: 0.850200]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.8652    recall@10 : 0.8792    mrr@5 : 0.8483    mrr@10 : 0.8502    ndcg@5 : 0.8525    ndcg@10 : 0.857    hit@5 : 0.8652    hit@10 : 0.8792    precision@5 : 0.173    precision@10 : 0.0879

Train    24:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    24:   9%|████▋                                              | 1/11 [00:00<00:01,  7.46it/s]
Train    24:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.77it/s]
Train    24:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.91it/s]
Train    24:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.93it/s]
Train    24:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.94it/s]
Train    24:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.93it/s]
Train    24:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.00it/s]
Train    24:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.07it/s]
Train    24:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.07it/s]
Train    24:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.01it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.91it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.94it/s]
13 Oct 03:38    INFO  epoch 24 training [time: 1.39s, train loss: 11.3786]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.69it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.17it/s]
13 Oct 03:38    INFO  epoch 24 evaluating [time: 0.16s, valid_score: 0.852300]
13 Oct 03:38    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8792    mrr@5 : 0.8508    mrr@10 : 0.8523    ndcg@5 : 0.8552    ndcg@10 : 0.8587    hit@5 : 0.8683    hit@10 : 0.8792    precision@5 : 0.1737    precision@10 : 0.0879

Train    25:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    25:   9%|████▋                                              | 1/11 [00:00<00:01,  8.32it/s]
Train    25:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.15it/s]
Train    25:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.97it/s]
Train    25:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.99it/s]
Train    25:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.05it/s]
Train    25:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.07it/s]
Train    25:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.01it/s]
Train    25:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.04it/s]
Train    25:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.05it/s]
Train    25:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.03it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.98it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.03it/s]
13 Oct 03:39    INFO  epoch 25 training [time: 1.37s, train loss: 11.9237]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.20it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.18it/s]
13 Oct 03:39    INFO  epoch 25 evaluating [time: 0.17s, valid_score: 0.852800]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8674    recall@10 : 0.8778    mrr@5 : 0.8513    mrr@10 : 0.8528    ndcg@5 : 0.8553    ndcg@10 : 0.8588    hit@5 : 0.8674    hit@10 : 0.8778    precision@5 : 0.1735    precision@10 : 0.0878

Train    26:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    26:   9%|████▋                                              | 1/11 [00:00<00:01,  8.01it/s]
Train    26:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.93it/s]
Train    26:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.81it/s]
Train    26:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.76it/s]
Train    26:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.85it/s]
Train    26:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.88it/s]
Train    26:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.75it/s]
Train    26:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.79it/s]
Train    26:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.80it/s]
Train    26:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  5.92it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.51it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.19it/s]
13 Oct 03:39    INFO  epoch 26 training [time: 1.53s, train loss: 11.2112]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.89it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.84it/s]
13 Oct 03:39    INFO  epoch 26 evaluating [time: 0.14s, valid_score: 0.854300]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8729    recall@10 : 0.8801    mrr@5 : 0.8534    mrr@10 : 0.8543    ndcg@5 : 0.8583    ndcg@10 : 0.8606    hit@5 : 0.8729    hit@10 : 0.8801    precision@5 : 0.1746    precision@10 : 0.088
13 Oct 03:39    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    27:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    27:   9%|████▋                                              | 1/11 [00:00<00:01,  8.25it/s]
Train    27:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.13it/s]
Train    27:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.02it/s]
Train    27:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.94it/s]
Train    27:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.93it/s]
Train    27:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.88it/s]
Train    27:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.82it/s]
Train    27:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.90it/s]
Train    27:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.93it/s]
Train    27:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.82it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.80it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.89it/s]
13 Oct 03:39    INFO  epoch 27 training [time: 1.40s, train loss: 11.0132]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.19it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.61it/s]
13 Oct 03:39    INFO  epoch 27 evaluating [time: 0.15s, valid_score: 0.854500]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8792    mrr@5 : 0.853    mrr@10 : 0.8545    ndcg@5 : 0.8569    ndcg@10 : 0.8604    hit@5 : 0.8683    hit@10 : 0.8792    precision@5 : 0.1737    precision@10 : 0.0879
13 Oct 03:39    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    28:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    28:   9%|████▋                                              | 1/11 [00:00<00:01,  8.21it/s]
Train    28:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.11it/s]
Train    28:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.97it/s]
Train    28:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.92it/s]
Train    28:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.99it/s]
Train    28:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.01it/s]
Train    28:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.98it/s]
Train    28:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.83it/s]
Train    28:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.89it/s]
Train    28:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.89it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.89it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.93it/s]
13 Oct 03:39    INFO  epoch 28 training [time: 1.39s, train loss: 11.1068]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.91it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.42it/s]
13 Oct 03:39    INFO  epoch 28 evaluating [time: 0.16s, valid_score: 0.854200]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.8805    mrr@5 : 0.8528    mrr@10 : 0.8542    ndcg@5 : 0.8571    ndcg@10 : 0.8605    hit@5 : 0.8697    hit@10 : 0.8805    precision@5 : 0.1739    precision@10 : 0.0881

Train    29:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    29:   9%|████▋                                              | 1/11 [00:00<00:01,  8.10it/s]
Train    29:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.26it/s]
Train    29:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.24it/s]
Train    29:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.17it/s]
Train    29:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.08it/s]
Train    29:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.12it/s]
Train    29:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.13it/s]
Train    29:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.11it/s]
Train    29:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.10it/s]
Train    29:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.00it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.88it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.04it/s]
13 Oct 03:39    INFO  epoch 29 training [time: 1.37s, train loss: 11.8484]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.38it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.54it/s]
13 Oct 03:39    INFO  epoch 29 evaluating [time: 0.14s, valid_score: 0.855100]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8692    recall@10 : 0.8783    mrr@5 : 0.8539    mrr@10 : 0.8551    ndcg@5 : 0.8578    ndcg@10 : 0.8607    hit@5 : 0.8692    hit@10 : 0.8783    precision@5 : 0.1738    precision@10 : 0.0878
13 Oct 03:39    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    30:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    30:   9%|████▋                                              | 1/11 [00:00<00:01,  8.02it/s]
Train    30:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.87it/s]
Train    30:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.89it/s]
Train    30:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.74it/s]
Train    30:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.71it/s]
Train    30:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.73it/s]
Train    30:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.59it/s]
Train    30:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  5.70it/s]
Train    30:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.29it/s]
Train    30:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.69it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.07it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.09it/s]
13 Oct 03:39    INFO  epoch 30 training [time: 1.55s, train loss: 10.8367]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.70it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.04it/s]
13 Oct 03:39    INFO  epoch 30 evaluating [time: 0.17s, valid_score: 0.856100]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8706    recall@10 : 0.8787    mrr@5 : 0.855    mrr@10 : 0.8561    ndcg@5 : 0.8589    ndcg@10 : 0.8616    hit@5 : 0.8706    hit@10 : 0.8787    precision@5 : 0.1741    precision@10 : 0.0879
13 Oct 03:39    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    31:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    31:   9%|████▋                                              | 1/11 [00:00<00:01,  8.08it/s]
Train    31:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.58it/s]
Train    31:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.73it/s]
Train    31:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.58it/s]
Train    31:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.73it/s]
Train    31:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.81it/s]
Train    31:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.82it/s]
Train    31:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.77it/s]
Train    31:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.73it/s]
Train    31:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.70it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.71it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.73it/s]
13 Oct 03:39    INFO  epoch 31 training [time: 1.43s, train loss: 11.6070]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 12.96it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 17.25it/s]
13 Oct 03:39    INFO  epoch 31 evaluating [time: 0.20s, valid_score: 0.856900]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.881    mrr@5 : 0.8553    mrr@10 : 0.8569    ndcg@5 : 0.859    ndcg@10 : 0.8626    hit@5 : 0.8697    hit@10 : 0.881    precision@5 : 0.1739    precision@10 : 0.0881
13 Oct 03:39    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    32:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    32:   9%|████▋                                              | 1/11 [00:00<00:01,  6.91it/s]
Train    32:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.48it/s]
Train    32:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.74it/s]
Train    32:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.94it/s]
Train    32:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.96it/s]
Train    32:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.97it/s]
Train    32:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.94it/s]
Train    32:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.96it/s]
Train    32:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.92it/s]
Train    32:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.80it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.81it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.82it/s]
13 Oct 03:39    INFO  epoch 32 training [time: 1.41s, train loss: 11.3697]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.28it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.15it/s]
13 Oct 03:39    INFO  epoch 32 evaluating [time: 0.14s, valid_score: 0.858500]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.881    mrr@5 : 0.8572    mrr@10 : 0.8585    ndcg@5 : 0.8606    ndcg@10 : 0.8638    hit@5 : 0.871    hit@10 : 0.881    precision@5 : 0.1742    precision@10 : 0.0881
13 Oct 03:39    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    33:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    33:   9%|████▋                                              | 1/11 [00:00<00:01,  7.72it/s]
Train    33:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.87it/s]
Train    33:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.83it/s]
Train    33:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.88it/s]
Train    33:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.90it/s]
Train    33:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.89it/s]
Train    33:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.83it/s]
Train    33:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.90it/s]
Train    33:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.84it/s]
Train    33:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.72it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.63it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.78it/s]
13 Oct 03:39    INFO  epoch 33 training [time: 1.42s, train loss: 11.1416]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.77it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.82it/s]
13 Oct 03:39    INFO  epoch 33 evaluating [time: 0.15s, valid_score: 0.860300]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8719    recall@10 : 0.8778    mrr@5 : 0.8595    mrr@10 : 0.8603    ndcg@5 : 0.8626    ndcg@10 : 0.8646    hit@5 : 0.8719    hit@10 : 0.8778    precision@5 : 0.1744    precision@10 : 0.0878
13 Oct 03:39    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    34:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    34:   9%|████▋                                              | 1/11 [00:00<00:01,  7.70it/s]
Train    34:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.82it/s]
Train    34:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.91it/s]
Train    34:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.87it/s]
Train    34:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.84it/s]
Train    34:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.87it/s]
Train    34:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.89it/s]
Train    34:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.89it/s]
Train    34:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.92it/s]
Train    34:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.08it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.60it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.27it/s]
13 Oct 03:39    INFO  epoch 34 training [time: 1.51s, train loss: 9.8315]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.51it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.60it/s]
13 Oct 03:39    INFO  epoch 34 evaluating [time: 0.14s, valid_score: 0.858700]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8828    mrr@5 : 0.857    mrr@10 : 0.8587    ndcg@5 : 0.8604    ndcg@10 : 0.8644    hit@5 : 0.8701    hit@10 : 0.8828    precision@5 : 0.174    precision@10 : 0.0883

Train    35:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    35:   9%|████▋                                              | 1/11 [00:00<00:01,  8.26it/s]
Train    35:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.30it/s]
Train    35:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.27it/s]
Train    35:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.22it/s]
Train    35:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.17it/s]
Train    35:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.19it/s]
Train    35:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.20it/s]
Train    35:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.16it/s]
Train    35:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.03it/s]
Train    35:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.98it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.94it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.09it/s]
13 Oct 03:39    INFO  epoch 35 training [time: 1.36s, train loss: 10.2343]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.16it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.66it/s]
13 Oct 03:39    INFO  epoch 35 evaluating [time: 0.16s, valid_score: 0.856900]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.881    mrr@5 : 0.8552    mrr@10 : 0.8569    ndcg@5 : 0.8585    ndcg@10 : 0.8626    hit@5 : 0.8683    hit@10 : 0.881    precision@5 : 0.1737    precision@10 : 0.0881

Train    36:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    36:   9%|████▋                                              | 1/11 [00:00<00:01,  8.08it/s]
Train    36:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.08it/s]
Train    36:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.97it/s]
Train    36:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.89it/s]
Train    36:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.80it/s]
Train    36:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.92it/s]
Train    36:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.98it/s]
Train    36:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.03it/s]
Train    36:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.97it/s]
Train    36:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.74it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.04it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.64it/s]
13 Oct 03:39    INFO  epoch 36 training [time: 1.44s, train loss: 9.8023]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.98it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.56it/s]
13 Oct 03:39    INFO  epoch 36 evaluating [time: 0.15s, valid_score: 0.855700]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.881    mrr@5 : 0.8544    mrr@10 : 0.8557    ndcg@5 : 0.8586    ndcg@10 : 0.8618    hit@5 : 0.871    hit@10 : 0.881    precision@5 : 0.1742    precision@10 : 0.0881

Train    37:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    37:   9%|████▋                                              | 1/11 [00:00<00:01,  7.52it/s]
Train    37:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.44it/s]
Train    37:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.69it/s]
Train    37:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.71it/s]
Train    37:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.66it/s]
Train    37:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.03it/s]
Train    37:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.28it/s]
Train    37:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.47it/s]
Train    37:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.56it/s]
Train    37:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.72it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.75it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.57it/s]
13 Oct 03:39    INFO  epoch 37 training [time: 1.45s, train loss: 10.7128]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.55it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.13it/s]
13 Oct 03:39    INFO  epoch 37 evaluating [time: 0.16s, valid_score: 0.855300]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8674    recall@10 : 0.8796    mrr@5 : 0.8538    mrr@10 : 0.8553    ndcg@5 : 0.8572    ndcg@10 : 0.8611    hit@5 : 0.8674    hit@10 : 0.8796    precision@5 : 0.1735    precision@10 : 0.088

Train    38:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    38:   9%|████▋                                              | 1/11 [00:00<00:01,  7.64it/s]
Train    38:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.00it/s]
Train    38:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.06it/s]
Train    38:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.01it/s]
Train    38:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.06it/s]
Train    38:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.03it/s]
Train    38:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.03it/s]
Train    38:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.07it/s]
Train    38:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.51it/s]
Train    38:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.83it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.13it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.28it/s]
13 Oct 03:39    INFO  epoch 38 training [time: 1.51s, train loss: 10.7494]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.07it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.72it/s]
13 Oct 03:39    INFO  epoch 38 evaluating [time: 0.15s, valid_score: 0.859300]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8719    recall@10 : 0.8837    mrr@5 : 0.8576    mrr@10 : 0.8593    ndcg@5 : 0.8612    ndcg@10 : 0.8651    hit@5 : 0.8719    hit@10 : 0.8837    precision@5 : 0.1744    precision@10 : 0.0884

Train    39:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    39:   9%|████▋                                              | 1/11 [00:00<00:01,  5.65it/s]
Train    39:  18%|█████████▎                                         | 2/11 [00:00<00:01,  6.73it/s]
Train    39:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.22it/s]
Train    39:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.45it/s]
Train    39:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.54it/s]
Train    39:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.51it/s]
Train    39:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.51it/s]
Train    39:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.63it/s]
Train    39:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.71it/s]
Train    39:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.62it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.69it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.47it/s]
13 Oct 03:39    INFO  epoch 39 training [time: 1.47s, train loss: 11.0422]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.98it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.53it/s]
13 Oct 03:39    INFO  epoch 39 evaluating [time: 0.16s, valid_score: 0.859600]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.8837    mrr@5 : 0.8578    mrr@10 : 0.8596    ndcg@5 : 0.8608    ndcg@10 : 0.8653    hit@5 : 0.8697    hit@10 : 0.8837    precision@5 : 0.1739    precision@10 : 0.0884

Train    40:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    40:   9%|████▋                                              | 1/11 [00:00<00:01,  7.39it/s]
Train    40:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.62it/s]
Train    40:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.52it/s]
Train    40:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.47it/s]
Train    40:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.66it/s]
Train    40:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.72it/s]
Train    40:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.80it/s]
Train    40:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.79it/s]
Train    40:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.84it/s]
Train    40:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.77it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.82it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.73it/s]
13 Oct 03:39    INFO  epoch 40 training [time: 1.42s, train loss: 10.1116]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.02it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.38it/s]
13 Oct 03:39    INFO  epoch 40 evaluating [time: 0.16s, valid_score: 0.860800]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8706    recall@10 : 0.8842    mrr@5 : 0.859    mrr@10 : 0.8608    ndcg@5 : 0.8619    ndcg@10 : 0.8663    hit@5 : 0.8706    hit@10 : 0.8842    precision@5 : 0.1741    precision@10 : 0.0884
13 Oct 03:39    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    41:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    41:   9%|████▋                                              | 1/11 [00:00<00:01,  7.78it/s]
Train    41:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.96it/s]
Train    41:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.99it/s]
Train    41:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.94it/s]
Train    41:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.97it/s]
Train    41:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.93it/s]
Train    41:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.99it/s]
Train    41:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.00it/s]
Train    41:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.96it/s]
Train    41:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.84it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.92it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.93it/s]
13 Oct 03:39    INFO  epoch 41 training [time: 1.39s, train loss: 9.5977]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.58it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.27it/s]
13 Oct 03:39    INFO  epoch 41 evaluating [time: 0.18s, valid_score: 0.857700]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8805    mrr@5 : 0.8562    mrr@10 : 0.8577    ndcg@5 : 0.8597    ndcg@10 : 0.8631    hit@5 : 0.8701    hit@10 : 0.8805    precision@5 : 0.174    precision@10 : 0.0881

Train    42:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    42:   9%|████▋                                              | 1/11 [00:00<00:01,  7.85it/s]
Train    42:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.90it/s]
Train    42:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.85it/s]
Train    42:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.93it/s]
Train    42:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.95it/s]
Train    42:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.93it/s]
Train    42:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.93it/s]
Train    42:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.94it/s]
Train    42:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.96it/s]
Train    42:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.91it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.87it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.91it/s]
13 Oct 03:39    INFO  epoch 42 training [time: 1.39s, train loss: 10.2352]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.97it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.84it/s]
13 Oct 03:39    INFO  epoch 42 evaluating [time: 0.15s, valid_score: 0.856100]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8828    mrr@5 : 0.8541    mrr@10 : 0.8561    ndcg@5 : 0.8577    ndcg@10 : 0.8624    hit@5 : 0.8683    hit@10 : 0.8828    precision@5 : 0.1737    precision@10 : 0.0883

Train    43:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    43:   9%|████▋                                              | 1/11 [00:00<00:01,  7.81it/s]
Train    43:  18%|█████████▎                                         | 2/11 [00:00<00:01,  4.72it/s]
Train    43:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  5.80it/s]
Train    43:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.40it/s]
Train    43:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  6.63it/s]
Train    43:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.84it/s]
Train    43:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  7.07it/s]
Train    43:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.23it/s]
Train    43:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.40it/s]
Train    43:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.50it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.71it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.98it/s]
13 Oct 03:39    INFO  epoch 43 training [time: 1.58s, train loss: 10.5877]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.17it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.43it/s]
13 Oct 03:39    INFO  epoch 43 evaluating [time: 0.13s, valid_score: 0.858500]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8846    mrr@5 : 0.8565    mrr@10 : 0.8585    ndcg@5 : 0.8599    ndcg@10 : 0.8647    hit@5 : 0.8701    hit@10 : 0.8846    precision@5 : 0.174    precision@10 : 0.0885

Train    44:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    44:   9%|████▋                                              | 1/11 [00:00<00:01,  7.55it/s]
Train    44:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.83it/s]
Train    44:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.78it/s]
Train    44:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.88it/s]
Train    44:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.85it/s]
Train    44:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.78it/s]
Train    44:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.81it/s]
Train    44:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.74it/s]
Train    44:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.66it/s]
Train    44:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.68it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.66it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.73it/s]
13 Oct 03:39    INFO  epoch 44 training [time: 1.42s, train loss: 10.1106]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.05it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.36it/s]
13 Oct 03:39    INFO  epoch 44 evaluating [time: 0.14s, valid_score: 0.860300]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8747    recall@10 : 0.8882    mrr@5 : 0.8586    mrr@10 : 0.8603    ndcg@5 : 0.8625    ndcg@10 : 0.8668    hit@5 : 0.8747    hit@10 : 0.8882    precision@5 : 0.1749    precision@10 : 0.0888

Train    45:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    45:   9%|████▋                                              | 1/11 [00:00<00:01,  7.91it/s]
Train    45:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.95it/s]
Train    45:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.94it/s]
Train    45:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.90it/s]
Train    45:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.87it/s]
Train    45:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.92it/s]
Train    45:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.87it/s]
Train    45:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.94it/s]
Train    45:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.96it/s]
Train    45:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.97it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.99it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.94it/s]
13 Oct 03:39    INFO  epoch 45 training [time: 1.39s, train loss: 9.8360]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.08it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.12it/s]
13 Oct 03:39    INFO  epoch 45 evaluating [time: 0.14s, valid_score: 0.860300]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8715    recall@10 : 0.8837    mrr@5 : 0.8587    mrr@10 : 0.8603    ndcg@5 : 0.8619    ndcg@10 : 0.8658    hit@5 : 0.8715    hit@10 : 0.8837    precision@5 : 0.1743    precision@10 : 0.0884

Train    46:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    46:   9%|████▋                                              | 1/11 [00:00<00:01,  7.92it/s]
Train    46:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.99it/s]
Train    46:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.99it/s]
Train    46:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.88it/s]
Train    46:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.88it/s]
Train    46:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.80it/s]
Train    46:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.73it/s]
Train    46:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.59it/s]
Train    46:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.53it/s]
Train    46:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.67it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.79it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.77it/s]
13 Oct 03:39    INFO  epoch 46 training [time: 1.42s, train loss: 10.3990]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.49it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.93it/s]
13 Oct 03:39    INFO  epoch 46 evaluating [time: 0.16s, valid_score: 0.862000]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8724    recall@10 : 0.8828    mrr@5 : 0.8607    mrr@10 : 0.862    ndcg@5 : 0.8636    ndcg@10 : 0.8669    hit@5 : 0.8724    hit@10 : 0.8828    precision@5 : 0.1745    precision@10 : 0.0883
13 Oct 03:39    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Train    47:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    47:   9%|████▋                                              | 1/11 [00:00<00:01,  7.59it/s]
Train    47:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.74it/s]
Train    47:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.83it/s]
Train    47:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.91it/s]
Train    47:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.90it/s]
Train    47:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  5.83it/s]
Train    47:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  6.36it/s]
Train    47:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.67it/s]
Train    47:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.92it/s]
Train    47:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.19it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.42it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.13it/s]
13 Oct 03:39    INFO  epoch 47 training [time: 1.54s, train loss: 10.2382]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.31it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.53it/s]
13 Oct 03:39    INFO  epoch 47 evaluating [time: 0.15s, valid_score: 0.860400]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.8846    mrr@5 : 0.8586    mrr@10 : 0.8604    ndcg@5 : 0.8617    ndcg@10 : 0.8661    hit@5 : 0.871    hit@10 : 0.8846    precision@5 : 0.1742    precision@10 : 0.0885

Train    48:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    48:   9%|████▋                                              | 1/11 [00:00<00:01,  7.97it/s]
Train    48:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.93it/s]
Train    48:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.01it/s]
Train    48:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.03it/s]
Train    48:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.05it/s]
Train    48:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.05it/s]
Train    48:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.07it/s]
Train    48:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.04it/s]
Train    48:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.05it/s]
Train    48:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.02it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.98it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.01it/s]
13 Oct 03:39    INFO  epoch 48 training [time: 1.37s, train loss: 9.4924]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.18it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.38it/s]
13 Oct 03:39    INFO  epoch 48 evaluating [time: 0.14s, valid_score: 0.861200]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.8738    recall@10 : 0.8873    mrr@5 : 0.8594    mrr@10 : 0.8612    ndcg@5 : 0.863    ndcg@10 : 0.8674    hit@5 : 0.8738    hit@10 : 0.8873    precision@5 : 0.1748    precision@10 : 0.0887

Train    49:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    49:   9%|████▋                                              | 1/11 [00:00<00:01,  8.00it/s]
Train    49:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.90it/s]
Train    49:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.88it/s]
Train    49:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.99it/s]
Train    49:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.03it/s]
Train    49:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.96it/s]
Train    49:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.90it/s]
Train    49:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.91it/s]
Train    49:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.62it/s]
Train    49:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.51it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.56it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.76it/s]
13 Oct 03:39    INFO  epoch 49 training [time: 1.42s, train loss: 9.9048]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  9.55it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 16.31it/s]
13 Oct 03:39    INFO  epoch 49 evaluating [time: 0.19s, valid_score: 0.861300]
13 Oct 03:39    INFO  valid result: 
recall@5 : 0.876    recall@10 : 0.886    mrr@5 : 0.8599    mrr@10 : 0.8613    ndcg@5 : 0.8639    ndcg@10 : 0.8671    hit@5 : 0.876    hit@10 : 0.886    precision@5 : 0.1752    precision@10 : 0.0886
13 Oct 03:39    INFO  Loading model structure and parameters from saved/BERT4Rec-Oct-13-2025_03-38-19.pth

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 12.37it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 16.79it/s]
13 Oct 03:39    INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |    18.00 %     |
+-------------+----------------+
| GPU         |   0.0 / 0.0    |
+-------------+----------------+
| Memory      | 1.56 G/15.33 G |
+-------------+----------------+
13 Oct 03:39    INFO  best valid : OrderedDict({'recall@5': 0.8724, 'recall@10': 0.8828, 'mrr@5': 0.8607, 'mrr@10': 0.862, 'ndcg@5': 0.8636, 'ndcg@10': 0.8669, 'hit@5': 0.8724, 'hit@10': 0.8828, 'precision@5': 0.1745, 'precision@10': 0.0883})
13 Oct 03:39    INFO  test result: OrderedDict({'recall@5': 0.9787, 'recall@10': 0.9835, 'mrr@5': 0.9596, 'mrr@10': 0.9602, 'ndcg@5': 0.9645, 'ndcg@10': 0.966, 'hit@5': 0.9787, 'hit@10': 0.9835, 'precision@5': 0.1957, 'precision@10': 0.0983})
2025-10-13 03:39:41,598 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/versions/BERT4Rec-Oct-13-2025_03-26-41.pth
2025-10-13 03:39:41,599 | INFO | Published checkpoint /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/saved/BERT4Rec-Oct-13-2025_03-38-19.pth → /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/versions/BERT4Rec-Oct-13-2025_03-38-19.pth
2025-10-13 03:39:41,599 | INFO | Retraining completed in 0:01:27.549005 | dataset=20251012-203815 | model=Oct-13-2025_03-38-19
2025-10-13 03:40:11,602 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:40:12,398 | INFO | 🔄 Đang trích xuất data từ Postgres...
🐘 Đã trích xuất bằng psycopg.
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 69
Số user: 2
Số sản phẩm: 11
Các loại event: {'add_to_cart': 0.42, 'view': 0.377, 'purchase': 0.203}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[10 rows x 5 columns]
2025-10-13 03:40:12,398 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:40:12,972 | INFO | 🗂  Đã cập nhật /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/interactions.csv (tổng 18368 bản ghi).
✅ Đã tạo snapshot 20251012-204012 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-204012/ecommerce.inter) với 18368 dòng
👥  User: 2609 | 🛒  Sản phẩm: 106
🏷️   Nhãn mua hàng (label=1): 2995
      user_id item_id   timestamp  label
4952        3      25  1704067200      0
4953        3      25  1704068520      0
18272       3      89  1707264000      0
18273       3      89  1707264300      0
18274       3      89  1707265440      0
18275       3      89  1707266820      1
1123        3      12  1708041600      0
1124        3      12  1708044480      0
10396       4       4  1707436800      0
10397       4       4  1707437100      0
2025-10-13 03:40:12,973 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-202833
2025-10-13 03:40:12,973 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 03:41:39,523 | INFO | 13 Oct 03:40    INFO  ['train_bert4rec.py']
13 Oct 03:40    INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = False
seed = 2020
state = INFO
reproducibility = True
data_path = /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/ecommerce
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 50
train_batch_size = 1024
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [5, 10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 1024
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = label
TIME_FIELD = timestamp
seq_len = 50
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp', 'label']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = mask_itemseq
n_layers = 2
n_heads = 2
hidden_size = 64
inner_size = 256
hidden_dropout_prob = 0.2
attn_dropout_prob = 0.2
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
mask_ratio = 0.2
loss_type = CE
ft_ratio = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
neg_sampling = None
embedding_size = 64
num_layers = 2
num_heads = 2
dropout_prob = 0.2
device = cuda
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:648: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=0, inplace=True)
/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/data/dataset/dataset.py:650: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  feat[field].fillna(value=feat[field].mean(), inplace=True)
13 Oct 03:40    INFO  ecommerce
The number of users: 2608
Average actions of users: 7.045646336785578
The number of items: 96
Average actions of items: 193.34736842105264
The number of inters: 18368
The sparsity of the dataset: 92.66359918200409%
Remain Fields: ['user_id', 'item_id', 'timestamp', 'label']
13 Oct 03:40    INFO  [Training]: train_batch_size = [1024] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
13 Oct 03:40    INFO  [Evaluation]: eval_batch_size = [1024] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
13 Oct 03:40    INFO  BERT4Rec(
  (item_embedding): Embedding(97, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (trm_encoder): TransformerEncoder(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.2, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.2, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (output_ffn): Linear(in_features=64, out_features=64, bias=True)
  (output_gelu): GELU(approximate='none')
  (output_ln): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
)
Trainable parameters: 113888
13 Oct 03:40    INFO  FLOPs: 5194664.0
🔧 Sử dụng topk=[5, 10], valid_metric=MRR@10, device=cpu

Train     0:   0%|                                                           | 0/11 [00:00<?, ?it/s]/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/lib/python3.12/site-packages/recbole/trainer/trainer.py:235: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=self.enable_scaler)

Train     0:   9%|████▋                                              | 1/11 [00:00<00:02,  3.62it/s]
Train     0:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.47it/s]
Train     0:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.58it/s]
Train     0:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.19it/s]
Train     0:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.62it/s]
Train     0:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.10it/s]
Train     0:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.28it/s]
Train     0:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.54it/s]
Train     0:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.66it/s]
Train     0:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.76it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.81it/s]
Train     0: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.78it/s]
13 Oct 03:40    INFO  epoch 0 training [time: 1.42s, train loss: 49.7594]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  8.24it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 14.57it/s]
13 Oct 03:40    INFO  epoch 0 evaluating [time: 0.22s, valid_score: 0.057500]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.0937    recall@10 : 0.1765    mrr@5 : 0.0466    mrr@10 : 0.0575    ndcg@5 : 0.0582    ndcg@10 : 0.0847    hit@5 : 0.0937    hit@10 : 0.1765    precision@5 : 0.0187    precision@10 : 0.0176
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train     1:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     1:   9%|████▋                                              | 1/11 [00:00<00:01,  8.78it/s]
Train     1:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.78it/s]
Train     1:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.80it/s]
Train     1:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.60it/s]
Train     1:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.34it/s]
Train     1:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.41it/s]
Train     1:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.47it/s]
Train     1:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.02it/s]
Train     1:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.26it/s]
Train     1:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.47it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.53it/s]
Train     1: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.46it/s]
13 Oct 03:40    INFO  epoch 1 training [time: 1.30s, train loss: 48.9054]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.54it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.46it/s]
13 Oct 03:40    INFO  epoch 1 evaluating [time: 0.17s, valid_score: 0.078800]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.1348    recall@10 : 0.2118    mrr@5 : 0.0691    mrr@10 : 0.0788    ndcg@5 : 0.0853    ndcg@10 : 0.1096    hit@5 : 0.1348    hit@10 : 0.2118    precision@5 : 0.027    precision@10 : 0.0212
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train     2:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     2:   9%|████▋                                              | 1/11 [00:00<00:01,  8.85it/s]
Train     2:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.79it/s]
Train     2:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.52it/s]
Train     2:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.53it/s]
Train     2:  45%|███████████████████████▏                           | 5/11 [00:00<00:01,  5.95it/s]
Train     2:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.68it/s]
Train     2:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.16it/s]
Train     2:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.56it/s]
Train     2:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.87it/s]
Train     2:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.82it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.06it/s]
Train     2: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.67it/s]
13 Oct 03:40    INFO  epoch 2 training [time: 1.44s, train loss: 46.8474]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.27it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.90it/s]
13 Oct 03:40    INFO  epoch 2 evaluating [time: 0.13s, valid_score: 0.351100]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.5244    recall@10 : 0.6136    mrr@5 : 0.3392    mrr@10 : 0.3511    ndcg@5 : 0.3855    ndcg@10 : 0.4144    hit@5 : 0.5244    hit@10 : 0.6136    precision@5 : 0.1049    precision@10 : 0.0614
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train     3:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     3:   9%|████▋                                              | 1/11 [00:00<00:01,  8.54it/s]
Train     3:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.64it/s]
Train     3:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.73it/s]
Train     3:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.82it/s]
Train     3:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.88it/s]
Train     3:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.87it/s]
Train     3:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.68it/s]
Train     3:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.54it/s]
Train     3:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.48it/s]
Train     3:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.51it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.60it/s]
Train     3: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.64it/s]
13 Oct 03:40    INFO  epoch 3 training [time: 1.27s, train loss: 42.5084]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.92it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.75it/s]
13 Oct 03:40    INFO  epoch 3 evaluating [time: 0.13s, valid_score: 0.538900]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.6611    recall@10 : 0.7217    mrr@5 : 0.5306    mrr@10 : 0.5389    ndcg@5 : 0.5636    ndcg@10 : 0.5834    hit@5 : 0.6611    hit@10 : 0.7217    precision@5 : 0.1322    precision@10 : 0.0722
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train     4:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     4:   9%|████▋                                              | 1/11 [00:00<00:01,  8.74it/s]
Train     4:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.61it/s]
Train     4:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.66it/s]
Train     4:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.65it/s]
Train     4:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.63it/s]
Train     4:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.63it/s]
Train     4:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.67it/s]
Train     4:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.66it/s]
Train     4:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.58it/s]
Train     4:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.56it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.51it/s]
Train     4: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.59it/s]
13 Oct 03:40    INFO  epoch 4 training [time: 1.28s, train loss: 38.5157]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.23it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.75it/s]
13 Oct 03:40    INFO  epoch 4 evaluating [time: 0.15s, valid_score: 0.577400]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.6937    recall@10 : 0.7443    mrr@5 : 0.5704    mrr@10 : 0.5774    ndcg@5 : 0.6016    ndcg@10 : 0.6183    hit@5 : 0.6937    hit@10 : 0.7443    precision@5 : 0.1387    precision@10 : 0.0744
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train     5:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     5:   9%|████▋                                              | 1/11 [00:00<00:01,  8.38it/s]
Train     5:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.61it/s]
Train     5:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.40it/s]
Train     5:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.35it/s]
Train     5:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.33it/s]
Train     5:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.32it/s]
Train     5:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.33it/s]
Train     5:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.42it/s]
Train     5:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.40it/s]
Train     5:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.37it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.45it/s]
Train     5: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.40it/s]
13 Oct 03:40    INFO  epoch 5 training [time: 1.31s, train loss: 35.0609]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.62it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.17it/s]
13 Oct 03:40    INFO  epoch 5 evaluating [time: 0.13s, valid_score: 0.636100]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.7303    recall@10 : 0.7765    mrr@5 : 0.6301    mrr@10 : 0.6361    ndcg@5 : 0.6553    ndcg@10 : 0.6701    hit@5 : 0.7303    hit@10 : 0.7765    precision@5 : 0.1461    precision@10 : 0.0776
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train     6:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     6:   9%|████▋                                              | 1/11 [00:00<00:01,  8.53it/s]
Train     6:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.69it/s]
Train     6:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.69it/s]
Train     6:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.72it/s]
Train     6:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.61it/s]
Train     6:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.32it/s]
Train     6:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.88it/s]
Train     6:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.34it/s]
Train     6:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.74it/s]
Train     6:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.97it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.23it/s]
Train     6: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.87it/s]
13 Oct 03:40    INFO  epoch 6 training [time: 1.40s, train loss: 31.5342]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.34it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.91it/s]
13 Oct 03:40    INFO  epoch 6 evaluating [time: 0.13s, valid_score: 0.688700]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.7548    recall@10 : 0.8023    mrr@5 : 0.6823    mrr@10 : 0.6887    ndcg@5 : 0.7006    ndcg@10 : 0.716    hit@5 : 0.7548    hit@10 : 0.8023    precision@5 : 0.151    precision@10 : 0.0802
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train     7:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     7:   9%|████▋                                              | 1/11 [00:00<00:01,  7.88it/s]
Train     7:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.19it/s]
Train     7:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.01it/s]
Train     7:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.99it/s]
Train     7:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.11it/s]
Train     7:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.15it/s]
Train     7:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.22it/s]
Train     7:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.21it/s]
Train     7:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.29it/s]
Train     7:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.26it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.22it/s]
Train     7: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.17it/s]
13 Oct 03:40    INFO  epoch 7 training [time: 1.35s, train loss: 28.7599]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.97it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.87it/s]
13 Oct 03:40    INFO  epoch 7 evaluating [time: 0.14s, valid_score: 0.720300]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.7842    recall@10 : 0.8213    mrr@5 : 0.7153    mrr@10 : 0.7203    ndcg@5 : 0.7326    ndcg@10 : 0.7446    hit@5 : 0.7842    hit@10 : 0.8213    precision@5 : 0.1568    precision@10 : 0.0821
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train     8:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     8:   9%|████▋                                              | 1/11 [00:00<00:01,  8.06it/s]
Train     8:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.21it/s]
Train     8:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.33it/s]
Train     8:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.31it/s]
Train     8:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.20it/s]
Train     8:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.17it/s]
Train     8:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.16it/s]
Train     8:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.18it/s]
Train     8:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.12it/s]
Train     8:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.16it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.17it/s]
Train     8: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.18it/s]
13 Oct 03:40    INFO  epoch 8 training [time: 1.35s, train loss: 25.9326]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.10it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.74it/s]
13 Oct 03:40    INFO  epoch 8 evaluating [time: 0.16s, valid_score: 0.747400]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8041    recall@10 : 0.8339    mrr@5 : 0.7434    mrr@10 : 0.7474    ndcg@5 : 0.7586    ndcg@10 : 0.7683    hit@5 : 0.8041    hit@10 : 0.8339    precision@5 : 0.1608    precision@10 : 0.0834
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train     9:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train     9:   9%|████▋                                              | 1/11 [00:00<00:01,  7.90it/s]
Train     9:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.00it/s]
Train     9:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.23it/s]
Train     9:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.24it/s]
Train     9:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.20it/s]
Train     9:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.10it/s]
Train     9:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.09it/s]
Train     9:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.05it/s]
Train     9:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.96it/s]
Train     9:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.77it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.90it/s]
Train     9: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.00it/s]
13 Oct 03:40    INFO  epoch 9 training [time: 1.38s, train loss: 23.2385]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.56it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.88it/s]
13 Oct 03:40    INFO  epoch 9 evaluating [time: 0.17s, valid_score: 0.783100]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.829    recall@10 : 0.8529    mrr@5 : 0.7799    mrr@10 : 0.7831    ndcg@5 : 0.7923    ndcg@10 : 0.8    hit@5 : 0.829    hit@10 : 0.8529    precision@5 : 0.1658    precision@10 : 0.0853
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    10:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    10:   9%|████▋                                              | 1/11 [00:00<00:01,  8.17it/s]
Train    10:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.23it/s]
Train    10:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.33it/s]
Train    10:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.32it/s]
Train    10:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.33it/s]
Train    10:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.32it/s]
Train    10:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.30it/s]
Train    10:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.30it/s]
Train    10:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.27it/s]
Train    10:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.18it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.73it/s]
Train    10: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.55it/s]
13 Oct 03:40    INFO  epoch 10 training [time: 1.46s, train loss: 20.9736]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.26it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.72it/s]
13 Oct 03:40    INFO  epoch 10 evaluating [time: 0.17s, valid_score: 0.809200]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8385    recall@10 : 0.8579    mrr@5 : 0.8065    mrr@10 : 0.8092    ndcg@5 : 0.8145    ndcg@10 : 0.8209    hit@5 : 0.8385    hit@10 : 0.8579    precision@5 : 0.1677    precision@10 : 0.0858
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    11:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    11:   9%|████▋                                              | 1/11 [00:00<00:01,  8.10it/s]
Train    11:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.44it/s]
Train    11:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.89it/s]
Train    11:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.02it/s]
Train    11:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.77it/s]
Train    11:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.53it/s]
Train    11:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.81it/s]
Train    11:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.02it/s]
Train    11:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.20it/s]
Train    11:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.22it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.37it/s]
Train    11: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.04it/s]
13 Oct 03:40    INFO  epoch 11 training [time: 1.37s, train loss: 19.1671]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.54it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 25.09it/s]
13 Oct 03:40    INFO  epoch 11 evaluating [time: 0.13s, valid_score: 0.820000]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8448    recall@10 : 0.8665    mrr@5 : 0.8171    mrr@10 : 0.82    ndcg@5 : 0.8241    ndcg@10 : 0.8311    hit@5 : 0.8448    hit@10 : 0.8665    precision@5 : 0.169    precision@10 : 0.0867
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    12:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    12:   9%|████▋                                              | 1/11 [00:00<00:01,  8.59it/s]
Train    12:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.66it/s]
Train    12:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.61it/s]
Train    12:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.21it/s]
Train    12:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.12it/s]
Train    12:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.93it/s]
Train    12:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.96it/s]
Train    12:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.03it/s]
Train    12:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.00it/s]
Train    12:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.03it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.13it/s]
Train    12: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.13it/s]
13 Oct 03:40    INFO  epoch 12 training [time: 1.35s, train loss: 17.4560]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 18.28it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.91it/s]
13 Oct 03:40    INFO  epoch 12 evaluating [time: 0.13s, valid_score: 0.829300]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8475    recall@10 : 0.8679    mrr@5 : 0.8265    mrr@10 : 0.8293    ndcg@5 : 0.8318    ndcg@10 : 0.8384    hit@5 : 0.8475    hit@10 : 0.8679    precision@5 : 0.1695    precision@10 : 0.0868
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    13:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    13:   9%|████▋                                              | 1/11 [00:00<00:01,  8.48it/s]
Train    13:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.51it/s]
Train    13:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.38it/s]
Train    13:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.36it/s]
Train    13:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.32it/s]
Train    13:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.23it/s]
Train    13:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.25it/s]
Train    13:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.24it/s]
Train    13:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.18it/s]
Train    13:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.42it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.64it/s]
Train    13: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.01it/s]
13 Oct 03:40    INFO  epoch 13 training [time: 1.37s, train loss: 16.1932]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.99it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.85it/s]
13 Oct 03:40    INFO  epoch 13 evaluating [time: 0.17s, valid_score: 0.835100]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8534    recall@10 : 0.8719    mrr@5 : 0.8326    mrr@10 : 0.8351    ndcg@5 : 0.8378    ndcg@10 : 0.8438    hit@5 : 0.8534    hit@10 : 0.8719    precision@5 : 0.1707    precision@10 : 0.0872
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    14:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    14:   9%|████▋                                              | 1/11 [00:00<00:01,  8.02it/s]
Train    14:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.01it/s]
Train    14:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.06it/s]
Train    14:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.09it/s]
Train    14:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.24it/s]
Train    14:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.26it/s]
Train    14:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.24it/s]
Train    14:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.21it/s]
Train    14:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.01it/s]
Train    14:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.79it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.75it/s]
Train    14: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.99it/s]
13 Oct 03:40    INFO  epoch 14 training [time: 1.38s, train loss: 15.6198]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  33%|█████████████████▎                                  | 1/3 [00:00<00:00,  5.18it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 11.23it/s]
13 Oct 03:40    INFO  epoch 14 evaluating [time: 0.28s, valid_score: 0.841300]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.857    recall@10 : 0.8742    mrr@5 : 0.8391    mrr@10 : 0.8413    ndcg@5 : 0.8436    ndcg@10 : 0.8491    hit@5 : 0.857    hit@10 : 0.8742    precision@5 : 0.1714    precision@10 : 0.0874
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    15:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    15:   9%|████▋                                              | 1/11 [00:00<00:01,  8.60it/s]
Train    15:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.97it/s]
Train    15:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.10it/s]
Train    15:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.97it/s]
Train    15:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.94it/s]
Train    15:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.98it/s]
Train    15:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.03it/s]
Train    15:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.05it/s]
Train    15:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.12it/s]
Train    15:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.12it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.17it/s]
Train    15: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.09it/s]
13 Oct 03:40    INFO  epoch 15 training [time: 1.36s, train loss: 13.9309]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.95it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 24.39it/s]
13 Oct 03:40    INFO  epoch 15 evaluating [time: 0.14s, valid_score: 0.845200]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8588    recall@10 : 0.8742    mrr@5 : 0.8432    mrr@10 : 0.8452    ndcg@5 : 0.8471    ndcg@10 : 0.852    hit@5 : 0.8588    hit@10 : 0.8742    precision@5 : 0.1718    precision@10 : 0.0874
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    16:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    16:   9%|████▋                                              | 1/11 [00:00<00:01,  8.63it/s]
Train    16:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.53it/s]
Train    16:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.41it/s]
Train    16:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.31it/s]
Train    16:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.32it/s]
Train    16:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.36it/s]
Train    16:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.28it/s]
Train    16:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.08it/s]
Train    16:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.88it/s]
Train    16:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.82it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.88it/s]
Train    16: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.10it/s]
13 Oct 03:40    INFO  epoch 16 training [time: 1.36s, train loss: 13.4300]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.86it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.66it/s]
13 Oct 03:40    INFO  epoch 16 evaluating [time: 0.15s, valid_score: 0.844100]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8575    recall@10 : 0.8765    mrr@5 : 0.8416    mrr@10 : 0.8441    ndcg@5 : 0.8456    ndcg@10 : 0.8517    hit@5 : 0.8575    hit@10 : 0.8765    precision@5 : 0.1715    precision@10 : 0.0876

Train    17:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    17:   9%|████▋                                              | 1/11 [00:00<00:01,  8.01it/s]
Train    17:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.10it/s]
Train    17:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.18it/s]
Train    17:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.20it/s]
Train    17:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.22it/s]
Train    17:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.26it/s]
Train    17:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.20it/s]
Train    17:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.16it/s]
Train    17:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.10it/s]
Train    17:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.16it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
Train    17: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.16it/s]
13 Oct 03:40    INFO  epoch 17 training [time: 1.35s, train loss: 13.0804]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.57it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.18it/s]
13 Oct 03:40    INFO  epoch 17 evaluating [time: 0.18s, valid_score: 0.846200]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8597    recall@10 : 0.8751    mrr@5 : 0.8443    mrr@10 : 0.8462    ndcg@5 : 0.8481    ndcg@10 : 0.853    hit@5 : 0.8597    hit@10 : 0.8751    precision@5 : 0.1719    precision@10 : 0.0875
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    18:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    18:   9%|████▋                                              | 1/11 [00:00<00:01,  7.64it/s]
Train    18:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.02it/s]
Train    18:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.11it/s]
Train    18:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.21it/s]
Train    18:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.20it/s]
Train    18:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.19it/s]
Train    18:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.02it/s]
Train    18:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.54it/s]
Train    18:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.98it/s]
Train    18:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.33it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.52it/s]
Train    18: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.40it/s]
13 Oct 03:40    INFO  epoch 18 training [time: 1.49s, train loss: 13.4371]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.32it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.74it/s]
13 Oct 03:40    INFO  epoch 18 evaluating [time: 0.15s, valid_score: 0.852200]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8647    recall@10 : 0.8769    mrr@5 : 0.8507    mrr@10 : 0.8522    ndcg@5 : 0.8542    ndcg@10 : 0.8581    hit@5 : 0.8647    hit@10 : 0.8769    precision@5 : 0.1729    precision@10 : 0.0877
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    19:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    19:   9%|████▋                                              | 1/11 [00:00<00:01,  8.55it/s]
Train    19:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.25it/s]
Train    19:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.20it/s]
Train    19:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.11it/s]
Train    19:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.11it/s]
Train    19:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.08it/s]
Train    19:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.04it/s]
Train    19:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  7.96it/s]
Train    19:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.03it/s]
Train    19:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.99it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.97it/s]
Train    19: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.05it/s]
13 Oct 03:40    INFO  epoch 19 training [time: 1.37s, train loss: 13.0179]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.06it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.23it/s]
13 Oct 03:40    INFO  epoch 19 evaluating [time: 0.17s, valid_score: 0.851000]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8638    recall@10 : 0.8778    mrr@5 : 0.8492    mrr@10 : 0.851    ndcg@5 : 0.8529    ndcg@10 : 0.8574    hit@5 : 0.8638    hit@10 : 0.8778    precision@5 : 0.1728    precision@10 : 0.0878

Train    20:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    20:   9%|████▋                                              | 1/11 [00:00<00:01,  7.61it/s]
Train    20:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.63it/s]
Train    20:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.61it/s]
Train    20:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.73it/s]
Train    20:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.75it/s]
Train    20:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.82it/s]
Train    20:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.88it/s]
Train    20:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.88it/s]
Train    20:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.87it/s]
Train    20:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.86it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.83it/s]
Train    20: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.80it/s]
13 Oct 03:40    INFO  epoch 20 training [time: 1.41s, train loss: 12.5615]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.75it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 17.89it/s]
13 Oct 03:40    INFO  epoch 20 evaluating [time: 0.19s, valid_score: 0.852700]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.867    recall@10 : 0.8778    mrr@5 : 0.8513    mrr@10 : 0.8527    ndcg@5 : 0.8552    ndcg@10 : 0.8587    hit@5 : 0.867    hit@10 : 0.8778    precision@5 : 0.1734    precision@10 : 0.0878
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    21:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    21:   9%|████▋                                              | 1/11 [00:00<00:01,  8.05it/s]
Train    21:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.03it/s]
Train    21:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.98it/s]
Train    21:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.10it/s]
Train    21:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.19it/s]
Train    21:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.03it/s]
Train    21:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.93it/s]
Train    21:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.84it/s]
Train    21:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.70it/s]
Train    21:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.62it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.67it/s]
Train    21: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.84it/s]
13 Oct 03:40    INFO  epoch 21 training [time: 1.40s, train loss: 11.9438]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.76it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.28it/s]
13 Oct 03:40    INFO  epoch 21 evaluating [time: 0.16s, valid_score: 0.853200]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8661    recall@10 : 0.8796    mrr@5 : 0.8515    mrr@10 : 0.8532    ndcg@5 : 0.8552    ndcg@10 : 0.8595    hit@5 : 0.8661    hit@10 : 0.8796    precision@5 : 0.1732    precision@10 : 0.088
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    22:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    22:   9%|████▋                                              | 1/11 [00:00<00:01,  7.80it/s]
Train    22:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.87it/s]
Train    22:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.93it/s]
Train    22:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.95it/s]
Train    22:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.97it/s]
Train    22:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  5.98it/s]
Train    22:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.56it/s]
Train    22:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.00it/s]
Train    22:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.28it/s]
Train    22:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.50it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.69it/s]
Train    22: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.36it/s]
13 Oct 03:40    INFO  epoch 22 training [time: 1.50s, train loss: 11.5617]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.41it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.44it/s]
13 Oct 03:40    INFO  epoch 22 evaluating [time: 0.15s, valid_score: 0.852400]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8652    recall@10 : 0.8783    mrr@5 : 0.8506    mrr@10 : 0.8524    ndcg@5 : 0.8543    ndcg@10 : 0.8586    hit@5 : 0.8652    hit@10 : 0.8783    precision@5 : 0.173    precision@10 : 0.0878

Train    23:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    23:   9%|████▋                                              | 1/11 [00:00<00:01,  7.54it/s]
Train    23:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.83it/s]
Train    23:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.97it/s]
Train    23:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.73it/s]
Train    23:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.51it/s]
Train    23:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.70it/s]
Train    23:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.50it/s]
Train    23:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.46it/s]
Train    23:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.59it/s]
Train    23:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.75it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.82it/s]
Train    23: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.69it/s]
13 Oct 03:40    INFO  epoch 23 training [time: 1.43s, train loss: 11.4483]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.32it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.34it/s]
13 Oct 03:40    INFO  epoch 23 evaluating [time: 0.14s, valid_score: 0.850200]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8652    recall@10 : 0.8792    mrr@5 : 0.8483    mrr@10 : 0.8502    ndcg@5 : 0.8525    ndcg@10 : 0.857    hit@5 : 0.8652    hit@10 : 0.8792    precision@5 : 0.173    precision@10 : 0.0879

Train    24:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    24:   9%|████▋                                              | 1/11 [00:00<00:01,  7.79it/s]
Train    24:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.81it/s]
Train    24:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.89it/s]
Train    24:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.93it/s]
Train    24:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.00it/s]
Train    24:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.01it/s]
Train    24:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.03it/s]
Train    24:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.05it/s]
Train    24:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.02it/s]
Train    24:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.95it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.96it/s]
Train    24: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.96it/s]
13 Oct 03:40    INFO  epoch 24 training [time: 1.38s, train loss: 11.3786]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.56it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.37it/s]
13 Oct 03:40    INFO  epoch 24 evaluating [time: 0.14s, valid_score: 0.852300]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8792    mrr@5 : 0.8508    mrr@10 : 0.8523    ndcg@5 : 0.8552    ndcg@10 : 0.8587    hit@5 : 0.8683    hit@10 : 0.8792    precision@5 : 0.1737    precision@10 : 0.0879

Train    25:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    25:   9%|████▋                                              | 1/11 [00:00<00:01,  7.89it/s]
Train    25:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.04it/s]
Train    25:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.07it/s]
Train    25:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.00it/s]
Train    25:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.02it/s]
Train    25:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.09it/s]
Train    25:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.10it/s]
Train    25:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.10it/s]
Train    25:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.15it/s]
Train    25:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.03it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
Train    25: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.08it/s]
13 Oct 03:40    INFO  epoch 25 training [time: 1.36s, train loss: 11.9237]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.64it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.72it/s]
13 Oct 03:40    INFO  epoch 25 evaluating [time: 0.14s, valid_score: 0.852800]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8674    recall@10 : 0.8778    mrr@5 : 0.8513    mrr@10 : 0.8528    ndcg@5 : 0.8553    ndcg@10 : 0.8588    hit@5 : 0.8674    hit@10 : 0.8778    precision@5 : 0.1735    precision@10 : 0.0878

Train    26:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    26:   9%|████▋                                              | 1/11 [00:00<00:01,  7.99it/s]
Train    26:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.00it/s]
Train    26:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.04it/s]
Train    26:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.99it/s]
Train    26:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.05it/s]
Train    26:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.90it/s]
Train    26:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.83it/s]
Train    26:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.84it/s]
Train    26:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.87it/s]
Train    26:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  5.99it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.45it/s]
Train    26: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.23it/s]
13 Oct 03:40    INFO  epoch 26 training [time: 1.52s, train loss: 11.2112]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.07it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.38it/s]
13 Oct 03:40    INFO  epoch 26 evaluating [time: 0.14s, valid_score: 0.854300]
13 Oct 03:40    INFO  valid result: 
recall@5 : 0.8729    recall@10 : 0.8801    mrr@5 : 0.8534    mrr@10 : 0.8543    ndcg@5 : 0.8583    ndcg@10 : 0.8606    hit@5 : 0.8729    hit@10 : 0.8801    precision@5 : 0.1746    precision@10 : 0.088
13 Oct 03:40    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    27:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    27:   9%|████▋                                              | 1/11 [00:00<00:01,  7.76it/s]
Train    27:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.90it/s]
Train    27:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.96it/s]
Train    27:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.95it/s]
Train    27:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.49it/s]
Train    27:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.50it/s]
Train    27:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.49it/s]
Train    27:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.49it/s]
Train    27:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.33it/s]
Train    27:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.51it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.71it/s]
Train    27: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.63it/s]
13 Oct 03:41    INFO  epoch 27 training [time: 1.44s, train loss: 11.0132]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.18it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.07it/s]
13 Oct 03:41    INFO  epoch 27 evaluating [time: 0.17s, valid_score: 0.854500]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8792    mrr@5 : 0.853    mrr@10 : 0.8545    ndcg@5 : 0.8569    ndcg@10 : 0.8604    hit@5 : 0.8683    hit@10 : 0.8792    precision@5 : 0.1737    precision@10 : 0.0879
13 Oct 03:41    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    28:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    28:   9%|████▋                                              | 1/11 [00:00<00:01,  8.08it/s]
Train    28:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.98it/s]
Train    28:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.07it/s]
Train    28:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.80it/s]
Train    28:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.87it/s]
Train    28:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.86it/s]
Train    28:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.74it/s]
Train    28:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.79it/s]
Train    28:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.82it/s]
Train    28:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.82it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.89it/s]
Train    28: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.86it/s]
13 Oct 03:41    INFO  epoch 28 training [time: 1.40s, train loss: 11.1068]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.33it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.80it/s]
13 Oct 03:41    INFO  epoch 28 evaluating [time: 0.15s, valid_score: 0.854200]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.8805    mrr@5 : 0.8528    mrr@10 : 0.8542    ndcg@5 : 0.8571    ndcg@10 : 0.8605    hit@5 : 0.8697    hit@10 : 0.8805    precision@5 : 0.1739    precision@10 : 0.0881

Train    29:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    29:   9%|████▋                                              | 1/11 [00:00<00:01,  7.66it/s]
Train    29:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.90it/s]
Train    29:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.94it/s]
Train    29:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.02it/s]
Train    29:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.04it/s]
Train    29:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.08it/s]
Train    29:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.05it/s]
Train    29:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.06it/s]
Train    29:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.08it/s]
Train    29:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.87it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.94it/s]
Train    29: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.98it/s]
13 Oct 03:41    INFO  epoch 29 training [time: 1.38s, train loss: 11.8484]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.57it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.16it/s]
13 Oct 03:41    INFO  epoch 29 evaluating [time: 0.16s, valid_score: 0.855100]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8692    recall@10 : 0.8783    mrr@5 : 0.8539    mrr@10 : 0.8551    ndcg@5 : 0.8578    ndcg@10 : 0.8607    hit@5 : 0.8692    hit@10 : 0.8783    precision@5 : 0.1738    precision@10 : 0.0878
13 Oct 03:41    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    30:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    30:   9%|████▋                                              | 1/11 [00:00<00:01,  7.79it/s]
Train    30:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.89it/s]
Train    30:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.86it/s]
Train    30:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.74it/s]
Train    30:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.85it/s]
Train    30:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.88it/s]
Train    30:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.88it/s]
Train    30:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  5.76it/s]
Train    30:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.23it/s]
Train    30:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.56it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.89it/s]
Train    30: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.05it/s]
13 Oct 03:41    INFO  epoch 30 training [time: 1.56s, train loss: 10.8367]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.20it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 17.91it/s]
13 Oct 03:41    INFO  epoch 30 evaluating [time: 0.18s, valid_score: 0.856100]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8706    recall@10 : 0.8787    mrr@5 : 0.855    mrr@10 : 0.8561    ndcg@5 : 0.8589    ndcg@10 : 0.8616    hit@5 : 0.8706    hit@10 : 0.8787    precision@5 : 0.1741    precision@10 : 0.0879
13 Oct 03:41    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    31:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    31:   9%|████▋                                              | 1/11 [00:00<00:01,  7.80it/s]
Train    31:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.84it/s]
Train    31:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.92it/s]
Train    31:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.94it/s]
Train    31:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.94it/s]
Train    31:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.88it/s]
Train    31:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.78it/s]
Train    31:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.80it/s]
Train    31:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.86it/s]
Train    31:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.85it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.85it/s]
Train    31: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.86it/s]
13 Oct 03:41    INFO  epoch 31 training [time: 1.40s, train loss: 11.6070]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.67it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.43it/s]
13 Oct 03:41    INFO  epoch 31 evaluating [time: 0.17s, valid_score: 0.856900]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.881    mrr@5 : 0.8553    mrr@10 : 0.8569    ndcg@5 : 0.859    ndcg@10 : 0.8626    hit@5 : 0.8697    hit@10 : 0.881    precision@5 : 0.1739    precision@10 : 0.0881
13 Oct 03:41    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    32:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    32:   9%|████▋                                              | 1/11 [00:00<00:01,  7.52it/s]
Train    32:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.64it/s]
Train    32:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.63it/s]
Train    32:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.69it/s]
Train    32:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.70it/s]
Train    32:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.78it/s]
Train    32:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.86it/s]
Train    32:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.77it/s]
Train    32:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.72it/s]
Train    32:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.60it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.68it/s]
Train    32: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.70it/s]
13 Oct 03:41    INFO  epoch 32 training [time: 1.43s, train loss: 11.3697]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.77it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.15it/s]
13 Oct 03:41    INFO  epoch 32 evaluating [time: 0.17s, valid_score: 0.858500]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.881    mrr@5 : 0.8572    mrr@10 : 0.8585    ndcg@5 : 0.8606    ndcg@10 : 0.8638    hit@5 : 0.871    hit@10 : 0.881    precision@5 : 0.1742    precision@10 : 0.0881
13 Oct 03:41    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    33:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    33:   9%|████▋                                              | 1/11 [00:00<00:01,  7.47it/s]
Train    33:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.53it/s]
Train    33:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.57it/s]
Train    33:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.60it/s]
Train    33:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.65it/s]
Train    33:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.73it/s]
Train    33:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.46it/s]
Train    33:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.51it/s]
Train    33:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.43it/s]
Train    33:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.50it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.56it/s]
Train    33: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.55it/s]
13 Oct 03:41    INFO  epoch 33 training [time: 1.46s, train loss: 11.1416]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.10it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.82it/s]
13 Oct 03:41    INFO  epoch 33 evaluating [time: 0.16s, valid_score: 0.860300]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8719    recall@10 : 0.8778    mrr@5 : 0.8595    mrr@10 : 0.8603    ndcg@5 : 0.8626    ndcg@10 : 0.8646    hit@5 : 0.8719    hit@10 : 0.8778    precision@5 : 0.1744    precision@10 : 0.0878
13 Oct 03:41    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    34:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    34:   9%|████▋                                              | 1/11 [00:00<00:01,  7.76it/s]
Train    34:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.76it/s]
Train    34:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.61it/s]
Train    34:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.65it/s]
Train    34:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.27it/s]
Train    34:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.37it/s]
Train    34:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.47it/s]
Train    34:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.62it/s]
Train    34:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.33it/s]
Train    34:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  5.71it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.31it/s]
Train    34: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.92it/s]
13 Oct 03:41    INFO  epoch 34 training [time: 1.59s, train loss: 9.8315]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.43it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.13it/s]
13 Oct 03:41    INFO  epoch 34 evaluating [time: 0.15s, valid_score: 0.858700]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8828    mrr@5 : 0.857    mrr@10 : 0.8587    ndcg@5 : 0.8604    ndcg@10 : 0.8644    hit@5 : 0.8701    hit@10 : 0.8828    precision@5 : 0.174    precision@10 : 0.0883

Train    35:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    35:   9%|████▋                                              | 1/11 [00:00<00:01,  7.69it/s]
Train    35:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.82it/s]
Train    35:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.07it/s]
Train    35:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.01it/s]
Train    35:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.01it/s]
Train    35:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.86it/s]
Train    35:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.78it/s]
Train    35:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.79it/s]
Train    35:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.74it/s]
Train    35:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.74it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.75it/s]
Train    35: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.82it/s]
13 Oct 03:41    INFO  epoch 35 training [time: 1.41s, train loss: 10.2343]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.67it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.92it/s]
13 Oct 03:41    INFO  epoch 35 evaluating [time: 0.17s, valid_score: 0.856900]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.881    mrr@5 : 0.8552    mrr@10 : 0.8569    ndcg@5 : 0.8585    ndcg@10 : 0.8626    hit@5 : 0.8683    hit@10 : 0.881    precision@5 : 0.1737    precision@10 : 0.0881

Train    36:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    36:   9%|████▋                                              | 1/11 [00:00<00:01,  7.11it/s]
Train    36:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.62it/s]
Train    36:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.72it/s]
Train    36:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.82it/s]
Train    36:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.87it/s]
Train    36:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.97it/s]
Train    36:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.98it/s]
Train    36:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  8.00it/s]
Train    36:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.92it/s]
Train    36:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.88it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.78it/s]
Train    36: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.83it/s]
13 Oct 03:41    INFO  epoch 36 training [time: 1.41s, train loss: 9.8023]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.44it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.93it/s]
13 Oct 03:41    INFO  epoch 36 evaluating [time: 0.17s, valid_score: 0.855700]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.881    mrr@5 : 0.8544    mrr@10 : 0.8557    ndcg@5 : 0.8586    ndcg@10 : 0.8618    hit@5 : 0.871    hit@10 : 0.881    precision@5 : 0.1742    precision@10 : 0.0881

Train    37:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    37:   9%|████▋                                              | 1/11 [00:00<00:01,  8.08it/s]
Train    37:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.87it/s]
Train    37:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.63it/s]
Train    37:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.78it/s]
Train    37:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.96it/s]
Train    37:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.97it/s]
Train    37:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.94it/s]
Train    37:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.85it/s]
Train    37:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.96it/s]
Train    37:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.03it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.08it/s]
Train    37: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.96it/s]
13 Oct 03:41    INFO  epoch 37 training [time: 1.38s, train loss: 10.7128]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.49it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 23.71it/s]
13 Oct 03:41    INFO  epoch 37 evaluating [time: 0.14s, valid_score: 0.855300]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8674    recall@10 : 0.8796    mrr@5 : 0.8538    mrr@10 : 0.8553    ndcg@5 : 0.8572    ndcg@10 : 0.8611    hit@5 : 0.8674    hit@10 : 0.8796    precision@5 : 0.1735    precision@10 : 0.088

Train    38:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    38:   9%|████▋                                              | 1/11 [00:00<00:01,  7.28it/s]
Train    38:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.75it/s]
Train    38:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.94it/s]
Train    38:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.99it/s]
Train    38:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.99it/s]
Train    38:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.01it/s]
Train    38:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.09it/s]
Train    38:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  6.13it/s]
Train    38:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  6.61it/s]
Train    38:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  6.86it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.16it/s]
Train    38: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.28it/s]
13 Oct 03:41    INFO  epoch 38 training [time: 1.51s, train loss: 10.7494]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.14it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.96it/s]
13 Oct 03:41    INFO  epoch 38 evaluating [time: 0.15s, valid_score: 0.859300]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8719    recall@10 : 0.8837    mrr@5 : 0.8576    mrr@10 : 0.8593    ndcg@5 : 0.8612    ndcg@10 : 0.8651    hit@5 : 0.8719    hit@10 : 0.8837    precision@5 : 0.1744    precision@10 : 0.0884

Train    39:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    39:   9%|████▋                                              | 1/11 [00:00<00:01,  7.81it/s]
Train    39:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.75it/s]
Train    39:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.73it/s]
Train    39:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.79it/s]
Train    39:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.69it/s]
Train    39:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.69it/s]
Train    39:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.74it/s]
Train    39:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.78it/s]
Train    39:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.81it/s]
Train    39:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.81it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.78it/s]
Train    39: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.76it/s]
13 Oct 03:41    INFO  epoch 39 training [time: 1.42s, train loss: 11.0422]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.21it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.22it/s]
13 Oct 03:41    INFO  epoch 39 evaluating [time: 0.15s, valid_score: 0.859600]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8697    recall@10 : 0.8837    mrr@5 : 0.8578    mrr@10 : 0.8596    ndcg@5 : 0.8608    ndcg@10 : 0.8653    hit@5 : 0.8697    hit@10 : 0.8837    precision@5 : 0.1739    precision@10 : 0.0884

Train    40:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    40:   9%|████▋                                              | 1/11 [00:00<00:01,  7.67it/s]
Train    40:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.80it/s]
Train    40:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.92it/s]
Train    40:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.99it/s]
Train    40:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.91it/s]
Train    40:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.88it/s]
Train    40:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.85it/s]
Train    40:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.90it/s]
Train    40:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.95it/s]
Train    40:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.97it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.97it/s]
Train    40: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.92it/s]
13 Oct 03:41    INFO  epoch 40 training [time: 1.39s, train loss: 10.1116]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.44it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.99it/s]
13 Oct 03:41    INFO  epoch 40 evaluating [time: 0.14s, valid_score: 0.860800]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8706    recall@10 : 0.8842    mrr@5 : 0.859    mrr@10 : 0.8608    ndcg@5 : 0.8619    ndcg@10 : 0.8663    hit@5 : 0.8706    hit@10 : 0.8842    precision@5 : 0.1741    precision@10 : 0.0884
13 Oct 03:41    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    41:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    41:   9%|████▋                                              | 1/11 [00:00<00:01,  8.05it/s]
Train    41:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.12it/s]
Train    41:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.13it/s]
Train    41:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.16it/s]
Train    41:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.12it/s]
Train    41:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.08it/s]
Train    41:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.11it/s]
Train    41:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.14it/s]
Train    41:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.13it/s]
Train    41:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.10it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.14it/s]
Train    41: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.12it/s]
13 Oct 03:41    INFO  epoch 41 training [time: 1.36s, train loss: 9.5977]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.33it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.29it/s]
13 Oct 03:41    INFO  epoch 41 evaluating [time: 0.14s, valid_score: 0.857700]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8805    mrr@5 : 0.8562    mrr@10 : 0.8577    ndcg@5 : 0.8597    ndcg@10 : 0.8631    hit@5 : 0.8701    hit@10 : 0.8805    precision@5 : 0.174    precision@10 : 0.0881

Train    42:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    42:   9%|████▋                                              | 1/11 [00:00<00:01,  8.00it/s]
Train    42:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.11it/s]
Train    42:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.93it/s]
Train    42:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.99it/s]
Train    42:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.94it/s]
Train    42:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.92it/s]
Train    42:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.91it/s]
Train    42:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.89it/s]
Train    42:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.97it/s]
Train    42:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.96it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.03it/s]
Train    42: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.97it/s]
13 Oct 03:41    INFO  epoch 42 training [time: 1.38s, train loss: 10.2352]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.77it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 21.24it/s]
13 Oct 03:41    INFO  epoch 42 evaluating [time: 0.16s, valid_score: 0.856100]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8683    recall@10 : 0.8828    mrr@5 : 0.8541    mrr@10 : 0.8561    ndcg@5 : 0.8577    ndcg@10 : 0.8624    hit@5 : 0.8683    hit@10 : 0.8828    precision@5 : 0.1737    precision@10 : 0.0883

Train    43:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    43:   9%|████▋                                              | 1/11 [00:00<00:01,  8.35it/s]
Train    43:  18%|█████████▎                                         | 2/11 [00:00<00:01,  5.19it/s]
Train    43:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  6.14it/s]
Train    43:  36%|██████████████████▌                                | 4/11 [00:00<00:01,  6.69it/s]
Train    43:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.09it/s]
Train    43:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.32it/s]
Train    43:  64%|████████████████████████████████▍                  | 7/11 [00:01<00:00,  7.45it/s]
Train    43:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.59it/s]
Train    43:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.48it/s]
Train    43:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.65it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.75it/s]
Train    43: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.25it/s]
13 Oct 03:41    INFO  epoch 43 training [time: 1.52s, train loss: 10.5877]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 14.42it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 19.80it/s]
13 Oct 03:41    INFO  epoch 43 evaluating [time: 0.17s, valid_score: 0.858500]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8701    recall@10 : 0.8846    mrr@5 : 0.8565    mrr@10 : 0.8585    ndcg@5 : 0.8599    ndcg@10 : 0.8647    hit@5 : 0.8701    hit@10 : 0.8846    precision@5 : 0.174    precision@10 : 0.0885

Train    44:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    44:   9%|████▋                                              | 1/11 [00:00<00:01,  7.65it/s]
Train    44:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.82it/s]
Train    44:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.84it/s]
Train    44:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.85it/s]
Train    44:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.91it/s]
Train    44:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.95it/s]
Train    44:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.85it/s]
Train    44:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.82it/s]
Train    44:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.84it/s]
Train    44:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.95it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.02it/s]
Train    44: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.91it/s]
13 Oct 03:41    INFO  epoch 44 training [time: 1.39s, train loss: 10.1106]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 16.49it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.52it/s]
13 Oct 03:41    INFO  epoch 44 evaluating [time: 0.14s, valid_score: 0.860300]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8747    recall@10 : 0.8882    mrr@5 : 0.8586    mrr@10 : 0.8603    ndcg@5 : 0.8625    ndcg@10 : 0.8668    hit@5 : 0.8747    hit@10 : 0.8882    precision@5 : 0.1749    precision@10 : 0.0888

Train    45:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    45:   9%|████▋                                              | 1/11 [00:00<00:01,  7.72it/s]
Train    45:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.84it/s]
Train    45:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.75it/s]
Train    45:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.84it/s]
Train    45:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.89it/s]
Train    45:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.92it/s]
Train    45:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.94it/s]
Train    45:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.96it/s]
Train    45:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.94it/s]
Train    45:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.78it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.87it/s]
Train    45: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.87it/s]
13 Oct 03:41    INFO  epoch 45 training [time: 1.40s, train loss: 9.8360]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 17.05it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 22.90it/s]
13 Oct 03:41    INFO  epoch 45 evaluating [time: 0.14s, valid_score: 0.860300]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8715    recall@10 : 0.8837    mrr@5 : 0.8587    mrr@10 : 0.8603    ndcg@5 : 0.8619    ndcg@10 : 0.8658    hit@5 : 0.8715    hit@10 : 0.8837    precision@5 : 0.1743    precision@10 : 0.0884

Train    46:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    46:   9%|████▋                                              | 1/11 [00:00<00:01,  7.56it/s]
Train    46:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.68it/s]
Train    46:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.87it/s]
Train    46:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.85it/s]
Train    46:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.85it/s]
Train    46:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.85it/s]
Train    46:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.76it/s]
Train    46:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.70it/s]
Train    46:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.79it/s]
Train    46:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.75it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.75it/s]
Train    46: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.77it/s]
13 Oct 03:41    INFO  epoch 46 training [time: 1.42s, train loss: 10.3990]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.01it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 17.75it/s]
13 Oct 03:41    INFO  epoch 46 evaluating [time: 0.19s, valid_score: 0.862000]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8724    recall@10 : 0.8828    mrr@5 : 0.8607    mrr@10 : 0.862    ndcg@5 : 0.8636    ndcg@10 : 0.8669    hit@5 : 0.8724    hit@10 : 0.8828    precision@5 : 0.1745    precision@10 : 0.0883
13 Oct 03:41    INFO  Saving current: saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Train    47:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    47:   9%|████▋                                              | 1/11 [00:00<00:01,  7.79it/s]
Train    47:  18%|█████████▎                                         | 2/11 [00:00<00:01,  7.78it/s]
Train    47:  27%|█████████████▉                                     | 3/11 [00:00<00:01,  7.81it/s]
Train    47:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.84it/s]
Train    47:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.94it/s]
Train    47:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  6.05it/s]
Train    47:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  6.61it/s]
Train    47:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.01it/s]
Train    47:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.33it/s]
Train    47:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.48it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.64it/s]
Train    47: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.35it/s]
13 Oct 03:41    INFO  epoch 47 training [time: 1.50s, train loss: 10.2382]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.07it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.81it/s]
13 Oct 03:41    INFO  epoch 47 evaluating [time: 0.16s, valid_score: 0.860400]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.871    recall@10 : 0.8846    mrr@5 : 0.8586    mrr@10 : 0.8604    ndcg@5 : 0.8617    ndcg@10 : 0.8661    hit@5 : 0.871    hit@10 : 0.8846    precision@5 : 0.1742    precision@10 : 0.0885

Train    48:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    48:   9%|████▋                                              | 1/11 [00:00<00:01,  8.16it/s]
Train    48:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.13it/s]
Train    48:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.03it/s]
Train    48:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  7.98it/s]
Train    48:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  7.97it/s]
Train    48:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  8.05it/s]
Train    48:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  8.04it/s]
Train    48:  73%|█████████████████████████████████████              | 8/11 [00:00<00:00,  8.01it/s]
Train    48:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  8.04it/s]
Train    48:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  8.02it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.06it/s]
Train    48: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  8.04it/s]
13 Oct 03:41    INFO  epoch 48 training [time: 1.37s, train loss: 9.4924]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 15.37it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 20.59it/s]
13 Oct 03:41    INFO  epoch 48 evaluating [time: 0.16s, valid_score: 0.861200]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.8738    recall@10 : 0.8873    mrr@5 : 0.8594    mrr@10 : 0.8612    ndcg@5 : 0.863    ndcg@10 : 0.8674    hit@5 : 0.8738    hit@10 : 0.8873    precision@5 : 0.1748    precision@10 : 0.0887

Train    49:   0%|                                                           | 0/11 [00:00<?, ?it/s]
Train    49:   9%|████▋                                              | 1/11 [00:00<00:01,  8.35it/s]
Train    49:  18%|█████████▎                                         | 2/11 [00:00<00:01,  8.01it/s]
Train    49:  27%|█████████████▉                                     | 3/11 [00:00<00:00,  8.05it/s]
Train    49:  36%|██████████████████▌                                | 4/11 [00:00<00:00,  8.13it/s]
Train    49:  45%|███████████████████████▏                           | 5/11 [00:00<00:00,  8.02it/s]
Train    49:  55%|███████████████████████████▊                       | 6/11 [00:00<00:00,  7.71it/s]
Train    49:  64%|████████████████████████████████▍                  | 7/11 [00:00<00:00,  7.77it/s]
Train    49:  73%|█████████████████████████████████████              | 8/11 [00:01<00:00,  7.78it/s]
Train    49:  82%|█████████████████████████████████████████▋         | 9/11 [00:01<00:00,  7.74it/s]
Train    49:  91%|█████████████████████████████████████████████▍    | 10/11 [00:01<00:00,  7.76it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.85it/s]
Train    49: 100%|██████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.87it/s]
13 Oct 03:41    INFO  epoch 49 training [time: 1.40s, train loss: 9.9048]

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.42it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 18.46it/s]
13 Oct 03:41    INFO  epoch 49 evaluating [time: 0.18s, valid_score: 0.861300]
13 Oct 03:41    INFO  valid result: 
recall@5 : 0.876    recall@10 : 0.886    mrr@5 : 0.8599    mrr@10 : 0.8613    ndcg@5 : 0.8639    ndcg@10 : 0.8671    hit@5 : 0.876    hit@10 : 0.886    precision@5 : 0.1752    precision@10 : 0.0886
13 Oct 03:41    INFO  Loading model structure and parameters from saved/BERT4Rec-Oct-13-2025_03-40-16.pth

Evaluate   :   0%|                                                            | 0/3 [00:00<?, ?it/s]
Evaluate   :  67%|██████████████████████████████████▋                 | 2/3 [00:00<00:00, 13.47it/s]
Evaluate   : 100%|████████████████████████████████████████████████████| 3/3 [00:00<00:00, 17.77it/s]
13 Oct 03:41    INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |    20.80 %     |
+-------------+----------------+
| GPU         |   0.0 / 0.0    |
+-------------+----------------+
| Memory      | 1.54 G/15.33 G |
+-------------+----------------+
13 Oct 03:41    INFO  best valid : OrderedDict({'recall@5': 0.8724, 'recall@10': 0.8828, 'mrr@5': 0.8607, 'mrr@10': 0.862, 'ndcg@5': 0.8636, 'ndcg@10': 0.8669, 'hit@5': 0.8724, 'hit@10': 0.8828, 'precision@5': 0.1745, 'precision@10': 0.0883})
13 Oct 03:41    INFO  test result: OrderedDict({'recall@5': 0.9787, 'recall@10': 0.9835, 'mrr@5': 0.9596, 'mrr@10': 0.9602, 'ndcg@5': 0.9645, 'ndcg@10': 0.966, 'hit@5': 0.9787, 'hit@10': 0.9835, 'precision@5': 0.1957, 'precision@10': 0.0983})
2025-10-13 03:41:39,533 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/versions/BERT4Rec-Oct-13-2025_03-28-38.pth
2025-10-13 03:41:39,533 | INFO | Published checkpoint /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training/saved/BERT4Rec-Oct-13-2025_03-40-16.pth → /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/saved/versions/BERT4Rec-Oct-13-2025_03-40-16.pth
2025-10-13 03:41:39,533 | INFO | Retraining completed in 0:01:27.933265 | dataset=20251012-204012 | model=Oct-13-2025_03-40-16
2025-10-13 03:42:09,537 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python user_behavior_advanced.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:42:10,302 | INFO | 🔄 Đang trích xuất data từ Postgres...
🐘 Đã trích xuất bằng psycopg.
✅ Đã tạo file /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/user_behavior_interactions.csv
Tổng số event: 69
Số user: 2
Số sản phẩm: 11
Các loại event: {'add_to_cart': 0.42, 'view': 0.377, 'purchase': 0.203}
                             session_id  ...   event_type
0  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
1  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
2  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
3  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
4  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
5  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view
6  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
7  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
8  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...  add_to_cart
9  df6fccfa-0843-4fd9-8111-c1c163b07d32  ...         view

[10 rows x 5 columns]
2025-10-13 03:42:10,302 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python prepare_interactions_for_recbole.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/preprocessing)
2025-10-13 03:42:10,857 | INFO | 🗂  Đã cập nhật /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/data/raw/interactions.csv (tổng 18368 bản ghi).
✅ Đã tạo snapshot 20251012-204210 (/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-204210/ecommerce.inter) với 18368 dòng
👥  User: 2609 | 🛒  Sản phẩm: 106
🏷️   Nhãn mua hàng (label=1): 2995
      user_id item_id   timestamp  label
4952        3      25  1704067200      0
4953        3      25  1704068520      0
18272       3      89  1707264000      0
18273       3      89  1707264300      0
18274       3      89  1707265440      0
18275       3      89  1707266820      1
1123        3      12  1708041600      0
1124        3      12  1708044480      0
10396       4       4  1707436800      0
10397       4       4  1707437100      0
2025-10-13 03:42:10,857 | INFO | Removed old version: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/dataset/versions/20251012-203029
2025-10-13 03:42:10,857 | INFO | Running: /home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/venv/bin/python train_bert4rec.py (cwd=/home/nemmer/Nemmer-Workflow/Project/Second-hand-Web-VietNam/ai-agent/recommender/training)
2025-10-13 03:42:23,229 | INFO | Starting scheduler mode (interval=20s, keep=6)
2025-10-13 03:53:03,921 | INFO | Starting scheduler mode (interval=20s, keep=6)
2025-10-13 04:12:15,718 | INFO | Starting scheduler mode (interval=20s, keep=6)
